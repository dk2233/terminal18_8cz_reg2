MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000000                00001 ﻿; w tej wersji wartosci temperatur sa wysylane zaraz po pomiarze
                      00002 
                      00003 
                      00004 ;zmieniono histereze na histereza 1 - gorna
                      00005 ;- oraz histereza 2  - dolna
                      00006 
                      00007 
                      00008 ;dodano sterowanie drugim obwodem
                      00009 ;rozszerzono menu o kolejne opcje - związane z operacją pracy regulatora drugiego
                      00010 
                      00011 
                      00012 ;program dopasowany do wspolpracy z ukladem 
                      00013 ;z pracy statutowej2007
                      00014 ;tzn tylko rejestracja danych
                      00015 
                      00016 ;procek = 18f4320
                      00017 
                      00018 ;procek = 18f442
                      00019 
                      00020 
                      00021 ;dodano  prezentacja  
                      00022 ;poprawa 
  00000010            00023 jak_duzo_zliczen_tmr1_na_sekunde    equ   0x10
                      00024 
  018F4320            00025 procek = 18f4320
                      00026 
                      00027         IF (procek == 18f442)
                      00028         LIST P=18f442
                      00029         include  "p18f442.inc"
                      00030 
                      00031          __CONFIG _CONFIG1H, _OSCS_OFF_1H & _XT_OSC_1H 
                      00032          __CONFIG _CONFIG2L, _BOR_OFF_2L & _PWRT_ON_2L
                      00033          __CONFIG _CONFIG2H, _WDT_OFF_2H
                      00034          
                      00035          __CONFIG _CONFIG4L, _DEBUG_ON_4L & _LVP_OFF_4L & _STVR_OFF_4L
                      00036         
                      00037         ENDIF
                      00038 
                      00039         IF (procek==18f4320)
                      00040         LIST P=18f4320
                      00041         include  "p18f4320.inc"
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC18F4320 processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2013 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      01412         LIST
                      00042 
                      00043          ; CONFIG FSCM=ON, IESO=OFF, OSC=XT, PWRT=ON, BOR=OFF, BORV=27, WDT=OFF, CCP2MX=OFF ,PBAD = DIG,
                             MCLRE = ON, DEBUG=ON, LVP=OFF
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

41 0A 1E 80 81 0F C0 000044          CONFIG FSCM=ON, IESO=OFF, OSC=XT, PWRT=ON, BOR=ON, BORV=27, WDT=OFF, CCP2MX=OFF ,PBAD = DIG, MC
                            LRE = ON, DEBUG=OFF, LVP=OFF
       F E0 0F 40 
                      00045          ; CONFIG1H, _IESO_OFF_1H & _XT_OSC_1H 
                      00046          ; __CONFIG _CONFIG2L, _BOR_ON_2L & _BORV_45_2L & _PWRT_ON_2L
                      00047          ; __CONFIG _CONFIG2H, _WDT_OFF_2H
                      00048          ; __CONFIG _CONFIG3H, _PBAD_DIG_3H & _MCLRE_ON_3H
                      00049          ; __CONFIG _CONFIG4L, _DEBUG_OFF_4L & _LVP_OFF_4L & _STVR_OFF_4L
                      00050         ENDIF
                      00051          
                      00052          ;__CONFIG _XT_OSC & _WDT_OFF & _PWRTE_ON & _BODEN_OFF & _LVP_OFF & _CPD_OFF & _WRT_OFF & _CP_OF
                            F & _DEBUG_OFF
                      00053 
                      00054 ;definicje są w odzielnym pliku
                      00055 
                      00056         include "def_var_reg2.h"
                      00001 
                      00002 
                      00003          
                      00004 
                      00005 
                      00006 
                      00007          cblock   80h
  00000080            00008          w_temp
  00000081            00009          status_temp
  00000082            00010          pclath_temp
  00000083            00011          bsr_temp
  00000084            00012          fsrl_temp
  00000085            00013          fsrh_temp
  00000086            00014          linia1
  00000087            00015          linia2
  00000088            00016          linia3
  00000089            00017          linia4
  0000008A            00018          letter
  0000008B            00019          n
  0000008C            00020          bit
  0000008D            00021          odebrano_liter
  0000008E            00022          liczba1
  0000008F            00023          liczba2
  00000090            00024          liczba3
  00000091            00025          tmp                       ; uzywany w odbiorze danych i procedurach poleceń
  00000092            00026          tmp_hex                    ;uzywany w procedurze hex2dec
  00000093            00027          tmp_hex_H                  ;starszy bajt 
  00000094            00028          tmp6                       ; uzywany w poprawce temp
  00000095            00029          tmp7                        ; uzywany do odbioru danych z rs232
  00000096            00030          dec100
  00000097            00031          dec10
  00000098            00032          dec1
  00000099            00033          stan_key
  0000009A            00034          stan2_key
  0000009B            00035          wynikh
  0000009C            00036          wynik
  0000009D            00037          wynik01
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000009E            00038          znaczniki ;0x09a
  0000009F            00039          markers
  000000A0            00040          markers2
  000000A1            00041          markers3
  000000A2            00042          markers_regulacja
  000000A3            00043          dane_lcd
  000000A4            00044          tmp_lcd              ; używany w procedurach lcd
  000000A5            00045          rcsta_temp
  000000A6            00046          aktualny_odstep
  000000A7            00047          ktory_rejestr_zapisuje
  000000A8            00048           pomiarH
  000000A9            00049           pomiarL
  000000AA            00050           pomiar_ulamek
  000000AB            00051          ktory_kanal_mierze ; 0x0a0
                      00052 
                      00053 ;po kolei ustawione opcje zeby wygodniej zapisywac         
  000000AC            00054          ile_kanalow ;0x0ac
  000000AD            00055          odstep_pomiarowy
  000000AE            00056          jak_duzo_probek  ;0x80
  000000AF            00057           jaka_wartosc_regulujeH1
  000000B0            00058           jaka_wartosc_regulujeL1
                      00059           
  000000B1            00060           jaka_wartosc_regulujeH2
  000000B2            00061           jaka_wartosc_regulujeL2
                      00062           
                      00063           
  000000B3            00064          histereza_R1_1
  000000B4            00065          histereza_R1_2
                      00066          
  000000B5            00067          histereza_R2_1
  000000B6            00068          histereza_R2_2
  000000B7            00069          czy_reguluje1
  000000B8            00070          czy_reguluje2
  000000B9            00071          ktory_czujnik_reguluje1
                      00072          
  000000BA            00073          ktory_czujnik_reguluje2
                      00074          
                      00075 
                      00076 
                      00077 
                      00078          
  000000BB            00079           ktora_probka
  000000BC            00080           ktory_kanal
  000000BD            00081           usrednianie_przez_co_mnoze
                      00082           ; znaczniki_ds
  000000BE            00083           polecenie_wysylane
                      00084          ; jak_duzo_bajtow_odbieram_z_ds
                      00085          
  000000BF            00086          pomiar0H
  000000C0            00087          pomiar0L
  000000C1            00088          pomiar1H
  000000C2            00089          pomiar1L
  000000C3            00090          pomiar2H
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  000000C4            00091          pomiar2L
  000000C5            00092          pomiar3H
  000000C6            00093          pomiar3L
  000000C7            00094          pomiar4H
  000000C8            00095          pomiar4L
  000000C9            00096          pomiar5H
  000000CA            00097          pomiar5L
  000000CB            00098          pomiar6H
  000000CC            00099          pomiar6L
  000000CD            00100          pomiar7H
  000000CE            00101          pomiar7L
  000000CF            00102          pomiar_prad1H
  000000D0            00103          pomiar_prad1L
  000000D1            00104          pomiar_prad2H
  000000D2            00105          pomiar_prad2L
  000000D3            00106          bajt_ds
  000000D4            00107          poprawka0
  000000D5            00108          poprawka1
  000000D6            00109          poprawka2
  000000D7            00110          poprawka3
  000000D8            00111          poprawka4
  000000D9            00112          poprawka5
  000000DA            00113          poprawka6
  000000DB            00114          poprawka7
  000000DC            00115          poprawka_prad1
  000000DD            00116          poprawka_prad2
  000000DE            00117          jak_duzo_kanalow_pradu
  000000DF            00118          ktory_aktualnie_kanal_pradu
                      00119          
  000000E0            00120          dzien_10
  000000E1            00121          dzien_1
  000000E2            00122          godziny_10
  000000E3            00123          godziny_1
  000000E4            00124          minuty_10
  000000E5            00125          minuty_1
  000000E6            00126          sekundy_10
  000000E7            00127          sekundy_1
                      00128          
  000000E8            00129          do_sekundy
  000000E9            00130          pozycja_menu    
  000000EA            00131          numer_opcji
  000000EB            00132          polozenie_gwiazdki
  000000EC            00133          szybka_zmiana_wartosci
                      00134          
  000000ED            00135          fsrl1_temp
  000000EE            00136          fsrh1_temp
                      00137          
                      00138          
  000000EF            00139          ustawianie_czasu_co_wyswietlam
                      00140          
                      00141          
                      00142          
                      00143          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00144          endc
                      00145 ;0xbe                           
                      00146         
                      00147          
                      00148 ;        cblock 100h
                      00149                   
                      00150 ;        endc
                      00151 
                      00152 ;eeprom                  
                      00153          cblock   0
  00000000            00154          poprawka0_ee
  00000001            00155          poprawka1_ee
  00000002            00156          poprawka2_ee
  00000003            00157          poprawka3_ee
  00000004            00158          poprawka4_ee
  00000005            00159          poprawka5_ee
  00000006            00160          poprawka6_ee
  00000007            00161          poprawka7_ee
  00000008            00162          poprawka_prad1_ee
  00000009            00163          poprawka_prad2_ee
                      00164          
                      00165          endc
                      00166 ;rejestry nieuzywane wykorzystuje jako dane
                      00167 
                      00168 ;        equ      TMR1L
                      00169 
                      00170 ;        equ      TMR1H
                      00171 
                      00172 ;                 equ      CCPR1H
                      00173 ;linia            equ      CCPR1L
                      00174                   
                      00175          
  00000004            00176 lampka            equ      4
  00000004            00177 lampka2           equ      4
                      00178 
  00000005            00179 czujnik_ds1820    equ      5                  
                      00180 
  00000F81            00181 portlampka2       equ      PORTB
  00000F82            00182 port_ds1820       equ      PORTC
  00000F82            00183 port_CTS      equ      PORTC                  
  00000F82            00184 port_RTS      equ          PORTC 
                      00185          
  00000004            00186 znacznik_CTS      equ      4
  00000005            00187 znacznik_RTS      equ      5
                      00188 ;klawisze
                      00189 
                      00190 
                      00191 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;markers
                      00192 ;/*wyswietl */     
  00000000            00193 czy_usrednianie   equ      0
  00000001            00194 czy_wysylanie     equ      1
  00000002            00195 pomiary_zrobione  equ      2  ;znacznik tego czy pomiary zostaly skonczone
  00000003            00196 inicjuj_pomiary   equ         3
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000004            00197 czy_wysylac_pomiary_serial    equ       4
  00000005            00198 czy_wyswietlam_temp     equ   5  
  00000006            00199 czy_wlaczyc_ponownie_temp    equ    6
  00000007            00200 trzymanie_klawisza            equ   7
                      00201              
                      00202 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;markers2
                      00203 
  00000000            00204 przerwanie_t0     equ      0
  00000001            00205 przerwanie_t1     equ      1
  00000002            00206 pomiary           equ      2
  00000003            00207 sprawdz_odebrane  equ      3
  00000004            00208 wyslij_pomiar     equ      4
                      00209 
                      00210 
                      00211 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;markers3
                      00212 
  00000000            00213 pomiary_pradu           equ   0
  00000001            00214 znacznik_pomiaru_pradu  equ   1
  00000002            00215 czy_zegar_wyswietlac    equ   2
  00000003            00216 odswiezanie_zegara      equ   3
  00000004            00217 wcisnieto_klawisz       equ   4
  00000005            00218 dzialanie_po_klawiszu   equ    5
  00000006            00219 napisz_minus            equ   6
  00000007            00220 pokazuje_temperatury_47       equ   7
                      00221 
                      00222 
                      00223 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;markers regulacja
                      00224 
  00000000            00225 zalacz_moc1        equ      0
  00000001            00226 reguluj1           equ      1
  00000002            00227 wylacz_moc1        equ      2
  00000003            00228 reguluj2           equ      3
  00000004            00229 zalacz_moc2        equ      4
  00000005            00230 wylacz_moc2        equ      5
                      00231 
                      00232 
  00000003            00233 max_procedury_regu      equ     3
                      00234 
                      00235 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;znaczniki
  00000000            00236 czy_ponownie_wlaczyc_temp     equ   0
  00000001            00237 czy_ponownie_wlaczyc_zegar    equ   1
  00000002            00238 czy_moge_juz_zmieniac         equ   2 ; dotyczy momentu w którym trzymanie klawisza trwa 1 s -> zmiana 
                            wartości
                      00239 
                      00240 
                      00241 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;pozycja_menu
                      00242 ;jezeli jest 0 to ekran główny
                      00243 ;ekran_glowny      equ   0
                      00244 
                      00245 
  00000000            00246 menu_opcje1       equ   0
  00000001            00247 menu_opcje2       equ   1
  00000002            00248 menu_opcje3       equ   2
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000003            00249 menu_opcje4       equ   3
  00000004            00250 menu_opcje5       equ   4
                      00251 
                      00252 
  00000007            00253 zmiana_opcji      equ   7
  00000005            00254 menu_opcje_end    equ   5
  00000014            00255 numer_opcji_koncowej    equ   0x14
                      00256 
                      00257 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;numery opcji
  00000001            00258 opcja_czujniki                   equ   1
  00000002            00259 opcja_odstep                     equ   2
  00000003            00260 opcja_srednia                    equ   3
  00000004            00261 opcja_pomiar_i                   equ   4
  00000005            00262 opcja_ustaw_temp_R1              equ   5
  00000006            00263 opcja_ustaw_temp_R2              equ   6
  00000007            00264 opcja_wlacz_1                 equ   7
  00000008            00265 opcja_wlacz_2                 equ   8
                      00266 
  00000009            00267 opcja_histereza_R1_1               equ   9
  0000000A            00268 opcja_histereza_R1_2              equ  0xa
  0000000B            00269 opcja_histereza_R2_1               equ   0xb
  0000000C            00270 opcja_histereza_R2_2              equ  0xc
                      00271 
  0000000D            00272 opcja_regulacja1                equ        0xd
  0000000E            00273 opcja_regulacja2                equ        0xe
                      00274 
  0000000F            00275 opcja_czujnik_regulacji1            equ   0x0f
  00000010            00276 opcja_czujnik_regulacji2           equ   0x10
                      00277 ;opcja_ustaw_serial                   equ   0xc
  00000011            00278 opcja_wyswietl_zegar          equ   0x11
  00000012            00279 opcja_wyswietl_temp           equ   0x12
  00000013            00280 opcja_podswietlenie           equ   0x13
  00000014            00281 opcja_ustaw_zegar             equ   0x14           
                      00282 ;;
                      00283 ;poprawki_czuj           equ   
                      00284 
  0000000A            00285 polozenie_liczby_menu         equ   0xa
                      00286 
                      00287 ;;;
  00000001            00288 nie      equ      1
  00000010            00289 ile_znakow        equ      10h
                      00290 
                      00291 
                      00292 ;znaczniki
  00000000            00293 kalibracja        equ 0
                      00294 
                      00295 
  00000F81            00296 port_serial       equ      PORTB
  00000007            00297 RXD               equ      7
                      00298 
                      00299 
                      00300 ;
  00000002            00301 ma       equ      2
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000001            00302 mb       equ      1
  00000000            00303 mc       equ      0
  00000003            00304 dana     equ      3        
  00000004            00305 kb_change         equ      4
  00000005            00306 kb_cofnij         equ      5
  00000006            00307 kb_enter    equ      6
  00000007            00308 kb_minus    equ      7
                      00309 
                      00310 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;klawisze
  00000004            00311 dlugosc_oczekiwania_na_zmiane       equ   4
  00000F83            00312 latch_keys        equ      PORTD
  00000F83            00313 port_keys         equ      PORTD
  00000000            00314 latch_back        equ   0
  00000001            00315 latch_down        equ   1
  00000002            00316 latch_up          equ   2
  00000003            00317 latch_enter       equ   3
                      00318 
                      00319 ;stan_key
  00000000            00320 mamy_back    equ   0
  00000001            00321 mamy_down   equ   1
  00000002            00322 mamy_up     equ   2
  00000003            00323 mamy_enter  equ   3
                      00324 
                      00325 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00326 
                      00327 
                      00328 
                      00329 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;LCD
                      00330 
  00000028            00331 set_4bit          equ   b'00101000'
  0000000C            00332 display_on        equ   b'00001100'
  0000002A            00333 init_4bit          equ      b'00101010' ;ustawia 2 linie i 5x8 font
                      00334 
  00000F8C            00335 latch_lcd          equ      LATD
  00000F8B            00336 latch_lcd_e        equ      LATC
  00000F8A            00337 latch_lcd_rw       equ      LATB
  00000F8A            00338 latch_lcd_rs       equ      LATB
                      00339 
                      00340 ;definicja bitow uzywanych w 4 bitowym przesylaniu 0 - uzywany 1 - nieuzywany
                      00341 ;zwiazane z opcja kasowania
  0000000F            00342 ktore_bity_uzywane_na_lcd     equ   0x0f
  000000F0            00343 ktore_bity_lcd_tris           equ   0xf0
  0000000F            00344 normalne_ustawienie_tris_lcd  equ   0x0f
                      00345 
                      00346 
  00000F83            00347 port_lcd          equ      PORTD
                      00348 
  00000F82            00349 port_lcd_e      equ     PORTC
  00000F81            00350 port_lcd_rw     equ     PORTB
  00000F81            00351 port_lcd_rs     equ     PORTB
                      00352 
  00000F95            00353 tris_lcd          equ      TRISD
                      00354 ;0 to pomiar
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00355 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00356 
  00000001            00357 pin_e_4724        equ      1
                      00358 
                      00359 ;3 to ref+
                      00360 
                      00361 
  00000003            00362 enable          equ     3
  00000003            00363 rs              equ     3
  00000002            00364 rw              equ     2
                      00365 
                      00366 ;znaki transmisyjne
  0000000D            00367 znak_cr           equ      0dh
  0000000A            00368 znak_lf           equ      0ah
  000000CC            00369 znak_I            equ      0cch
                      00370 
                      00371 ;znaczniki_ds
                      00372                   ;inicjacja         equ      0
                      00373                   ;skip_rom          equ      1             
  00000001            00374 dane_odebraneH    equ      1
  00000000            00375 dane_odebraneL    equ      0   
                      00376 
                      00377  
                      00378 
  00000F81            00379 port_triak        equ      PORTB
  00000F8A            00380 latch_moc         equ       LATB
                      00381 
  00000000            00382 triak1            equ      0
  00000001            00383 triak2            equ      1
                      00384 
  00000002            00385 pomiar_prad1      equ      2
  00000004            00386 pomiar_prad2      equ      4
                      00387 
                      00388 ;histereza         equ   4
  00000F82            00389 port_multiplekser equ   PORTC
  00000F8B            00390 latch_multiplekser equ   LATC
  00000000            00391 pin_A                  equ    0
  00000001            00392 pin_B                   equ   1
  00000002            00393 pin_C                   equ   2
                      00394 
                      00395 
                      00396 
                      00397 ;ustawienia czujników
                      00398 
  00000007            00399 ilosc_czujnikow            equ      7      
                      00057 
  00000001            00058 czy_ekran         equ      1
  00000001            00059 czy_pomiary_na_ekran       equ      1
  00000001            00060 polozenie_danych_lcd equ 1
                      00061 ;2007-06-07
                      00062 ;
                      00063 ;dodano obsluge ds1820
                      00064 ;poprawiono bledy
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00065 ;ten program odbiera dane korzystajac z modulu obslugi USART
                      00066 ;w procesorze
                      00067 
                      00068 ;jest to "karta" zbioru danych z 2 czujników temp
                      00069 ;LM35 i
                      00070 ;
                      00071 ;
                      00072 ;PORTD -0 -Klawisz Back
                      00073 ;PORTD -1 -Klawisz down
                      00074 ;PORTD -2 - klawisz up
                      00075 ;PORTD -3 -Klawisz enter
                      00076 ;PORTD -4 - LCD Data
                      00077 ;PORTD -5 - Lcd Data
                      00078 ;PORTD -6 - Lcd Data
                      00079 ;PORTD -7 - Lcd Data
                      00080 
                      00081 ;PORTB -0 -Triak 1 
                      00082 ;PORTB -1 -Triak 2
                      00083 ;PORTB -2 -R/W
                      00084 ;PORTB -3 - RS
                      00085 ;PORTB -4 -
                      00086 ;PORTB -5 -
                      00087 ;PORTB -6 - 
                      00088 ;PORTB -7 -
                      00089          
                      00090 ;PORTC - 0 -  A 4051
                      00091 ;PORTC - 1 -   B 4051
                      00092 ;PORTC-  2 -  C 4051
                      00093 ;POrtc - 3 -   Enable
                      00094 ;POrtc - 4 -  CTS (czyli ze procek wysyla) (dane z procka)
                      00095 ;POrtc - 5 - RTS (czyli znacznik ze komputer cos wysyla) (dane do procka)
                      00096 ;POrtc - 6 - transmit
                      00097 ;POrtc - 7 - receive
                      00098 
                      00099 ;PORTA - 0 - Anlog - 8 wejsc lm35 przez mulitplesker
                      00100 ;PORTA - 1 - 
                      00101 ;PORTA - 2 - pomiar pradu 1
                      00102 ;PORTA - 3 - REferencyjne+2,560 V
                      00103 ;PORTA - 4 - 
                      00104 ;PORTA - 5 - pomiar pradu 2 
                      00105 ;PORTE - 0 - 
                      00106 ;PORTE - 1 - 
                      00107 ;PORTE - 2 - 
                      00108 
                      00109 ;TMR0L - czekanie miedzy kanalami analoga na pomiar
                      00110 ;tmr1  - odliczanie sekund pomiaru
                      00111 ;tmr2  - ewentualnie ds1820
                      00112 ;tmr3  -zegar systemowy (przyciski systemu)
                      00113 
                      00114 ;bledy przy pomiarach - tzn gdzies sie wiesza gdy wylaczy sie pomiary
                      00115 ;zaczyna wyrzucac na ekran wszystkie pomiary nie usredniajac  
                      00116 ;to wynika z faktu ze przy wysylaniu danych pojawia sie powrotne wysylania
                      00117 
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00118 ;okazuje sie ze wlaczenie odbioru "cat /dev/ttyS0" powoduje przeskok RTS w stan 0 (tzn informacja o nada
                            waniu)
                      00119 
                      00120 ;trzeba zrobic tak by odczyt przez komputer byl tylko w czasie wysylania danych tzn 
                      00121 ;gdy CTS jest na wysoko poza tym powinien byc brak odczytu
                      00122 
                      00123 ;INDF0 (FSR0L i FSR0H) - uzywane tylko w odbiorze danych, tzn w komunikacji z portem szeregowym, oraz w 
                            poleceniach 
                      00124 ;INDF1   - uzywane w operacjach Analog oraz w procedurze obróbki danej zmierzonej przez A/D
                      00125 ;INDF2  - używany w procedurach czasu, oraz w 
                      00126 
                      00127 
                      00128 ;2008.03.01
                      00129 ;dodano obsluge zegara i jego wyswietlanie
                      00130 ;brak procedury miganie :zamieniona na procedura_obslugi_zegara
                      00131 
                      00132 ;program działa zupełnie nieźle, jednak wiesza się przy większej liczbie czujników
                      00133 
                      00134 ;2008.03.31
                      00135 
                      00136 
                      00137 
                      00138 ;2008.04.14
                      00139 
                      00140 ;wciąż się wiesza podczas pomiarów temperatury  - próba wyłączania wskazania zegara w trakcie pom
                            iarów nie wpłynęła na poprawę pracy
                      00141 ;wyłączanie wskazywania temperatur również nie wpłynęło na stabilność pracy
                      00142 
                      00143 ;poprawa czyszczenia ekranu kiedy zmieniam wskazania temp na ekranie głównym
                      00144 
                      00145 ;poprawa pracy pokazywania zawartości rejestru
                      00146 ;
                      00147 ;obsługa  wpisywania histerezy, temperatury regulowanej, średniej, ilości próbek,
                      00148                                                                                                         
                                                                                                                            
                      00149 ;2008.04.15
                      00150 ;wieszanie programu w trakcie pomiarów wynikają z błędów w algorytmie uśredniania wyników
                      00151 ;po zmniejszeniu średniej do 32 próbek nie następuje wieszanie
                      00152 ;wyraźnie na błędy wpływa ilość próbek 64 i 128
                      00153 
                      00154 ;próba zmiany algorytmu uśredniania uzyskanego wyniku
                      00155 ;uśrednianie liczb:
                      00156 ;0x80 (128 próbek) to mnożenie przez 0x02 (2/256)
                      00157 ;0x40 (64 próbki) 0x04
                      00158 ;0x20 (32)  0x08
                      00159 ;0x10 (16)   0x10
                      00160 ;0x08 (8)    0x20 
                      00161 ;0x04 (4 próbki) 0x64
                      00162 ;0x02 (2 próbki) 0x80 (128/256 czyli 0.5) 
                      00163 
                      00164 ;usunięcie procedury przesuwania
                      00165 ;2008.04.16
                      00166 ;poprawiony algorytm usredniania pomiarow
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00167 ;
                      00168 ;dodano możliwość zmiany wartości przez trzymanie przycisku
                      00169 ;ustaw temp, odstep, 
                      00170 
                      00171 ;2008.04.17
                      00172 ;ostatecznie poprawiłem wieszanie układu, poprawiłem błędy podczas wyświetlania danych na ekranie 
                            -> błędy były przy powrocie z
                      00173 ;procedur przerwań, tzn W z W_temp wracał najpierw, a potem jeszcze do W zapisywane były inne wartoś
                            ci
                      00174 ;poza tym błędy były przy wywoływaniu procedur klawisza. Otóż każde naciśnięcie klawisza wywoł
                            ywało przeskok do procedury
                      00175 ;w przypadku gdy trzymany był klawisz i procedury wykryły że należy zmieniać wskazanie liczby, nast
                            ępował przekok do procedur wykrycia klawisza up lub down,
                      00176 ;jednak powrót następował za pomocą procedury "goto". Stąd problem, bowiem wywołanie funkcji trzym
                            ania klawisza są za pomocą call. To powodowało brak
                      00177 ;powrotu z funkcji call, i w końcu zapchanie stosu.
                      00178 ;układowi brakuje wciąż:
                      00179 ;           - zmiany ustawień zegara
                      00180 ;           - wybór wartości mocy dostarczanej do układu
                      00181 ;           - błędy - przy wyświetlaniu prądu triaka 2 jego wartosć jest dodawana do wskazania temp
                            eratury 1, 
                      00182 ;           - dodać wybór wskazania który czujnik temperatury jest czujnikiem regulatora
                      00183 ;           - dodać  procedurę regulatora P
                      00184 ;           - regulator PID
                      00185 ;           - dodać przeliczanie wartości zmierzonej prądu na wskazanie amperów
                      00186 ;Poprawić procedurę liczenia średniej wartości pomiarów z pewnego czasu - mieszać ze sobą pomiary
                             w postaci
                      00187 ; pomiar czujnika 1,2,3,4,5 - dłuższa przerwa, 1,2,3,4,5, dłuższa przerwa, etc
                      00188 
                      00189 ;2008.04.26
                      00190 ;błędne działanie procedur pomiaru temperatury - zły pomiar temperatur ujemnych 
                      00191 ;zamiast poprawnej wartości ujemnych po osiągnięciu 0 oC wyświetlana jest wartość -64 oC.
                      00192 ;poza tym zamiast 0 wyświetlane były temperatury na poziomie 1.25 - 1.5 oC. 
                      00193 ;Zważywszy że czujnik był wyskalowany dla temperatur 23 - 20 C, wskazuje to na nierównomierną
                      00194 ;skalę błędu - zmiana być może liniowa - należy to sprawdzić
                      00195 
                      00196 ;2008.04.27
                      00197 ;dodano ustawianie wartości zegara
                      00198 ;
                      00199 ;2009.04.22
                      00200 ;poprawa działania histerezy regulacji dwustawnej
                      00201 
                      00202 
                      00203 ;2011.05.09 
                      00204 ;dalej jest problem z praca regulacji dwustawnej i pomiarami temperatury w punkcie 5
                      00205 
                      00206 
000000                00207          org      0000h
000000                00208 BEGIN
                      00209          ;bsf      PCLATH,3
                      00210          ;bcf      PCLATH,4
                      00211          
000000 EFB2 F00E      00212          goto     inicjacja
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00213                   
                      00214          
000008                00215          org      0008h
                      00216          
000008                00217 przerwanie
                      00218 ;zachowuje rejestr W
000008 CFD8 F081      00219       movff    STATUS,status_temp
00000C 6F80           00220          movwf    w_temp
                      00221 ;zachowuje rejestr STATUS
                      00222          
00000E CFE0 F083      00223          movff    BSR,bsr_temp
                      00224          
000012 50E9           00225          movf     FSR0L,w
000014 6F84           00226          movwf    fsrl_temp
000016 50EA           00227          movf     FSR0H,w
000018 6F85           00228          movwf    fsrh_temp
                      00229          
00001A 50E1           00230          movf     FSR1L,w
00001C 6FED           00231          movwf    fsrl1_temp
00001E 50E2           00232          movf     FSR1H,w
000020 6FEE           00233          movwf    fsrh1_temp
                      00234          
                      00235 ;po to by wszystkie ustawienia banki itd byly na 0    
                      00236          ;bsf      STATUS,RP0
000022 AA9D           00237          btfss    PIE1,RCIE
000024 EF17 F000      00238          goto     przerwanie_1
                      00239          
                      00240          ;bcf      STATUS,RP0
000028 BA9E           00241          btfsc    PIR1,RCIF
00002A EF9C F000      00242          goto     wykryto_odbior    
                      00243 
00002E                00244 przerwanie_1
                      00245          ;bsf      STATUS,RP0
                      00246          
00002E A09D           00247          btfss    PIE1,TMR1IE
000030 EF1D F000      00248          goto     przerwanie_2
                      00249          
                      00250          ;bcf      STATUS,RP0
000034 B09E           00251          btfsc    PIR1,TMR1IF
000036 EF49 F000      00252          goto     wykryto_t1
                      00253 
00003A                00254 przerwanie_2      
                      00255         
                      00256          
00003A A89D           00257          btfss    PIE1,TXIE
00003C EF23 F000      00258          goto     przerwanie_3
                      00259          
                      00260          ;bcf      STATUS,RP0
000040 B89E           00261          btfsc    PIR1,TXIF
000042 EFBE F000      00262          goto     przerwanie_wysylania
                      00263          
000046                00264 przerwanie_3      
                      00265          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00266          
000046 AC9D           00267          btfss    PIE1,ADIE
000048 EF29 F000      00268          goto     przerwanie_4
                      00269          
                      00270          ;bcf      STATUS,RP0
00004C BC9E           00271          btfsc    PIR1,ADIF
00004E EFC8 F000      00272          goto     przerwanie_pomiaru
                      00273          
000052                00274 przerwanie_4
                      00275          
                      00276          
000052 A29D           00277          btfss    PIE1,TMR2IE
000054 EF2F F000      00278          goto     przerwanie_5
                      00279          
                      00280          ;bcf      STATUS,RP0
000058 B29E           00281          btfsc    PIR1,TMR2IF
00005A EF99 F000      00282          goto     wykryto_t2
00005E                00283 przerwanie_5
                      00284          
                      00285 ;        goto     wykryto_rb
                      00286         
                      00287         
00005E B4F2           00288         btfsc    INTCON,TMR0IF
000060 EF94 F000      00289         goto     wykryto_t0
                      00290 
000064                00291 przerwanie_6
000064 A2A0           00292         btfss    PIE2,TMR3IE
000066 EF38 F000      00293         goto     przerwanie_7
                      00294          
                      00295         
00006A B2A1           00296         btfsc    PIR2,TMR3IF
00006C EFD6 F000      00297         goto     wykryto_t3   
                      00298         
000070                00299 przerwanie_7        
000070 B4A1           00300         btfsc    PIR2,LVDIF
000072 EFF0 F000      00301         goto     wykryto_low_voltage
                      00302          
                      00303 ;        btfsc    PIR1,TMR2IF
                      00304 ;        goto     wykryto_t2
                      00305          
000076                00306 wyjscie_przerwanie
                      00307 
000076 C083 FFE0      00308          movff    bsr_temp,BSR
                      00309          
                      00310          
00007A 5184           00311          movf     fsrl_temp,w
00007C 6EE9           00312          movwf    FSR0L
00007E 5185           00313          movf     fsrh_temp,w
000080 6EEA           00314          movwf    FSR0H
                      00315          
000082 51ED           00316          movf     fsrl1_temp,w
000084 6EE1           00317          movwf    FSR1L
000086 51EE           00318          movf     fsrh1_temp,w
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000088 6EE2           00319          movwf    FSR1H
                      00320          
00008A 5180           00321          movf     w_temp,w
00008C C081 FFD8      00322          movff    status_temp,STATUS
                      00323 
000090 0010           00324          retfie
                      00325          
                      00326          
                      00327          
000092                00328 wykryto_t1
                      00329 
                      00330                                                       ;Procedury obslugi czasu
000092 909E           00331       bcf      PIR1,TMR1IF
                      00332       
                      00333       
                      00334          ;czy minelo 16 sekund
000094 83A0           00335       bsf      markers2,przerwanie_t1   
                      00336          
000096 0E10           00337       movlw jak_duzo_zliczen_tmr1_na_sekunde
000098 19E8           00338       xorwf do_sekundy,w
                      00339 ;jezeli    nie  0 w wyniku to skok do procedury 
00009A E13D           00340       bnz   wykryto_t1_wyjscie      
                      00341 ;jezeli 0 to zwiększ sekunda o 1      
                      00342       
00009C 6BE8           00343       clrf  do_sekundy
00009E 2BE7           00344       incf  sekundy_1,f
                      00345            
                      00346 ;sprawdz czy cyfra jednosci nie przekroczyla 9 sekund
0000A0 0E3A           00347       movlw 0x3a
0000A2 19E7           00348       xorwf sekundy_1,w
0000A4 E134           00349       bnz   ustaw_wyswietlanie_czasu_na_lcd
                      00350 ;czyszcze    liczbe jednosci i zwiekszam o jeden liczbe 
0000A6 0E30           00351       movlw 0x30
0000A8 6FE7           00352       movwf  sekundy_1
0000AA 2BE6           00353       incf  sekundy_10,f
                      00354       
0000AC 0E36           00355       movlw 0x36
0000AE 19E6           00356       xorwf sekundy_10,w
0000B0 E12E           00357       bnz   ustaw_wyswietlanie_czasu_na_lcd
0000B2 0E30           00358       movlw 0x30
0000B4 6FE6           00359       movwf  sekundy_10
                      00360       
0000B6 2BE5           00361       incf  minuty_1,f
                      00362 ;sprawdzam czy nie przekroczylem  
                      00363       
0000B8 0E3A           00364       movlw 0x3a
0000BA 19E5           00365       xorwf minuty_1,w
                      00366       
0000BC E128           00367       bnz   ustaw_wyswietlanie_czasu_na_lcd
0000BE 0E30           00368       movlw 0x30
0000C0 6FE5           00369       movwf minuty_1
0000C2 2BE4           00370       incf  minuty_10,f
                      00371       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0000C4 0E36           00372       movlw 0x36
0000C6 19E4           00373       xorwf minuty_10,w
0000C8 E122           00374       bnz   ustaw_wyswietlanie_czasu_na_lcd
0000CA 0E30           00375       movlw 0x30
0000CC 6FE4           00376       movwf minuty_10
                      00377                                           ;godziny      
0000CE 2BE3           00378       incf  godziny_1,f
                      00379 ;sprawdz czy jezeli jest 4 czy nie ma 2 na godziny_10
0000D0 0E34           00380       movlw       0x34
0000D2 63E3           00381       cpfseq      godziny_1
0000D4 EF81 F000      00382       goto        sprawdz_godziny
0000D8 0E32           00383       movlw       0x32
0000DA 63E2           00384       cpfseq      godziny_10
0000DC EF81 F000      00385       goto        sprawdz_godziny
0000E0 0E30           00386       movlw       0x30
0000E2 6FE2           00387       movwf godziny_10
0000E4 6FE3           00388       movwf godziny_1
0000E6 2BE1           00389       incf  dzien_1,f
                      00390       
                      00391             
0000E8                00392 sprawdz_dzien
0000E8 0E3A           00393       movlw 0x3a
0000EA 19E1           00394       xorwf dzien_1,w
0000EC E110           00395       bnz   ustaw_wyswietlanie_czasu_na_lcd
0000EE 0E30           00396       movlw 0x30
0000F0 6FE1           00397       movwf  dzien_1
0000F2 2BE0           00398       incf  dzien_10,f
                      00399       
0000F4 0E3A           00400       movlw 0x3a
0000F6 19E2           00401       xorwf godziny_10,w
0000F8 E10A           00402       bnz   ustaw_wyswietlanie_czasu_na_lcd
0000FA 0E30           00403       movlw 0x30
0000FC 6FE0           00404       movwf dzien_10
                      00405       
0000FE EF87 F000      00406       goto  ustaw_wyswietlanie_czasu_na_lcd
000102                00407 sprawdz_godziny      
000102 0E3A           00408       movlw 0x3a
000104 19E3           00409       xorwf godziny_1,w
000106 E103           00410       bnz   ustaw_wyswietlanie_czasu_na_lcd
000108 0E30           00411       movlw 0x30
00010A 6FE3           00412       movwf godziny_1
00010C 2BE2           00413       incf  godziny_10,f
                      00414       
                      00415       
                      00416       
                      00417 
                      00418 
00010E                00419 ustaw_wyswietlanie_czasu_na_lcd
                      00420       ;czy system obsluguje zegar, bo nie musi i nie powinien przy bardzo częstym pomiarze i wysyłaniu
                             danych
                      00421       ;czyli co 1/16
                      00422       
00010E A5A1           00423       btfss markers3,czy_zegar_wyswietlac
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000110 EF8B F000      00424       goto  wykryto_t1_wyjscie 
                      00425       
                      00426       ;a jezeli ma odswiezyc wszystkie znaki:
000114 87A1           00427       bsf   markers3,odswiezanie_zegara
                      00428       
                      00429       ;jezeli mam odswiezyc zegar to wylaczam na chwilke pomiary i dopiero po wyswietleniu 
                      00430       ;sprawdz czy byly wlaczone pomiary
                      00431       ;btfss       markers2,pomiary
                      00432       ;goto        wykryto_t1_wyjscie 
                      00433       
                      00434       
                      00435       ;bsf   markers,pomiary_zrobione
                      00436       ;i zaznacz zeby je jeszcze raz wlaczyl po wyswietleniu czasu
                      00437       ;bsf   markers,czy_wlaczyc_ponownie_temp
                      00438       
                      00439       
                      00440       
000116                00441 wykryto_t1_wyjscie  
000116 2BE8           00442       incf     do_sekundy,f
                      00443       
000118 EF3B F000      00444       goto     wyjscie_przerwanie                  
                      00445          
00011C                00446 wykryto_rb
                      00447 ;wlaczam przerwanie tmr2 i ustawiam przy pomocy TMR2 na 100us tzn 
                      00448 ;
                      00449 ;
                      00450          
00011C 90F2           00451          bcf      INTCON,RBIF
                      00452          
                      00453 ;        btfsc    markers2,odbior
                      00454 ;        goto     wyjscie_przerwanie
                      00455          
00011E BE81           00456          btfsc    port_serial,RXD
000120 EF3B F000      00457          goto     wyjscie_przerwanie         
                      00458 ;        btfsc    bit,7
                      00459 ;        goto     wylaczam_odbior
                      00460 ;        bsf      markers2,poczatkowy_bit
                      00461          
000124 EF3B F000      00462          goto     wyjscie_przerwanie
                      00463 
000128                00464 wykryto_t0
                      00465 ;uzywam do wykrywania czy juz zrobic pomiar
                      00466         IF (procek == 18f442)
                      00467          bcf      INTCON,T0IF
                      00468          bcf      INTCON,T0IE
                      00469          
                      00470         ENDIF
                      00471 
                      00472         IF (procek == 18f4320)
000128 94F2           00473          bcf      INTCON,TMR0IF
00012A 9AF2           00474          bcf      INTCON,TMR0IE
                      00475          
                      00476         ENDIF
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00477          
00012C 82C2           00478          bsf      ADCON0,GO 
                      00479          ;clrf     pomiarH
                      00480          ;clrf     pomiarL
                      00481          ;clrf     pomiar_ulamek        
00012E EF3B F000      00482          goto     wyjscie_przerwanie
                      00483          
000132                00484 wykryto_t2
                      00485 ;uzywam do odmierzania czasu dla DS1820
                      00486 ;1 - 
                      00487 ;oczekuje kolejne max 480 us. jezeli po tym czasie nie wystapi jeden to napisz blad
                      00488 
                      00489 ;
                      00490 
                      00491 ;
000132 929E           00492          bcf      PIR1,TMR2IF
                      00493          
                      00494 ;jezeli tesuje czas     
                      00495 ;          bcf     PORTC,2         
                      00496          ;bsf      STATUS,RP0
000134 929D           00497          bcf     PIE1,TMR2IE
                      00498          ;bcf      STATUS,RP0
000136 94CA           00499          bcf      T2CON,TMR2ON
                      00500              
                      00501          
                      00502          
                      00503 ;        btfss    markers2,
                      00504 ;        goto     wyjscie_przerwanie
                      00505          
                      00506 ;        bsf      markers2,odbierz_bit
                      00507         
                      00508 
000138                00509 wykryto_odbior
                      00510 ;        btfsc    odebrano_liter,4
                      00511          ;call     miganie
                      00512 ;czytanie rcsta go kasuje
000138                00513 wykryto_odbior_odczyt
                      00514 ;jezeli mam ustawione na ekran to nic nie odbieraj    
000138 B7A0           00515          btfsc    markers2,sprawdz_odebrane
00013A EF3B F000      00516          goto     wyjscie_przerwanie
                      00517 ;wylacz inne przerwania
                      00518 ;        bsf      STATUS,RP0
                      00519 ;        bcf      PIE1,TMR1IE
                      00520 ;        bcf      STATUS,RP0
                      00521          
                      00522 ;          bcf      markers2,blad_transmisji
                      00523 ;czy jest framing error
00013E B4AB           00524          btfsc    RCSTA,FERR
000140 EFC5 F000      00525          goto     wykryto_blad
                      00526 ;        bsf      markers2,blad_transmisji
                      00527          
000144 B2AB           00528          btfsc    RCSTA,OERR
000146 EFC0 F000      00529          goto     wykryto_oerr
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00530          
                      00531          
00014A 518D           00532          movf     odebrano_liter,w
00014C 0F00           00533          addlw    dane_odebraneL
00014E 6EE9           00534          movwf    FSR0L
000150 0E01           00535          movlw    dane_odebraneH
000152 6EEA           00536          movwf    FSR0H
                      00537          
000154 50AE           00538          movf     RCREG,w
000156 6EEF           00539          movwf    INDF0
                      00540 ;jezeli blad transmisji to nie zapamietuj         
                      00541 ;          btfsc    markers2,blad_transmisji
                      00542 ;          goto     wykryto_odbior_odczyt_dalej  
                      00543 ;                    
                      00544          
                      00545          
                      00546          
000158 0E0A           00547          movlw    0x0a
00015A 18EF           00548          xorwf    INDF0,w
00015C B4D8           00549          btfsc    STATUS,Z
00015E EFB4 F000      00550          goto     wykryto_odbior_CR
                      00551          
                      00552 ;        movlw    0x0a
                      00553 ;        xorwf    INDF0,w
                      00554 ;        btfss    STATUS,Z
000162 2B8D           00555         incf     odebrano_liter,f
                      00556          
000164 EF3B F000      00557          goto     wyjscie_przerwanie
                      00558 ;        goto     wykryto_odbior_wyjscie
                      00559 ;        
                      00560          
                      00561 ;        movlw    0x0A
                      00562 ;        xorwf    INDF0,w
                      00563 ;        btfss    STATUS,Z
                      00564 ;        goto     wykryto_odbior_wyjscie
                      00565          
                      00566                   
000168                00567 wykryto_odbior_CR 
                      00568 ;sprawdz czy pierwszym znakiem jest *
                      00569          
000168 87A0           00570          bsf      markers2,sprawdz_odebrane
                      00571 ;        clrf     odebrano_liter
                      00572 ;        movf     RCREG,w
                      00573 ;        movwf    INDF0
                      00574 ;        
                      00575 ;        czysc dwa bwyswietlajty na zero -> znacznik konca wyswietlania         
                      00576 ;        
                      00577          
00016A 0E0D           00578         movlw     0x0d
00016C 6EEF           00579          movwf    INDF0
                      00580           
00016E 2AE9           00581         incf    FSR0L,f
000170 6EEF           00582         movwf    INDF0
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000172 2AE9           00583         incf    FSR0L,f
000174 6AEF           00584         clrf     INDF0
000176 2AE9           00585          incf    FSR0L,f
000178 6AEF           00586         clrf     INDF0
                      00587 ;wylaczam szeregowy odbior
00017A 98AB           00588          bcf      RCSTA,CREN        
                      00589 
00017C                00590 przerwanie_wysylania       
00017C EF3B F000      00591          goto     wyjscie_przerwanie
                      00592 
000180                00593 wykryto_oerr      
000180 98AB           00594          bcf      RCSTA,CREN        
000182 0000           00595          nop
000184 88AB           00596          bsf      RCSTA,CREN
                      00597                                     
000186 EF3B F000      00598          goto     wyjscie_przerwanie
00018A                00599 wykryto_blad
00018A 50AE           00600          movf     RCREG,w
00018C EF3B F000      00601          goto     wyjscie_przerwanie
                      00602 
000190                00603 przerwanie_pomiaru
000190 9C9E           00604          bcf      PIR1,ADIF
                      00605 ;kopiuje pomiar do rejestru
                      00606 ;sprawdz czy ustawiono 1 lub 0 - wtedy nic nie dziele 
                      00607          
000192 0E9B           00608          movlw    wynikh
000194 A19F           00609          btfss    markers,czy_usrednianie
000196 0EA8           00610          movlw    pomiarH
                      00611 ;        addwf    ktory_rejestr_zapisuje,w
000198 6EE1           00612          movwf    FSR1L
00019A 6AE2           00613          clrf     FSR1H
                      00614          
00019C 50C4           00615          movf     ADRESH,w
00019E 6EE7           00616          movwf    INDF1
0001A0 2AE1           00617          incf     FSR1L,f
                      00618 
0001A2 50C3           00619          movf     ADRESL,w
                      00620 
0001A4 6EE7           00621          movwf    INDF1
0001A6 89A0           00622          bsf      markers2,wyslij_pomiar
                      00623 ;nastepnym razem zapisze do kolejnego rejestru        
                      00624 ;        incf     ktory_rejestr_zapisuje,f
0001A8 EF3B F000      00625          goto     wyjscie_przerwanie
                      00626    
                      00627 
0001AC                00628 wykryto_t3
                      00629 
0001AC 92A1           00630       bcf   PIR2,TMR3IF
                      00631       ;sprawdzam czy klawisz jest dalej wcisniety
                      00632       
                      00633       ;robie and z zawartoscia stan_key
                      00634       ;jezeli jest w wyniku 0 (tzn ze klawisz wciaz jest trzymany
                      00635       ;np dla klawisza back stan latch_keys:  xxxx1110 - jezeli wcisniety 
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00636       ;                                      stan_keys          xxxx001  
                      00637       ;w wyniku 0 chyba że klawisz puszczono i jest 1
0001AE 5199           00638       movf        stan_key,w
0001B0 1483           00639       andwf       latch_keys,w
                      00640 ;tzn ze wciaz przycisk jest wcisniety
                      00641       ;i nic nie robie czyli wychodze
0001B2 B4D8           00642       btfsc       STATUS,Z
0001B4 EFE2 F000      00643       goto         wykryto_t3_nie_puszczono
                      00644       
                      00645       ;natomiast jezeli wyszlo 1 to sprawdz ktory przycisk zostal puszczony  
                      00646       ;i wymus sprawdzenie i dalsze podprogramy zwiazane z danym klawiszem
0001B8 99A1           00647       bcf         markers3,wcisnieto_klawisz
0001BA 9F9F           00648       bcf         markers,trzymanie_klawisza
0001BC 959E           00649       bcf         znaczniki,czy_moge_juz_zmieniac
                      00650       
                      00651       ;wylacz przerwanie tmr3
0001BE 8BA1           00652       bsf         markers3,dzialanie_po_klawiszu
0001C0 EF3B F000      00653       goto        wyjscie_przerwanie
                      00654       
0001C4                00655 wykryto_t3_nie_puszczono
                      00656 ;jeżeli zaznaczony jest bit trzymanie_klawisza to pozwól na szybką zmianę wartości w trakcie 
                      00657 ;trzymania przycisku
                      00658 
                      00659 ;jeżeli już zaznaczono ze moge zmieniac to nie sprawdzaj miniecia sekundy
0001C4 B59E           00660       btfsc       znaczniki,czy_moge_juz_zmieniac
0001C6 EF3B F000      00661       goto        wyjscie_przerwanie
                      00662 
0001CA AF9F           00663       btfss       markers,trzymanie_klawisza
0001CC EF3B F000      00664       goto        wyjscie_przerwanie
                      00665 ;szybka zmiana dopiero po sekundzie - czyli dwa zliczenia
0001D0 2FEC           00666       decfsz      szybka_zmiana_wartosci,f
0001D2 EF3B F000      00667       goto        wyjscie_przerwanie
                      00668 
0001D6 0E01           00669       movlw       1
0001D8 6FEC           00670       movwf       szybka_zmiana_wartosci
                      00671 ;jeżeli już jest 0 to pozwól na zmianę       
0001DA 859E           00672       bsf         znaczniki,czy_moge_juz_zmieniac
0001DC EF3B F000      00673       goto        wyjscie_przerwanie
                      00674 
                      00675 
                      00676 
                      00677 
                      00678       
                      00679       
                      00680       
                      00681       
                      00682       
                      00683       
                      00684       
                      00685       
0001E0                00686 wykryto_low_voltage
                      00687         ;wylaczam wszystko co niepotrzebnie pobiera prad
0001E0 6AA6           00688          clrf  EECON1
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0001E2 6A9D           00689          clrf   PIE1
0001E4 6AA0           00690          clrf   PIE2
0001E6 6AF2           00691          clrf   INTCON
                      00692          ; bcf      INTCON,GIE
                      00693          ; bcf      INTCON,PEIE
                      00694          ;wylaczam wszystkie uklady
0001E8 6AD5           00695          clrf     T0CON
0001EA 6ACA           00696          clrf     T2CON
0001EC 6ACD           00697          clrf     T1CON
0001EE 6AB1           00698          clrf     T3CON
0001F0 6AC2           00699          clrf     ADCON0
0001F2 6AAB           00700          clrf     RCSTA
0001F4 0EFF           00701          movlw  0xff
0001F6 6E92           00702          movwf  TRISA
0001F8 6E93           00703          movwf  TRISB
0001FA 6E94           00704          movwf  TRISC
0001FC 6E96           00705          movwf  TRISE
                      00706          
                      00707          ; goto    mala_petla
                      00708 ;zapisuje do EEPROM
0001FE EE10 F0AC      00709          LFSR    FSR1,ile_kanalow
                      00710              
                      00711 ;adres pod ktorym zapisuje w EEprom odpowiada adresom w pamieci danych         
000202                00712 petla_zapisu
                      00713          ; movlw    ktory_czujnik_reguluje2+1
000202 0EB7           00714          movlw   histereza_R2_2+1
                      00715          ;okazuje sie ze bez bledow zapisuje najczesciej tylko 11 bajtow
000204 18E1           00716          xorwf    FSR1L,w
000206 B4D8           00717          btfsc    STATUS,Z
000208 EF0C F001      00718          goto     mala_petla
                      00719 ;czytam adres z FSR
00020C 50E1           00720          movf     FSR1L,w
00020E ECBA F001      00721          call     zapis_eeprom
                      00722              
000212 2AE1           00723          incf     FSR1L,f
000214 EF01 F001      00724          goto     petla_zapisu          
000218                00725 mala_petla
                      00726 ;zwiekszam o jeden rejestr wlaczen do zrobienia w przyszlosci
                      00727       
                      00728 
000218 EF0C F001      00729          goto     mala_petla                           
                      00730 
                      00731 
                      00732 
                      00733 
                      00734 
                      00735 
                      00736 
                      00737         
                      00738       
                      00739       
                      00740 
                      00741       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00742 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;       
                                      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;KOniec Przerwan   
                      00743 
                      00744 
                      00745 
                      00746 
                      00747 
                      00748 
                      00749 
                      00750 
                      00751 
                      00752 
00021C                00753 wait_kilka_sekund
00021C 92A0           00754         bcf     PIE2,TMR3IE
00021E 0ED9           00755         movlw       b'11011001'
000220 6EB1           00756         movwf       T3CON
000222 0E04           00757         movlw    0x4
000224 6F8B           00758         movwf    n
000226 92A1           00759         bcf     PIR2,TMR3IF
000228                00760 czekaj05sek
000228 A2A1           00761         btfss  PIR2,TMR3IF
00022A EF14 F001      00762         goto     czekaj05sek
00022E 92A1           00763         bcf     PIR2,TMR3IF
000230 2F8B           00764         decfsz   n,f
000232 EF14 F001      00765         goto     czekaj05sek
                      00766         
                      00767         
                      00768         
000236 0012           00769         return
                      00770 
                      00771 
                      00772 
                      00773 
                      00774 
                      00775 
                      00776 
                      00777 ;;;;;;;;;;;;;;;;;;;;;;;;
                      00778 ;;;PROGRAM
                      00779 ;;;;;;;;;;;;;;;;;;;;;;;;;
                      00780         include  "../libs/lcd.h"
                      00001  ;;ten dokument zawiera definicje wszystkich funkcji
                      00002 ;;uytych do wywietlania danych na LCD
                      00003 ;;wywietlanie 8 bitowe
                      00004 
                      00005 ;def lcd
                      00006 ;cay port RB0-RB7 uyty jako dane do LCD
                      00007 ;init
                      00008 ;to idzie na port zwizany z danymi
                      00009 
                      00010 
                      00011 
  00000030            00012 init_8bit       equ     b'00110000'
  0000003C            00013 set_8bit        equ     b'00111100' ; 8bit, 2 linie,font 5x8
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000008            00014 function_set2   equ     b'00001000' ;ustawia 2 linie i 5x8 font
                      00015 ;init_4bit          equ      b'00100010' ;ustawia 2 linie i 5x8 font
                      00016 
  00000008            00017 display_off     equ     b'00001000' ;ustawia blinking,cursor,
  00000006            00018 entry           equ     b'00000110' ;increment
  00000080            00019 dd_addres_set   equ     b'10000000' ;od rb6 do rb0 wstawi�adres
                      00020 
  00000001            00021 display_clear   equ     b'00000001'
  0000000C            00022 display_on      equ     b'00001100';bez kursora
  0000000F            00023 display_2       equ     b'00001111'
  00000010            00024 write_4bit      equ     b'00010000' ;pisz na ekranie
  00000040            00025 write           equ     b'01000000' ;zacz rd6 - rs
                      00026 
  00000002            00027 disp_home       equ     b'00000010'
                      00028 
                      00029 
                      00030 ;;dla 4bit�
  00000003            00031 function_set1_4b        equ     b'00000011' ;- ustawia 4 bit
  00000008            00032 function_set2_4b        equ     b'00001000' ;ustawia 2 linie i 5x8 font
  00000000            00033 display1_4b     equ     b'00000000'
  0000000F            00034 display2_4b     equ     b'00001111' ;ustawia blinking,cursor,
  00000000            00035 entry1_4b               equ     b'00000000'
  0000000C            00036 entry2_4b               equ     b'00001100' ;increment
  00000000            00037 display_clear1_4b       equ     b'00000000'
  00000001            00038 display_clear2_4b       equ     b'00000001'
                      00039 
                      00040 
  00000030            00041 _0              equ     b'00110000'
  00000031            00042 _1              equ     b'00110001'
  00000032            00043 _2              equ     b'00110010'
  00000033            00044 _3              equ     b'00110011'
  00000034            00045 _4              equ     b'00110100'
  00000035            00046 _5              equ     b'00110101'
  00000036            00047 _6              equ     b'00110110'
  00000037            00048 _7              equ     b'00110111'
  00000038            00049 _8              equ     b'00111000'
  00000039            00050 _9              equ     b'00111001'
  0000003A            00051 _dwukropek      equ     b'00111010'
  00000020            00052 _puste          equ     b'00100000'
  0000002E            00053 _kropka         equ     b'00101110'
  000000DF            00054 _stopni         equ     b'11011111'
  0000002D            00055 _minus          equ     0x2d
  0000002B            00056 _plus           equ     0x2b
  00000041            00057 _A              equ     b'01000001'
  00000042            00058 _B              equ     b'01000010'
  00000043            00059 _C              equ     b'01000011'
  00000044            00060 _D              equ     b'01000100'
  00000045            00061 _E              equ     b'01000101'
  00000046            00062 _F              equ     b'01000110'
  00000047            00063 _G              equ     b'01000111'
  00000048            00064 _H              equ     b'01001000'
  00000049            00065 _I              equ     b'01001001'
  0000004A            00066 _J              equ     b'01001010'
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000004B            00067 _K              equ     b'01001011'
  0000004C            00068 _L              equ     b'01001100'
  0000004D            00069 _M              equ     b'01001101'
  0000004E            00070 _N              equ     b'01001110'
  0000004F            00071 _O              equ     b'01001111'
  00000050            00072 _P              equ     b'01010000'
  00000051            00073 _Q              equ     b'01010001'
  00000052            00074 _R              equ     b'01010010'
  00000053            00075 _S              equ     b'01010011'
  00000054            00076 _T              equ     b'01010100'
  00000055            00077 _U              equ     b'01010101'
  00000056            00078 _V              equ     b'01010110'
  00000057            00079 _W              equ     b'01010111'
  00000058            00080 _X              equ     b'01011000'
  00000059            00081 _Y              equ     b'01011001'
  0000005A            00082 _Z              equ     b'01011010'
                      00083 
  00000061            00084 _a              equ     b'01100001'
  00000062            00085 _b              equ     b'01100010'
  00000063            00086 _c              equ     b'01100011'
  00000064            00087 _d              equ     b'01100100'
  00000065            00088 _e              equ     b'01100101'
  00000066            00089 _f              equ     b'01100110'
  00000067            00090 _g              equ     b'01100111'
  00000068            00091 _h              equ     b'01101000'
  00000069            00092 _i              equ     b'01101001'
  0000006A            00093 _j              equ     b'01101010'
  0000006B            00094 _k              equ     b'01101011'
  0000006C            00095 _l              equ     b'01101100'
  0000006D            00096 _m              equ     b'01101101'
  0000006E            00097 _n              equ     b'01101110'
  0000006F            00098 _o              equ     b'01101111'
  00000070            00099 _p              equ     b'01110000'
  00000071            00100 _q              equ     b'01110001'
  00000072            00101 _r              equ     b'01110010'
  00000073            00102 _s              equ     b'01110011'
  00000074            00103 _t              equ     b'01110100'
  00000075            00104 _u              equ     b'01110101'
  00000076            00105 _v              equ     b'01110110'
  00000077            00106 _w              equ     b'01110111'
  00000078            00107 _x              equ     b'01111000'
  00000079            00108 _y              equ     b'01111001'
  0000007A            00109 _z              equ     b'01111010'
                      00110 
  0000002A            00111 _star           equ     0x2a
  0000005E            00112 _up             equ     b'01011110'
  0000002C            00113 _przecinek      equ     0x2c
  0000003C            00114 _mniejszosci      equ      0x3c
  0000003E            00115 _wiekszosci       equ      0x3e
  0000007C            00116 _linia_pionowa    equ         0x7c
                      00117 
                      00118 
  00000080            00119 linia_pierwsza  equ     0x80
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000080            00120 linia_gorna     equ     0x80
                      00121 
  000000C0            00122 linia_dolna     equ     0xc0
  000000C0            00123 linia_druga     equ     0xc0
                      00124 
  00000090            00125 linia_trzecia   equ     0x90
  000000D0            00126 linia_czwarta   equ     0xd0
                      00127 ;
                      00128 
                      00781 
                      00782         include  "../libs/lcd4bit18.asm"
                      00001 ;wersja 2007-12-07
                      00002 ;dla prockow serji 18fxxx
                      00003 ;do odczekania 64ms uzywam komendy cpfsgt
                      00004 ;zmienne
                      00005 ;ktore_bity_uzywane_na_lcd - ktore porty ekranu sa uzywane jako dane
                      00006 ;ktore_bity_lcd_tris   - definiuje ktore bity maja byc zamieniane na wejscie podczas check busy
                      00007 ;tris_lcd   -definiuje ktory tris wplywa na tris lcd
                      00008 ;set_4bit   - ustawienia dla lcd
                      00009 ;tmp_lcd - tymczasowa zmienna uywana tylko w procedurach lcd
                      00010 
000238                00011 wait
                      00012          
                      00013         ;bsf      portlampka,lampka              
                      00014         IF (procek == 18f442)
                      00015         bcf     INTCON,T0IF
                      00016 wait_petla                   
                      00017         btfss   INTCON,T0IF      
                      00018         goto    wait_petla
                      00019         bcf     INTCON,T0IF            
                      00020         ENDIF
                      00021 
                      00022         IF (procek == 18f4320)
000238 94F2           00023          bcf     INTCON,TMR0IF
00023A                00024 wait_petla         
00023A A4F2           00025         btfss   INTCON,TMR0IF      
00023C EF1D F001      00026         goto    wait_petla
000240 94F2           00027         bcf     INTCON,TMR0IF
000242 9AF2           00028         bcf      INTCON,TMR0IE
                      00029               
                      00030         ENDIF        
                      00031         ;bcf      portlampka,lampka              
000244 0012           00032         return
                      00033         
                      00034          
                      00035 ;funkcja wysy?aj?ca 4 bitowa
                      00036 ;LCD
                      00037 ;;;;;;;;;;;;;;;;;;;;;;;;;
                      00038 
000246                00039 send
                      00040 ;np PORTA bity 0-3  sa uzywane przez 4 bitowy ekran lcd
                      00041 ;najpierw wysylane sa 4bity gorne
000246 6FA3           00042          movwf    dane_lcd
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000248 0E02           00043          movlw    2
00024A 6FA4           00044          movwf    tmp_lcd
00024C                00045 send4bit_petla
                      00046          
                      00047 ;przenosze PORTA tak aby gorne bity nieulegly zmianie
00024C 0E0F           00048          movlw    ktore_bity_uzywane_na_lcd
00024E 168C           00049          andwf    latch_lcd,f
                      00050                           
                      00051         IF (polozenie_danych_lcd == 0)        
                      00052 ;jesli na gorze bitow port d
                      00053          
                      00054          swapf    dane_lcd,f
                      00055         ENDIF
                      00056 
                      00057          
000250 0EF0           00058          movlw    ktore_bity_lcd_tris
000252 15A3           00059          andwf    dane_lcd,w
000254 268C           00060          addwf    latch_lcd,f
                      00061          
000256 8682           00062          bsf      port_lcd_e,enable
000258 0000           00063          nop
00025A 0000           00064          nop
00025C 9682           00065          bcf      port_lcd_e,enable
                      00066          
                      00067         IF (polozenie_danych_lcd == 1)        
                      00068 ;jesli na gorze bitow port d
                      00069          
00025E 3BA3           00070          swapf    dane_lcd,f
                      00071         ENDIF
                      00072             
000260 2FA4           00073          decfsz   tmp_lcd,f
000262 EF26 F001      00074          goto     send4bit_petla
000266 0012           00075          return
                      00076          ;movwf    latch_lcd
                      00077          
                      00078          
                      00079 ;funkcja pisz?ca na ekranie
000268                00080 write_lcd
                      00081 
                      00082          
000268 868A           00083          bsf      latch_lcd_rs,rs
                      00084          ;bsf      PORTB,rs
                      00085          
00026A EC23 F001      00086          call     send
                      00087          
00026E 968A           00088          bcf      latch_lcd_rs,rs    
                      00089          ;bcf      PORTB,rs
000270 0012           00090          return
                      00091 
                      00092 ;funkcja czyszcz?ca ekran
                      00093 
                      00094 ;funkcja czyszcz?ca ekran
                      00095 
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000272                00096 cmd_off
                      00097 
                      00098          
000272 968A           00099          bcf      latch_lcd_rs,rs
                      00100          
                      00101          
000274 0012           00102         return
                      00103          
                      00104 
                      00105 
                      00106 ;funkcja czysci cala linie
                      00107 ; przed jej wywolaniem w W umi#1esc adres linii
                      00108 ;po zakonczeniu z powrotem w niej umieszcza adres
                      00109 ;stara wersja - dziala na cala linie
                      00110 
000276                00111 clear_line_old
000276 6F8B           00112          movwf    n
000278 9681           00113          bcf      port_lcd_rs,rs
                      00114          
00027A 518B           00115          movf     n,w
00027C 6FA3           00116          movwf    dane_lcd
00027E EC23 F001      00117          call     send
000282 0E10           00118          movlw    ile_znakow
000284 6F95           00119          movwf    tmp7
000286 0FFF           00120          addlw    0xff
000288 6FA4           00121          movwf    tmp_lcd
00028A                00122 clear_line_old2
00028A EC61 F001      00123          call     check_busy
00028E 0E20           00124          movlw    _puste
000290 6FA3           00125          movwf    dane_lcd
000292 EC34 F001      00126          call     write_lcd
                      00127          
000296 2F95           00128          decfsz   tmp7,f
000298 EF45 F001      00129          goto     clear_line_old2
                      00130          
00029C EC39 F001      00131          call     cmd_off
0002A0 518B           00132          movf     n,w
0002A2 0012           00133          return
                      00134          
0002A4                00135 clear_line
                      00136 ;przed wywolaniem do n trzeba wrzucic ilosc kasowanych znakow
                      00137 ;a w W musi byc adres linii         
0002A4 6FA3           00138          movwf    dane_lcd
0002A6 EC23 F001      00139          call     send
                      00140          
0002AA                00141 clear_line_petla
0002AA EC61 F001      00142          call     check_busy
0002AE 0E20           00143          movlw    _puste
0002B0 6FA3           00144          movwf    dane_lcd
0002B2 EC34 F001      00145          call     write_lcd
                      00146          
0002B6 2F8B           00147          decfsz   n,f
0002B8 EF55 F001      00148          goto     clear_line_petla
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00149          
0002BC EC39 F001      00150          call     cmd_off
                      00151         
0002C0 0012           00152          return
                      00153 
                      00154          
                      00155          
0002C2                00156 check_busy
                      00157 
                      00158         IF (polozenie_danych_lcd == 1)        
                      00159 ;jesli na gorze bitow port d
0002C2 0E0F           00160          movlw    0x0f
                      00161          
0002C4 168C           00162          andwf    latch_lcd,f
                      00163         ENDIF
                      00164 
                      00165         IF (polozenie_danych_lcd == 0)        
                      00166 ;jesli w dolnej polowce  bajtu rejestru  portd
                      00167          movlw    0xf0
                      00168          
                      00169          andwf    latch_lcd,f
                      00170         ENDIF
                      00171          
                      00172          ;clrf     port_lcd
                      00173          ;clrf     PORTD
                      00174 ;przesylam dane np tris 00000001
                      00175 ;chce zrobic tak by bylo 
                      00176 ;  11110001
                      00177        
0002C6 5095           00178          movf     tris_lcd,w
0002C8 09F0           00179          iorlw    ktore_bity_lcd_tris
0002CA 6E95           00180          movwf    tris_lcd    
                      00181          
                      00182       
                      00183          
                      00184          
                      00185                   
0002CC 848A           00186          bsf      latch_lcd_rw,rw
0002CE 968A           00187          bcf      latch_lcd_rs,rs
                      00188 
0002D0                00189 check
                      00190          
0002D0 868B           00191          bsf      latch_lcd_e,enable
                      00192          
                      00193         IF (polozenie_danych_lcd == 0) 
                      00194 ;jezli dolne bity portud 
                      00195          swapf    port_lcd,w
                      00196         ENDIF
                      00197             
                      00198         IF (polozenie_danych_lcd == 1)        
                      00199 ;jesli na gorze bitow port d
                      00200             
0002D2 5083           00201          movf    port_lcd,w
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00202         ENDIF
0002D4 0BF0           00203          andlw    0xf0
                      00204          
0002D6 6FA4           00205          movwf    tmp_lcd
                      00206          
0002D8 968B           00207          bcf      latch_lcd_e,enable
                      00208             
0002DA 0000           00209          nop 
                      00210          
0002DC 868B           00211          bsf      latch_lcd_e,enable
                      00212          
                      00213         IF (polozenie_danych_lcd == 1) 
                      00214 ;jesli na gorze bitow port d
0002DE 3883           00215          swapf    port_lcd,w
                      00216         ENDIF
                      00217             
                      00218         IF (polozenie_danych_lcd == 0)        
                      00219 
                      00220             
                      00221          movf    port_lcd,w
                      00222         ENDIF         
                      00223      
0002E0 0B0F           00224          andlw    0x0f
                      00225          
0002E2 27A4           00226          addwf    tmp_lcd,f
                      00227          
0002E4 968B           00228          bcf      latch_lcd_e,enable    
                      00229             
0002E6 BFA4           00230          btfsc    tmp_lcd,7
0002E8 EF68 F001      00231          goto     check
                      00232          
0002EC 0E0F           00233          movlw   normalne_ustawienie_tris_lcd
0002EE 6E95           00234          movwf    tris_lcd
                      00235          
                      00236          
0002F0 948A           00237          bcf      latch_lcd_rw,rw
0002F2 968A           00238          bcf      latch_lcd_rs,rs
0002F4 0012           00239          return
                      00240 
                      00241 
                      00242 
                      00243 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                           
                      00244 ;poczatek dzialania 4 bitowego ekranu
                      00245 
0002F6                00246 lcd_init
0002F6 EC39 F001      00247          call     cmd_off
                      00248          
                      00249         IF (polozenie_danych_lcd == 1)        
                      00250 ;jesli na gorze bitow port d
0002FA 0E0F           00251          movlw    0x0f         
0002FC 168C           00252          andwf    latch_lcd,f
                      00253         ENDIF
                      00254 
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00255         IF (polozenie_danych_lcd == 0)        
                      00256 ;jesli w dolnej polowce  bajtu rejestru  portd
                      00257          movlw    0xf0         
                      00258          andwf    latch_lcd,f
                      00259         ENDIF
                      00260 
                      00261 
0002FE 948A           00262          bcf      latch_lcd_rw,rw
000300 968B           00263          bcf      latch_lcd_e,enable
                      00264 ;wylaczam przerwanie         
                      00265         
000302 6AD6           00266          clrf     TMR0L
                      00267         IF (procek == 18f442)
                      00268          bcf      INTCON,T0IE
                      00269          
                      00270         ENDIF
                      00271         IF (procek == 18f4320)
000304 9AF2           00272          bcf      INTCON,TMR0IE
                      00273          
                      00274          
                      00275         ENDIF         
                      00276          
                      00277 ;wylaczam przerwania tmr0         
                      00278         
000306 EC1C F001      00279          call     wait     ;64ms
                      00280 
00030A 0E2A           00281          movlw    init_4bit
00030C 0BF0           00282          andlw    ktore_bity_lcd_tris
                      00283 ;teraz w W mam postac 0011 w tym nibbles ktory jest port lcd , jezeli gorne to 00110000
00030E 128C           00284          iorwf    latch_lcd,f
                      00285          
000310 868B           00286          bsf     latch_lcd_e,enable
000312 0000           00287          nop
000314 968B           00288          bcf     latch_lcd_e,enable
                      00289          ;call     send    ;zalaczam
000316 6AD6           00290          clrf     TMR0L ;64 ms
000318 EC1C F001      00291          call     wait
                      00292          
00031C 0E2A           00293          movlw    init_4bit
00031E 0BF0           00294          andlw    ktore_bity_lcd_tris
                      00295 ;teraz w W mam postac 0011 w tym nibbles ktory jest port lcd , jezeli gorne to 00110000
000320 128C           00296          iorwf    latch_lcd,f
                      00297          
000322 868B           00298          bsf     latch_lcd_e,enable
000324 0000           00299          nop
000326 968B           00300          bcf     latch_lcd_e,enable
                      00301          ;call     send    ;zalaczam
000328 6AD6           00302          clrf     TMR0L ;64 ms
00032A EC1C F001      00303          call     wait
                      00304          
00032E 0E2A           00305          movlw    init_4bit
000330 0BF0           00306          andlw    ktore_bity_lcd_tris
                      00307 ;teraz w W mam postac 0011 w tym nibbles ktory jest port lcd , jezeli gorne to 00110000
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000332 128C           00308          iorwf    latch_lcd,f
                      00309          
000334 868B           00310          bsf     latch_lcd_e,enable
000336 0000           00311          nop
000338 968B           00312          bcf     latch_lcd_e,enable
                      00313          ;call     send    ;zalaczam
00033A 6AD6           00314          clrf     TMR0L ;64 ms
00033C EC1C F001      00315          call     wait
                      00316          
000340 0E28           00317          movlw    set_4bit
000342 EC23 F001      00318          call     send
                      00319          
000346 EC61 F001      00320          call     check_busy
                      00321          
00034A 0E01           00322          movlw    display_clear
                      00323          ;movwf    port_lcd,ACCESS
00034C EC23 F001      00324          call     send
000350 EC61 F001      00325          call     check_busy
                      00326          
000354 0E0C           00327          movlw   display_on
                      00328          ;movwf    port_lcd,ACCESS
000356 EC23 F001      00329          call     send
                      00330          
                      00331          ;clrf   TMR0L;64 ms
                      00332          ;call     wait
00035A EC61 F001      00333          call     check_busy
                      00334          
                      00335         
                      00336         ;clrf   TMR0L;64 ms
                      00337          ;call     wait
                      00338 
                      00339          ;call    check_busy
00035E 0E06           00340          movlw   entry
                      00341         ;movwf   port_lcd,ACCESS
000360 EC23 F001      00342         call    send
000364 EC61 F001      00343         call     check_busy
000368 0012           00344         return
                      00783 
                      00784 ;include  "../../libs/dziel_przez2_18.asm"
                      00785 
                      00786         include  "../libs/eeprom18.asm"
00036A                00001 czytaj_eeprom
                      00002 
                      00003        
                      00004 ;IF procek==1         
00036A 6EA9           00005          movwf    EEADR
                      00006 ;ENDIF         
                      00007 ;IF procek==2
                      00008  ;        movwf    EEADRL
                      00009 ;ENDIF         
                      00010            
00036C 9EA6           00011          bcf      EECON1,EEPGD
00036E 80A6           00012          bsf      EECON1,RD
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00013          
                      00014        
                      00015 
000370 50A8           00016          movf     EEDATA,w
                      00017 
000372 0012           00018          return
                      00019          
000374                00020 zapis_eeprom
                      00021 ;do w adres pod ktory zapisuje
                      00022 ;do FSR (INDF) co zapisuje         
                      00023 ;poprawka ze zapisuje dana spod INDF1         
                      00024          
000374                00025 check_if_write
000374 B2A6           00026          btfsc    EECON1,WR
000376 EFBA F001      00027          goto     check_if_write
                      00028     
                      00029  
                      00030          
                      00031 ;IF procek==1         
00037A 6EA9           00032          movwf    EEADR
                      00033 ;ENDIF         
                      00034 
                      00035        
00037C 50E7           00036          movf     INDF1,w
                      00037         
00037E 6EA8           00038          movwf     EEDATA
                      00039       
000380 9EA6           00040          bcf      EECON1,EEPGD
000382 84A6           00041          bsf      EECON1,WREN
                      00042   ;bez przerwan       
000384 9EF2           00043          bcf      INTCON,GIE
                      00044          
000386 0E55           00045          movlw    55h
000388 6EA7           00046          movwf    EECON2
00038A 0EAA           00047          movlw    0aah
00038C 6EA7           00048          movwf    EECON2
                      00049          
00038E 82A6           00050          bsf      EECON1,WR                  
                      00051          
000390 8EF2           00052          bsf      INTCON,GIE
000392 94A6           00053          bcf      EECON1,WREN
                      00054          
                      00055          
                      00056                   
000394 0012           00057          return         
                      00787 
000396                00788 Start
000396 6AA6           00789         clrf      EECON1
                      00790 ;odczytuje wartosci poprawek czujnikow temperatury
000398 0E00           00791       movlw     poprawka0_ee
00039A 6EE9           00792       movwf      FSR0L
00039C 6AEA           00793       clrf       FSR0H
00039E 0ED4           00794       movlw      poprawka0
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0003A0 6EE1           00795       movwf      FSR1L
0003A2 6AE2           00796       clrf       FSR1H
                      00797       
0003A4                00798 petla_odczytu_poprawek_z_eeprom
0003A4 50E9           00799       movf       FSR0L,w
0003A6 ECB5 F001      00800       call        czytaj_eeprom
0003AA 6EE7           00801       movwf      INDF1
                      00802       
0003AC 2AE9           00803       incf       FSR0L,f
0003AE 2AE1           00804       incf       FSR1L,f
0003B0 0E0A           00805       movlw      0x0a
0003B2 18E9           00806       xorwf      FSR0L,w
0003B4 A4D8           00807       btfss      STATUS,Z
0003B6 EFD2 F001      00808       goto        petla_odczytu_poprawek_z_eeprom
                      00809       
                      00810       
                      00811 
                      00812         IF  (czy_ekran==1)
0003BA EC7B F001      00813          call     lcd_init
0003BE EC61 F001      00814          call     check_busy
0003C2 EC39 F001      00815          call    cmd_off
                      00816          
                      00817          
                      00818 ;        call     check_busy
0003C6 0E80           00819          movlw   linia_gorna
0003C8 EC23 F001      00820          call    send
0003CC EC61 F001      00821          call     check_busy
0003D0 0E45           00822          movlw    _E
0003D2 EC34 F001      00823          call     write_lcd
                      00824         ENDIF
                      00825          
                      00826 ;konfiguruje port szeregowy
                      00827 ;ustawiam baud rate
                      00828          ;bsf      STATUS,RP0
                      00829          ;bcf      STATUS,RP1
                      00830 ;        movlw    0x1a
                      00831 ;         movlw    0x1a
                      00832 ;         movlw    0x1a
0003D6 0E0C           00833          movlw    0x0c
0003D8 6EAF           00834          movwf    SPBRG
0003DA 6AAC           00835          clrf     TXSTA
0003DC 84AC           00836          bsf      TXSTA,BRGH
0003DE 8AAC           00837          bsf      TXSTA,TXEN
                      00838          
                      00839 
                      00840          
                      00841 ;wlaczam przerwanie szeregu
0003E0 8A9D           00842          bsf      PIE1,RCIE
                      00843 ;        bsf      PIE1,TXIE
                      00844          ;bcf      STATUS,RP0
0003E2 0E90           00845          movlw    b'10010000'
0003E4 6EAB           00846          movwf    RCSTA
                      00847          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00848          
                      00849 
0003E6 0E00           00850          movlw    0
0003E8 6FA7           00851          movwf    ktory_rejestr_zapisuje
                      00852                   
                      00853          
                      00854          
0003EA 6FBB           00855          movwf   ktora_probka
                      00856          
                      00857 
                      00858          
                      00859          ; bsf      port_CTS,znacznik_CTS
                      00860          
                      00861          
                      00862          ;tu ustawiam napiecia referencyjne jako AN3 i Vss 
                      00863 ;wszystkie 
                      00864         IF  (procek==18f442)
                      00865          movlw    b'10000001'
                      00866          movwf    ADCON1
                      00867         ENDIF         
                      00868         
                      00869         IF  (procek==18f4320)         
0003EC 0E1A           00870          movlw    b'00011010'
0003EE 6EC1           00871          movwf    ADCON1
                      00872          
0003F0 0EA6           00873          movlw    b'10100110'
0003F2 6EC0           00874          movwf    ADCON2
                      00875         ENDIF
                      00876 
0003F4 85A1           00877       bsf   markers3,czy_zegar_wyswietlac
                      00878 
0003F6 0E30           00879          movlw    0x30
0003F8 6FE0           00880          movwf    dzien_10
0003FA 6FE1           00881          movwf    dzien_1
0003FC 6FE2           00882          movwf    godziny_10
0003FE 6FE3           00883          movwf    godziny_1
000400 6FE4           00884          movwf    minuty_10
000402 6FE5           00885          movwf    minuty_1
000404 6FE6           00886          movwf    sekundy_10
000406 6FE7           00887          movwf    sekundy_1
                      00888          
                      00889          
                      00890          ;ustawienie opcji pomiarowych dla menu
                      00891          ; movlw          0
                      00892          ; movwf          ile_kanalow
                      00893          ; movlw          0x20
                      00894          ; movwf          odstep_pomiarowy
                      00895          ; movlw          0x80
                      00896          ; movwf          jak_duzo_probek
                      00897          
                      00898          
                      00899          
                      00900          ; movlw    0
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00901          ; movwf    jaka_wartosc_regulujeH1
                      00902          ; movlw    0x80
                      00903          ; movwf    jaka_wartosc_regulujeL1
                      00904          
                      00905          ; movlw    0
                      00906          ; movwf    jaka_wartosc_regulujeH2
                      00907          ; movlw    0x80
                      00908          ; movwf    jaka_wartosc_regulujeL2
                      00909          
                      00910          ; movlw    2
                      00911          ; movwf    histereza_R1_1
                      00912          
                      00913          ; movlw    2
                      00914          ; movwf    histereza_R1_2
                      00915          
                      00916          ; movlw    1
                      00917          ; movwf    histereza_R2_1
                      00918          
                      00919          ; movlw    1
                      00920          ; movwf    histereza_R2_2
                      00921          
                      00922          
                      00923          ;włączam znaczniki sprawiające że przy opuszczeniu menu następuje ponowne włączenie
                      00924 ;zegara oraz pokazywania temperatury
                      00925 ;z poziomu menu można zmienić te znaczniki tak by nie nastąpiło ponowne wyświetlanie zegara i tempe
                            ratur
000408 0E00           00926          movlw    0
00040A 6FB9           00927          movwf    ktory_czujnik_reguluje1
00040C 6FBA           00928          movwf    ktory_czujnik_reguluje2
00040E 6FB7           00929          movwf    czy_reguluje1
000410 6FB8           00930          movwf    czy_reguluje2
                      00931          
                      00932          
                      00933          
                      00934          ; movlw    1
                      00935          
                      00936          
000412 839E           00937          bsf            znaczniki,czy_ponownie_wlaczyc_zegar
000414 819E           00938          bsf            znaczniki,czy_ponownie_wlaczyc_temp
                      00939 
                      00940 
                      00941          
                      00942          
                      00943          
                      00944          
000416                00945 odczytuje_opcje_z_eeprom
000416 6AA6           00946       clrf      EECON1
000418 0EAC           00947       movlw     ile_kanalow
00041A 6EE9           00948       movwf      FSR0L
00041C 6AEA           00949       clrf       FSR0H
                      00950       
00041E                00951 petla_odczytuje_opcje_z_eeprom
                      00952         
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00041E 0EC0           00953               movlw   linia_druga
000420 EC23 F001      00954         call    send
000424 EC61 F001      00955          call     check_busy
                      00956   
                      00957         
000428 EC0E F001      00958       call  wait_kilka_sekund
                      00959 
                      00960 
00042C 38E9           00961       swapf      FSR0L,w
                      00962       
00042E 0B0F           00963       andlw    0x0f
000430 EC6E F003      00964       call     zamien_na_hex
                      00965       
000434 EC34 F001      00966       call        write_lcd      
000438 EC61 F001      00967       call        check_busy
                      00968       
00043C 50E9           00969       movf       FSR0L,w
                      00970       
00043E 0B0F           00971       andlw    0x0f
000440 EC6E F003      00972       call     zamien_na_hex
                      00973       
000444 EC34 F001      00974       call        write_lcd      
000448 EC61 F001      00975       call        check_busy
00044C 0E2E           00976       movlw     _kropka
00044E EC34 F001      00977       call        write_lcd      
000452 EC61 F001      00978       call        check_busy
                      00979       
000456 EC0E F001      00980       call  wait_kilka_sekund
                      00981       
00045A 50E9           00982       movf       FSR0L,w
00045C ECB5 F001      00983       call        czytaj_eeprom
000460 6EEF           00984       movwf      INDF0
                      00985       
000462 6F92           00986       movwf       tmp_hex
000464 3992           00987       swapf    tmp_hex,w
000466 0B0F           00988       andlw    0x0f
000468 EC6E F003      00989       call     zamien_na_hex
                      00990       
00046C EC34 F001      00991       call        write_lcd      
000470 EC61 F001      00992       call        check_busy
                      00993       
000474 5192           00994       movf       tmp_hex,w
                      00995       
000476 0B0F           00996       andlw    0x0f
000478 EC6E F003      00997       call     zamien_na_hex
                      00998       
00047C EC34 F001      00999       call        write_lcd      
000480 EC61 F001      01000       call        check_busy
000484 0E2E           01001       movlw     _kropka
000486 EC34 F001      01002       call        write_lcd      
00048A EC61 F001      01003       call        check_busy
                      01004       
00048E 2AE9           01005       incf       FSR0L,f
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01006       
                      01007       ; movlw      ktory_czujnik_reguluje2+1
000490 0EB7           01008       movlw     histereza_R2_2+1
000492 18E9           01009       xorwf      FSR0L,w
000494 A4D8           01010       btfss      STATUS,Z
000496 EF0F F002      01011       goto        petla_odczytuje_opcje_z_eeprom
                      01012 
                      01013       
                      01014       
                      01015 ;jeslie odczytano z eepromu 0xff to wpisz wartosc  defaulotowa    
                      01016       
00049A EE00 F0AC      01017       LFSR        FSR0,ile_kanalow
00049E 0E04           01018       movlw       HIGH tab_poprawnych_nastaw
0004A0 6EF7           01019       movwf       TBLPTRH
                      01020       
0004A2 0ECE           01021       movlw       LOW tab_poprawnych_nastaw
0004A4 6EF6           01022       movwf       TBLPTRL
                      01023       
0004A6                01024 petla_spr_nastaw      
                      01025       
0004A6 0EFF           01026       movlw     0xff
0004A8 62EF           01027       cpfseq    INDF0
0004AA EF59 F002      01028       goto      petla_spr_nastaw_dalej
                      01029       
0004AE EF5D F002      01030       goto      ustaw_opcje_standartowe
                      01031       
0004B2                01032 petla_spr_nastaw_dalej      
0004B2 0E00           01033       movlw     0x00
0004B4 62EF           01034       cpfseq    INDF0
0004B6 EF60 F002      01035       goto      petla_spr_nastaw_dalej2
                      01036       
0004BA                01037 ustaw_opcje_standartowe      
0004BA 0009           01038       TBLRD       *+
0004BC 50F5           01039       movf        TABLAT,w
0004BE 6EEF           01040       movwf     INDF0
                      01041       
0004C0                01042 petla_spr_nastaw_dalej2      
0004C0 2AE9           01043       incf      FSR0L,f
                      01044       
                      01045       ; movlw     ktory_czujnik_reguluje2+1
0004C2 0EB7           01046       movlw     histereza_R2_2+1
0004C4 62E9           01047       cpfseq    FSR0L
0004C6 EF53 F002      01048       goto      petla_spr_nastaw
                      01049       
                      01050       
0004CA EF6F F002      01051       goto      sprawdz_pierwsza_nastawe
                      01052       
                      01053       ;nastawy poprawne jesli bylo w eeprom 0xff
0004CE                01054 tab_poprawnych_nastaw
0004CE 2000 0080 00A0 01055         db      0x00,0x20,0x80,0,0xa0,0,0xa0,2,2,2,2,0,0,0,0
       02A0 0202 0002 
       0000 0000 
                      01056      
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01057 
                      01058 
                      01059 ;jezeli jaka_wartosc_regulujeH1 lub jaka_wartosc_regulujeH2
                      01060 ;sa wieksze od 1 to wyzeruj
                      01061 
0004DE                01062 sprawdz_pierwsza_nastawe
0004DE 0E01           01063         movlw   0x01
0004E0 65AF           01064         cpfsgt jaka_wartosc_regulujeH1
0004E2 EF74 F002      01065         goto    sprawdz_druga_nastawe
                      01066         
0004E6 6BAF           01067         clrf    jaka_wartosc_regulujeH1
                      01068         
0004E8                01069 sprawdz_druga_nastawe        
0004E8 0E01           01070         movlw   0x01
0004EA 65B1           01071         cpfsgt jaka_wartosc_regulujeH2
0004EC EF79 F002      01072         goto    ustawienia_low_voltage
                      01073      
0004F0 6BB1           01074         clrf    jaka_wartosc_regulujeH2
                      01075      
0004F2                01076 ustawienia_low_voltage
0004F2 0E1C           01077         movlw   b'00011100'
0004F4 6ED2           01078         movwf   LVDCON
                      01079         
0004F6                01080 ustawienia_low_voltage_loop
0004F6 AAD2           01081         btfss   LVDCON,IRVST
0004F8 EF7B F002      01082         goto    ustawienia_low_voltage_loop
                      01083         
0004FC 94A1           01084         bcf     PIR2,LVDIF
0004FE 84A0           01085         bsf     PIE2,LVDIE
                      01086 
                      01087 
                      01088 
000500 ECB6 F003      01089         call           ustaw_wartosc_dziel_usredniania
000504 0E01           01090         movlw       1
000506 63AE           01091        cpfseq      jak_duzo_probek
000508 819F           01092        bsf      markers,czy_usrednianie              
                      01093        
                      01094 
                      01095          
00050A EF7D F00E      01096          goto     LOOP
                      01097   
                      01098          
00050E                01099 hex2dec18
                      01100       ;zamiana wartosci szesnastkowej na dziesietne
                      01101       ;dziele przez 10 tzn mnoze przez 0x1a/256 (0x26) lub przez 0x19/256 (25)
                      01102 ;      i wynik jednosci w PRODH, a ulamek w ProdL
                      01103       ;w młodszym bajcie wyniku jest ułamek
                      01104       ;należy przed uruchomieniem procedury 
                      01105       ; umieścić liczbę dzieloną w rejestrze  
                      01106       ;tmp_hex
                      01107       ;bajt starszy w tmp_hex_H
                      01108       
                      01109       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01110       ;clrf        dec1
                      01111       ;clrf        dec10
00050E 6B96           01112       clrf        dec100
                      01113       
                      01114       ;dziele przez 5
                      01115       ;mullw       0x33
                      01116       ;wynik jest w starszym bajcie
                      01117       ;movf        PRODH,w
                      01118       ;dzielę przez 2 - 0x80
                      01119       ;dzielę przez 0.0976 - mnoże przez 0x19
000510 5192           01120       movf        tmp_hex,w
000512 0D19           01121       mullw       0x19
000514 50F4           01122       movf        PRODH,w
                      01123       
000516 6F97           01124       movwf       dec10
000518 0D0A           01125       mullw       0xa
00051A 50F3           01126       movf        PRODL,w
                      01127       ;tmp_hex - dec10*10 = liczba jednosci
00051C 5D92           01128       subwf       tmp_hex,w
00051E 6F98           01129       movwf       dec1
                      01130 ;sprawdzam czy liczba jedności nie przekracza 10, czyli czy nie jest większa > 9
000520 0E09           01131       movlw       0x9
000522 6598           01132       cpfsgt      dec1  
000524 EF99 F002      01133       goto        hex2dec18_nie_przekroczono_1
                      01134       
000528 0E0A           01135       movlw       0xa
00052A 5F98           01136       subwf       dec1,f
00052C 2B97           01137       incf        dec10,f
                      01138       
00052E B0D8           01139       btfsc       STATUS,C
000530 2B96           01140       incf        dec100,f
                      01141       
                      01142       
000532                01143 hex2dec18_nie_przekroczono_1
                      01144 ;sprawdz czy liczba dziesiatek  nie przekracza liczby 10 tzn podziel liczbę przez 10 (mnożę przez 0x1
                            a)
                      01145       ;przez 5
000532 5197           01146       movf       dec10,w
                      01147       ;mullw       0x33
                      01148       
                      01149       ;movf        PRODH,w
                      01150       ;dzielę przez 26
000534 0D1A           01151       mullw       0x1a
                      01152       
000536 50F4           01153       movf        PRODH,w
                      01154 ;jezeli jest 0 to skocz dalej
000538 E005           01155       bz          hex2dec18_brak_setek
                      01156 ;jezeli brak 0 tzn ze w wyniku mamy jakies liczby setek
00053A 6F96           01157       movwf       dec100
                      01158       ;a ile zostalo liczb 10 - 
00053C 0E0A           01159       movlw       0xa
00053E 0396           01160       mulwf       dec100
                      01161       ;mnoze dec100*100 i wynik odejmuje od liczby 10
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000540 50F3           01162       movf        PRODL,w
000542 5F97           01163       subwf       dec10,f
                      01164 ; i juz mam ilosc dziesiatek i setek i jednosci z wyniku zamiany jednego bajta na postać dziesiętną
                      01165       
000544                01166 hex2dec18_brak_setek
                      01167 ;teraz sprawdzam czy w starszym bajcie liczby dzielonej stoi jakas wartość jezeli tak to zwiekszam ilo
                            sc setek i dziesiatek
                      01168 ;jezeli w starszym bajcie stoi cos:
                      01169       
000544 5193           01170       movf       tmp_hex_H,w
                      01171             
                      01172       
                      01173       ;jezeli 0 to koncz prace procedury
000546 E015           01174       bz          hex2_dec_koniec
                      01175       ;jezeli nie to popraw wyniki o poprawke
000548 0A01           01176       xorlw       0x01
00054A E005           01177       bz          hex2dec_temperatur_popraw_o_64
                      01178       
00054C 5193           01179       movf       tmp_hex_H,w
00054E 0A02           01180       xorlw       0x02
000550 E008           01181       bz          hex2dec_temperatur_popraw_o_128
                      01182 
000552 EFB9 F002      01183       goto        hex2_dec_koniec
                      01184       
000556                01185 hex2dec_temperatur_popraw_o_64
000556 0E06           01186       movlw       0x06
000558 2797           01187       addwf       dec10,f
00055A 0E04           01188       movlw       0x04
00055C 2798           01189       addwf       dec1,f
00055E EFB9 F002      01190       goto        hex2_dec_koniec
                      01191       
000562                01192 hex2dec_temperatur_popraw_o_128
000562 0E01           01193       movlw       0x01
000564 2796           01194       addwf       dec100,f
000566 0E02           01195       movlw       0x02
000568 2797           01196       addwf       dec10,f
00056A 0E08           01197       movlw       0x08
00056C 2798           01198       addwf       dec1,f
00056E EFB9 F002      01199       goto        hex2_dec_koniec
                      01200       
000572                01201 hex2_dec_koniec
000572 0012           01202       return
                      01203 
                      01204 
                      01205                                                                                                 ;ZEGAR  
                              Systemowy  
                      01206  
                      01207 
000574                01208 napisz_czas
000574 97A1           01209       bcf   markers3,odswiezanie_zegara
                      01210       ;wyswietlam wszyskie wielkosci czasowe na 1 linii ekranu
000576 EC61 F001      01211       call     check_busy
00057A 0E80           01212       movlw   linia_gorna
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00057C EC23 F001      01213       call    send
000580 EC61 F001      01214       call     check_busy
                      01215       
                      01216      
                      01217      ;jeżeli praca w trybie regulacji to pisz r
                      01218      
                      01219      ;jezeli po tej operacji jest 0 w W to znczy ze 
                      01220      ;przedtem obydwa te bajty zawieraly 0
                      01221      
000584 51B7           01222      movf       czy_reguluje1,w
000586 11B8           01223      iorwf      czy_reguluje2,w
000588 E103           01224      bnz        napisz_czas_litera_r
00058A                01225 nie_pisz_litery_r
00058A 0E20           01226      movlw  _puste 
00058C EFC9 F002      01227      goto   napisz_czas_dalej1 
                      01228      
000590                01229 napisz_czas_litera_r     
000590 0E72           01230      movlw  _r
                      01231      
000592                01232 napisz_czas_dalej1     
                      01233      ; btfsc  markers_regulacja,reguluj1
                      01234      ; movlw  _r
                      01235      
                      01236      ; btfsc  markers_regulacja,reguluj2
                      01237      ; movlw  _r
                      01238      
000592 EC34 F001      01239      call   write_lcd
                      01240      
000596 EC61 F001      01241      call     check_busy
                      01242      
                      01243      ;jeżeli praca w trybie transferu szeregowego
00059A 0E20           01244      movlw  _puste 
00059C B99F           01245      btfsc  markers,czy_wysylac_pomiary_serial
00059E 0E73           01246      movlw  _s
0005A0 EC34 F001      01247      call   write_lcd
0005A4 EC61 F001      01248      call     check_busy 
                      01249       
                      01250       
                      01251       
                      01252       ;addlw 2
                      01253       
                      01254       
                      01255             
0005A8 0EE0           01256       movlw       dzien_10
0005AA 6ED9           01257       movwf       FSR2L      
0005AC 6ADA           01258       clrf        FSR2H
0005AE EFDE F002      01259       goto        petla_napisz_czas
                      01260       
0005B2                01261 petla_napisz_czas_dwukropek      
                      01262 ;po kazdych dwóch cyfrach pisz dwukropek
0005B2 0E3A           01263       movlw       _dwukropek
0005B4 EC34 F001      01264       call        write_lcd
0005B8 EC61 F001      01265       call        check_busy
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01266             
                      01267 ;w FSR2l umieszczam adres komorki dzien_10, zwiekszajac ten adres o 1 mam dostep po kolei do wszystkich 
                            wartosci 
                      01268 ;czasowych
0005BC                01269 petla_napisz_czas
                      01270 ;sprawdz czy cyfra 10 jest 0 - jezeli tak to wyswietl puste
0005BC 0E30           01271       movlw 0x30
0005BE 18D9           01272       xorwf FSR2L,w
0005C0 B4D8           01273       btfsc STATUS,Z
0005C2 EFE6 F002      01274       goto  wyswietl_puste
                      01275 ;jezeli wyswietlam zawartosc rejestru      
0005C6 50DF           01276       movf  INDF2,w
0005C8 EFE7 F002      01277       goto  wyswietl_1
                      01278       
0005CC                01279 wyswietl_puste
0005CC 0E20           01280       movlw _puste
                      01281       
0005CE                01282 wyswietl_1      
                      01283       
                      01284       
0005CE EC34 F001      01285       call  write_lcd
0005D2 EC61 F001      01286       call  check_busy
                      01287       
0005D6 2AD9           01288       incf  FSR2L,f
0005D8 50DF           01289       movf  INDF2,w
0005DA EC34 F001      01290       call  write_lcd
0005DE EC61 F001      01291       call  check_busy
                      01292       
0005E2 2AD9           01293       incf  FSR2L,f
                      01294       
0005E4 0EE8           01295       movlw       sekundy_1+1
0005E6 18D9           01296       xorwf       FSR2L,w
0005E8 E1E4           01297       bnz         petla_napisz_czas_dwukropek
                      01298       
                      01299       ;po wyswietleniu zegara znow kaz mierzyc
                      01300       
0005EA AD9F           01301       btfss       markers,czy_wlaczyc_ponownie_temp
0005EC EF7D F00E      01302       goto        LOOP 
                      01303       
                      01304       
                      01305       ;bcf   markers,pomiary_zrobione
                      01306       ;i zaznacz zeby je jeszcze raz wlaczyl po wyswietleniu czasu
0005F0 9D9F           01307       bcf   markers,czy_wlaczyc_ponownie_temp
                      01308       
0005F2 EF7D F00E      01309       goto  LOOP
                      01310       ;sprawdz czy INDF2 ==    sekundy_1 + 1
                      01311       
                      01312       
                      01313  
                      01314 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                                                 SPRAWDZANIE CZY nast
                            apilo 0  
0005F6                01315 odznacz_by_znow_mierzyc
                      01316                                     ;sprawdz czy odstep miedzy pomiarami juz minal
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01317       
                      01318       ;incf  aktualny_odstep,w
                      01319       
                      01320       ;movf  aktualny_odstep,w
                      01321       ;bnz   bez_wlaczania_pomiarow
                      01322       
0005F6 2FA6           01323          decfsz   aktualny_odstep,f
0005F8 0012           01324          return                
                      01325          
0005FA 51AD           01326          movf     odstep_pomiarowy,w
0005FC 6FA6           01327          movwf    aktualny_odstep
                      01328          
0005FE A59F           01329          btfss    markers,pomiary_zrobione
000600 0012           01330          return
                      01331          
000602 959F           01332          bcf      markers,pomiary_zrobione
000604 879F           01333          bsf      markers,inicjuj_pomiary
000606 0012           01334          return
                      01335 
                      01336 
                      01337 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                       ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; 
                                                  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;  KAZDE ROZPOCZEcie POMIAROW         
000608                01338 rozpocznij_pomiary         
                      01339 ;dokonuj pomiaru  na pierwszym kanale
                      01340 ;wlaczam tez przerwanie analogowego pomiaru
                      01341          
                      01342 ;wlacz przerwanie jak skonczy mierzyc zeby wyslac
                      01343 ;wystarczy ze 000 do bitow kanalu
000608 6B87           01344       clrf  linia2
00060A 6B89           01345       clrf  linia4
00060C 99A0           01346          bcf      markers2,wyslij_pomiar 
                      01347          ;
00060E 51AC           01348          movf     ile_kanalow,w
000610 6FAB           01349          movwf    ktory_kanal_mierze 
                      01350          
000612 51AE           01351          movf    jak_duzo_probek,w
000614 6FBB           01352          movwf   ktora_probka
000616 6BBC           01353          clrf     ktory_kanal
                      01354          
                      01355          ;movwf   ktore_dzielenie_przez2
                      01356          
000618 5082           01357          movf     port_multiplekser,w
                      01358 ;czyszcze aktualne ustawienia multipleksera
                      01359 ;jezeli byl tu b'01010001'     
00061A 0BF8           01360          andlw    b'11111000'
                      01361 ;w wyniku mamy b'01010000'      
00061C 6E8B           01362          movwf    latch_multiplekser   
                      01363          
00061E 50C2           01364          movf     ADCON0,w
                      01365          
                      01366          ;bsf      STATUS,RP0
                      01367          ;bcf      STATUS,RP1
                      01368 ;        movlw    0x1a
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 45


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01369          
                      01370          ;bcf      STATUS,RP0    
                      01371          ;clrf     TMR0L
                      01372         
                      01373         IF (procek == 18f442)
                      01374          ;bcf      INTCON,T0IF
                      01375          ;bsf      INTCON,T0IE
                      01376          andlw    b'11000111'
                      01377          movwf    ADCON0
                      01378          
                      01379         
                      01380         ENDIF
                      01381         
                      01382         
                      01383         IF (procek == 18f4320)
                      01384          ;bcf      INTCON,TMR0IF
                      01385          ;bsf      INTCON,TMR0IE
000620 0BC3           01386          andlw    b'11000011'
000622 6EC2           01387          movwf    ADCON0
                      01388          
                      01389         ENDIF
                      01390          
                      01391          ;jezeli mam wykonywac pomiary to zapisz z rejestru ile mam robic pomiarow
000624 B1A1           01392          btfsc    markers3,pomiary_pradu
000626 6BDF           01393          clrf     ktory_aktualnie_kanal_pradu
                      01394          
000628 979F           01395          bcf      markers,inicjuj_pomiary
                      01396          
00062A 82C2           01397          bsf      ADCON0,GO
00062C 8C9D           01398          bsf      PIE1,ADIE
                      01399          
00062E 0012           01400         return             
                      01401 
                      01402          
000630                01403 bez_wlaczania_pomiarow
                      01404 
                      01405          
                      01406       
000630                01407 procedura_obslugi_zegara
                      01408 ;najpierw sprawdz czy minelo 16 zliczen?
                      01409       
                      01410 
                      01411 
                      01412       ;jezeli pomiary to cy je robic?
000630 B5A0           01413          btfsc    markers2,pomiary
000632 ECFB F002      01414          call     odznacz_by_znow_mierzyc
                      01415       ;odznacz    
000636 93A0           01416          bcf      markers2,przerwanie_t1
                      01417       
                      01418       
                      01419          ;btfss    portlampka,lampka
                      01420          ;goto     zapal    
                      01421          ;bcf      portlampka,lampka
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 46


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01422                   
000638 0012           01423          return
                      01424 ;zapal    
                      01425  ;        bsf      portlampka,lampka
                      01426   ;       return
                      01427 
                      01428 
                      01429   
                      01430   
                      01431   
                      01432   
                      01433   
                      01434   
                      01435 
00063A                01436 sprawdz_czy_mozna_wysylac
                      01437          ;bsf      STATUS,RP0
00063A                01438 TMR_nie_pusty     
00063A A2AC           01439          btfss    TXSTA,TRMT
00063C EF1D F003      01440          goto     TMR_nie_pusty     
                      01441          ;bcf      STATUS,RP0
000640                01442 TXREG_nie_pusty   
000640 A89E           01443          btfss    PIR1,TXIF
000642 EF20 F003      01444          goto     TXREG_nie_pusty
000646 0012           01445          return   
                      01446          
                      01447          
                      01448          
                      01449          
                      01450          
                      01451          
                      01452          
                      01453          
                      01454          
000648                01455 wyslij_znak
                      01456 ;sprawdz czy USART transmit buffer jest pusty
                      01457 
000648 0E00           01458          movlw    dane_odebraneL
                      01459          
00064A 6EE9           01460          movwf    FSR0L
00064C 0E01           01461          movlw    dane_odebraneH
00064E 6EEA           01462          movwf    FSR0H
                      01463          
000650                01464 wyslij_znak_petla 
000650 EC1D F003      01465          call     sprawdz_czy_mozna_wysylac
                      01466 ;laduje dane do wyslania   
000654 2AE9           01467          incf     FSR0L,f
                      01468          
                      01469 ;        movf     INDF0,w
                      01470 ;        call     write_lcd
                      01471 ;        call     check_busy
                      01472          
000656 0E0D           01473          movlw    0x0d
000658 18EF           01474         xorwf    INDF0,w
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 47


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00065A B4D8           01475          btfsc    STATUS,Z
00065C EF34 F003      01476          goto     wyslij_znak_koniec
                      01477          
000660 50EF           01478          movf    INDF0,w
000662 6EAD           01479          movwf    TXREG
000664 EF28 F003      01480          goto     wyslij_znak_petla
000668                01481 wyslij_znak_koniec
000668 EC1D F003      01482          call     sprawdz_czy_mozna_wysylac
00066C 0E20           01483          movlw    _puste
00066E 6EAD           01484          movwf    TXREG
000670 EC1D F003      01485          call     sprawdz_czy_mozna_wysylac
000674 0E3A           01486          movlw    _dwukropek
000676 6EAD           01487          movwf    TXREG
000678 EC1D F003      01488          call     sprawdz_czy_mozna_wysylac
00067C 0E2D           01489          movlw    _minus
00067E 6EAD           01490          movwf    TXREG
000680 EC1D F003      01491          call     sprawdz_czy_mozna_wysylac
000684 0E0A           01492          movlw    znak_lf
000686 6EAD           01493          movwf    TXREG
                      01494          
000688 06E9           01495          decf     FSR0L,f
                      01496 ;        call     sprawdz_czy_mozna_wysylac
                      01497 ;        movlw    znak_lf
                      01498 ;        movwf    TXREG
                      01499          
                      01500 
00068A EF22 F004      01501          goto     powrot_z_polecen
                      01502          
00068E                01503 sprawdz_czy_odebrano_litere
00068E 0E30           01504          movlw    0x30
000690 5CEF           01505          subwf    INDF0,w
000692 6F95           01506          movwf    tmp7
                      01507 ;sprawdzam czy zostaly jakies bity w gornej polowce bajtu
                      01508          
000694 0BF0           01509          andlw    0xf0 
000696 B4D8           01510          btfsc    STATUS,Z
000698 0012           01511          return
                      01512 ;jezeli odebrano litere duza (A,B,C,D,E,F) to po odjeciu 0x41 nic nie powinno zostac w                  
                              
00069A 0E41           01513          movlw    0x41
00069C 5CEF           01514          subwf    INDF0,w
00069E 6F95           01515          movwf    tmp7
                      01516 
0006A0 0BF0           01517          andlw    0xf0 
0006A2 A4D8           01518          btfss    STATUS,Z
0006A4 EF57 F003      01519          goto     sprawdz_czy_odebrano_mala_litere
                      01520 ;zasada taka to co zostalo po odjeciu 0x41 to 0 dla A 1 dla B etc
                      01521 ;aby miec prawdziwy znak dodaje do tego 0x0a         
0006A8 0E0A           01522          movlw    0x0A
0006AA 2795           01523          addwf    tmp7,f
0006AC 0012           01524          return
0006AE                01525 sprawdz_czy_odebrano_mala_litere
0006AE 0E61           01526          movlw    0x61
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 48


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0006B0 5CEF           01527          subwf    INDF0,w
0006B2 6F95           01528          movwf    tmp7
0006B4 0BF0           01529          andlw    0xf0 
0006B6 A4D8           01530          btfss    STATUS,Z
0006B8 EF61 F003      01531          goto     zla_dana_wez_0
0006BC 0E0A           01532          movlw    0x0A
0006BE 2795           01533          addwf    tmp7,f
0006C0 0012           01534          return
0006C2                01535 zla_dana_wez_0
0006C2 6B95           01536          clrf     tmp7
0006C4 0012           01537          return
                      01538          
0006C6                01539 kopiuj_liczbe_przeslana
                      01540 ;procedura dziala na tej zasadzie
                      01541 ;ze znaki 0123456789;:<=>?
                      01542 ;wysłane na ekran 
                      01543 ;po odjeciu 0x30 sa 4bitami liczby
                      01544 ;pierwszy znak jest wyzszym bajtem
                      01545 ;drugi znak nizszym
                      01546 
                      01547 ;dodano obsluge literek a,b,c,d,e,f
                      01548 ;zamiast znakow ;:<=>?
0006C6 2AE9           01549          incf     FSR0L,f
                      01550          
0006C8 EC47 F003      01551          call   sprawdz_czy_odebrano_litere  
                      01552          
                      01553          
0006CC 3995           01554          swapf    tmp7,w
0006CE 6F91           01555          movwf    tmp
                      01556          
0006D0 2AE9           01557          incf     FSR0L,f
0006D2 EC47 F003      01558          call     sprawdz_czy_odebrano_litere
0006D6 5195           01559          movf     tmp7,w
0006D8 2791           01560          addwf    tmp,f
                      01561          
0006DA 0012           01562          return
                      01563                   
0006DC                01564 zamien_na_hex
                      01565 ;jezeli po odjeciu 0a jest niezanaczony bit C
                      01566 ;to znaczy ze dodaj 
0006DC 6F95           01567          movwf    tmp7
0006DE 0E0A           01568          movlw    0x0a
0006E0 5D95           01569          subwf    tmp7,w
0006E2 A0D8           01570          btfss    STATUS,C
0006E4 EF77 F003      01571          goto     cyfry_0_9
0006E8 5195           01572          movf     tmp7,w
0006EA 0F37           01573          addlw    0x37
0006EC 0012           01574          return
0006EE                01575 cyfry_0_9         
0006EE 5195           01576          movf     tmp7,w
0006F0 0F30           01577          addlw    0x30
0006F2 0012           01578          return
                      01579          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 49


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01580 
                      01581          
                      01582          
0006F4                01583 pokaz_rejestr     
                      01584          
0006F4 EF22 F004      01585          goto     powrot_z_polecen
                      01586 
                      01587 
                      01588          
0006F8                01589 inicjuj_pomiar
                      01590 ;odbierz cyfre ile mam wlaczyc portow analogowych
                      01591          
                      01592 ;do pomiarow potrzebuje rejestr TMR2         
0006F8 2AE9           01593          incf     FSR0L,f
0006FA 50EF           01594          movf     INDF0,w
0006FC B4D8           01595          btfsc    STATUS,Z
0006FE EFA0 F003      01596          goto     wylacz_pomiary
                      01597          
000702 0E30           01598          movlw    0x30
000704 5CEF           01599          subwf    INDF0,w
000706 B4D8           01600          btfsc    STATUS,Z
000708 EFA0 F003      01601          goto     wylacz_pomiary
00070C 6FAC           01602          movwf    ile_kanalow
                      01603          
00070E 6FAB           01604          movwf    ktory_kanal_mierze
                      01605          
                      01606             
                      01607 ;sprawdz czy liczba kanalow nie jest wieksza od 8
                      01608 ;jezeli od ile_kanalow odejme 8 i nie wyjdzie bit C
                      01609 ;tzn pozyczki to przyjmij 0x07
                      01610          ; sublw    0x08
                      01611          ; btfss    STATUS,C
                      01612          ; goto     zle_polecenie
                      01613 ;jezeli nie ma kropki to koncz
000710 2AE9           01614          incf     FSR0L,f
000712 0E2E           01615          movlw    _kropka
000714 18EF           01616          xorwf    INDF0,w
000716 A4D8           01617          btfss    STATUS,Z
000718 EF22 F004      01618          goto     powrot_z_polecen
                      01619 ;odbierz kolejne cyfry
                      01620         
00071C EC63 F003      01621          call     kopiuj_liczbe_przeslana
000720 5191           01622          movf     tmp,w
000722 6FAD           01623          movwf    odstep_pomiarowy
000724 6FA6           01624          movwf    aktualny_odstep
                      01625 ;wlacz analog/cyfre
000726 0E01           01626          movlw    b'00000001'
000728 6EC2           01627          movwf    ADCON0
00072A 85A0           01628          bsf      markers2,pomiary
                      01629          ;bcf      portlampka2,lampka2
                      01630          ;clrf     TMR2
                      01631          ;movlw    b'00000000'
                      01632          ;movwf    T2CON
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 50


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00072C 51AE           01633          movf    jak_duzo_probek,w
                      01634          
00072E 6FBB           01635          movwf   ktora_probka
000730 5082           01636          movf     port_multiplekser,w
                      01637          
                      01638 ;czyszcze aktualne ustawienia 
                      01639 ;jezeli byl tu b'01010001'     
000732 0BF8           01640          andlw    b'11111000'
                      01641 ;w wyniku mamy b'01010000'      
000734 6E8B           01642          movwf    latch_multiplekser
                      01643          
                      01644 ;IF  (czy_ekran==1)
                      01645 ;         
                      01646 ;         movlw   linia_gorna+4
                      01647 ;         call    send
                      01648  ;        call     check_busy
                      01649 ;         movlw    _B
                      01650 ;         call     write_lcd
                      01651 ;ENDIF
000736 8B9F           01652          bsf      markers,czy_wyswietlam_temp
000738 859F           01653          bsf      markers,pomiary_zrobione
00073A 899F           01654          bsf   markers,czy_wysylac_pomiary_serial
                      01655          
00073C EF22 F004      01656          goto     powrot_z_polecen    
                      01657 
000740                01658 wylacz_pomiary
000740 999F           01659       bcf   markers,czy_wysylac_pomiary_serial
000742 0E00           01660          movlw    b'00000000'
000744 6EC2           01661          movwf    ADCON0
000746 95A0           01662          bcf      markers2,pomiary
000748 99A0           01663          bcf     markers2,wyslij_pomiar
                      01664          ; bcf     portlampka2,lampka2
                      01665          
00074A 97A2           01666          bcf      markers_regulacja,reguluj2
00074C 93A2           01667          bcf      markers_regulacja,reguluj1
                      01668          ;bcf      markers2,
00074E 9B9F           01669          bcf      markers,czy_wyswietlam_temp
                      01670          
000750 6BB7           01671          clrf     czy_reguluje1
000752 6BB8           01672          clrf     czy_reguluje2
                      01673          
000754 9081           01674          bcf    port_triak,triak1
000756 9281           01675          bcf    port_triak,triak2
                      01676          
000758 EF22 F004      01677          goto     powrot_z_polecen                      
                      01678 ;polecenie ustawia regulator -> pokazuje wzgledem ktorego pomiaru ma regulowac wyjscie regulatora wybran
                            e arbitralnie np PORTC0
                      01679 ;i do tego portu podlaczam wyjscie na przekaznik lub triac     
                      01680 ;
                      01681 ;*Rx.yyyy
00075C                01682 wylacz_regulator
00075C 93A2           01683          bcf      markers_regulacja,reguluj1
00075E 97A2           01684          bcf      markers_regulacja,reguluj2
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 51


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01685          
000760 6BB7           01686          clrf     czy_reguluje1
000762 6BB8           01687          clrf     czy_reguluje2
                      01688          
                      01689          ; bcf      portlampka2,lampka2
000764 EF22 F004      01690          goto     powrot_z_polecen              
000768                01691 ustaw_regulator
                      01692          
000768 EF22 F004      01693          goto     powrot_z_polecen    
                      01694 
                      01695          
                      01696 ; ustaw_wartosc_dzielenia_usredniania
00076C                01697 ustaw_wartosc_dziel_usredniania         
                      01698       ;sprawdzam    który bit jest ustawiony
                      01699 ;jeżeli jak_duzo_probek == 0x80 to ustawiony jest bit 7
00076C BFAE           01700       btfsc       jak_duzo_probek,7
00076E 0E02           01701       movlw       0x02
                      01702 ;bit 6 = 0x40   
000770 BDAE           01703       btfsc       jak_duzo_probek,6
000772 0E04           01704       movlw       0x04
                      01705       
000774 BBAE           01706       btfsc       jak_duzo_probek,5
000776 0E08           01707       movlw       0x08
                      01708 ;0x10      
000778 B9AE           01709       btfsc       jak_duzo_probek,4
00077A 0E10           01710       movlw       0x10
                      01711 ;0x20      
00077C B7AE           01712       btfsc       jak_duzo_probek,3
00077E 0E20           01713       movlw       0x20
                      01714 ;0x40      
000780 B5AE           01715       btfsc       jak_duzo_probek,2
000782 0E40           01716       movlw       0x40
                      01717       
                      01718 ;2 próbki      
000784 B3AE           01719       btfsc       jak_duzo_probek,1
000786 0E80           01720       movlw       0x80
                      01721       
000788 6FBD           01722       movwf       usrednianie_przez_co_mnoze
                      01723       
                      01724 
00078A 0012           01725       return
                      01726       
00078C                01727 ustaw_probki                              ;                 PROBKI
00078C 6BA8           01728          clrf     pomiarH
00078E 6BA9           01729          clrf     pomiarL
000790 6BAA           01730          clrf     pomiar_ulamek
000792 6B9B           01731          clrf     wynikh
000794 6B9C           01732          clrf     wynik
                      01733 ;zawsze wyłącz na początku usrednianie
000796 919F           01734          bcf      markers,czy_usrednianie
                      01735          
000798 EC63 F003      01736          call     kopiuj_liczbe_przeslana
00079C 5191           01737          movf     tmp,w
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 52


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00079E 6FAE           01738          movwf    jak_duzo_probek
                      01739          
                      01740          ;movwf   ktora_probka
                      01741          
                      01742 ;sprawdz czy usredniamy czy nie tzn czy wartosc jak_duzo_probek < 2
0007A0 0801           01743          sublw    1
0007A2 B0D8           01744          btfsc    STATUS,C
0007A4 EF22 F004      01745          goto     powrot_z_polecen
0007A8 819F           01746          bsf      markers,czy_usrednianie
                      01747 ;ustaw wartość liczby przez którą mnoże każdy z pomiarów -> tzn przez ile dzielę
                      01748          
0007AA ECB6 F003      01749          call     ustaw_wartosc_dziel_usredniania
                      01750          
0007AE EF22 F004      01751          goto     powrot_z_polecen
                      01752 
                      01753 
                      01754 
                      01755 
                      01756          
                      01757          
                      01758          
                      01759          
                      01760          
                      01761          
                      01762          
                      01763          
0007B2                01764 wlaczenie_rejestracji_pradu
                      01765 
0007B2 EF22 F004      01766       goto        powrot_z_polecen
                      01767       
                      01768       
                      01769       
                      01770       
                      01771       
                      01772       
                      01773       
                      01774       
                      01775       
                      01776       
                      01777       
                      01778       
                      01779 ; rozkaz_rejestracji_poprawki_pomiaru_temperatury
0007B6                01780 rozkaz_rejestracji_poprawki_temp
                      01781       ;incf     FSR0L,f   
0007B6 EC63 F003      01782       call     kopiuj_liczbe_przeslana
                      01783 
                      01784         
0007BA 5191           01785       movf     tmp,w
                      01786 ;tmp6 przechowuje pod ktory adres zapisac poprawke      
0007BC 6F94           01787       movwf    tmp6
0007BE 0809           01788       sublw    9
                      01789 ;jezeli wyszlo C tzn ze przekroczono a kanalow mamy tylko 8 + 2 pradowe
0007C0 A0D8           01790       btfss       STATUS,C
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 53


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0007C2 EF22 F004      01791       goto        powrot_z_polecen
                      01792       
                      01793       
                      01794 ;sprawdz czy przeslana dana nie jest wieksza od 7 jezeli jest to przerwij
                      01795 ;odbierz kolejna liczbe
                      01796       ;incf     FSR0L,f
0007C6 EC63 F003      01797       call     kopiuj_liczbe_przeslana
                      01798 
                      01799       ;jest w tmp  poprawka
0007CA 0ED4           01800       movlw    poprawka0
                      01801       ;dec100 przechowuje ktorego czujnika to dotyczy
0007CC 2594           01802       addwf    tmp6,w
0007CE 6EE1           01803       movwf    FSR1L
0007D0 6AE2           01804       clrf     FSR1H
                      01805       ;zapisuje do rejestru poprawek
0007D2 5191           01806       movf     tmp,w
0007D4 6EE7           01807       movwf    INDF1
                      01808       ;movwf    poprawka
0007D6 0E91           01809       movlw       tmp
0007D8 6EE1           01810       movwf    FSR1L
                      01811       
0007DA 0E00           01812       movlw poprawka0_ee
0007DC 2594           01813       addwf tmp6,w
0007DE ECBA F001      01814       call  zapis_eeprom
0007E2 EF22 F004      01815       goto        powrot_z_polecen
                      01816 
                      01817       
                      01818       
                      01819       
                      01820       
                      01821       
                      01822       
0007E6                01823 wybor_czujnika_regulatora
                      01824       
0007E6 EF22 F004      01825       goto        powrot_z_polecen
                      01826       
                      01827       
                      01828       
                      01829       
                      01830       
                      01831       
                      01832       
0007EA                01833 sprawdz_czy_polecenie                  
                      01834 ;sprawdz czy odebrano 'znak_cr'
0007EA 0E00           01835          movlw    0x00
0007EC 6EE9           01836          movwf    FSR0L
0007EE 0E01           01837          movlw    1
0007F0 6EEA           01838          movwf    FSR0H
                      01839          
0007F2 0E2A           01840          movlw    _star
0007F4 18EF           01841          xorwf    INDF0,w
0007F6 A4D8           01842          btfss    STATUS,Z
                      01843          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 54


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01844         IF (czy_ekran==1)         
0007F8 EF27 F004      01845          goto     wyslij_na_ekran_to_co_odebralem
                      01846         ENDIF         
                      01847         
                      01848         IF       (czy_ekran==0)
                      01849         goto     powrot_z_polecen
                      01850         ENDIF         
                      01851    
                      01852 
                      01853 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;         
0007FC                01854 sprawdz_ktore_polecenie
                      01855 ;polecenia:
                      01856 ;
                      01857 ;        *L-zapal lub zgas lampke lampke
                      01858 ;        *Px.y - pomiar kanal x wyrzucany na port szeregowy co y czasu (y to 1/2 sekundy)
                      01859 ;                 konfiguruje kanal 0 i referencyjne zasilajace
                      01860 ;        *P - puste przerywa pomiary
                      01861 ;        *Cx - czysci x linie ekranu i zeruje kursor
                      01862 ;        *Ryyy    - reguluj odczyt x(ktory kanal) na poziom y ustawienia w ilosc odczytanej cyfry
                      01863 ;        *+x.y - dodaje x + y i wynik na 4 linii ekranu
                      01864 ;        *>x      przeslij znak x
                      01865 ;        **xx   ustaw zegar szeregowego xxx->do SPBRG 
                      01866 ;        xx -> zapis szesnastkowy tzn **:: ustawia SPBRG na 0xaa
                      01867 ;        *#xxxx - pokaz zawartosc rejestru xxxx (podobnie jak powyzej) - podaje dwa bajty np 0fff
                      01868 ;        *S00 - ustawienie ilosci probek na jeden pomiar
                      01869 ;        
                      01870 ;        *Di  -  inicjuje ds1820
                      01871 ;        *Dr  -read rom (only one ds)
                      01872 ;        *Ds      -skip rom (whitout rom identification)
                      01873 
                      01874 ;        *exxyy  - na ekran w miejscu xx wyrzuc znak yy
                      01875 ;        *p0xyy  - poprawka kanalu x o yy
                      01876 ;           *i0x - pomiar pradu z kanalow 2     
                      01877 ;           *A    - który czujnik użyty jest w regulacji
                      01878 ;zacznij robic
                      01879 ;sprawdzam czy
0007FC 2AE9           01880          incf     FSR0L,f
                      01881          
                      01882          
                      01883 ;*> - znak wysylania
0007FE 0E3E           01884          movlw    0x3e
000800 18EF           01885          xorwf    INDF0,w
000802 B4D8           01886          btfsc    STATUS,Z
000804 EF24 F003      01887          goto     wyslij_znak
                      01888 ;**         
                      01889          ; movlw    _star
                      01890          ; xorwf    INDF0,w
                      01891          ; btfsc    STATUS,Z
                      01892          ; goto     ustaw_spbrg
                      01893 ;*# - pokaz komorke pamieci         
                      01894          ; movlw    0x23
                      01895          ; xorwf    INDF0,w
                      01896          ; btfsc    STATUS,Z
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 55


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01897          ; goto     pokaz_rejestr
                      01898 ;*P -> pomiar     
000808 0E50           01899          movlw    _P
00080A 18EF           01900          xorwf    INDF0,w
00080C B4D8           01901          btfsc    STATUS,Z
00080E EF7C F003      01902          goto     inicjuj_pomiar
                      01903 
                      01904 
                      01905 ;*r ->Reguluj
000812 0E52           01906          movlw    _R
000814 18EF           01907          xorwf    INDF0,w
000816 B4D8           01908          btfsc    STATUS,Z
000818 EFB4 F003      01909          goto     ustaw_regulator
                      01910          
                      01911 ;*S ->probki
00081C 0E53           01912          movlw    _S
00081E 18EF           01913          xorwf    INDF0,w
000820 B4D8           01914          btfsc    STATUS,Z
000822 EFC6 F003      01915          goto     ustaw_probki
                      01916 
                      01917          
                      01918 ;*p - poprawka  czujnika temperatury i o ile np: *p0009 czyli 0 o 9 (ujemne to uzupelnienia czyli *p00fe
                             to poprawka o -1
000826 0E70           01919          movlw    _p
000828 18EF           01920          xorwf    INDF0,w
00082A B4D8           01921          btfsc    STATUS,Z
00082C EFDB F003      01922          goto     rozkaz_rejestracji_poprawki_temp
                      01923          
                      01924 ;*i - pomiar pradu np *i0x
                      01925          
000830 0E69           01926          movlw    _i
000832 18EF           01927          xorwf    INDF0,w
000834 B4D8           01928          btfsc    STATUS,Z
000836 EFD9 F003      01929          goto     wlaczenie_rejestracji_pradu
                      01930          
00083A 0E41           01931          movlw    _A
00083C 18EF           01932          xorwf    INDF0,w
00083E B4D8           01933          btfsc    STATUS,Z
000840 EFF3 F003      01934          goto     wybor_czujnika_regulatora
                      01935          
                      01936 ;ustaw szybkosc portu szeregowego
                      01937 ;ustawienie jest zapisane do EEPROM i w momencie startu urzadzenia stamtad czytane
                      01938 ;mozliwe ustawienia:
                      01939 ;0x1a - 11200 baudow
                      01940 ;0x0c - 19200 baudow
                      01941 ;
                      01942          
                      01943                            
000844                01944 powrot_z_polecen
                      01945 ;        movlw    _up
000844 2AE9           01946          incf     FSR0L,f
000846 97A0           01947          bcf      markers2,sprawdz_odebrane
000848 6B8D           01948          clrf     odebrano_liter
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 56


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00084A 88AB           01949          bsf      RCSTA,CREN
                      01950 ;        clrf     FSR0L
                      01951 ;        movwf    INDF
00084C 0012           01952          return
                      01953          
                      01954          
00084E                01955 wyslij_na_ekran_to_co_odebralem
00084E EC61 F001      01956       call     check_busy
000852 0EC0           01957          movlw    linia_dolna
000854 EC23 F001      01958          call     send
000858 EC61 F001      01959          call     check_busy
00085C 0E00           01960          movlw    dane_odebraneL
00085E 6EE9           01961          movwf    FSR0L      
000860 0E01           01962          movlw    dane_odebraneH
000862 6EEA           01963          movwf    FSR0H      
                      01964          
000864                01965 wyswietl_litere_petla
                      01966          
000864 0E0D           01967          movlw    0x0d
000866 18EF           01968          xorwf    INDF0,w
000868 B4D8           01969          btfsc    STATUS,Z
00086A EF51 F004      01970          goto     koniec_wyswietlania
                      01971          
                      01972 ;sprawdz czy odebrano pusty znak...
                      01973 ;        movlw    0x0a
                      01974 ;        xorwf    INDF,w
                      01975 ;        btfsc    STATUS,Z
                      01976 ;        goto     koniec_wyswietlania        
                      01977          
00086E 50EF           01978          movf     INDF0,w
000870 B4D8           01979          btfsc    STATUS,Z
000872 EF51 F004      01980          goto     koniec_wyswietlania
                      01981 
                      01982 
000876 518D           01983          movf     odebrano_liter,w
000878 A4D8           01984          btfss    STATUS,Z
00087A EF3F F004      01985          goto     wyswietl_litere_petla2
                      01986          
                      01987          
                      01988 ;        goto     koniec_wyswietlania
                      01989 
00087E                01990 wyswietl_litere_petla2
                      01991          ;movlw    linia_dolna
                      01992          ;addwf    linia2,w
                      01993          ;call     send
                      01994          ;call     check_busy
                      01995          
00087E 50EF           01996          movf     INDF0,w
000880 EC34 F001      01997          call     write_lcd
000884 EC61 F001      01998          call     check_busy
                      01999 ;        clrf     odebrana_litera
000888 2B87           02000          incf     linia2,f
                      02001          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 57


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02002 ;        movlw    0A
                      02003 ;        xorwf    linia2
00088A A987           02004          btfss    linia2,4
00088C EF4E F004      02005          goto     wyswietl_litere_petla3
                      02006          
000890 6B87           02007          clrf     linia2
000892 0E0F           02008          movlw    0x0f
000894 6F8B           02009          movwf    n
000896 0EC0           02010          movlw    linia_dolna
000898 EC52 F001      02011          call     clear_line
                      02012          
00089C                02013 wyswietl_litere_petla3
00089C 2AE9           02014          incf     FSR0L,f
                      02015 ;        decfsz   odebrano_liter,f
00089E EF32 F004      02016          goto     wyswietl_litere_petla
                      02017          
0008A2                02018 koniec_wyswietlania        
                      02019          ;clrf     odebrano_liter
                      02020          ;bcf      markers2,wyswietl
0008A2 88AB           02021          bsf      RCSTA,CREN
0008A4 EF22 F004      02022          goto     powrot_z_polecen
                      02023 
                      02024          
                      02025          
                      02026          
                      02027          
                      02028          
                      02029 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                                                     ;;
                            ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;  
                      02030 
                      02031 
                      02032 ; tu sa procedury pomiaru
                      02033 
                      02034 
                      02035 
                      02036 
                      02037                                                    ;POMIARY!!!!!!!!!!!!!!!!!!!!!!!         
                      02038 
                      02039                                                    
                      02040                                                    
                      02041                                                    
                      02042                                                    
                      02043                                                    
                      02044                                                    
                      02045                                                    
                      02046                                                    
                      02047 ;;;;;;;;;;;;;;;
                      02048 
                      02049 
                      02050             
0008A8                02051 wyswietl_cyfry_temperatury
                      02052    
                      02053   
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 58


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02054   
0008A8 EC61 F001      02055          call     check_busy
0008AC 51BC           02056         movf        ktory_kanal,w
                      02057          
0008AE 0F30           02058       addlw       0x30
                      02059       ;movlw       _plus
0008B0 EC34 F001      02060       call        write_lcd
                      02061       
                      02062       
                      02063       
                      02064       
                      02065       
                      02066       
                      02067    
0008B4 EC61 F001      02068       call     check_busy
0008B8 0E20           02069       movlw       _puste
0008BA BDA1           02070       btfsc       markers3,napisz_minus
0008BC 0E2D           02071       movlw       _minus
0008BE EC34 F001      02072       call        write_lcd
                      02073       
                      02074       
                      02075       
0008C2                02076 wyswietl_cyfry_temperatury_opcje  
                      02077    ;sprawdz czy rzadna z cyfr nie przekracza 10
0008C2 0E0A           02078       movlw       0x0a
0008C4 5D98           02079       subwf       dec1,w
0008C6 E302           02080       bnc         sprawdz_10
0008C8 6F98           02081       movwf       dec1
0008CA 2B97           02082       incf        dec10,f
                      02083       
0008CC                02084 sprawdz_10
0008CC 0E0A           02085      movlw       0x0a
0008CE 5D97           02086       subwf       dec10,w
0008D0 E302           02087       bnc         wyswietl_cyfry_temperatury2
0008D2 6F97           02088       movwf       dec10
0008D4 2B96           02089       incf        dec100,f
                      02090 
0008D6                02091 wyswietl_cyfry_temperatury2        
0008D6 EC61 F001      02092       call     check_busy
0008DA 5196           02093       movf     dec100,w
0008DC E10E           02094       bnz       pisz_cyfre_100
                      02095       
0008DE 0E20           02096       movlw    _puste
0008E0 EC34 F001      02097       call     write_lcd
0008E4 EC61 F001      02098       call     check_busy
0008E8 5197           02099       movf     dec10,w
0008EA E10D           02100       bnz      pisz_cyfre_10
                      02101       
0008EC 0E20           02102       movlw    _puste
0008EE EC34 F001      02103       call     write_lcd
0008F2 EC61 F001      02104       call     check_busy
0008F6 EF89 F004      02105       goto     pisz_cyfre_1
                      02106       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 59


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0008FA                02107 pisz_cyfre_100
0008FA 5196           02108       movf        dec100,w
0008FC 0F30           02109       addlw       0x30
0008FE EC34 F001      02110       call     write_lcd
000902 EC61 F001      02111       call     check_busy
                      02112 
000906                02113 pisz_cyfre_10
000906 5197           02114       movf        dec10,w
000908 0F30           02115       addlw       0x30
00090A EC34 F001      02116       call     write_lcd
00090E EC61 F001      02117       call     check_busy
                      02118       
000912                02119 pisz_cyfre_1
000912 5198           02120       movf        dec1,w
000914 0F30           02121       addlw       0x30
000916 EC34 F001      02122       call     write_lcd
00091A EC61 F001      02123       call     check_busy
                      02124       
00091E 0E2E           02125       movlw    _kropka
000920 EC34 F001      02126       call     write_lcd
                      02127       
                      02128       
                      02129 ;sprawdz ktory ulamek
000924 519D           02130       movf     wynik01,w
000926 E008           02131       bz       pisz_ulamek_00
                      02132       
000928 0A40           02133       xorlw    0x40
00092A E011           02134       bz       pisz_ulamek_25
                      02135       
00092C 519D           02136       movf     wynik01,w
00092E 0A80           02137       xorlw    0x80
000930 E019           02138       bz       pisz_ulamek_50
                      02139       
000932 519D           02140       movf     wynik01,w
000934 0AC0           02141       xorlw    0xc0
000936 E021           02142       bz       pisz_ulamek_75
                      02143       
                      02144       
000938                02145 pisz_ulamek_00
000938 EC61 F001      02146       call     check_busy
00093C 0E30           02147       movlw    0x30
00093E EC34 F001      02148       call     write_lcd
000942 EC61 F001      02149       call     check_busy
000946 0E20           02150       movlw    _puste
000948 EC34 F001      02151       call     write_lcd
                      02152       
                      02153       
00094C 0012           02154       return
                      02155 
00094E                02156 pisz_ulamek_25
00094E EC61 F001      02157       call     check_busy
000952 0E32           02158       movlw    0x32
000954 EC34 F001      02159       call     write_lcd
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 60


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02160       
000958 EC61 F001      02161       call     check_busy
00095C 0E35           02162       movlw    0x35
00095E EC34 F001      02163       call     write_lcd
000962 0012           02164       return
                      02165       
000964                02166 pisz_ulamek_50
000964 EC61 F001      02167       call     check_busy
000968 0E35           02168       movlw    0x35
00096A EC34 F001      02169       call     write_lcd
00096E EC61 F001      02170       call     check_busy
000972 0E30           02171       movlw    0x30
000974 EC34 F001      02172       call     write_lcd
000978 0012           02173       return
                      02174       
00097A                02175 pisz_ulamek_75
00097A EC61 F001      02176       call     check_busy
00097E 0E37           02177       movlw    0x37
000980 EC34 F001      02178       call     write_lcd
000984 EC61 F001      02179       call     check_busy
000988 0E35           02180       movlw    0x35
00098A EC34 F001      02181       call     write_lcd
00098E 0012           02182       return
                      02183       
                      02184       
000990                02185 odejmij_512_od_wyniku_sredniej
                      02186 
000990 0E02           02187          movlw    0x02
000992 5FA8           02188          subwf    pomiarH,f
                      02189          ;jezeli jest 0 to nic wiecej nie trzeba robic
                      02190          
000994 B4D8           02191          btfsc    STATUS,Z
000996 EFD2 F004      02192          goto     wynik_to_po_prostu_L
                      02193          
                      02194        ;jezeli w wyniku nie ma bitu 7 to oznacza brak liczby ujemnej
00099A AFA8           02195        btfss      pomiarH,7
00099C EFD2 F004      02196        goto       wynik_to_po_prostu_L
                      02197        
                      02198        
                      02199        
                      02200       ;w wyniku mamy np ff90 - brak 0
                      02201       ;tego nie trzeba bo polecenie negf - działa z -1 przed zastosowaniem
                      02202       ;decf  pomiarL,f
                      02203       
                      02204       ;przy odejmowaniu C jest normalnie ustawione
                      02205       ;btfss STATUS,C
                      02206       
                      02207       ;ale to trzeba bo tak samo zadziała dla starszego bajtu, a on nie ma być -1
0009A0 2BA8           02208       incf  pomiarH,f
                      02209       
                      02210       ;zaznacz ze pisz minus
0009A2 8DA1           02211       bsf   markers3,napisz_minus
                      02212       ;negf  pomiarL,f
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 61


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02213       ;negf  pomiarH,f
                      02214 
0009A4                02215 wynik_to_po_prostu_L
0009A4 0012           02216       return
                      02217 
                      02218 
0009A6                02219 usrednianie_wartosci
                      02220 ;oblicz srednia dzielac za pomoca ilosc probek pobieranych
                      02221          
0009A6 51AE           02222         movf    jak_duzo_probek,w
                      02223         
                      02224         ;movwf   ktore_dzielenie_przez2
                      02225         
                      02226         
                      02227         
                      02228 
0009A8 6B9D           02229         clrf      wynik01
                      02230         
0009AA                02231 petla_dzielenia
                      02232                                                                     ; bcf     STATUS,C
                      02233                                                                     ; call     dzielenie_przez_przesuwan
                            ie
                      02234                                                                   ;mam na poczatku w ktore dzieleni_prze
                            z2 b'10000000'
                      02235                                                                   ;po jednym dzieleniu mam b'01000000'
                      02236                                                                     ; bcf       STATUS,C
                      02237                                                                     ; rrcf     ktore_dzielenie_przez2,f
                      02238                                                                     ; btfss   ktore_dzielenie_przez2,0
                      02239                                                                     ; goto     petla_dzielenia
                      02240                                                                      
                      02241 
                      02242 
0009AA 51BD           02243       movf    usrednianie_przez_co_mnoze,w
0009AC 039C           02244       mulwf     wynik
                      02245       
                      02246       ;w PRODH jest wartość do wynik, a w ProdL do wynik01
0009AE 50F4           02247       movf        PRODH,w
0009B0 6F9C           02248       movwf       wynik
0009B2 50F3           02249       movf        PRODL,w
0009B4 6F9D           02250       movwf       wynik01
                      02251       
0009B6 519B           02252       movf        wynikh,w
0009B8 E008           02253       bz          procedura_sumowania_wyniku
                      02254       
0009BA 51BD           02255       movf      usrednianie_przez_co_mnoze,w
0009BC 039B           02256       mulwf     wynikh
                      02257       
0009BE 50F4           02258       movf        PRODH,w
0009C0 6F9B           02259       movwf       wynikh
0009C2 50F3           02260       movf        PRODL,w
0009C4 279C           02261       addwf       wynik,f
                      02262       ;jeżeli przekroczyłem bajt to zwiększ o 1
                      02263       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 62


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0009C6 B0D8           02264       btfsc       STATUS,C
0009C8 2B9B           02265       incf        wynikh,f
                      02266          
0009CA                02267 procedura_sumowania_wyniku
0009CA 519D           02268          movf     wynik01,w
0009CC 27AA           02269          addwf    pomiar_ulamek,f
                      02270 ;jezeli przekroczono pomiarL
0009CE A0D8           02271          btfss    STATUS,C
0009D0 EFEE F004      02272          goto     nie_przekroczono_bajtu_ulamka
0009D4 0E01           02273          movlw    1
0009D6 27A9           02274          addwf    pomiarL,f
                      02275 
                      02276          
0009D8 B0D8           02277          btfsc    STATUS,C
0009DA 2BA8           02278          incf     pomiarH,f
                      02279          
0009DC                02280 nie_przekroczono_bajtu_ulamka         
0009DC 519C           02281          movf     wynik,w
0009DE 27A9           02282          addwf    pomiarL,f
0009E0 B0D8           02283          btfsc    STATUS,C
0009E2 2BA8           02284          incf     pomiarH,f
                      02285         
0009E4 519B           02286          movf     wynikh,w
0009E6 27A8           02287          addwf    pomiarH,f
0009E8 0012           02288          return
                      02289          
0009EA                02290 znow_kaz_mierzyc
                      02291 
                      02292 ;         bsf      STATUS,RP0
                      02293  ;        bcf      STATUS,RP1
                      02294 ;        movlw    0x1a
                      02295   ;       bsf      PIE1,ADIE
                      02296    ;      bcf      STATUS,RP0
                      02297     ;     bsf      ADCON0,2 
                      02298          ;clrf     TMR0L
                      02299          ;bcf      INTCON,T0IF
                      02300          ;bsf      INTCON,T0IE
                      02301         IF (procek== 18f442)         
                      02302          
                      02303         ENDIF
                      02304         IF (procek== 18f4320)         
                      02305          
                      02306         ENDIF
0009EA 82C2           02307          bsf      ADCON0,GO
0009EC 99A0           02308          bcf      markers2,wyslij_pomiar
                      02309          
0009EE 0012           02310          return
                      02311           
                      02312 ;na koniec dodaj do pomiarH i pomiarL i pomiar_ulamek
                      02313 
0009F0                02314 wysylanie_pomiaru
                      02315 
                      02316 ;jezeli na każdy pomiar wykonuje szereg pomiarów to nie wysyłaj jeszcze
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 63


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0009F0 99A0           02317          bcf      markers2,wyslij_pomiar
0009F2 A19F           02318          btfss    markers,czy_usrednianie
0009F4 EF01 F005      02319          goto     zapisz_do_pamieci
                      02320        
                      02321 
0009F8 ECD3 F004      02322          call     usrednianie_wartosci
                      02323 
0009FC 2FBB           02324          decfsz   ktora_probka,f
0009FE EFF5 F004      02325          goto     znow_kaz_mierzyc
                      02326          ;return        
000A02                02327 zapisz_do_pamieci
                      02328 ;przed zapisem pomiaru w pamieci ulamki > 0x80 (tzn od 0.5 ) zamieniam na +1 do pomiarL 
                      02329 ;w przeciwnym wypadku pomijam
                      02330          ;movlw    0x81
                      02331          ;subwf    pomiar_ulamek,w
                      02332          ;btfss    STATUS,C
                      02333          ;goto     zapisz_starszy
                      02334          ;bcf      STATUS,C
                      02335          ;movlw    1
                      02336          ;addwf    pomiarL,f
                      02337          ;btfsc    STATUS,C
                      02338          ;incf     pomiarH,f
                      02339 ;                                                              
                      02340          
                      02341          
                      02342          
                      02343          
000A02 B3A1           02344          btfsc    markers3,znacznik_pomiaru_pradu
000A04 EF7C F005      02345          goto     zapis_do_pamieci_prad
                      02346          
000A08                02347 zapis_do_pamieci_temperatury  
                      02348 
                      02349                         ;                                         POPRAWKA temperatury
000A08 6AE2           02350          clrf     FSR1H
000A0A 0ED4           02351          movlw    poprawka0
                      02352          
                      02353          
                      02354          ;ktora poprawka
000A0C 6EE1           02355          movwf    FSR1L
000A0E 51BC           02356          movf     ktory_kanal,w
000A10 26E1           02357          addwf    FSR1L,f
000A12 50E7           02358          movf     INDF1,w
                      02359          
                      02360 
000A14 27A9           02361          addwf    pomiarL,f
                      02362          
                      02363          ;sprawdz czy poprawka jest ujemna
                      02364       ;tzn czy jest zaznaczony bit 7
                      02365       ;jezeli tak to nie sprawdzaj przekroczenia
000A16 BEE7           02366         btfsc     INDF1,7
000A18 EF10 F005      02367         goto      zapisz_do_pam_nie_spr_przekrocz
                      02368          ;jezeli przekroczylem to
                      02369          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 64


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000A1C B0D8           02370          btfsc    STATUS,C
000A1E 2BA8           02371          incf     pomiarH,f
                      02372          
000A20                02373 zapisz_do_pam_nie_spr_przekrocz
                      02374                         ;koniec poprawiania wyniku o blad kanalu pomiarowego i skalowanie czujnika
                      02375                         
                      02376 ;dopiero teraz zamieniam na wartość -512                        
                      02377 
                      02378 
                      02379 
                      02380 ;jednak przed odjęciem 512 sprawdzam czy nie ustawiono przesylu do komputera
                      02381 
000A20                02382 zapisz_do_pamieci_czy_mam_send
000A20 A99F           02383          btfss       markers,czy_wysylac_pomiary_serial
000A22 EF2C F005      02384          goto        zapisz_do_pamieci_juz_po_SERIAL
                      02385       
000A26 9882           02386          bcf      port_CTS,znacznik_CTS
                      02387 
                      02388                   
                      02389          
                      02390         
000A28 98AB           02391          bcf      RCSTA,CREN
                      02392  
                      02393          
000A2A EC1D F003      02394          call    sprawdz_czy_mozna_wysylac
                      02395          
000A2E 51A8           02396          movf    pomiarH,w
000A30 0F30           02397          addlw    0x30
000A32 6EAD           02398          movwf   TXREG
                      02399            
000A34 EC1D F003      02400          call    sprawdz_czy_mozna_wysylac
                      02401          
                      02402         
000A38 39A9           02403          swapf    pomiarL,w
000A3A 0B0F           02404          andlw    0x0f
000A3C EC6E F003      02405          call     zamien_na_hex
000A40 6EAD           02406          movwf   TXREG
                      02407          
                      02408          
000A42 EC1D F003      02409          call    sprawdz_czy_mozna_wysylac
                      02410          
000A46 51A9           02411          movf     pomiarL,w
000A48 0B0F           02412          andlw    0x0f
000A4A EC6E F003      02413          call     zamien_na_hex
000A4E 6EAD           02414          movwf   TXREG     
                      02415          
                      02416 
000A50 EC1D F003      02417          call    sprawdz_czy_mozna_wysylac
                      02418          
000A54 0E2C           02419          movlw    _przecinek
                      02420         
000A56 6EAD           02421          movwf   TXREG     
                      02422          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 65


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02423 
000A58                02424 zapisz_do_pamieci_juz_po_SERIAL        
                      02425           ;                                         teraz odejmuje od starszego bajtu 0x02 
000A58 ECC8 F004      02426          call     odejmij_512_od_wyniku_sredniej
                      02427         
                      02428         
000A5C 0EBF           02429          movlw    pomiar0H
000A5E 6EE1           02430          movwf    FSR1L
                      02431                   
000A60 51BC           02432          movf     ktory_kanal,w
000A62 26E1           02433          addwf    FSR1L,f
000A64 26E1           02434          addwf    FSR1L,f
                      02435                   
000A66 51A8           02436          movf     pomiarH,w         
000A68 6EE7           02437          movwf    INDF1
                      02438                               ;IF (czy_pomiary_na_ekran==1)  
                      02439                               ;sprawdz czy mam wyswietlac 
                      02440                               ;jezeli wszedlem do menu ekranu to nie wyswietlam temperatur
                      02441                                     
                      02442                                     ; btfss      markers,czy_wyswietlam_temp
                      02443                                     ; goto        bez_wyswietlania_temp1
                      02444 
                      02445                                     
                      02446                               ;         movf     INDF1,w
                      02447                                        ;tu wlaczam procedurę zamiany szesnastkowej wartości na dziesi
                            tną liczbę
                      02448                                        
                      02449                                        
                      02450                                ;        addlw    0x30
                      02451                                 ;       call     write_lcd
                      02452                                  ;      incf     linia2,f
                      02453                               ;ENDIF         
                      02454 
000A6A                02455 bez_wyswietlania_temp1
000A6A 2AE1           02456          incf     FSR1L,f
000A6C 51A9           02457          movf     pomiarL,w
                      02458                   
000A6E 6EE7           02459          movwf    INDF1
                      02460         IF (czy_pomiary_na_ekran==1)   
                      02461 
000A70 AB9F           02462       btfss      markers,czy_wyswietlam_temp
000A72 EF7A F005      02463       goto        bez_wyswietlania_temp2
                      02464       
                      02465             
                      02466       ;sprawdz czy rejestr linia2 > 13
000A76 0E0C           02467       movlw       0x0c
                      02468       ; sprawdzam                  rejestr > W
000A78 6187           02469       cpfslt      linia2      
000A7A 6B87           02470       clrf        linia2
                      02471       
                      02472       
000A7C                02473 nie_czysc_rejestru_polozenia  
                      02474   ;temperatury 0-3 na ekranie sa wyswietlane jezeli niezaznaczono bitu markers3,pokazuje_temperatury_47
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 66


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02475       ;aby to sprawdzic dokonuje operacji odjecia od 3 - ktory_kanal
                      02476       
000A7C 0E04           02477       movlw       0x04
                      02478       ; sprawdzam                  rejestr > W
000A7E 61BC           02479       cpfslt        ktory_kanal
000A80 EF4B F005      02480       goto          sprawdz_czy_mam_wyswietlac_47       
                      02481  
                      02482       ;jezeli wynik wskazuje na pomiary na kanale 0 - 3 to sprawdz czy nie wlaczony jest bit 
                      02483       
000A84 BFA1           02484       btfsc       markers3,pokazuje_temperatury_47
000A86 EF7A F005      02485       goto        bez_wyswietlania_temp2
                      02486       
000A8A 0E01           02487       movlw 1
                      02488       ;bit      0-1 ida na linie 2  -> 00000011
                      02489       ; ktory_kanal   > 1 to na linii3
000A8C 65BC           02490       cpfsgt  ktory_kanal
000A8E EF5C F005      02491       goto         ustaw_linie_druga
                      02492       ;jezeli kanal 2-3
000A92 EF54 F005      02493       goto        ustaw_linie_trzecia
                      02494             
                      02495       
000A96                02496 sprawdz_czy_mam_wyswietlac_47
                      02497  ;jezeli wyswietlam kanal 4 -7
                      02498  ; i zaznaczono ten bit tzn ze mam teraz kanal 4, ktory mam wyswietlac na ekranie (pomiary czujnikow 4-7
                            )
                      02499  
000A96 AFA1           02500       btfss       markers3,pokazuje_temperatury_47
000A98 EF7A F005      02501       goto        bez_wyswietlania_temp2
                      02502       
000A9C 0E05           02503       movlw 5
                      02504       ;bit      0-1 ida na linie 2  -> 00000011
                      02505       ; ktory_kanal   > 5 to na linii3
000A9E 65BC           02506       cpfsgt  ktory_kanal
000AA0 EF5C F005      02507       goto         ustaw_linie_druga
                      02508       ;jezeli kanal ma wartosc 6-7
000AA4 EF54 F005      02509       goto        ustaw_linie_trzecia
                      02510       
                      02511       
000AA8                02512 ustaw_linie_trzecia
000AA8 EC61 F001      02513       call     check_busy
000AAC 0E90           02514          movlw    linia_trzecia
000AAE 2587           02515          addwf    linia2,w
000AB0 EC23 F001      02516          call      send      
000AB4 EF64 F005      02517          goto     napisz_wartosc_temperatury
                      02518       
000AB8                02519 ustaw_linie_druga      
000AB8 EC61 F001      02520       call     check_busy
000ABC 0EC0           02521          movlw    linia_dolna
000ABE 2587           02522          addwf    linia2,w
000AC0 EC23 F001      02523          call      send
000AC4 EF64 F005      02524          goto     napisz_wartosc_temperatury
                      02525          
                      02526  
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 67


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02527          ;call     check_busy      
                      02528          ;call     check_busy
                      02529          ;swapf    INDF1,w
                      02530          ;andlw    0x0f
                      02531          ;call     zamien_na_hex
                      02532                          
                      02533          ;call     write_lcd
                      02534          
                      02535          ;call     check_busy
                      02536          ;movf     INDF1,w
                      02537          ;andlw    0x0f
                      02538          ;call     zamien_na_hex
                      02539          ;call     write_lcd
                      02540          ;call     check_busy
                      02541          ;movlw    _puste
                      02542          ;call     write_lcd
                      02543          
                      02544          
                      02545          
000AC8                02546 napisz_wartosc_temperatury         
000AC8 50E7           02547       movf        INDF1,w
000ACA 6F92           02548       movwf       tmp_hex
                      02549       
000ACC 06E1           02550       decf        FSR1L,f ; - FSR1L pokazuje teraz wartosc starszego bajtu liczby zamienianej
000ACE 50E7           02551       movf        INDF1,w
                      02552       
000AD0 6F93           02553       movwf       tmp_hex_H
                      02554       
000AD2 BDA1           02555       btfsc       markers3,napisz_minus
000AD4 6D92           02556       negf        tmp_hex
                      02557       
000AD6 BDA1           02558       btfsc       markers3,napisz_minus
000AD8 6D93           02559       negf        tmp_hex_H
                      02560       
000ADA 5192           02561       movf        tmp_hex,w
                      02562       ;dziele przez 4
000ADC 0D40           02563       mullw       0x40
                      02564       
000ADE 50F3           02565       movf        PRODL,w
000AE0 6F9D           02566       movwf       wynik01
                      02567       
                      02568       ;temperatura jest w bajcie starszym
000AE2 50F4           02569       movf        PRODH,w
000AE4 6F92           02570       movwf       tmp_hex
                      02571       
000AE6 EC87 F002      02572          call     hex2dec18
                      02573          
000AEA EC54 F004      02574          call     wyswietl_cyfry_temperatury
                      02575          
                      02576          ;call     check_busy
                      02577          ;movlw    _linia_pionowa
                      02578          
                      02579          ;call     write_lcd
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 68


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000AEE 9DA1           02580          bcf      markers3,napisz_minus
000AF0 0E08           02581          movlw    8
                      02582          
000AF2 2787           02583          addwf     linia2,f
                      02584          ;bcf      markers3,pokazuje_temperatury_47
                      02585         
                      02586         ENDIF         
                      02587 
000AF4                02588 bez_wyswietlania_temp2
                      02589 
000AF4 EFC3 F005      02590       goto  procedura_regulacji_dwustawnej
                      02591       
000AF8                02592 zapis_do_pamieci_prad
000AF8 6AE2           02593       clrf     FSR1H
000AFA 0EDC           02594       movlw    poprawka_prad1
                      02595          
                      02596          ;ktora poprawka
000AFC 6EE1           02597          movwf    FSR1L
000AFE 05DF           02598          decf     ktory_aktualnie_kanal_pradu,w
000B00 26E1           02599          addwf    FSR1L,f
000B02 50E7           02600          movf     INDF1,w
000B04 27A9           02601          addwf    pomiarL,f
                      02602          ;jezeli przekroczylem to
000B06 B0D8           02603          btfsc    STATUS,C
000B08 2BA8           02604          incf     pomiarH,f
                      02605         ;movwf     
                      02606 
                      02607                   
000B0A 0ECF           02608          movlw    pomiar_prad1H        
000B0C 6EE1           02609          movwf    FSR1L
                      02610                   
000B0E 05DF           02611          decf     ktory_aktualnie_kanal_pradu,w
000B10 26E1           02612          addwf    FSR1L,f
000B12 26E1           02613          addwf    FSR1L,f
                      02614                   
000B14 51A8           02615          movf     pomiarH,w         
000B16 6EE7           02616          movwf    INDF1 
                      02617         IF (czy_pomiary_na_ekran==1)  
                      02618 ;sprawdz czy mam wyswietlac 
                      02619 ;jezeli wszedlem do menu ekranu to nie wyswietlam temperatur
                      02620       
000B18 AB9F           02621       btfss      markers,czy_wyswietlam_temp
000B1A EF9B F005      02622       goto        bez_wyswietlania_pradu
                      02623 
000B1E EC61 F001      02624       call     check_busy
000B22 0ED0           02625          movlw    linia_czwarta
000B24 2589           02626          addwf    linia4,w
000B26 EC23 F001      02627          call      send
                      02628          
                      02629          
                      02630  
000B2A EC61 F001      02631          call     check_busy
                      02632          ;movf     INDF1,w
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 69


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02633          ;tu wlaczam procedurę zamiany szesnastkowej wartości na dziesiętną liczbę
                      02634          
                      02635          
                      02636          ;addlw    0x30
000B2E 0E20           02637          movlw    _puste
000B30 EC34 F001      02638          call     write_lcd
000B34 2B89           02639          incf     linia4,f
                      02640         ENDIF         
                      02641 
000B36                02642 bez_wyswietlania_pradu
                      02643 
                      02644          
000B36 2AE1           02645       incf     FSR1L,f
000B38 51A9           02646       movf     pomiarL,w
                      02647                   
000B3A 6EE7           02648       movwf    INDF1    
                      02649       
                      02650         IF (czy_pomiary_na_ekran==1)
                      02651 
000B3C AB9F           02652       btfss      markers,czy_wyswietlam_temp
000B3E EFC1 F005      02653       goto        bez_wyswietlania_pradu2
                      02654        
                      02655          ; call     check_busy
                      02656          ; swapf    INDF1,w
                      02657          ; andlw    0x0f
                      02658          ; call     zamien_na_hex
                      02659                          
                      02660          ; call     write_lcd
                      02661          
                      02662          ; call     check_busy
                      02663          ; movf     INDF1,w
                      02664          ; andlw    0x0f
                      02665          ; call     zamien_na_hex
                      02666          ; call     write_lcd
                      02667          ; call     check_busy
                      02668          ; movlw    _puste
                      02669          ; call     write_lcd
                      02670          ; incf     linia4,f
                      02671          ; incf     linia4,f
                      02672          ; incf     linia4,f
                      02673          
000B42 50E7           02674          movf     INDF1,w
000B44 6F92           02675          movwf       tmp_hex
000B46 6B93           02676       clrf        tmp_hex_H
000B48 6B98           02677       clrf        dec1
000B4A 6B97           02678       clrf        dec10
000B4C EC87 F002      02679       call        hex2dec18
                      02680        
                      02681 
000B50 EC61 F001      02682          call        check_busy
                      02683  
                      02684  ;i wyswietlic wszystkie cyfry
000B54 5196           02685       movf        dec100,w
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 70


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000B56 0F30           02686       addlw       0x30
000B58 EC34 F001      02687       call        write_lcd      
000B5C EC61 F001      02688       call        check_busy
                      02689       
000B60 5197           02690       movf        dec10,w      
000B62 0F30           02691       addlw       0x30
000B64 EC34 F001      02692       call        write_lcd      
                      02693       
000B68 EC61 F001      02694       call        check_busy
000B6C 5198           02695       movf        dec1,w
000B6E 0F30           02696       addlw       0x30
000B70 EC34 F001      02697       call        write_lcd      
                      02698       
000B74 EC61 F001      02699       call     check_busy
000B78 0E20           02700       movlw    _puste
000B7A EC34 F001      02701       call     write_lcd
                      02702          
000B7E 0E04           02703       movlw       4
000B80 2789           02704          addwf    linia4,f
                      02705         
                      02706         
                      02707         ENDIF       
                      02708 
000B82                02709 bez_wyswietlania_pradu2
                      02710       
000B82 EFA0 F006      02711       goto     spr_czy_mam_dalej_mierz_prad
                      02712       
                      02713       
                      02714       
                      02715       
                      02716       
                      02717       
                      02718       
                      02719       
                      02720       ; tu jest   procedura regulacji kanalu 1
                      02721       
000B86                02722 procedura_regulacji_dwustawnej         
                      02723       
                      02724 ;jezeli ostatni kanal to wyslij wszystkie, jezeli nie ostatni to zmierz kolejny
                      02725         
000B86 51B7           02726         movf    czy_reguluje1,w
000B88 B4D8           02727         btfsc   STATUS,Z
000B8A EF2D F006      02728         goto    procedura_regulacji_dwu_2
                      02729         
                      02730         
                      02731          
                      02732  ;jezeli to nie aktualny czujnik to dalej nie sprawdzaj 
                      02733  
000B8E 51B9           02734          movf    ktory_czujnik_reguluje1,w
000B90 63BC           02735          cpfseq   ktory_kanal
000B92 EF2D F006      02736          goto           procedura_regulacji_dwu_2
                      02737 
                      02738         
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 71


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02739         ;jezeli jest 1 
000B96 51B7           02740          movf     czy_reguluje1,w
000B98 0A01           02741          xorlw    1
000B9A B4D8           02742          btfsc    STATUS,Z
000B9C EFD5 F005      02743          goto     procedura_regulacji_dwu_grzanie1
                      02744          
                      02745          
                      02746          ;jezeli jest 1 
000BA0 51B7           02747          movf     czy_reguluje1,w
000BA2 0A02           02748          xorlw    2
000BA4 B4D8           02749          btfsc    STATUS,Z
000BA6 EF01 F006      02750          goto     procedura_regulacji_dwu_cool1
                      02751          
                      02752          
                      02753          
                      02754          
                      02755          
000BAA                02756 procedura_regulacji_dwu_grzanie1
                      02757      
                      02758 ;porownaj wartosc pomierzona z zadana
                      02759                   
                      02760          
                      02761                   ;tu musze poprawic prace regulatora
                      02762          
                      02763          ;chodzi o to zeby wlaczal moc kiedy temperatura spadnie ponizej temperatury zadanej - histereza
                      02764          
                      02765          
                      02766          ;tzn jezeli moc jest wylaczona
                      02767          
                      02768          ;to wlacz dopiero kiedy temperatura osiagnie wartosc t min
                      02769          
                      02770          
                      02771          ; czy moc jest teraz wlaczona?
                      02772          
                      02773          ;btfsc    
                      02774 
                      02775          
                      02776          
000BAA 51AF           02777          movf     jaka_wartosc_regulujeH1,w
                      02778          ;pomiarh - jaka_wartosc_regulujeH
000BAC 5DA8           02779          subwf    pomiarH,w
                      02780 ;sprawdz czy to samo czy wieksze
000BAE B4D8           02781          btfsc    STATUS,Z
000BB0 EFE4 F005      02782          goto     sa_rowne_sprawdz_Lbajt
000BB4 A0D8           02783          btfss    STATUS,C 
000BB6 EFE0 F005      02784          goto     zalacz_grzanie
                      02785 ;tzn reguluj<pomiaru w starszym bajcie wiec wylacz grzanie
000BBA 85A2           02786          bsf      markers_regulacja,wylacz_moc1
000BBC EF2D F006      02787          goto     procedura_regulacji_dwu_2
                      02788          
000BC0                02789 zalacz_grzanie    
                      02790 ;jezeli jakikolwiek pomiar wykazal ze trzeba wylaczyc to nie wlaczaj grzania
                      02791 ;        
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 72


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000BC0 A5A2           02792          btfss    markers_regulacja,wylacz_moc1
000BC2 81A2           02793          bsf      markers_regulacja,zalacz_moc1
                      02794          
000BC4 EF2D F006      02795          goto     procedura_regulacji_dwu_2
                      02796 
                      02797                            
000BC8                02798 sa_rowne_sprawdz_Lbajt
                      02799 ;tak samo
                      02800          ;movf     histereza,w
                      02801          ;sprawdz czy moc wylaczona - jezeli tak to wlacz 1  stopien nizej czyli 4 nizej
                      02802 ;jezeli jest wlaczona energia to dodaj wartosc histerezy tj wylacza pozniej
                      02803          ;btfsc    latch_moc,lampka2
000BC8 B081           02804          btfsc    port_triak,triak1
000BCA EFF3 F005      02805          goto     regulacja_dwu_moc_ON
                      02806          
                      02807          
000BCE                02808 regulacja_dwu_moc_OFF         
                      02809          ;jeżeli moc jest wyłączona w tej chwili to włącz ją dopiero gdy 
                      02810          ;pomiar będzie mniejszy niż temperatura zadana 
                      02811          
                      02812          ;histereza dolna
000BCE 51B4           02813          movf     histereza_R1_2,w
000BD0 5DB0           02814          subwf     jaka_wartosc_regulujeL1,w
                      02815              
                      02816          
000BD2 5DA9           02817          subwf    pomiarL,w
                      02818 ;sprawdz czy to samo czy wieksze
000BD4 B4D8           02819          btfsc    STATUS,Z
000BD6 EFE0 F005      02820          goto     zalacz_grzanie
                      02821          
                      02822          
                      02823 ; jeżeli po odjęciu nie ma C w Statusie, tzn że pomiarL < pomiaru-histerezy
                      02824          
000BDA A0D8           02825          btfss    STATUS,C 
000BDC EFE0 F005      02826          goto     zalacz_grzanie
                      02827 ;tzn reguluj>pomiaru w mlodszym bajcie wiec wlacz grzanie
000BE0 85A2           02828          bsf      markers_regulacja,wylacz_moc1
000BE2 EF2D F006      02829          goto     procedura_regulacji_dwu_2
                      02830          
                      02831          
000BE6                02832 regulacja_dwu_moc_ON
                      02833          ;jeżeli moc jest włączona w tej chwili to wyłącz ją dopiero gdy 
                      02834          ;pomiar będzie większy niż temperatura zadana + histereza zadana
                      02835          
                      02836          ;histereza górna
000BE6 51B3           02837          movf     histereza_R1_1,w
000BE8 25B0           02838          addwf    jaka_wartosc_regulujeL1,w
                      02839          
                      02840          ; w WREG jest wartosc  histereza + ustawienie wartosci regulacji
                      02841          
                      02842        
000BEA 5DA9           02843          subwf    pomiarL,w  
                      02844          ;w WREG  jest wartosc   pomiarL  -  (histereza + ustawienie wartosci )
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 73


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02845 ;sprawdz czy to samo czy wieksze
000BEC B4D8           02846          btfsc    STATUS,Z
000BEE EFFC F005      02847          goto     regulacja_dwu_moc_ON_wylacz
                      02848 
                      02849          
                      02850          
                      02851          ;C pojawia sie tylko gdy pomiarL > (histereza + ustawienie wartosci )
                      02852          
000BF2 A0D8           02853          btfss    STATUS,C 
000BF4 EFE0 F005      02854          goto     zalacz_grzanie
                      02855 ;tzn reguluj<pomiaru w mlodszym bajcie wiec wylacz grzanie
                      02856 
000BF8                02857 regulacja_dwu_moc_ON_wylacz
000BF8 85A2           02858          bsf      markers_regulacja,wylacz_moc1
000BFA EF2D F006      02859          goto     procedura_regulacji_dwu_2                         
                      02860          
000BFE                02861 sa_rowne_nic_nie_rob
000BFE EFE0 F005      02862          goto     zalacz_grzanie    
                      02863          ;goto     procedura_regulacji_dwu_2       
                      02864 
                      02865          
                      02866          
                      02867          
                      02868          
                      02869          
                      02870          
                      02871          
000C02                02872 procedura_regulacji_dwu_cool1         
                      02873 ;tutaj zakladam ze dzialanie regulacji jest na chlodzenie
                      02874 
                      02875 ;tzn jesli temperatura jest powyzej wartosci zadanej to uruchom 
                      02876 ;wentylator         
                      02877          
000C02 51AF           02878          movf     jaka_wartosc_regulujeH1,w
                      02879          ;pomiarh - jaka_wartosc_regulujeH
000C04 5DA8           02880          subwf    pomiarH,w
                      02881 ;sprawdz czy to samo czy wieksze
000C06 B4D8           02882          btfsc    STATUS,Z
000C08 EF10 F006      02883          goto     sa_rowne_sprawdz_Lbajt_cool
                      02884          
                      02885          ;jesli jest wylaczony C
                      02886          ;tzn ze 
                      02887          ;pomiarH  - jaka_wartosc_regulujeH1  
                      02888          ;jesli C jest ustawione
                      02889          ;to pomiarH> jaka_wartosc_regulujeH1
000C0C B0D8           02890          btfsc    STATUS,C 
000C0E EF0C F006      02891          goto     zalacz_chlodzenie1
                      02892 ;tzn reguluj<pomiaru w starszym bajcie wiec wylacz grzanie
000C12 85A2           02893          bsf      markers_regulacja,wylacz_moc1
000C14 EF2D F006      02894          goto     procedura_regulacji_dwu_2
                      02895          
000C18                02896 zalacz_chlodzenie1
                      02897 ;jezeli jakikolwiek pomiar wykazal ze trzeba wylaczyc to nie wlaczaj grzania
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 74


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02898 ;        
000C18 A5A2           02899          btfss    markers_regulacja,wylacz_moc1
000C1A 81A2           02900          bsf      markers_regulacja,zalacz_moc1
                      02901          
000C1C EF2D F006      02902          goto     procedura_regulacji_dwu_2
                      02903 
                      02904                            
000C20                02905 sa_rowne_sprawdz_Lbajt_cool
                      02906 ;tak samo
                      02907          ;movf     histereza,w
                      02908          ;sprawdz czy moc wylaczona - jezeli tak to wlacz 1  stopien nizej czyli 4 nizej
                      02909 ;jezeli jest wlaczona energia to dodaj wartosc histerezy tj wylacza pozniej
                      02910          ;btfsc    latch_moc,lampka2
000C20 B081           02911          btfsc    port_triak,triak1
000C22 EF1F F006      02912          goto     regulacja_dwu_moc_cool_ON
                      02913          
                      02914          
000C26                02915 regulacja_dwu_moc_cool_OFF         
                      02916          ;jeżeli moc jest wyłączona w tej chwili to włącz ją dopiero gdy 
                      02917          ;pomiar będzie wiekszy niż temperatura zadana 
                      02918          
                      02919          ;histereza dolna
                      02920          ;jezeli ustawilem chlodzenie po 
                      02921          ;temp 40
                      02922          ;histereza 0,5 st
                      02923          ;to wlacz dopiero jesli temp wzrosnie powyzej 40,5
000C26 51B3           02924          movf     histereza_R1_1,w
000C28 25B0           02925          addwf     jaka_wartosc_regulujeL1,w
                      02926              
                      02927          
000C2A 5DA9           02928          subwf    pomiarL,w
                      02929 ;sprawdz czy to samo czy wieksze
000C2C B4D8           02930          btfsc    STATUS,Z
000C2E EF0C F006      02931          goto     zalacz_chlodzenie1
                      02932          
                      02933          ;pomiarL - jaka_wartosc_regulujeL1
                      02934 ; jeżeli po odjęciu jest C w Statusie, tzn że pomiarL > pomiaru+histerezy
                      02935          
000C32 B0D8           02936          btfsc    STATUS,C 
000C34 EF0C F006      02937          goto     zalacz_chlodzenie1
                      02938 ;tzn reguluj>pomiaru w mlodszym bajcie wiec wlacz grzanie
000C38 85A2           02939          bsf      markers_regulacja,wylacz_moc1
000C3A EF2D F006      02940          goto     procedura_regulacji_dwu_2
                      02941          
                      02942          
000C3E                02943 regulacja_dwu_moc_cool_ON
                      02944          ;jeżeli moc jest włączona w tej chwili to wyłącz ją dopiero gdy 
                      02945          ;pomiar będzie mniejszy niż temperatura zadana - histereza zadana
                      02946          
                      02947          ;histereza dolna
                      02948          ;
000C3E 51B4           02949          movf     histereza_R1_2,w
000C40 5DB0           02950          subwf    jaka_wartosc_regulujeL1,w
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 75


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02951          
                      02952          ; w WREG jest wartosc  histereza - ustawienie wartosci regulacji
                      02953          ;np 40 ustawiona
                      02954          ;40 - 0,5 (histereza)
                      02955        
000C42 5DA9           02956          subwf    pomiarL,w  
                      02957          ;w WREG  jest wartosc   pomiarL  -  ( ustawienie wartosci -histereza )
                      02958 ;sprawdz czy to samo czy wieksze, jesli jest wieksze to C ustawione
000C44 B4D8           02959          btfsc    STATUS,Z
000C46 EF28 F006      02960          goto     regulacja_dwu_moc_ON_wylacz_cool
                      02961 
                      02962          ;jesli pomiarL < ust_warto   ->  C nie ustawione
                      02963          
000C4A B0D8           02964          btfsc    STATUS,C 
000C4C EF0C F006      02965          goto     zalacz_chlodzenie1
                      02966 ;tzn reguluj<pomiaru w mlodszym bajcie wiec wylacz grzanie
                      02967 
000C50                02968 regulacja_dwu_moc_ON_wylacz_cool
000C50 85A2           02969          bsf      markers_regulacja,wylacz_moc1
000C52 EF2D F006      02970          goto     procedura_regulacji_dwu_2                         
                      02971          
                      02972 
000C56 EF0C F006      02973          goto     zalacz_chlodzenie1   
                      02974          ;goto     procedura_regulacji_dwu_2       
                      02975 
                      02976          
                      02977          
                      02978          
                      02979          
                      02980          
                      02981          
                      02982          
                      02983          
                      02984          
                      02985          
                      02986          
                      02987          
000C5A                02988 procedura_regulacji_dwu_2         
                      02989       
                      02990 ;jezeli ostatni kanal to wyslij wszystkie, jezeli nie ostatni to zmierz kolejny
                      02991         
000C5A 51B8           02992         movf    czy_reguluje2,w
000C5C B4D8           02993         btfsc   STATUS,Z
000C5E EF97 F006      02994         goto    sprawdz_czy_mam_dalej_mierzyc
                      02995          
000C62 51BA           02996          movf      ktory_czujnik_reguluje2,w
000C64 63BC           02997          cpfseq    ktory_kanal
000C66 EF97 F006      02998          goto      sprawdz_czy_mam_dalej_mierzyc
                      02999          
                      03000          
                      03001         ;jezeli jest 1 
000C6A 51B8           03002          movf     czy_reguluje2,w
000C6C 0A01           03003          xorlw    1
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 76


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000C6E B4D8           03004          btfsc    STATUS,Z
000C70 EF3F F006      03005          goto     procedura_regulacji_dwu_grzanie2
                      03006          
                      03007          
                      03008          ;jezeli jest 1 
000C74 51B8           03009          movf     czy_reguluje2,w
000C76 0A02           03010          xorlw    2
000C78 B4D8           03011          btfsc    STATUS,Z
000C7A EF6B F006      03012          goto     procedura_regulacji_dwu_cool2
                      03013          
                      03014           
                      03015          
                      03016          
                      03017          
                      03018          
                      03019          
                      03020          
000C7E                03021 procedura_regulacji_dwu_grzanie2         
                      03022          
                      03023          
                      03024          
000C7E 51B1           03025          movf     jaka_wartosc_regulujeH2,w
                      03026          ;pomiarh - jaka_wartosc_regulujeH
000C80 5DA8           03027          subwf    pomiarH,w
                      03028 ;sprawdz czy to samo czy wieksze
000C82 B4D8           03029          btfsc    STATUS,Z
000C84 EF4E F006      03030          goto     sa_rowne_sprawdz_Lbajt2
000C88 A0D8           03031          btfss    STATUS,C 
000C8A EF4A F006      03032          goto     zalacz_grzanie2
                      03033 ;tzn reguluj<pomiaru w starszym bajcie wiec wylacz grzanie
000C8E 8BA2           03034          bsf      markers_regulacja,wylacz_moc2
000C90 EF97 F006      03035          goto     sprawdz_czy_mam_dalej_mierzyc
                      03036          
000C94                03037 zalacz_grzanie2    
                      03038 ;jezeli jakikolwiek pomiar wykazal ze trzeba wylaczyc to nie wlaczaj grzania
                      03039 ;        
000C94 ABA2           03040          btfss    markers_regulacja,wylacz_moc2
000C96 89A2           03041          bsf      markers_regulacja,zalacz_moc2
                      03042          
000C98 EF97 F006      03043          goto     sprawdz_czy_mam_dalej_mierzyc
                      03044 
                      03045                            
000C9C                03046 sa_rowne_sprawdz_Lbajt2
                      03047 
000C9C B281           03048          btfsc    port_triak,triak2
000C9E EF5D F006      03049          goto     regulacja_dwu_moc_ON2
                      03050          
                      03051          
000CA2                03052 regulacja_dwu_moc_OFF2         
                      03053          ;jeżeli moc jest wyłączona w tej chwili to włącz ją dopiero gdy 
                      03054          ;pomiar będzie mniejszy niż temperatura zadana 
                      03055          
                      03056          ;histereza dolna
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 77


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000CA2 51B6           03057          movf     histereza_R2_2,w
000CA4 5DB2           03058          subwf     jaka_wartosc_regulujeL2,w
                      03059              
                      03060          
000CA6 5DA9           03061          subwf    pomiarL,w
                      03062 ;sprawdz czy to samo czy wieksze
000CA8 B4D8           03063          btfsc    STATUS,Z
000CAA EF4A F006      03064          goto     zalacz_grzanie2
                      03065          
                      03066          
                      03067 ; jeżeli po odjęciu nie ma C w Statusie, tzn że pomiarL < pomiaru-histerezy
                      03068          
000CAE A0D8           03069          btfss    STATUS,C 
000CB0 EF4A F006      03070          goto     zalacz_grzanie2
                      03071 ;tzn reguluj>pomiaru w mlodszym bajcie wiec wlacz grzanie
000CB4 8BA2           03072          bsf      markers_regulacja,wylacz_moc2
000CB6 EF97 F006      03073          goto     sprawdz_czy_mam_dalej_mierzyc
                      03074          
                      03075          
000CBA                03076 regulacja_dwu_moc_ON2
                      03077          ;jeżeli moc jest włączona w tej chwili to wyłącz ją dopiero gdy 
                      03078          ;pomiar będzie większy niż temperatura zadana + histereza zadana
                      03079          
                      03080          ;histereza górna
000CBA 51B5           03081          movf     histereza_R2_1,w
000CBC 25B2           03082          addwf    jaka_wartosc_regulujeL2,w
                      03083          
                      03084          ; w WREG jest wartosc  histereza + ustawienie wartosci regulacji
                      03085          
                      03086        
000CBE 5DA9           03087          subwf    pomiarL,w  
                      03088          ;w WREG  jest wartosc   pomiarL  -  (histereza + ustawienie wartosci )
                      03089 ;sprawdz czy to samo czy wieksze
000CC0 B4D8           03090          btfsc    STATUS,Z
000CC2 EF66 F006      03091          goto     regulacja_dwu_moc_ON_wylacz2
                      03092 
                      03093          
                      03094          
                      03095          ;C pojawia sie tylko gdy 
                      03096          
000CC6 A0D8           03097          btfss    STATUS,C 
000CC8 EF4A F006      03098          goto     zalacz_grzanie2
                      03099 ;tzn reguluj<pomiaru w mlodszym bajcie wiec wylacz grzanie
                      03100 
000CCC                03101 regulacja_dwu_moc_ON_wylacz2
000CCC 8BA2           03102          bsf      markers_regulacja,wylacz_moc2
000CCE EF97 F006      03103          goto     sprawdz_czy_mam_dalej_mierzyc                         
000CD2                03104 sa_rowne_nic_nie_rob2
000CD2 EF4A F006      03105          goto     zalacz_grzanie2    
                      03106          
                      03107          
                      03108          ;goto     sprawdz_czy_mam_dalej_mierzyc       
                      03109 
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 78


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03110          
                      03111 
                      03112 
                      03113 
                      03114 
                      03115          
000CD6                03116 procedura_regulacji_dwu_cool2
                      03117 ;tutaj zakladam ze dzialanie regulacji jest na chlodzenie
                      03118 
                      03119 ;tzn jesli temperatura jest powyzej wartosci zadanej to uruchom 
                      03120 ;wentylator         
                      03121          
000CD6 51B1           03122          movf     jaka_wartosc_regulujeH2,w
                      03123          ;pomiarh - jaka_wartosc_regulujeH
000CD8 5DA8           03124          subwf    pomiarH,w
                      03125 ;sprawdz czy to samo czy wieksze
000CDA B4D8           03126          btfsc    STATUS,Z
000CDC EF7A F006      03127          goto     sa_rowne_sprawdz_Lbajt_cool2
                      03128          
                      03129          ;jesli jest wylaczony C
                      03130          ;tzn ze 
                      03131          ;pomiarH  - jaka_wartosc_regulujeH1  
                      03132          ;jesli C jest ustawione
                      03133          ;to pomiarH> jaka_wartosc_regulujeH1
000CE0 B0D8           03134          btfsc    STATUS,C 
000CE2 EF76 F006      03135          goto     zalacz_chlodzenie2
                      03136 ;tzn reguluj<pomiaru w starszym bajcie wiec wylacz grzanie
000CE6 8BA2           03137          bsf      markers_regulacja,wylacz_moc2
000CE8 EF97 F006      03138          goto     sprawdz_czy_mam_dalej_mierzyc
                      03139          
000CEC                03140 zalacz_chlodzenie2
                      03141 ;jezeli jakikolwiek pomiar wykazal ze trzeba wylaczyc to nie wlaczaj grzania
                      03142 ;        
000CEC ABA2           03143          btfss    markers_regulacja,wylacz_moc2
000CEE 89A2           03144          bsf      markers_regulacja,zalacz_moc2
                      03145          
000CF0 EF97 F006      03146          goto     sprawdz_czy_mam_dalej_mierzyc
                      03147 
                      03148                            
000CF4                03149 sa_rowne_sprawdz_Lbajt_cool2
                      03150 ;tak samo
                      03151          ;movf     histereza,w
                      03152          ;sprawdz czy moc wylaczona - jezeli tak to wlacz 1  stopien nizej czyli 4 nizej
                      03153 ;jezeli jest wlaczona energia to dodaj wartosc histerezy tj wylacza pozniej
                      03154          ;btfsc    latch_moc,lampka2
000CF4 B281           03155          btfsc    port_triak,triak2
000CF6 EF89 F006      03156          goto     regulacja_dwu_moc_cool_ON2
                      03157          
                      03158          
000CFA                03159 regulacja_dwu_moc_cool_OFF2        
                      03160          ;jeżeli moc jest wyłączona w tej chwili to włącz ją dopiero gdy 
                      03161          ;pomiar będzie wiekszy niż temperatura zadana 
                      03162          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 79


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03163          ;histereza dolna
                      03164          ;jezeli ustawilem chlodzenie po 
                      03165          ;temp 40
                      03166          ;histereza 0,5 st
                      03167          ;to wlacz dopiero jesli temp wzrosnie powyzej 40,5
000CFA 51B5           03168          movf     histereza_R2_1,w
000CFC 25B2           03169          addwf     jaka_wartosc_regulujeL2,w
                      03170              
                      03171          
000CFE 5DA9           03172          subwf    pomiarL,w
                      03173 ;sprawdz czy to samo czy wieksze
000D00 B4D8           03174          btfsc    STATUS,Z
000D02 EF76 F006      03175          goto     zalacz_chlodzenie2
                      03176          
                      03177          ;pomiarL - jaka_wartosc_regulujeL1
                      03178 ; jeżeli po odjęciu jest C w Statusie, tzn że pomiarL > pomiaru+histerezy
                      03179          
000D06 B0D8           03180          btfsc    STATUS,C 
000D08 EF76 F006      03181          goto     zalacz_chlodzenie2
                      03182 ;tzn reguluj>pomiaru w mlodszym bajcie wiec wlacz grzanie
000D0C 8BA2           03183          bsf      markers_regulacja,wylacz_moc2
000D0E EF97 F006      03184          goto     sprawdz_czy_mam_dalej_mierzyc
                      03185          
                      03186          
000D12                03187 regulacja_dwu_moc_cool_ON2
                      03188          ;jeżeli moc jest włączona w tej chwili to wyłącz ją dopiero gdy 
                      03189          ;pomiar będzie mniejszy niż temperatura zadana - histereza zadana
                      03190          
                      03191          ;histereza dolna
                      03192          ;
000D12 51B6           03193          movf     histereza_R2_2,w
000D14 5DB2           03194          subwf    jaka_wartosc_regulujeL2,w
                      03195          
                      03196          ; w WREG jest wartosc  histereza - ustawienie wartosci regulacji
                      03197          ;np 40 ustawiona
                      03198          ;40 - 0,5 (histereza)
                      03199        
000D16 5DA9           03200          subwf    pomiarL,w  
                      03201          ;w WREG  jest wartosc   pomiarL  -  ( ustawienie wartosci -histereza )
                      03202 ;sprawdz czy to samo czy wieksze, jesli jest wieksze to C ustawione
000D18 B4D8           03203          btfsc    STATUS,Z
000D1A EF92 F006      03204          goto     regulacja_dwu_moc_ON_wyl_cool2
                      03205 
                      03206          ;jesli pomiarL < ust_warto   ->  C nie ustawione
                      03207          
000D1E B0D8           03208          btfsc    STATUS,C 
000D20 EF76 F006      03209          goto     zalacz_chlodzenie2
                      03210 ;tzn reguluj<pomiaru w mlodszym bajcie wiec wylacz grzanie
                      03211 
000D24                03212 regulacja_dwu_moc_ON_wyl_cool2
000D24 85A2           03213          bsf      markers_regulacja,wylacz_moc1
000D26 EF97 F006      03214          goto     sprawdz_czy_mam_dalej_mierzyc                         
                      03215          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 80


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03216 
000D2A EF76 F006      03217          goto     zalacz_chlodzenie2
                      03218          ;goto     procedura_regulacji_dwu_2       
                      03219 
                      03220 
                      03221 
                      03222 
                      03223 
                      03224 
                      03225 
                      03226 
                      03227          
                      03228          
                      03229          
                      03230          
                      03231          
000D2E                03232 sprawdz_czy_mam_dalej_mierzyc
                      03233 ;sprawdzam tu czy mam wykonac pomiary dla kolejnego 
                      03234 ;kanalu
                      03235 ;tu czyszcze zawartosc rejestrow pomiaru
000D2E 6BA8           03236          clrf     pomiarH
000D30 6BA9           03237          clrf     pomiarL
000D32 6BAA           03238          clrf     pomiar_ulamek
                      03239          
                      03240          
000D34 2FAB           03241          decfsz   ktory_kanal_mierze,f
000D36 EF18 F007      03242          goto     zmierz_nast_czujnik_temperatury
                      03243 
                      03244 ;zmierz jeszcze prady          
                      03245          
000D3A A1A1           03246          btfss    markers3,pomiary_pradu
000D3C EFAA F006      03247          goto     wykonano_pom_wszystkich_kanalow
                      03248         
                      03249         ;jeszcze mierze prady jezeli ustawiono bit pomiary_pradu
                      03250          
000D40                03251 spr_czy_mam_dalej_mierz_prad
                      03252 
                      03253          ;sprawdz czy rejestr przechowujący aktualne wskazanie mierzonej temperatury nie wskazuje 0
000D40 51DF           03254          movf     ktory_aktualnie_kanal_pradu,w;zwiększam o jeden żeby skala obydwu rejestrów była i
                            dentyczna
                      03255          
000D42 19DE           03256          xorwf    jak_duzo_kanalow_pradu,w
                      03257          ;jezeli 0 tzn ze juz zmierzylem co trzeba
000D44 B4D8           03258          btfsc    STATUS,Z
000D46 EFAA F006      03259          goto     wykonano_pom_wszystkich_kanalow
                      03260          
                      03261       ;wlaczam pomiar pradu na 1 kanale
                      03262       
                      03263       ;do kanalu aktualnego trzeba dodać 8*2 by uzyskac kanal pradowy
                      03264       ;bo aby zmierzyc 1 kanal pradu to z AN0 przeskok do AN2
                      03265       ;z kanalu AN2 do AN4
                      03266       
000D4A 0E08           03267       movlw    8
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 81


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03268             
000D4C 26C2           03269       addwf   ADCON0,f
000D4E 2BDF           03270       incf     ktory_aktualnie_kanal_pradu,f
                      03271       ;movlw    b'00111100'
                      03272       ;andwf    ADCON0,w
000D50 EF13 F007      03273       goto  zmierz_prad
                      03274       
                      03275       ;goto     zmierz_nastepny_czujnik_temperatury   
                      03276          
                      03277 ; wykonano_pomiary_wszystkich_kanalow
000D54                03278 wykonano_pom_wszystkich_kanalow
                      03279 ;jezeli juz skonczylem wszystkie mierzyc to sprawdz czy mam wlaczyc grzanie
                      03280 ;jezeli ustawiono bit o nie wlaczaniu to olej
                      03281          
000D54 51B7           03282          movf    czy_reguluje1,w         
000D56 E00D           03283          bz     powlaczaj_moc_reg2
                      03284          
000D58 B5A2           03285          btfsc    markers_regulacja,wylacz_moc1
000D5A EFB6 F006      03286          goto    wylaczam_moc
                      03287          
000D5E A1A2           03288          btfss    markers_regulacja,zalacz_moc1
000D60 EFB6 F006      03289          goto    wylaczam_moc
                      03290          
000D64 A081           03291          btfss    port_triak,triak1
000D66 8081           03292          bsf      port_triak,triak1
                      03293          
000D68 EFB7 F006      03294          goto    koncz_z_moca
000D6C                03295 wylaczam_moc
000D6C 9081           03296          bcf      port_triak,triak1
                      03297          
                      03298          
                      03299          
                      03300          
000D6E                03301 koncz_z_moca
000D6E 91A2           03302          bcf      markers_regulacja,zalacz_moc1
000D70 95A2           03303          bcf      markers_regulacja,wylacz_moc1
                      03304          
                      03305          
                      03306          
                      03307          
                      03308          
                      03309          
                      03310          
                      03311          
000D72                03312 powlaczaj_moc_reg2         
000D72 51B8           03313          movf    czy_reguluje2,w         
                      03314          
000D74 E00D           03315          bz     koniec_mierzenia
                      03316          
000D76 BBA2           03317          btfsc    markers_regulacja,wylacz_moc2
000D78 EFC5 F006      03318          goto    wylaczam_moc2
                      03319          
000D7C A9A2           03320          btfss    markers_regulacja,zalacz_moc2
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 82


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000D7E EFC5 F006      03321          goto    wylaczam_moc2
                      03322          
000D82 A281           03323          btfss    port_triak,triak2
000D84 8281           03324          bsf      port_triak,triak2
                      03325          
000D86 EFC6 F006      03326          goto    koncz_z_moca2
                      03327          
000D8A                03328 wylaczam_moc2
000D8A 9281           03329          bcf      port_triak,triak2
                      03330          
000D8C                03331 koncz_z_moca2
000D8C 99A2           03332          bcf      markers_regulacja,zalacz_moc2
000D8E 9BA2           03333          bcf      markers_regulacja,wylacz_moc2
                      03334 
                      03335 
                      03336 
                      03337          
                      03338                           ;juz wszystkie kanaly i wysylaj pomiary
000D90                03339 koniec_mierzenia
                      03340 
                      03341  
                      03342 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                            ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;koniec wysylania pomiarow 
                      03343 
                      03344 
                      03345 
                      03346 
                      03347          ;jezeli mierzylem prady to sprawdz to, maxymalnie dwa prady podaje
000D90 A1A1           03348          btfss    markers3,pomiary_pradu
000D92 EF03 F007      03349          goto     juz_wysylac_znak_LF
                      03350          
000D96                03351 sprawdz_RTS_prad
                      03352          ;btfss    port_RTS,znacznik_RTS
                      03353          ;goto     sprawdz_RTS_prad
                      03354       
                      03355       ;jak duzo mialem mierzyc pradow
000D96 EC1D F003      03356          call    sprawdz_czy_mozna_wysylac
000D9A 0E69           03357          movlw    _i
                      03358         
000D9C 6EAD           03359          movwf   TXREG    
000D9E EC1D F003      03360          call    sprawdz_czy_mozna_wysylac
                      03361          
                      03362          
                      03363          
000DA2 51CF           03364          movf     pomiar_prad1H,w
000DA4 0F30           03365          addlw    0x30
000DA6 6EAD           03366          movwf   TXREG        
                      03367          
000DA8 EC1D F003      03368          call    sprawdz_czy_mozna_wysylac
                      03369          
000DAC 39D0           03370          swapf     pomiar_prad1L,w
000DAE 0B0F           03371          andlw    0x0f
000DB0 EC6E F003      03372          call     zamien_na_hex
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 83


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000DB4 6EAD           03373          movwf   TXREG
                      03374                   
000DB6 EC1D F003      03375          call    sprawdz_czy_mozna_wysylac
                      03376          
000DBA 51D0           03377          movf    pomiar_prad1L,w
000DBC 0B0F           03378          andlw    0x0f
000DBE EC6E F003      03379          call     zamien_na_hex
000DC2 6EAD           03380          movwf   TXREG   
                      03381          
000DC4 EC1D F003      03382          call    sprawdz_czy_mozna_wysylac
                      03383          
                      03384          ;czy mialem mierzyc dwa prady czy tylko 1
                      03385          ;movf     jak_duzo_kanalow_pradu,w
                      03386          ;xorlw    2
                      03387          ;btfss    STATUS,Z   
                      03388          ;goto     juz_wysylac_znak_LF 
                      03389 
                      03390          
                      03391          
000DC8 0E2C           03392          movlw    _przecinek
                      03393         
000DCA 6EAD           03394          movwf   TXREG    
000DCC EC1D F003      03395          call    sprawdz_czy_mozna_wysylac
                      03396          
000DD0 0E69           03397          movlw    _i
                      03398         
000DD2 6EAD           03399          movwf   TXREG    
000DD4 EC1D F003      03400          call    sprawdz_czy_mozna_wysylac
                      03401          
000DD8 51D1           03402          movf     pomiar_prad2H,w
000DDA 0F30           03403          addlw    0x30
000DDC 6EAD           03404          movwf   TXREG        
                      03405          
000DDE EC1D F003      03406          call    sprawdz_czy_mozna_wysylac
                      03407          
000DE2 39D2           03408          swapf     pomiar_prad2L,w
000DE4 0B0F           03409          andlw    0x0f
000DE6 EC6E F003      03410          call     zamien_na_hex
000DEA 6EAD           03411          movwf   TXREG
                      03412                   
000DEC EC1D F003      03413          call    sprawdz_czy_mozna_wysylac
                      03414          
000DF0 51D2           03415          movf    pomiar_prad2L,w
000DF2 0B0F           03416          andlw    0x0f
000DF4 EC6E F003      03417          call     zamien_na_hex
000DF8 6EAD           03418          movwf   TXREG     
000DFA EC1D F003      03419          call    sprawdz_czy_mozna_wysylac
                      03420          
000DFE 0E2C           03421           movlw    _przecinek
                      03422         
000E00 6EAD           03423          movwf   TXREG    
000E02 EC1D F003      03424          call    sprawdz_czy_mozna_wysylac
                      03425          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 84


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03426 ;jezeli moc zalaczona wyslij 1,
                      03427 ;jezeli wylaczona wyslik 0,
                      03428          
                      03429          ;call    sprawdz_czy_mozna_wysylac
                      03430          
                      03431          ;btfsc    portlampka2,lampka2
                      03432          ;movlw    0x31
                      03433          
                      03434          ;btfss    portlampka2,lampka2
                      03435          ;movlw    0x30
                      03436          
000E06                03437 juz_wysylac_znak_LF         
                      03438          ;movwf   TXREG
                      03439          ;wysylam znak konca linii
000E06 EC1D F003      03440          call    sprawdz_czy_mozna_wysylac
000E0A 0E0A           03441          movlw    znak_lf
000E0C 6EAD           03442          movwf   TXREG
                      03443          
000E0E 88AB           03444          bsf      RCSTA,CREN 
000E10 0000           03445          nop
000E12 0000           03446          nop
                      03447          
000E14 8882           03448          bsf      port_CTS,znacznik_CTS
                      03449          
                      03450          
000E16                03451 koniec_pomiarow
                      03452 
000E16 6BA8           03453          clrf     pomiarH
000E18 6BA9           03454          clrf     pomiarL
000E1A 6BAA           03455          clrf     pomiar_ulamek
                      03456 
000E1C 859F           03457          bsf      markers,pomiary_zrobione
000E1E 99A0           03458          bcf      markers2,wyslij_pomiar
000E20 93A1           03459          bcf   markers3,znacznik_pomiaru_pradu
000E22 6B89           03460          clrf     linia4
000E24 0012           03461          return         
                      03462  
                      03463 
000E26                03464 zmierz_prad
000E26 51AE           03465       movf     jak_duzo_probek,w
000E28 6FBB           03466       movwf    ktora_probka
000E2A 83A1           03467       bsf   markers3,znacznik_pomiaru_pradu
000E2C EF2A F007      03468       goto     zmierz_nastepny_nie_3
                      03469       
                      03470 ; zmierz_nastepny_czujnik_temperatury
000E30                03471 zmierz_nast_czujnik_temperatury
                      03472 ;tzn kanal analogowy ten sam, ale zmienia sie ustawienie multipleksera
000E30 2BBC           03473       incf     ktory_kanal,f
000E32 51AE           03474       movf     jak_duzo_probek,w
000E34 6FBB           03475       movwf    ktora_probka
                      03476       ;movf     port_multiplekser,w
                      03477 ;czyszcze aktualne ustawienia 
                      03478 ;jezeli byl tu b'01010001'     
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 85


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03479       ;andlw    b'11111000'
                      03480 ;w wyniku mamy b'01010000'      
                      03481       ;addwf    ktory_kanal,w
000E36 2A8B           03482       incf  latch_multiplekser,f
                      03483       ;movwf    latch_multiplekser   
000E38 EF2A F007      03484       goto     zmierz_nastepny_nie_3
                      03485       
000E3C                03486 zmierz_nastepny_kanal
                      03487 ;zwiekaszam na kolejne wejscie  multipleksera
                      03488             
000E3C 2BBC           03489          incf     ktory_kanal,f
000E3E 51AE           03490          movf     jak_duzo_probek,w
000E40 6FBB           03491          movwf    ktora_probka
000E42 50C2           03492          movf     ADCON0,w
                      03493 ;musze zwiekszyc o jeden ten wycinek bitowy
                      03494 ;b'xx000xxx' - czyli nawet nie starszy 4 bit
                      03495 ;tylko cos w srodku
                      03496 ;aby to zrobic stosuje prosty wybieg + 8 do ADCON0
                      03497 
                      03498 ;dla 18f4x20 mamy troszke zmian
                      03499 ;ADCON0  wyglada ;b'xx0000xx'
                      03500         
                      03501         
                      03502         IF (procek == 18f442)
                      03503          addlw    8
                      03504          movwf    ADCON0
                      03505          movlw    b'00111000'
                      03506          andwf    ADCON0,w
                      03507          xorlw    b'00011000'
                      03508          bnz      zmierz_nastepny_nie_3
                      03509 ;drugi raz zwiekszam ADCON0 dla pominiecia 3 kanalu         
                      03510          movlw    8
                      03511          addwf    ADCON0,f
                      03512         ENDIF
                      03513 
                      03514         
                      03515         
                      03516         
                      03517         IF (procek == 18f4320)
000E44 0F04           03518          addlw    4
000E46 6EC2           03519          movwf    ADCON0
000E48 0E3C           03520          movlw    b'00111100'
000E4A 14C2           03521          andwf    ADCON0,w
000E4C 0A0C           03522          xorlw    b'00001100'
000E4E E102           03523          bnz      zmierz_nastepny_nie_3
                      03524 ;drugi raz zwiekszam ADCON0 dla pominiecia 3 kanalu         
000E50 0E04           03525          movlw    4
000E52 26C2           03526          addwf    ADCON0,f
                      03527         
                      03528         ENDIF
                      03529         
                      03530         
                      03531          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 86


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000E54                03532 zmierz_nastepny_nie_3
                      03533 ;wlaczam pomiar i przerwanie
                      03534          
000E54 8C9D           03535          bsf      PIE1,ADIE
                      03536          
                      03537 ;rozpocznij pomiar      
                      03538 ;wedlug opisu procka tu trzeba czekac okolo 20-30us  
                      03539 ;dla pewnosci bede czekal 120us wykozystujac TMR2
                      03540 ;czyszcze obecny TMR2
000E56 6BA8           03541          clrf     pomiarH
000E58 6BA9           03542          clrf     pomiarL
000E5A 6BAA           03543          clrf     pomiar_ulamek
000E5C 6AD6           03544          clrf     TMR0L
                      03545         IF (procek == 18f442)
                      03546          bcf      INTCON,T0IF
                      03547          bsf      INTCON,T0IE
                      03548         ENDIF
                      03549         IF (procek == 18f4320)
000E5E 94F2           03550          bcf      INTCON,TMR0IF
000E60 8AF2           03551          bsf      INTCON,TMR0IE
                      03552         ENDIF
                      03553          
                      03554          ;clrf     TMR2
                      03555          ;bsf    T2CON,TMR2ON
                      03556         
                      03557 ;tzn wlaczam przerwanie TMR2
                      03558          ;bsf      STATUS,RP0
                      03559          ;bsf     PIE1,TMR2IE
                      03560          ;bcf      STATUS,RP0
                      03561 ;przetestowanie czy dobry czas  
                      03562 ;          bsf     PORTC,2         
000E62 99A0           03563          bcf      markers2,wyslij_pomiar
000E64 0012           03564          return   
                      03565     
                      03566     
                      03567     
                      03568     
                      03569     
                      03570     
                      03571     
                      03572     
                      03573 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;procedury 
                            klawiszy
000E66                03574 wlacz_przerwanie_tmr3
                      03575 
000E66 92A0           03576       bcf   PIE2,TMR3IE
000E68 6AB3           03577       clrf  TMR3H
000E6A 6AB2           03578       clrf  TMR3L
000E6C 92A1           03579       bcf   PIR2,TMR3IF
                      03580       
000E6E 82A0           03581       bsf   PIE2,TMR3IE
                      03582 
000E70 0012           03583       return
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 87


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03584       
000E72                03585 wcisnieto_back
000E72 B9A1           03586       btfsc   markers3,wcisnieto_klawisz
000E74 0012           03587       return
                      03588       
000E76 89A1           03589       bsf   markers3,wcisnieto_klawisz
000E78 6B99           03590       clrf  stan_key
000E7A 8199           03591       bsf   stan_key,mamy_back
                      03592       
000E7C EF33 F007      03593       goto  wlacz_przerwanie_tmr3
                      03594       
                      03595       
                      03596 
                      03597       
                      03598       
000E80                03599 wcisnieto_down
                      03600 ;jeżeli zaznaczono że upłynął czas oczekiwania to wybierz procedurę zmiany      
000E80 B59E           03601       btfsc   znaczniki,czy_moge_juz_zmieniac
000E82 EF8B F007      03602       goto  wykryto_down
                      03603       
                      03604       ;goto    wykryto_down_zmiana_opcji
                      03605       
000E86 B9A1           03606       btfsc   markers3,wcisnieto_klawisz
000E88 0012           03607       return
                      03608       
000E8A 89A1           03609       bsf   markers3,wcisnieto_klawisz
000E8C 6B99           03610       clrf  stan_key
000E8E 8399           03611       bsf   stan_key,mamy_down
                      03612       
                      03613       ;btfsc       pozycja_menu,zmiana_opcji
                      03614       ;goto        sprawdz_czy_wlaczyc_szybka_zmiane
                      03615       
000E90 EF6C F007      03616       goto        ustaw_spr_szybkiej_zmiany
                      03617       
000E94 EF33 F007      03618       goto  wlacz_przerwanie_tmr3
                      03619 
                      03620       
000E98                03621 wcisnieto_up
000E98 B59E           03622       btfsc   znaczniki,czy_moge_juz_zmieniac
000E9A EF81 F009      03623       goto        wykryto_up
                      03624       ;goto    wykryto_up_zmiana_opcji
                      03625       
000E9E B9A1           03626       btfsc   markers3,wcisnieto_klawisz
000EA0 0012           03627       return
                      03628       
000EA2 89A1           03629       bsf   markers3,wcisnieto_klawisz
000EA4 6B99           03630       clrf  stan_key
000EA6 8599           03631       bsf   stan_key,mamy_up
                      03632       
                      03633 ;jeżeli klawisz up wcisnieto w momencie gdy uzytkownik wybral juz zmiane wartosci
                      03634       ;btfsc       pozycja_menu,zmiana_opcji
                      03635       ;goto        sprawdz_czy_wlaczyc_szybka_zmiane
                      03636       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 88


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000EA8 EF6C F007      03637       goto        ustaw_spr_szybkiej_zmiany
                      03638       
000EAC EF33 F007      03639       goto        wlacz_przerwanie_tmr3
                      03640       
                      03641 ; sprawdz_czy_wlaczyc_szybka_zmiane
                      03642 ; sprawdz_czy_wlaczyc_szybka_zmiane
                      03643 ;jest w menu na pozycji     
                      03644 ;opcja_odstep
                      03645 ;opcja_ustaw_temp
                      03646 
000EB0 0E02           03647       movlw       opcja_odstep
000EB2 63EA           03648       cpfseq      numer_opcji
000EB4 EF5E F007      03649       goto        sprawdz_czy_wlacz_szybka_zmiane2
                      03650 
000EB8 EF6C F007      03651       goto        ustaw_spr_szybkiej_zmiany
                      03652       
000EBC                03653 sprawdz_czy_wlacz_szybka_zmiane2      
000EBC 0E05           03654       movlw       opcja_ustaw_temp_R1
000EBE 63EA           03655       cpfseq      numer_opcji
000EC0 EF64 F007      03656       goto        sprawdz_czy_wlacz_szybka_zmiane3
                      03657 
000EC4 EF6C F007      03658       goto        ustaw_spr_szybkiej_zmiany
                      03659       
000EC8                03660 sprawdz_czy_wlacz_szybka_zmiane3
000EC8 0E06           03661       movlw       opcja_ustaw_temp_R2
000ECA 63EA           03662       cpfseq      numer_opcji
000ECC EF6A F007      03663       goto        sprawdz_czy_wlacz_szybka_zmiane4
                      03664 
000ED0 EF6C F007      03665       goto        ustaw_spr_szybkiej_zmiany
                      03666       
000ED4                03667 sprawdz_czy_wlacz_szybka_zmiane4
000ED4 EF33 F007      03668       goto  wlacz_przerwanie_tmr3
                      03669  
                      03670 ; ustaw_sprawdzanie_szybkiej_zmiany
000ED8                03671 ustaw_spr_szybkiej_zmiany
                      03672 ;jak długo trzymam przycisk zanim zaczne zmieniac wartości
000ED8 0E04           03673       movlw       dlugosc_oczekiwania_na_zmiane
000EDA 6FEC           03674       movwf       szybka_zmiana_wartosci
                      03675 ;zaznaczam że procedury sprawdzają zmianę opcji w czasie trzymania przycisku      
000EDC 8F9F           03676       bsf         markers,trzymanie_klawisza
000EDE EF33 F007      03677       goto  wlacz_przerwanie_tmr3
                      03678  
000EE2                03679 wcisnieto_enter
000EE2 B9A1           03680       btfsc   markers3,wcisnieto_klawisz
000EE4 0012           03681       return
                      03682       
000EE6 89A1           03683       bsf   markers3,wcisnieto_klawisz
000EE8 6B99           03684       clrf  stan_key
000EEA 8799           03685       bsf   stan_key,mamy_enter
                      03686       
000EEC EF33 F007      03687       goto  wlacz_przerwanie_tmr3
                      03688 
                      03689 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; ;                       ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 89


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            ;;;;;;;;                                BACK
000EF0                03690 wykryto_back
                      03691       ;co sie dzieje jezeli wykryje ze wcisnieto i puszczono klawisz cofnij
                      03692       
                      03693       ;jezeli jestem w menu to wyswietl ponownie czas i temperatury
                      03694       ;movf        pozycja_menu,w
                      03695       ;bz         wykryto_back_nic_nie_rob
                      03696       
                      03697 ;jezeli pozycja menu jest różna od 0 to po nacisnieciu klawisza back
                      03698 ;następuje powrót do ekranu z pomiarami temperatury oraz z zegarem systemowym
                      03699 ;oraz z prądami
                      03700       ;czyszczę wszystkie linie ekranu - polecenie clear display
000EF0 EC61 F001      03701       call        check_busy
000EF4 0E01           03702       movlw       display_clear
000EF6 EC23 F001      03703       call        send
000EFA EC61 F001      03704       call        check_busy
                      03705       
                      03706       ;następnie włączam wyświetlanie czasu i temperatur
                      03707 ;jeżeli znaczniki są ustawione to przy wyjściu
                      03708       
000EFE B19E           03709       btfsc       znaczniki,czy_ponownie_wlaczyc_temp
000F00 8B9F           03710       bsf         markers,czy_wyswietlam_temp
                      03711       
000F02 B39E           03712       btfsc       znaczniki,czy_ponownie_wlaczyc_zegar
000F04 85A1           03713       bsf         markers3,czy_zegar_wyswietlac
                      03714       
000F06 6BE9           03715       clrf       pozycja_menu
000F08 6BEA           03716       clrf        numer_opcji
                      03717       
000F0A EF87 F007      03718       goto  wykryto_back_exit
                      03719       
                      03720 
                      03721      
                      03722       ;jezeli w ekranie zegara to nic nie rob
                      03723       
                      03724       ;dla testow wyswietl na dole ekranu litere b
                      03725       
                      03726       
                      03727 ; wykryto_back_pisz
                      03728       ; call     write_lcd
000F0E                03729 wykryto_back_nic_nie_rob
000F0E                03730 wykryto_back_exit
000F0E 9BA1           03731       bcf   markers3,dzialanie_po_klawiszu
000F10 6B99           03732       clrf  stan_key
000F12 EF98 F00E      03733       goto  LOOP11
                      03734       
                      03735 
                      03736 
                      03737 
                      03738 
                      03739 
                      03740 
                      03741 
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 90


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03742 
                      03743 
                      03744 
                      03745 
                      03746 
                      03747 
                      03748 
                      03749 
                      03750 
                      03751 
                      03752 
                      03753 
                      03754       
                      03755 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; ;                       ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                            ;;;;;;;;                                DOWN
                      03756 
000F16                03757 wykryto_down
                      03758       
                      03759       ;co sie dzieje jezeli wykryje ze wcisnieto i puszczono klawisz cofnij
                      03760       
000F16 BFE9           03761       btfsc       pozycja_menu,zmiana_opcji
000F18 EF0D F008      03762       goto        wykryto_down_zmiana_opcji
                      03763       
                      03764       ;jezeli jestem w menu to przeskocz na kolejną opcję gwiazdką
                      03765       
                      03766       
                      03767       ;jezeli w ekranie zegara to pokaż kolejny zestaw czujników
000F1C 51E9           03768       movf        pozycja_menu,w
000F1E E10A           03769       bnz         wyk_down_spr_czy_wys_kolej_opcje
                      03770 ;jezeli pozycja menu ==0 to po nacisnieciu klawisza zmien wskazania temperatury
                      03771       ;najpierw czyść ekran
000F20 EC61 F001      03772       call        check_busy
000F24 0E01           03773       movlw       display_clear
000F26 EC23 F001      03774       call        send
000F2A EC61 F001      03775       call        check_busy
000F2E 7FA1           03776       btg         markers3,pokazuje_temperatury_47
                      03777       ;dla testow wyswietl na dole ekranu litere b
                      03778       
000F30 EF78 F009      03779        goto        wykryto_down_exit
                      03780 
                      03781 
                      03782 
                      03783 
                      03784 
                      03785 ; wykryto_down_sprawdz_czy_wyswietlam_kolejne_opcje      
000F34                03786 wyk_down_spr_czy_wys_kolej_opcje
                      03787       
                      03788       ; polozenie gwiazdki przechowuje liczbe wskazującą aktualny adres polozenia
                      03789       ;gwiazdki w 
                      03790       ;tablicy_gwiazdki
                      03791       ;
                      03792       
000F34 0E1E           03793       movlw       HIGH tablica_gwiazdki
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 91


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000F36 6EF7           03794       movwf       TBLPTRH
                      03795       
000F38 0ECC           03796       movlw       LOW tablica_gwiazdki
000F3A 6EF6           03797       movwf       TBLPTRL
                      03798       
                      03799       ;poniewaz najpierw zmniejszam polozenie
000F3C 2BEB           03800       incf        polozenie_gwiazdki,f
000F3E 51EB           03801       movf       polozenie_gwiazdki,w
                      03802       
000F40 26F6           03803       addwf       TBLPTRL,f
                      03804       
                      03805        ;a nastepnie czytam z adresu tablica_gwiazdki + polozenie_gwiazdki to uzywam polecenia
000F42 0008           03806       TBLRD *
                      03807       
000F44 0E01           03808       movlw       1
000F46 62F5           03809       cpfseq      TABLAT
                      03810 ;jezeli odczytano 1 tzn ze gwiazdka jest polozona na 
                      03811 ; dole ekranu
                      03812 ; i nalezy zmienic pozycje_menu oraz wyswietlic opcje menu z kolejnego ekranu
                      03813 
000F48 EFF3 F007      03814       goto         wykryto_down_zmiana_pol_gwiazdki
                      03815       ;polozenie_gwiazdki == 1
                      03816       ;tzn opcje kolejnego ekranu sa wyswietlane
000F4C 0E01           03817       movlw       1
000F4E 6FEB           03818       movwf       polozenie_gwiazdki;znow na pierwszej linii
                      03819       
                      03820       ;numer opcji ulega zmianie na kolejny
000F50 2BEA           03821       incf        numer_opcji,f
                      03822       ;czyszczenie ekranu
000F52 EC61 F001      03823       call        check_busy
000F56 0E01           03824       movlw       display_clear
000F58 EC23 F001      03825       call        send
000F5C EC61 F001      03826       call        check_busy
                      03827       
                      03828       ;zaznaczam ze wyświetlam kolejny ekran opcji
                      03829       
                      03830       
                      03831       ;clrf        numer_opcji
                      03832       
                      03833       
                      03834       ;call        check_busy
000F60 0E80           03835       movlw       linia_gorna
                      03836       
000F62 EC23 F001      03837       call        send
000F66 EC61 F001      03838       call        check_busy
                      03839       
000F6A 0E2A           03840       movlw       _star
000F6C EC34 F001      03841       call        write_lcd
000F70 EC61 F001      03842       call        check_busy      
                      03843       
000F74 90D8           03844       bcf         STATUS,C
000F76 37E9           03845       rlcf       pozycja_menu,f
                      03846       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 92


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03847       ;btfsc       pozycja_menu,menu_opcje1
                      03848       ;goto        wykryto_down_wyswietl_opcje_tablicy_jeden
                      03849       
000F78 B3E9           03850       btfsc       pozycja_menu,menu_opcje2
000F7A EFD3 F007      03851       goto        wyk_down_wyswietl_opcje_tabl_2
                      03852       
000F7E B5E9           03853       btfsc       pozycja_menu,menu_opcje3
000F80 EFDB F007      03854       goto        wykryto_down_wys_opcje_tab_trzy
                      03855       
000F84 B7E9           03856       btfsc       pozycja_menu,menu_opcje4
000F86 EFE3 F007      03857       goto        wykryto_down_wysw_opcje_tab_4
                      03858 
000F8A B9E9           03859       btfsc       pozycja_menu,menu_opcje5
000F8C EFEB F007      03860       goto        wykryto_down_wysw_opcje_tab_5
                      03861 
                      03862       
                      03863       ;btfsc       pozycja_menu,menu_opcje_end ;(tj zaznaczono bit ekranu którego nie ma w tym wypadku 
                            są   ekrany bit 0 i 1,  2  a bit 3 oznacza ekran którego nie ma     )
                      03864       ;goto        wykryto_down_wyswietl_opcje_tablicy_end
                      03865       ;pisanie 
                      03866       
                      03867       
                      03868       ;gdy wyświetlam opcje ekranu 1 - tzn gwiazdka byla na koncu opcji linii czwartej ekranu 2
000F90 0E01           03869       movlw       1
000F92 6FEA           03870       movwf       numer_opcji
000F94 6FE9           03871       movwf       pozycja_menu
                      03872       
000F96 0E1E           03873       movlw       HIGH tablica_pierwsza
000F98 6EF7           03874       movwf       TBLPTRH
                      03875       
000F9A 0E08           03876       movlw       LOW tablica_pierwsza
000F9C 6EF6           03877       movwf       TBLPTRL
                      03878       
000F9E ECCC F00B      03879       call        wyswietl_opcje_menu
                      03880       
000FA2 EF78 F009      03881       goto        wykryto_down_exit
                      03882       
                      03883       
                      03884 ;wykryto_down_wyswietl_opcje_tablicy_druga   
000FA6                03885 wyk_down_wyswietl_opcje_tabl_2
                      03886       ;gdy wyświetlam opcje ekranu 2
000FA6 0E1E           03887       movlw       HIGH tablica_druga
000FA8 6EF7           03888       movwf       TBLPTRH
                      03889       
000FAA 0E2A           03890       movlw       LOW tablica_druga
000FAC 6EF6           03891       movwf       TBLPTRL
                      03892       
                      03893       
000FAE ECCC F00B      03894       call        wyswietl_opcje_menu
                      03895       
000FB2 EF78 F009      03896       goto        wykryto_down_exit
                      03897       
                      03898 
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 93


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03899 
                      03900 ; wykryto_down_wyswietl_opcje_tablicy_trzy
000FB6                03901 wykryto_down_wys_opcje_tab_trzy
                      03902       ;gdy wyświetlam opcje ekranu 3
000FB6 0E1E           03903       movlw       HIGH tablica_trzecia
000FB8 6EF7           03904       movwf       TBLPTRH
                      03905       
000FBA 0E4A           03906       movlw       LOW tablica_trzecia
000FBC 6EF6           03907       movwf       TBLPTRL
                      03908       
                      03909       
000FBE ECCC F00B      03910       call        wyswietl_opcje_menu
                      03911       
000FC2 EF78 F009      03912       goto        wykryto_down_exit
                      03913       
                      03914       
                      03915 ;wykryto_down_wyswietl_opcje_tablicy_end 
                      03916      
                      03917 ; wykryto_down_wyswietl_opcje_tablicy_cztery      
000FC6                03918 wykryto_down_wysw_opcje_tab_4      
000FC6 0E1E           03919       movlw       HIGH tablica_czwarta
000FC8 6EF7           03920       movwf       TBLPTRH
                      03921       
000FCA 0E70           03922       movlw       LOW tablica_czwarta
000FCC 6EF6           03923       movwf       TBLPTRL
                      03924       
000FCE ECCC F00B      03925       call        wyswietl_opcje_menu
                      03926       
000FD2 EF78 F009      03927       goto        wykryto_down_exit
                      03928       
                      03929       
                      03930 ; wykryto_down_wyswietl_opcje_tablicy_piata
000FD6                03931 wykryto_down_wysw_opcje_tab_5
000FD6 0E1E           03932       movlw       HIGH tablica_piata
000FD8 6EF7           03933       movwf       TBLPTRH
                      03934       
000FDA 0E98           03935       movlw       LOW tablica_piata
000FDC 6EF6           03936       movwf       TBLPTRL
                      03937       
000FDE ECCC F00B      03938       call        wyswietl_opcje_menu
                      03939       
000FE2 EF78 F009      03940       goto        wykryto_down_exit
                      03941       
                      03942 ; wykryto_down_zmiana_polozenia_gwiazdki
000FE6                03943 wykryto_down_zmiana_pol_gwiazdki
                      03944       ;opcje zmnieniaja się o tą położoną wyżej
000FE6 2BEA           03945       incf        numer_opcji,f
                      03946       
                      03947       ;nowa gwiazdka jest rysowana w miejscu odczytanym z tablicy
000FE8 EC61 F001      03948       call     check_busy
000FEC 50F5           03949       movf        TABLAT,w
000FEE EC23 F001      03950       call        send
                      03951       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 94


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000FF2 EC61 F001      03952       call     check_busy
                      03953       
000FF6 0E2A           03954       movlw       _star
000FF8 EC34 F001      03955       call        write_lcd
000FFC EC61 F001      03956       call     check_busy
                      03957       ;gwiazdka poprzednia jest kasowana - tzn znow czytam z tablicy ale tym razem polozenie poprzednie
                      03958       
                      03959       
001000 06F6           03960       decf        TBLPTRL,f
001002 0008           03961       TBLRD *
001004 50F5           03962       movf        TABLAT,w
001006 EC23 F001      03963       call        send
00100A EC61 F001      03964       call     check_busy
00100E 0E20           03965       movlw       _puste
001010 EC34 F001      03966       call        write_lcd
                      03967       
001014 2AF6           03968       incf        TBLPTRL,f
                      03969       
001016 EF78 F009      03970       goto        wykryto_down_exit
                      03971 
                      03972       
                      03973       
                      03974       
                      03975       
                      03976       
                      03977       
                      03978       
                      03979       
                      03980       
                      03981 ;;;;
                      03982 
                      03983 
                      03984 ;;;; numer opcji odpowiada polozeniu opcji w MENU      
                      03985       
00101A                03986 wykryto_down_zmiana_opcji
                      03987 
00101A 0E01           03988       movlw       opcja_czujniki
00101C 63EA           03989       cpfseq      numer_opcji
00101E EF26 F008      03990       goto          wykryto_down_sprawdz_2
                      03991       
                      03992       ;jeżeli zmieniam ilość obsługiwanych czujników temp
                      03993       ;to tu powinno być zmiana o 1 ilości kanałów 
                      03994       ;i sprawdzenie czy nie przekroczyłem dopuszczalnych 8
                      03995       
001022 07AC           03996       decf        ile_kanalow,f
                      03997       
001024 0EFF           03998       movlw      0xff
                      03999       
001026 63AC           04000       cpfseq      ile_kanalow
001028 EF18 F008      04001       goto         wykr_down_zmian_opcji_wysw_kanal
                      04002       
00102C 0E08           04003       movlw       8
00102E 6FAC           04004       movwf       ile_kanalow
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 95


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04005       
                      04006 ; wykryto_down_zmiana_opcji_wyswietl_kanaly
001030                04007 wykr_down_zmian_opcji_wysw_kanal
001030 EC61 F001      04008       call     check_busy
001034 0E80           04009       movlw    linia_gorna
001036 0F0A           04010       addlw       polozenie_liczby_menu
001038 EC23 F001      04011       call      send
                      04012       ;
00103C EC61 F001      04013       call     check_busy
001040 51AC           04014       movf        ile_kanalow,w
001042 0F30           04015       addlw       0x30
001044 EC34 F001      04016       call        write_lcd
                      04017       
001048 EF78 F009      04018       goto        wykryto_down_exit
                      04019       
                      04020       
                      04021       
00104C                04022 wykryto_down_sprawdz_2
                      04023 
00104C 0E02           04024       movlw       opcja_odstep
00104E 63EA           04025       cpfseq      numer_opcji
001050 EF36 F008      04026       goto        wykryto_down_sprawdz_3
                      04027 
001054 07AD           04028       decf        odstep_pomiarowy,f
001056 51AD           04029       movf        odstep_pomiarowy,w
001058 6F92           04030       movwf       tmp_hex
00105A 6B93           04031       clrf        tmp_hex_H
00105C 6B98           04032       clrf        dec1
00105E 6B97           04033       clrf        dec10
001060 EC87 F002      04034       call        hex2dec18
                      04035 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04036       ;wyświetlam obok nazwy opcji czyli 
001064 ECED F00D      04037       call        wykr_enter_gdzie_wysw_licz_bajt
                      04038   
001068 EF78 F009      04039       goto        wykryto_down_exit
                      04040 
                      04041 
                      04042 
                      04043       
00106C                04044 wykryto_down_sprawdz_3  
                      04045 
00106C 0E03           04046       movlw       opcja_srednia
00106E 63EA           04047       cpfseq      numer_opcji
001070 EF57 F008      04048       goto        wykryto_down_sprawdz_4
                      04049       
                      04050       ;bsf      markers,czy_usrednianie
                      04051       
                      04052       ;sprawdz czy liczba próbek == 1
001074 0E01           04053       movlw       0x1
001076 63AE           04054       cpfseq      jak_duzo_probek
001078 EF42 F008      04055       goto        wykryto_down_spr_3_zmni_probki
                      04056       ;zmieniam liczbe próbek na 0x80
00107C 0E80           04057       movlw       0x80
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 96


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00107E 6FAE           04058       movwf       jak_duzo_probek
001080 EF48 F008      04059       goto        wykryto_down_3_wyswietl
                      04060       
                      04061 ; wykryto_down_sprawdz_3_zmniejsz_probki
001084                04062 wykryto_down_spr_3_zmni_probki
                      04063 ;dziele przez 2
001084 0E80           04064       movlw       0x80 
001086 03AE           04065       mulwf       jak_duzo_probek
001088 50F4           04066       movf        PRODH,w
00108A 6FAE           04067       movwf       jak_duzo_probek
                      04068       
00108C ECB6 F003      04069       call     ustaw_wartosc_dziel_usredniania
                      04070       
001090                04071 wykryto_down_3_wyswietl
                      04072 ;sprawdz czy liczba próbek ==1
001090 919F           04073       bcf      markers,czy_usrednianie
                      04074       
001092 0E01           04075       movlw       1
001094 63AE           04076       cpfseq      jak_duzo_probek
001096 819F           04077       bsf      markers,czy_usrednianie      
                      04078       
001098 51AE           04079       movf        jak_duzo_probek,w
00109A 6F92           04080       movwf       tmp_hex
00109C 6B93           04081       clrf        tmp_hex_H
00109E 6B98           04082       clrf        dec1
0010A0 6B97           04083       clrf        dec10
0010A2 EC87 F002      04084       call        hex2dec18
                      04085 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04086       ;wyświetlam obok nazwy opcji czyli 
0010A6 ECED F00D      04087       call        wykr_enter_gdzie_wysw_licz_bajt
                      04088 
0010AA EF78 F009      04089       goto        wykryto_down_exit
                      04090 
                      04091 
                      04092       
                      04093       
                      04094       
                      04095       
0010AE                04096 wykryto_down_sprawdz_4
                      04097       
                      04098       
0010AE                04099 wykryto_down_sprawdz_5
0010AE 0E05           04100       movlw       opcja_ustaw_temp_R1
0010B0 63EA           04101       cpfseq      numer_opcji
0010B2 EF6B F008      04102       goto        wykryto_down_sprawdz_6
                      04103       
                      04104       ;wlacz pomiar pradu
                      04105       ;jako test wlacz podswietlenie lub je wylacz
                      04106       
                      04107       ;btg   portlampka2,lampka2
                      04108       
0010B6 07B0           04109       decf        jaka_wartosc_regulujeL1,f
                      04110       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 97


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0010B8 B0D8           04111       btfsc       STATUS,C
0010BA EF67 F008      04112       goto        wykryto_down_sprawdz_5_zero
                      04113       ;jeżeli w H jest 0 to  umieść tam 1
0010BE 51AF           04114       movf       jaka_wartosc_regulujeH1,w
0010C0 E004           04115       bz          wykryto_down_spr_5_zawracanie
                      04116       
0010C2 07AF           04117       decf        jaka_wartosc_regulujeH1,f
                      04118       
0010C4 B0D8           04119       btfsc       STATUS,C
0010C6 EF67 F008      04120       goto        wykryto_down_sprawdz_5_zero
                      04121 ; wykryto_down_sprawdz_5_zawracanie
0010CA                04122 wykryto_down_spr_5_zawracanie
0010CA 0E01           04123       movlw       1
0010CC 6FAF           04124       movwf       jaka_wartosc_regulujeH1
                      04125       
0010CE                04126 wykryto_down_sprawdz_5_zero      
                      04127                                                 ; movf        jaka_wartosc_regulujeL,w
                      04128                                                 ; movwf       tmp_hex
                      04129                                                 ; movf        jaka_wartosc_regulujeH,w
                      04130                                                 ; movwf        tmp_hex_H
                      04131                                                 ; clrf        dec1
                      04132                                                 ; clrf        dec10
                      04133                                                 ; call        hex2dec18
                      04134 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04135       ;wyświetlam obok nazwy opcji czyli 
                      04136                                                 ;call        wykryto_enter_gdzie_wyswietlam_liczbe_bajto
                            wa
                      04137       
                      04138       
0010CE EC77 F00C      04139       call  wyswietl_temp_w_opcjach
                      04140       
0010D2 EF78 F009      04141       goto        wykryto_down_exit
                      04142       
                      04143             
                      04144       
                      04145       
                      04146       
                      04147       
                      04148       
0010D6                04149 wykryto_down_sprawdz_6
                      04150       
0010D6 0E06           04151       movlw       opcja_ustaw_temp_R2
0010D8 63EA           04152       cpfseq      numer_opcji
0010DA EF7F F008      04153       goto        wykryto_down_sprawdz_7
                      04154       
                      04155       ;wlacz pomiar pradu
                      04156       ;jako test wlacz podswietlenie lub je wylacz
                      04157       
                      04158       ;btg   portlampka2,lampka2
                      04159       
0010DE 07B2           04160       decf        jaka_wartosc_regulujeL2,f
                      04161       
0010E0 B0D8           04162       btfsc       STATUS,C
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 98


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0010E2 EF7B F008      04163       goto        wykryto_down_sprawdz_6_zero
                      04164       ;jeżeli w H jest 0 to  umieść tam 1
0010E6 51B1           04165       movf       jaka_wartosc_regulujeH2,w
0010E8 E004           04166       bz          wykryto_down_spr_6_zawracanie
                      04167       
0010EA 07B1           04168       decf        jaka_wartosc_regulujeH2,f
                      04169       
0010EC B0D8           04170       btfsc       STATUS,C
0010EE EF7B F008      04171       goto        wykryto_down_sprawdz_6_zero
0010F2                04172 wykryto_down_spr_6_zawracanie
0010F2 0E01           04173       movlw       1
0010F4 6FB1           04174       movwf       jaka_wartosc_regulujeH2
                      04175       
0010F6                04176 wykryto_down_sprawdz_6_zero      
                      04177                       
0010F6 EC9A F00C      04178       call  wyswietl_temp_w_opcjach2
                      04179       
0010FA EF78 F009      04180       goto        wykryto_down_exit
                      04181       
                      04182       
0010FE                04183 wykryto_down_sprawdz_7      
                      04184       
                      04185       
0010FE                04186 wykryto_down_sprawdz_9
                      04187 ;histereza górna
                      04188 
0010FE 0E09           04189       movlw       opcja_histereza_R1_1
001100 63EA           04190       cpfseq      numer_opcji
001102 EF8F F008      04191       goto        wykryto_down_sprawdz_10
                      04192       
                      04193       ;wlacz pomiar pradu
                      04194       ;jako test wlacz podswietlenie lub je wylacz
                      04195       
                      04196       ;btg   portlampka2,lampka2
001106 07B3           04197       decf        histereza_R1_1,f
                      04198       
001108 51B3           04199       movf        histereza_R1_1,w
00110A 6F92           04200       movwf       tmp_hex
                      04201       
00110C 6B93           04202       clrf        tmp_hex_H
00110E 6B98           04203       clrf        dec1
001110 6B97           04204       clrf        dec10
001112 EC87 F002      04205       call        hex2dec18
                      04206 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04207       ;wyświetlam obok nazwy opcji czyli 
001116 ECED F00D      04208       call        wykr_enter_gdzie_wysw_licz_bajt
                      04209       
00111A EF78 F009      04210       goto        wykryto_down_exit     
                      04211 
00111E                04212 wykryto_down_sprawdz_10
                      04213 ;histereza dolna
00111E 0E0A           04214       movlw       opcja_histereza_R1_2
001120 63EA           04215       cpfseq      numer_opcji
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 99


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001122 EF9F F008      04216       goto        wykryto_down_sprawdz_11
                      04217       
                      04218       
001126 07B4           04219       decf        histereza_R1_2,f
                      04220       
001128 51B4           04221       movf        histereza_R1_2,w
00112A 6F92           04222       movwf       tmp_hex
                      04223       
00112C 6B93           04224       clrf        tmp_hex_H
00112E 6B98           04225       clrf        dec1
001130 6B97           04226       clrf        dec10
001132 EC87 F002      04227       call        hex2dec18
                      04228 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04229       ;wyświetlam obok nazwy opcji czyli 
001136 ECED F00D      04230       call        wykr_enter_gdzie_wysw_licz_bajt
                      04231       
00113A EF78 F009      04232       goto        wykryto_down_exit     
                      04233 
                      04234 
                      04235 
                      04236       
                      04237       
                      04238       
00113E                04239 wykryto_down_sprawdz_11
                      04240 ;histereza dolna
00113E 0E0B           04241       movlw       opcja_histereza_R2_1
001140 63EA           04242       cpfseq      numer_opcji
001142 EFAF F008      04243       goto        wykryto_down_sprawdz_12
                      04244       
001146 07B5           04245       decf        histereza_R2_1,f
                      04246       
001148 51B5           04247       movf        histereza_R2_1,w
00114A 6F92           04248       movwf       tmp_hex
                      04249       
00114C 6B93           04250       clrf        tmp_hex_H
00114E 6B98           04251       clrf        dec1
001150 6B97           04252       clrf        dec10
001152 EC87 F002      04253       call        hex2dec18
                      04254 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04255       ;wyświetlam obok nazwy opcji czyli 
001156 ECED F00D      04256       call        wykr_enter_gdzie_wysw_licz_bajt
                      04257       
00115A EF78 F009      04258       goto        wykryto_down_exit     
                      04259 
                      04260       
                      04261       
00115E                04262 wykryto_down_sprawdz_12
                      04263 ;histereza dolna
00115E 0E0C           04264       movlw       opcja_histereza_R2_2
001160 63EA           04265       cpfseq      numer_opcji
001162 EFBF F008      04266       goto        wykryto_down_sprawdz_13
                      04267       
001166 07B6           04268       decf        histereza_R2_2,f
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 100


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04269       
001168 51B6           04270       movf        histereza_R2_2,w
00116A 6F92           04271       movwf       tmp_hex
                      04272       
00116C 6B93           04273       clrf        tmp_hex_H
00116E 6B98           04274       clrf        dec1
001170 6B97           04275       clrf        dec10
001172 EC87 F002      04276       call        hex2dec18
                      04277 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04278       ;wyświetlam obok nazwy opcji czyli 
001176 ECED F00D      04279       call        wykr_enter_gdzie_wysw_licz_bajt
                      04280       
00117A EF78 F009      04281       goto        wykryto_down_exit     
                      04282 
                      04283 
                      04284 
                      04285 
00117E                04286 wykryto_down_sprawdz_13
00117E 0E0D           04287       movlw       opcja_regulacja1
001180 63EA           04288       cpfseq      numer_opcji
001182 EFCF F008      04289       goto        wykryto_down_sprawdz_14
                      04290       
                      04291       
001186 07B7           04292       decf        czy_reguluje1,f
                      04293       
001188 B0D8           04294       btfsc       STATUS,C
00118A EFC9 F008      04295       goto        wykryto_down_sprawdz_13_zero
                      04296       ;jeżeli w H jest 0 to  umieść tam 1
00118E 0E02           04297       movlw      max_procedury_regu-1
001190 6FB7           04298       movwf      czy_reguluje1
                      04299       
001192                04300 wykryto_down_sprawdz_13_zero      
                      04301       
                      04302       
                      04303 
                      04304       ; movlw     czy_reguluje1
                      04305       ; movwf     FSR2
001192 EE20 F0B7      04306       lfsr      FSR2,czy_reguluje1
001196 ECE3 F00A      04307       call      wyswietl_opcje_regulacji
                      04308 
                      04309       
00119A EF78 F009      04310       goto        wykryto_down_exit   
                      04311 
                      04312 
00119E                04313 wykryto_down_sprawdz_14
00119E 0E0E           04314         movlw       opcja_regulacja2
0011A0 63EA           04315       cpfseq      numer_opcji
0011A2 EFDF F008      04316       goto        wykryto_down_sprawdz_15
                      04317       
                      04318       
0011A6 07B8           04319       decf        czy_reguluje2,f
                      04320       
0011A8 B0D8           04321       btfsc       STATUS,C
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 101


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0011AA EFD9 F008      04322       goto        wykryto_down_sprawdz_14_zero
                      04323       ;jeżeli w H jest 0 to  umieść tam 1
0011AE 0E02           04324       movlw      max_procedury_regu-1
0011B0 6FB8           04325       movwf      czy_reguluje2
                      04326       
0011B2                04327 wykryto_down_sprawdz_14_zero      
                      04328       
                      04329       
                      04330 
                      04331       ; movlw     czy_reguluje2
                      04332       ; movwf     FSR2
0011B2 EE20 F0B8      04333       lfsr      FSR2,czy_reguluje2
0011B6 ECE3 F00A      04334       call      wyswietl_opcje_regulacji
                      04335 
                      04336       
0011BA EF78 F009      04337       goto        wykryto_down_exit   
                      04338 
                      04339 
                      04340 
                      04341 
                      04342 
0011BE                04343 wykryto_down_sprawdz_15
                      04344 ;czujnik regulatora
                      04345 
0011BE 0E0F           04346       movlw       opcja_czujnik_regulacji1
0011C0 63EA           04347       cpfseq      numer_opcji
0011C2 EFF7 F008      04348       goto        wykryto_down_sprawdz_16
                      04349       
                      04350       ;wlacz pomiar pradu
                      04351       ;jako test wlacz podswietlenie lub je wylacz
                      04352       
                      04353       ;btg   portlampka2,lampka2
                      04354       
0011C6 51B9           04355       movf        ktory_czujnik_reguluje1,w
0011C8 A4D8           04356       btfss       STATUS,Z
0011CA EFEB F008      04357       goto        wykryto_down_spr15_nie_ma_zero
                      04358       
0011CE 0E07           04359       movlw       ilosc_czujnikow
                      04360       
0011D0 6FB9           04361       movwf       ktory_czujnik_reguluje1
                      04362       
0011D2 EFEC F008      04363       goto        wykryto_down_sprawdz15_show
0011D6                04364 wykryto_down_spr15_nie_ma_zero      
0011D6 07B9           04365       decf        ktory_czujnik_reguluje1,f
                      04366       
                      04367 
0011D8                04368 wykryto_down_sprawdz15_show
0011D8 51B9           04369       movf        ktory_czujnik_reguluje1,w
0011DA 6F92           04370       movwf       tmp_hex
                      04371       
0011DC 6B93           04372       clrf        tmp_hex_H
0011DE 6B98           04373       clrf        dec1
0011E0 6B97           04374       clrf        dec10
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 102


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0011E2 EC87 F002      04375       call        hex2dec18
                      04376 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04377       ;wyświetlam obok nazwy opcji czyli 
0011E6 ECED F00D      04378       call        wykr_enter_gdzie_wysw_licz_bajt
                      04379       
0011EA EF78 F009      04380       goto        wykryto_down_exit
                      04381 
                      04382 
                      04383 
                      04384 
0011EE                04385 wykryto_down_sprawdz_16
                      04386 ;czujnik regulatora
                      04387 
0011EE 0E10           04388       movlw       opcja_czujnik_regulacji2
0011F0 63EA           04389       cpfseq      numer_opcji
0011F2 EF0F F009      04390       goto        wykryto_down_sprawdz_17
                      04391       
                      04392       ;wlacz pomiar pradu
                      04393       ;jako test wlacz podswietlenie lub je wylacz
                      04394       
                      04395       ;btg   portlampka2,lampka2
                      04396       
0011F6 51BA           04397       movf        ktory_czujnik_reguluje2,w
0011F8 A4D8           04398       btfss       STATUS,Z
0011FA EF03 F009      04399       goto        wykryto_down_spr16_nie_ma_zero
                      04400       
0011FE 0E07           04401       movlw       ilosc_czujnikow
                      04402       
001200 6FBA           04403       movwf       ktory_czujnik_reguluje2
                      04404       
001202 EF04 F009      04405       goto        wykryto_down_sprawdz16_show
                      04406 ; wykryto_down_sprawdz16_nie_ma_zero
001206                04407 wykryto_down_spr16_nie_ma_zero      
001206 07BA           04408       decf        ktory_czujnik_reguluje2,f
                      04409       
                      04410 
001208                04411 wykryto_down_sprawdz16_show
001208 51BA           04412       movf        ktory_czujnik_reguluje2,w
00120A 6F92           04413       movwf       tmp_hex
                      04414       
00120C 6B93           04415       clrf        tmp_hex_H
00120E 6B98           04416       clrf        dec1
001210 6B97           04417       clrf        dec10
001212 EC87 F002      04418       call        hex2dec18
                      04419 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04420       ;wyświetlam obok nazwy opcji czyli 
001216 ECED F00D      04421       call        wykr_enter_gdzie_wysw_licz_bajt
                      04422       
00121A EF78 F009      04423       goto        wykryto_down_exit
                      04424 
                      04425 
                      04426       
                      04427       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 103


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04428       
                      04429       
00121E                04430 wykryto_down_sprawdz_17
                      04431 
                      04432 
                      04433 
                      04434 
                      04435 
                      04436       
00121E                04437 wykryto_down_sprawdz_20
00121E 0E14           04438       movlw       opcja_ustaw_zegar
001220 63EA           04439       cpfseq      numer_opcji
001222 EF78 F009      04440       goto        wykryto_down_sprawdz21
                      04441       
                      04442 ;sprawdzenie która wielkość zegara podlega zmianie
                      04443 ;jeżeli dzien_10 to zmniejszam o jeden dzien_1
                      04444 ;problem polega na tym, że nie mogę skorzystać z FSR2 bo  każda z wielkości
                      04445 ;czasu musi być indywidualnie rozpatrywana
001226 0EE0           04446       movlw       dzien_10
001228 63EF           04447       cpfseq      ustawianie_czasu_co_wyswietlam
00122A EF2C F009      04448       goto        wykryto_down_sprawdz_11_1
                      04449 
                      04450 ;jeżeli dzień_1 jest 0 (0x30) to jeżeli dzien_10 <> 0x30 zmniejsz dzien_10
                      04451 
00122E 0E30           04452       movlw       0x30
001230 63E1           04453       cpfseq      dzien_1
001232 EF29 F009      04454       goto        zmniejsz_dzien_1
                      04455       
                      04456       ;sprawdz czy dzien_10 == 0x30
001236 0E30           04457       movlw       0x30
001238 63E0           04458       cpfseq      dzien_10
00123A EF24 F009      04459       goto        zapisz_do_dzien_1_99
                      04460       
00123E 0E39           04461       movlw       0x39
001240 6FE0           04462       movwf       dzien_10
001242 6FE1           04463       movwf       dzien_1
                      04464       
001244 EF74 F009      04465       goto        wykryto_down_sprawdz_11_4
                      04466       
001248                04467 zapisz_do_dzien_1_99
001248 0E39           04468       movlw       0x39
00124A 6FE1           04469       movwf       dzien_1
00124C 07E0           04470       decf        dzien_10,f
00124E EF74 F009      04471       goto        wykryto_down_sprawdz_11_4
                      04472       
                      04473       
001252                04474 zmniejsz_dzien_1      
001252 07E1           04475       decf        dzien_1,f
                      04476       
                      04477       
001254 EF74 F009      04478       goto        wykryto_down_sprawdz_11_4
                      04479       
001258                04480 wykryto_down_sprawdz_11_1
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 104


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001258 0EE2           04481       movlw       godziny_10
00125A 63EF           04482       cpfseq      ustawianie_czasu_co_wyswietlam
00125C EF46 F009      04483       goto        wykryto_down_sprawdz_11_2
                      04484       
001260 0E30           04485       movlw       0x30
001262 63E3           04486       cpfseq      godziny_1
001264 EF43 F009      04487       goto        zmniejsz_godziny_1
                      04488       
                      04489       ;sprawdz czy dzien_10 == 0x30
001268 0E30           04490       movlw       0x30
00126A 63E2           04491       cpfseq      godziny_10
00126C EF3E F009      04492       goto        zapisz_do_godziny_1_9
                      04493       
001270 0E32           04494       movlw       0x32
001272 6FE2           04495       movwf       godziny_10
001274 0E33           04496       movlw       0x33
001276 6FE3           04497       movwf       godziny_1
                      04498       
001278 EF74 F009      04499       goto        wykryto_down_sprawdz_11_4
                      04500       
00127C                04501 zapisz_do_godziny_1_9
00127C 0E39           04502       movlw       0x39
00127E 6FE3           04503       movwf       godziny_1
001280 07E2           04504       decf        godziny_10,f
001282 EF74 F009      04505       goto        wykryto_down_sprawdz_11_4
                      04506       
                      04507       
001286                04508 zmniejsz_godziny_1      
001286 07E3           04509       decf        godziny_1,f
                      04510       
                      04511       
001288 EF74 F009      04512       goto        wykryto_down_sprawdz_11_4
                      04513       
                      04514       
00128C                04515 wykryto_down_sprawdz_11_2
00128C 0EE4           04516       movlw       minuty_10
00128E 63EF           04517       cpfseq      ustawianie_czasu_co_wyswietlam
001290 EF60 F009      04518       goto        wykryto_down_sprawdz_11_3
                      04519       
001294 0E30           04520       movlw       0x30
001296 63E5           04521       cpfseq      minuty_1
001298 EF5D F009      04522       goto        zmniejsz_minuty_1
                      04523       
                      04524       ;sprawdz czy dzien_10 == 0x30
00129C 0E30           04525       movlw       0x30
00129E 63E4           04526       cpfseq      minuty_10
0012A0 EF58 F009      04527       goto        zapisz_do_minuty_1_9
                      04528       
0012A4 0E35           04529       movlw       0x35
0012A6 6FE4           04530       movwf       minuty_10
0012A8 0E39           04531       movlw       0x39
0012AA 6FE5           04532       movwf       minuty_1
                      04533       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 105


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0012AC EF74 F009      04534       goto        wykryto_down_sprawdz_11_4
                      04535       
0012B0                04536 zapisz_do_minuty_1_9
0012B0 0E39           04537       movlw       0x39
0012B2 6FE5           04538       movwf       minuty_1
0012B4 07E4           04539       decf        minuty_10,f
0012B6 EF74 F009      04540       goto        wykryto_down_sprawdz_11_4
                      04541       
                      04542       
0012BA                04543 zmniejsz_minuty_1      
0012BA 07E5           04544       decf        minuty_1,f
                      04545       
0012BC EF74 F009      04546       goto        wykryto_down_sprawdz_11_4
                      04547       
0012C0                04548 wykryto_down_sprawdz_11_3     
0012C0 0E30           04549       movlw       0x30
0012C2 63E7           04550       cpfseq      sekundy_1
0012C4 EF73 F009      04551       goto        zmniejsz_sekundy_1
                      04552       
                      04553       ;sprawdz czy dzien_10 == 0x30
0012C8 0E30           04554       movlw       0x30
0012CA 63E6           04555       cpfseq      sekundy_10
0012CC EF6E F009      04556       goto        zapisz_do_sekundy_1_9
                      04557       
0012D0 0E35           04558       movlw       0x35
0012D2 6FE6           04559       movwf       sekundy_10
0012D4 0E39           04560       movlw       0x39
0012D6 6FE7           04561       movwf       sekundy_1
                      04562       
0012D8 EF74 F009      04563       goto        wykryto_down_sprawdz_11_4
                      04564       
0012DC                04565 zapisz_do_sekundy_1_9
0012DC 0E39           04566       movlw       0x39
0012DE 6FE7           04567       movwf       sekundy_1
0012E0 07E6           04568       decf        sekundy_10,f
0012E2 EF74 F009      04569       goto        wykryto_down_sprawdz_11_4
                      04570       
                      04571       
0012E6                04572 zmniejsz_sekundy_1      
0012E6 07E7           04573       decf        sekundy_1,f
                      04574       
0012E8                04575 wykryto_down_sprawdz_11_4            
                      04576 
0012E8 EC1A F00E      04577       call        proc_wyswietl_kolej_liczb_zegara
                      04578       
0012EC EF78 F009      04579       goto        wykryto_down_exit           
                      04580 ;       call     check_busy
                      04581 ;       movlw    linia_czwarta
                      04582 ;       call      send
                      04583 ;         
                      04584 ;       call     check_busy
                      04585 ; ;czy gasze czy wyswietlam      
                      04586 ;       btfsc       markers,test
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 106


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04587 ;       goto        zamaz_D
                      04588 ; napisz_D
                      04589 ;       bsf   markers,test
                      04590 ;       movlw       _d
                      04591 ;       goto  wykryto_down_pisz
                      04592 ; zamaz_D      
                      04593 ;       bcf   markers,test
                      04594 ;       movlw       _puste
                      04595 ;       
                      04596 ; wykryto_down_pisz
                      04597 ;       call     write_lcd
                      04598 
                      04599       
                      04600       
                      04601       
                      04602       
                      04603       
                      04604       
                      04605       
                      04606       
                      04607       
                      04608       
                      04609       
                      04610       
                      04611       
0012F0                04612 wykryto_down_sprawdz21
                      04613 
                      04614 
                      04615 
                      04616 
                      04617 
                      04618 
                      04619 
                      04620 
                      04621 
0012F0                04622 wykryto_down_exit
                      04623 ;jeżeli jest opuszczenie procedury w trakcie przyciskania kończ w inny sposób
                      04624 
0012F0 B59E           04625       btfsc   znaczniki,czy_moge_juz_zmieniac
0012F2 EF7F F009      04626       goto    wykryto_down_exit_trzymanie
                      04627       
0012F6 9BA1           04628       bcf   markers3,dzialanie_po_klawiszu
0012F8 6B99           04629       clrf  stan_key
0012FA EF98 F00E      04630       goto  LOOP11
                      04631  
0012FE                04632 wykryto_down_exit_trzymanie
0012FE 959E           04633       bcf     znaczniki,czy_moge_juz_zmieniac
001300 0012           04634       return
                      04635  
                      04636  
                      04637  
                      04638  
                      04639  
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 107


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04640  
                      04641  
                      04642  
                      04643  
                      04644  
                      04645  
                      04646  
                      04647  
                      04648  
                      04649  
                      04650  
                      04651  
                      04652  
                      04653  
                      04654  
                      04655  
                      04656  
                      04657  
                      04658  
                      04659  
                      04660  
                      04661  
                      04662  
                      04663  
                      04664  
                      04665  
                      04666  
                      04667  
                      04668  
                      04669  
                      04670                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; ;                       ;;;;;;;;;;;;;;
                            ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                                UP
001302                04671 wykryto_up
                      04672       ;co sie dzieje jezeli wykryje ze wcisnieto i puszczono klawisz up
                      04673       
001302 BFE9           04674       btfsc       pozycja_menu,zmiana_opcji
001304 EF3C F00A      04675       goto        wykryto_up_zmiana_opcji
                      04676       
001308 51E9           04677       movf        pozycja_menu,w
00130A E10A           04678       bnz         wyk_up_spr_czy_wyswi_kol_opcje
                      04679 ;jezeli pozycja menu ==0 to po nacisnieciu klawisza zmien wskazania temperatury
                      04680 
00130C EC61 F001      04681       call        check_busy
001310 0E01           04682       movlw       display_clear
001312 EC23 F001      04683       call        send
001316 EC61 F001      04684       call        check_busy
00131A 7FA1           04685       btg         markers3,pokazuje_temperatury_47
                      04686       ;tzn pozwala obejrzec temperatury 0-3 lub 4-7 (zawsze 4)
00131C EFC3 F00B      04687       goto        wykryto_up_exit
                      04688 
                      04689 
                      04690 
                      04691 
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 108


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04692 
                      04693 
                      04694 
                      04695       
                      04696 
                      04697       
                      04698       
                      04699       
                      04700       
                      04701 ; wykryto_up_sprawdz_czy_wyswietlam_kolejne_opcje
001320                04702 wyk_up_spr_czy_wyswi_kol_opcje
                      04703       ;movlw       1
                      04704       ;cpfseq      pozycja_menu
                      04705       ;goto        sprawdz_czy_wyswietlam_zmiane_opcji
                      04706       
                      04707       ; polozenie gwiazdki przechowuje liczbe wskazującą aktualny adres polozenia
                      04708       ;gwiazdki w 
                      04709       ;tablicy_gwiazdki
                      04710       ;
                      04711       
001320 0E1E           04712       movlw       HIGH tablica_gwiazdki
001322 6EF7           04713       movwf       TBLPTRH
                      04714       
001324 0ECC           04715       movlw       LOW tablica_gwiazdki
001326 6EF6           04716       movwf       TBLPTRL
                      04717       
                      04718       ;poniewaz najpierw zmniejszam polozenie
001328 07EB           04719       decf        polozenie_gwiazdki,f
00132A 51EB           04720       movf       polozenie_gwiazdki,w
                      04721       
00132C 26F6           04722       addwf       TBLPTRL,f
                      04723       
                      04724        ;a nastepnie czytam to uzywam polecenia
00132E 0008           04725       TBLRD       *
001330 50F5           04726       movf        TABLAT,w
                      04727       
                      04728       
                      04729       
                      04730 ;jezeli odczytano 0 tzn ze bylem na gorze ekranu (pierwsze polecenie)
                      04731 ; i następuje przeskok do ekranu menu 0 lub 1 
                      04732 
                      04733 
001332 A4D8           04734       btfss       STATUS,Z
001334 EF22 F00A      04735       goto         wykryto_up_zmiana_polozeni_gwiaz
                      04736       
                      04737       ;polozenie_gwiazdki == 4 bo gwiazdka jest na dole opcji ekranu poprzedniego
                      04738       
001338 0E04           04739       movlw       4
00133A 6FEB           04740       movwf       polozenie_gwiazdki
                      04741       
                      04742       
00133C 07EA           04743       decf        numer_opcji,f
                      04744       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 109


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04745       ;czyszczenie ekranu
00133E EC61 F001      04746       call        check_busy
001342 0E01           04747       movlw       display_clear
001344 EC23 F001      04748       call        send
001348 EC61 F001      04749       call        check_busy
                      04750       
                      04751            
                      04752       
                      04753       ;zaznaczam ze wyświetlam kolejny ekran opcji
                      04754       
                      04755       
00134C B1E9           04756       btfsc       pozycja_menu,menu_opcje1 ;(tj zaznaczony jet bit wskazujący na pokazywanie opcji ekra
                            nu 1, czyli przeskok do ekranu koncowego)
00134E EF0A F00A      04757       goto        wykr_up_wyswietl_opcje_tabl_end
                      04758       
                      04759       
                      04760       
                      04761       
                      04762       
001352 90D8           04763       bcf         STATUS,C
001354 33E9           04764       rrcf       pozycja_menu,f
                      04765       
                      04766 ;########################################## WAZNE
                      04767 ;jeżeli będzie więcej ekrnów opcji menu, to tu należy dodać procedurę wykrywania adres której ta
                            blicy jest używany do wyświetlania opcji
                      04768        
                      04769       ;gdy wyświetlam opcje ekranu 2 - tzn gwiazdka byla na górze opcji linii pierwszej ekranu 2
                      04770       
                      04771       ;jeżeli po przesunięciu zaznaczony jest bit menu_opcje1 to wyswietl menu_opcje1
001356 B1E9           04772       btfsc       pozycja_menu,menu_opcje1 ;(tj zaznaczony jet bit wskazujący na pokazywanie opcji ekra
                            nu 1, czyli przeskok do ekranu 0)
001358 EFBA F009      04773       goto        wykr_up_wysw_opcje_tab_pierwsza
                      04774       
                      04775       
00135C B3E9           04776       btfsc       pozycja_menu,menu_opcje2 ;(tj zaznaczony jet bit wskazujący na pokazywanie opcji ekra
                            nu 1, czyli przeskok do ekranu 0)
00135E EFCE F009      04777       goto        wyk_up_wyswietl_opcje_tabl_dwa
                      04778 
001362 B5E9           04779       btfsc       pozycja_menu,menu_opcje3 ;(tj zaznaczony jet bit wskazujący na pokazywanie opcji ekra
                            nu 1, czyli przeskok do ekranu 0)
001364 EFE2 F009      04780       goto        wykr_up_wyswietl_opcje_tab_trzy
                      04781       
001368 B7E9           04782       btfsc       pozycja_menu,menu_opcje4 ;(tj zaznaczony jet bit wskazujący na pokazywanie opcji ekra
                            nu 1, czyli przeskok do ekranu 0)
00136A EFF6 F009      04783       goto        wykr_up_wysw_opcje_tabli_cztery
                      04784       
                      04785 
00136E B9E9           04786       btfsc       pozycja_menu,menu_opcje5 
                      04787       ;(tj zaznaczony jet bit wskazujący na pokazywanie opcji ekranu 1, czyli przeskok do ekranu 0)
001370 EF0A F00A      04788       goto        wykr_up_wyswietl_opcje_tabl_5
                      04789       
                      04790       
                      04791       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 110


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04792       
                      04793 ; wykryto_up_wyswietl_opcje_tablicy_pierwsza
001374                04794 wykr_up_wysw_opcje_tab_pierwsza
001374 0E1E           04795       movlw       HIGH tablica_pierwsza
001376 6EF7           04796       movwf       TBLPTRH
                      04797       
001378 0E08           04798       movlw       LOW tablica_pierwsza
00137A 6EF6           04799       movwf       TBLPTRL
                      04800       
00137C ECCC F00B      04801       call        wyswietl_opcje_menu
                      04802       
                      04803       ;wyswietlam gwiazdke na linii ostatniej poprzedniego ekranu
001380 EC61 F001      04804       call        check_busy
001384 0ED0           04805       movlw       linia_czwarta
                      04806       
001386 EC23 F001      04807       call        send
00138A EC61 F001      04808       call        check_busy
00138E 0E2A           04809       movlw       _star
001390 EC34 F001      04810       call        write_lcd
001394 EC61 F001      04811       call        check_busy
                      04812       
001398 EFC3 F00B      04813       goto        wykryto_up_exit
                      04814       
                      04815            
                      04816 ; wykryto_up_wyswietl_opcje_tablicy_dwa
00139C                04817 wyk_up_wyswietl_opcje_tabl_dwa
                      04818       ;tu jest przeskok z numeru opcji 1 do ostatniej możliwej czyli 8
                      04819       
                      04820       ;wyświetlam opcje ekranu 2
                      04821       
                      04822       
00139C 0E1E           04823       movlw       HIGH tablica_druga
00139E 6EF7           04824       movwf       TBLPTRH
                      04825       
0013A0 0E2A           04826       movlw       LOW tablica_druga
0013A2 6EF6           04827       movwf       TBLPTRL
                      04828       
0013A4 ECCC F00B      04829       call        wyswietl_opcje_menu
                      04830       
                      04831       ;wyswietlam gwiazdke na linii ostatniej poprzedniego ekranu
0013A8 EC61 F001      04832       call        check_busy
0013AC 0ED0           04833       movlw       linia_czwarta
0013AE EC23 F001      04834       call        send
                      04835       
0013B2 EC61 F001      04836       call        check_busy
0013B6 0E2A           04837       movlw       _star
0013B8 EC34 F001      04838       call        write_lcd
0013BC EC61 F001      04839       call        check_busy
                      04840       
0013C0 EFC3 F00B      04841       goto        wykryto_up_exit
                      04842 
                      04843 
                      04844 ; wykryto_up_wyswietl_opcje_tablicy_trzy
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 111


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0013C4                04845 wykr_up_wyswietl_opcje_tab_trzy
                      04846       
0013C4 0E1E           04847       movlw       HIGH tablica_trzecia
0013C6 6EF7           04848       movwf       TBLPTRH
                      04849       
0013C8 0E4A           04850       movlw       LOW tablica_trzecia
0013CA 6EF6           04851       movwf       TBLPTRL
                      04852             
0013CC ECCC F00B      04853       call        wyswietl_opcje_menu
                      04854       
0013D0 EC61 F001      04855       call        check_busy
0013D4 0ED0           04856       movlw       linia_czwarta      
0013D6 EC23 F001      04857       call        send
                      04858       
0013DA EC61 F001      04859       call        check_busy
0013DE 0E2A           04860       movlw       _star
0013E0 EC34 F001      04861       call        write_lcd
0013E4 EC61 F001      04862       call        check_busy
                      04863       
0013E8 EF78 F009      04864       goto        wykryto_down_exit
                      04865 
                      04866 
                      04867 ; wykryto_up_wyswietl_opcje_tablicy_cztery
0013EC                04868 wykr_up_wysw_opcje_tabli_cztery
                      04869       
0013EC 0E1E           04870       movlw       HIGH tablica_czwarta
0013EE 6EF7           04871       movwf       TBLPTRH
                      04872       
0013F0 0E70           04873       movlw       LOW tablica_czwarta
0013F2 6EF6           04874       movwf       TBLPTRL
                      04875             
0013F4 ECCC F00B      04876       call        wyswietl_opcje_menu
                      04877       
0013F8 EC61 F001      04878       call        check_busy
0013FC 0ED0           04879       movlw       linia_czwarta      
0013FE EC23 F001      04880       call        send
                      04881       
001402 EC61 F001      04882       call        check_busy
001406 0E2A           04883       movlw       _star
001408 EC34 F001      04884       call        write_lcd
00140C EC61 F001      04885       call        check_busy
                      04886       
001410 EF78 F009      04887       goto        wykryto_down_exit
                      04888 
                      04889 
                      04890 
                      04891 ; wykryto_up_wyswietl_opcje_tablicy_end      
001414                04892 wykr_up_wyswietl_opcje_tabl_end      
                      04893 ; wykryto_up_wyswietl_opcje_tablicy_piata
001414                04894 wykr_up_wyswietl_opcje_tabl_5
                      04895 
001414 0E14           04896       movlw       numer_opcji_koncowej    
001416 6FEA           04897       movwf       numer_opcji
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 112


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001418 6BE9           04898       clrf        pozycja_menu
00141A 89E9           04899       bsf         pozycja_menu,(menu_opcje_end-1)
                      04900 
00141C 0E1E           04901       movlw       HIGH tablica_piata
00141E 6EF7           04902       movwf       TBLPTRH
                      04903       
001420 0E98           04904       movlw       LOW tablica_piata
001422 6EF6           04905       movwf       TBLPTRL
                      04906       
                      04907       
001424 ECCC F00B      04908       call        wyswietl_opcje_menu
                      04909       
001428 EC61 F001      04910       call        check_busy
00142C 0ED0           04911       movlw       linia_czwarta      
00142E EC23 F001      04912       call        send
                      04913       
001432 EC61 F001      04914       call        check_busy
001436 0E2A           04915       movlw       _star
001438 EC34 F001      04916       call        write_lcd
00143C EC61 F001      04917       call        check_busy
                      04918       
001440 EF78 F009      04919       goto        wykryto_down_exit
                      04920       
                      04921       
                      04922       
                      04923 ; wykryto_up_zmiana_polozenia_gwiazdki
001444                04924 wykryto_up_zmiana_polozeni_gwiaz
                      04925 
                      04926       ;opcje zmnieniaja się o tą położoną wyżej
001444 07EA           04927       decf        numer_opcji,f
                      04928       
                      04929       ;nowa gwiazdka jest rysowana w miejscu odczytanym z tablicy
                      04930       
001446 EC61 F001      04931       call     check_busy
00144A 50F5           04932       movf        TABLAT,w
00144C EC23 F001      04933       call        send
                      04934       
001450 EC61 F001      04935       call     check_busy
001454 0E2A           04936       movlw       _star
001456 EC34 F001      04937       call        write_lcd
00145A EC61 F001      04938       call     check_busy
                      04939       ;gwiazdka poprzednia jest kasowana - tzn znow czytam z tablicy ale tym razem polozenie poprzednie
                      04940       
                      04941       
00145E 2AF6           04942       incf        TBLPTRL,f
001460 0008           04943       TBLRD *
001462 50F5           04944       movf        TABLAT,w
001464 EC23 F001      04945       call        send
001468 EC61 F001      04946       call     check_busy
00146C 0E20           04947       movlw       _puste
00146E EC34 F001      04948       call        write_lcd
                      04949       
001472 06F6           04950       decf        TBLPTRL,f
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 113


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04951       
001474 EFC3 F00B      04952       goto        wykryto_up_exit
                      04953 
                      04954 
                      04955       
                      04956       
                      04957       
                      04958       
                      04959       
                      04960       
                      04961       
                      04962       
                      04963       
                      04964       
                      04965       
                      04966       
                      04967       
                      04968       
                      04969       
                      04970       
                      04971       
                      04972       
                      04973       
                      04974       
                      04975       
                      04976       
                      04977       
                      04978 ;#########################################KLAWISZ UP
                      04979 ;ZMIANA Opcji
                      04980 
                      04981 
                      04982 ;opcja 1      
                      04983 
001478                04984 wykryto_up_zmiana_opcji
                      04985 
                      04986 ;sprawdz którą opcję zmieniam
001478 0E01           04987       movlw       opcja_czujniki
00147A 63EA           04988       cpfseq      numer_opcji
00147C EF54 F00A      04989       goto          wykryto_up_sprawdz_2
                      04990       
                      04991       ;jeżeli zmieniam ilość obsługiwanych czujników temp
                      04992       ;to tu powinno być zmiana o 1 ilości kanałów 
                      04993       ;i sprawdzenie czy nie przekroczyłem dopuszczalnych 8
001480 2BAC           04994       incf        ile_kanalow,f
001482 0E09           04995       movlw      9
                      04996       
001484 63AC           04997       cpfseq      ile_kanalow
001486 EF46 F00A      04998       goto         wykr_up_zmiana_opcji_wysw_kanaly
                      04999       
00148A 6BAC           05000       clrf              ile_kanalow
                      05001 
                      05002 ; wykryto_up_zmiana_opcji_wyswietl_kanaly
00148C                05003 wykr_up_zmiana_opcji_wysw_kanaly
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 114


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05004 
00148C EC61 F001      05005       call     check_busy
001490 0E80           05006       movlw    linia_gorna
001492 0F0A           05007       addlw     polozenie_liczby_menu 
001494 EC23 F001      05008       call      send
                      05009       ;
001498 EC61 F001      05010       call     check_busy
00149C 51AC           05011       movf        ile_kanalow,w
00149E 0F30           05012       addlw       0x30
0014A0 EC34 F001      05013       call        write_lcd
                      05014       
0014A4 EFC3 F00B      05015       goto        wykryto_up_exit
                      05016       
                      05017 
                      05018 
                      05019 
                      05020 
                      05021 
                      05022 
                      05023 ;numery opcji odpowiadają położeniu opcji w menu
                      05024 
                      05025 
                      05026       
0014A8                05027 wykryto_up_sprawdz_2
0014A8 0E02           05028       movlw       opcja_odstep
0014AA 63EA           05029       cpfseq      numer_opcji
0014AC EF64 F00A      05030       goto        wykryto_up_sprawdz_3
                      05031 
0014B0 2BAD           05032       incf        odstep_pomiarowy,f
0014B2 51AD           05033       movf        odstep_pomiarowy,w
                      05034       
0014B4 6F92           05035       movwf       tmp_hex
0014B6 6B93           05036       clrf        tmp_hex_H
0014B8 6B98           05037       clrf        dec1
0014BA 6B97           05038       clrf        dec10
0014BC EC87 F002      05039       call        hex2dec18
                      05040 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      05041       ;wyświetlam obok nazwy opcji czyli 
0014C0 ECED F00D      05042       call        wykr_enter_gdzie_wysw_licz_bajt
                      05043       
                      05044       
0014C4 EFC3 F00B      05045       goto        wykryto_up_exit
                      05046       
                      05047       
                      05048 
                      05049 
                      05050 
                      05051       
                      05052       
0014C8                05053 wykryto_up_sprawdz_3
0014C8 0E03           05054       movlw       opcja_srednia
0014CA 63EA           05055       cpfseq      numer_opcji
0014CC EF83 F00A      05056       goto        wykryto_up_sprawdz_4
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 115


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05057       
                      05058       ;sprawdz czy liczba próbek == 128 (0x80)
0014D0 0E80           05059       movlw       0x80
0014D2 63AE           05060       cpfseq      jak_duzo_probek
0014D4 EF71 F00A      05061       goto        wykryto_up_spr_3_zwieksz_probki
                      05062       ;zmieniam liczbe próbek na 1
0014D8 0E01           05063       movlw       1
0014DA 6FAE           05064       movwf       jak_duzo_probek
0014DC 919F           05065       bcf      markers,czy_usrednianie
                      05066       
0014DE EF78 F00A      05067       goto        wykryto_up_3_wyswietl
                      05068       
0014E2                05069 wykryto_up_spr_3_zwieksz_probki
0014E2 819F           05070       bsf      markers,czy_usrednianie
0014E4 0E02           05071       movlw       0x02
0014E6 03AE           05072       mulwf       jak_duzo_probek
0014E8 50F3           05073       movf        PRODL,w
0014EA 6FAE           05074       movwf       jak_duzo_probek
                      05075       
0014EC ECB6 F003      05076       call     ustaw_wartosc_dziel_usredniania      
                      05077       
0014F0                05078 wykryto_up_3_wyswietl
0014F0 51AE           05079       movf        jak_duzo_probek,w
0014F2 6F92           05080       movwf       tmp_hex
0014F4 6B93           05081       clrf        tmp_hex_H
0014F6 6B98           05082       clrf        dec1
0014F8 6B97           05083       clrf        dec10
0014FA EC87 F002      05084       call        hex2dec18
                      05085 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      05086       ;wyświetlam obok nazwy opcji czyli 
0014FE ECED F00D      05087       call        wykr_enter_gdzie_wysw_licz_bajt
                      05088       
001502 EFC3 F00B      05089       goto        wykryto_up_exit
                      05090             
                      05091 
001506                05092 wykryto_up_sprawdz_4
                      05093 ;pomiar pradu
                      05094 
                      05095 
001506                05096 wykryto_up_sprawdz_5
001506 0E05           05097       movlw       opcja_ustaw_temp_R1
001508 63EA           05098       cpfseq      numer_opcji
00150A EF93 F00A      05099       goto        wykryto_up_sprawdz_6
                      05100       
                      05101             
00150E 2BB0           05102       incf        jaka_wartosc_regulujeL1,f
                      05103       
001510 E306           05104       bnc         wykryto_up_sprawdz_5_dalej
                      05105       ;czy  przekroczono 0x200
                      05106             
001512 2BAF           05107       incf        jaka_wartosc_regulujeH1,f
                      05108       
001514 0E02           05109       movlw       0x02
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 116


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001516 63AF           05110       cpfseq      jaka_wartosc_regulujeH1
001518 EF8F F00A      05111       goto        wykryto_up_sprawdz_5_dalej
                      05112       
                      05113       
                      05114       ;jeżeli w H jest 3 to wyzeruj 
00151C 6BAF           05115       clrf       jaka_wartosc_regulujeH1
                      05116       
                      05117       
00151E                05118 wykryto_up_sprawdz_5_dalej
                      05119                                                 ; movf        jaka_wartosc_regulujeL,w
                      05120                                                 ; movwf       tmp_hex
                      05121                                                 ; movf        jaka_wartosc_regulujeH,w
                      05122                                                 ; movwf        tmp_hex_H
                      05123                                                 ; clrf        dec1
                      05124                                                 ; clrf        dec10
                      05125                                                 ; call        hex2dec18
                      05126                                           ;czyli zawartość rejestru jest zamieniana na postać dziesi
                            tną i przenoszonona do dec100 dec10 dec1
                      05127                                            ;     wyświetlam obok nazwy opcji czyli 
                      05128                                                 ; call        wykryto_enter_gdzie_wyswietlam_liczbe_bajt
                            owa
                      05129       
00151E EC77 F00C      05130       call  wyswietl_temp_w_opcjach
                      05131       
                      05132       
001522 EF78 F009      05133       goto        wykryto_down_exit
                      05134       
                      05135       
                      05136       
                      05137       
                      05138       
001526                05139 wykryto_up_sprawdz_6
                      05140 
001526 0E06           05141          movlw       opcja_ustaw_temp_R2
001528 63EA           05142       cpfseq      numer_opcji
00152A EFA3 F00A      05143       goto        wykryto_up_sprawdz_7
                      05144       
                      05145             
00152E 2BB2           05146       incf        jaka_wartosc_regulujeL2,f
                      05147       
001530 E306           05148       bnc         wykryto_up_sprawdz_6_dalej
                      05149       ;czy  przekroczono 0x200
                      05150             
001532 2BB1           05151       incf        jaka_wartosc_regulujeH2,f
                      05152       
001534 0E02           05153       movlw       0x02
001536 63B1           05154       cpfseq      jaka_wartosc_regulujeH2
001538 EF9F F00A      05155       goto        wykryto_up_sprawdz_6_dalej
                      05156       
                      05157       
                      05158       ;jeżeli w H jest 3 to wyzeruj 
00153C 6BB1           05159       clrf       jaka_wartosc_regulujeH2
                      05160       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 117


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05161       
00153E                05162 wykryto_up_sprawdz_6_dalej
                      05163                                                 ; movf        jaka_wartosc_regulujeL,w
                      05164                                                 ; movwf       tmp_hex
                      05165                                                 ; movf        jaka_wartosc_regulujeH,w
                      05166                                                 ; movwf        tmp_hex_H
                      05167                                                 ; clrf        dec1
                      05168                                                 ; clrf        dec10
                      05169                                                 ; call        hex2dec18
                      05170                                           ;czyli zawartość rejestru jest zamieniana na postać dziesi
                            tną i przenoszonona do dec100 dec10 dec1
                      05171                                            ;     wyświetlam obok nazwy opcji czyli 
                      05172                                                 ; call        wykryto_enter_gdzie_wyswietlam_liczbe_bajt
                            owa
                      05173       
00153E EC9A F00C      05174       call  wyswietl_temp_w_opcjach2
                      05175       
                      05176       
001542 EF78 F009      05177       goto        wykryto_down_exit
                      05178 
                      05179 
                      05180 
001546                05181 wykryto_up_sprawdz_7
                      05182 
                      05183 
001546                05184 wykryto_up_sprawdz_9
                      05185 ;górna histereza 
001546 0E09           05186       movlw       opcja_histereza_R1_1
001548 63EA           05187       cpfseq      numer_opcji
00154A EFB3 F00A      05188       goto        wykryto_up_sprawdz_10
                      05189       
                      05190       ;wlacz pomiar pradu
                      05191       ;jako test wlacz podswietlenie lub je wylacz
                      05192       
                      05193       ;btg   portlampka2,lampka2
00154E 2BB3           05194       incf        histereza_R1_1,f
                      05195       
001550 51B3           05196       movf        histereza_R1_1,w
001552 6F92           05197       movwf       tmp_hex
                      05198       
001554 6B93           05199       clrf        tmp_hex_H
001556 6B98           05200       clrf        dec1
001558 6B97           05201       clrf        dec10
00155A EC87 F002      05202       call        hex2dec18
                      05203 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      05204       ;wyświetlam obok nazwy opcji czyli 
00155E ECED F00D      05205       call        wykr_enter_gdzie_wysw_licz_bajt
                      05206       
001562 EFC3 F00B      05207       goto        wykryto_up_exit     
                      05208       
001566                05209 wykryto_up_sprawdz_10
                      05210 ;dolna histereza 
001566 0E0A           05211       movlw       opcja_histereza_R1_2
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 118


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001568 63EA           05212       cpfseq      numer_opcji
00156A EFC3 F00A      05213       goto        wykryto_up_sprawdz_11
                      05214       
                      05215       ;wlacz pomiar pradu
                      05216       ;jako test wlacz podswietlenie lub je wylacz
                      05217       
                      05218       ;btg   portlampka2,lampka2
00156E 2BB4           05219       incf        histereza_R1_2,f
                      05220       
001570 51B4           05221       movf        histereza_R1_2,w
001572 6F92           05222       movwf       tmp_hex
                      05223       
001574 6B93           05224       clrf        tmp_hex_H
001576 6B98           05225       clrf        dec1
001578 6B97           05226       clrf        dec10
00157A EC87 F002      05227       call        hex2dec18
                      05228 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      05229       ;wyświetlam obok nazwy opcji czyli 
00157E ECED F00D      05230       call        wykr_enter_gdzie_wysw_licz_bajt
                      05231       
001582 EFC3 F00B      05232       goto        wykryto_up_exit     
                      05233 
                      05234       
                      05235       
                      05236 
                      05237 
001586                05238 wykryto_up_sprawdz_11
                      05239 ;dolna histereza 
001586 0E0B           05240       movlw       opcja_histereza_R2_1
001588 63EA           05241       cpfseq      numer_opcji
00158A EFD3 F00A      05242       goto        wykryto_up_sprawdz_12
                      05243       
                      05244       ;wlacz pomiar pradu
                      05245       ;jako test wlacz podswietlenie lub je wylacz
                      05246       
                      05247       ;btg   portlampka2,lampka2
00158E 2BB5           05248       incf        histereza_R2_1,f
                      05249       
001590 51B5           05250       movf        histereza_R2_1,w
001592 6F92           05251       movwf       tmp_hex
                      05252       
001594 6B93           05253       clrf        tmp_hex_H
001596 6B98           05254       clrf        dec1
001598 6B97           05255       clrf        dec10
00159A EC87 F002      05256       call        hex2dec18
                      05257 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      05258       ;wyświetlam obok nazwy opcji czyli 
00159E ECED F00D      05259       call        wykr_enter_gdzie_wysw_licz_bajt
                      05260       
0015A2 EFC3 F00B      05261       goto        wykryto_up_exit     
                      05262 
                      05263 
                      05264 
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 119


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05265 
                      05266 
0015A6                05267 wykryto_up_sprawdz_12
                      05268 ;dolna histereza 
0015A6 0E0C           05269       movlw       opcja_histereza_R2_2
0015A8 63EA           05270       cpfseq      numer_opcji
0015AA EF09 F00B      05271       goto        wykryto_up_sprawdz_13
                      05272       
                      05273       ;wlacz pomiar pradu
                      05274       ;jako test wlacz podswietlenie lub je wylacz
                      05275       
                      05276       ;btg   portlampka2,lampka2
0015AE 2BB6           05277       incf        histereza_R2_2,f
                      05278       
0015B0 51B6           05279       movf        histereza_R2_2,w
0015B2 6F92           05280       movwf       tmp_hex
                      05281       
0015B4 6B93           05282       clrf        tmp_hex_H
0015B6 6B98           05283       clrf        dec1
0015B8 6B97           05284       clrf        dec10
0015BA EC87 F002      05285       call        hex2dec18
                      05286 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      05287       ;wyświetlam obok nazwy opcji czyli 
0015BE ECED F00D      05288       call        wykr_enter_gdzie_wysw_licz_bajt
                      05289       
0015C2 EFC3 F00B      05290       goto        wykryto_up_exit     
                      05291 
                      05292 
0015C6                05293 wyswietl_opcje_regulacji      
                      05294 ;jezeli jest 1 to wyswietl h
                      05295         ;jezeli jest 2 to wyswietl c
                      05296         ;jezeli jest 0 to wyswietl 0
                      05297 
                      05298       
0015C6 0E01           05299         movlw   1
0015C8 62DF           05300         cpfseq   INDF2
0015CA EFE9 F00A      05301         goto    wyswietl_opcje_regulacji1
                      05302         
0015CE 0E38           05303         movlw   _h-0x30
0015D0 6F96           05304         movwf       dec100
                      05305         
0015D2                05306 wyswietl_opcje_regulacji1        
0015D2 0E02           05307         movlw   2
0015D4 62DF           05308         cpfseq   INDF2
0015D6 EFEF F00A      05309         goto    wyswietl_opcje_regulacji2
                      05310                 
0015DA 0E33           05311         movlw   _c-0x30
0015DC 6F96           05312         movwf       dec100
                      05313 
                      05314         
                      05315                 
0015DE                05316 wyswietl_opcje_regulacji2      
0015DE 0E00           05317        movlw    0
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 120


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0015E0 62DF           05318        cpfseq   INDF2
0015E2 EF01 F00B      05319        goto     wyswietl_opcje_regulacji3
                      05320        
0015E6 0E00           05321       movlw     0
0015E8 6F96           05322       movwf       dec100
                      05323       
                      05324       ;jesli juz wylaczam to wylacz triaki
0015EA 0EB7           05325       movlw     czy_reguluje1
0015EC 62D9           05326       cpfseq    FSR2L
0015EE EFFC F00A      05327       goto      spr_czy_wylaczyc_triak
                      05328       
0015F2 9081           05329       bcf       port_triak,triak1
0015F4 EF01 F00B      05330       goto      wyswietl_opcje_regulacji3
0015F8                05331 spr_czy_wylaczyc_triak
0015F8 0EB8           05332         movlw     czy_reguluje2
0015FA 62D9           05333       cpfseq    FSR2L
0015FC EF01 F00B      05334       goto      wyswietl_opcje_regulacji3
                      05335       
001600 9281           05336       bcf       port_triak,triak2
                      05337       
                      05338       
                      05339       
001602                05340 wyswietl_opcje_regulacji3      
001602 6B93           05341       clrf        tmp_hex_H
001604 0EF0           05342       movlw       _puste-0x30
001606 6F98           05343       movwf       dec1
001608 0EF0           05344       movlw       _puste-0x30
00160A 6F97           05345       movwf       dec10
                      05346       
                      05347 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      05348       ;wyświetlam obok nazwy opcji czyli 
00160C ECED F00D      05349       call        wykr_enter_gdzie_wysw_licz_bajt
                      05350       
001610 0012           05351       return    
                      05352       
                      05353       
                      05354       
                      05355       
001612                05356 wykryto_up_sprawdz_13
001612 0E0D           05357       movlw       opcja_regulacja1
001614 63EA           05358       cpfseq      numer_opcji
001616 EF19 F00B      05359       goto        wykryto_up_sprawdz_14
                      05360       
                      05361       
00161A 2BB7           05362       incf        czy_reguluje1,f
                      05363       
00161C 0E02           05364       movlw      max_procedury_regu-1
                      05365       
                      05366       ; cpfseq      czy_reguluje1
00161E 65B7           05367       cpfsgt      czy_reguluje1
001620 EF13 F00B      05368       goto         wykryto_up_sprawdz_13_dalej
                      05369       
001624 6BB7           05370       clrf              czy_reguluje1
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 121


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05371 
                      05372 
                      05373       
001626                05374 wykryto_up_sprawdz_13_dalej
001626 EE20 F0B7      05375       lfsr      FSR2,czy_reguluje1
00162A ECE3 F00A      05376       call      wyswietl_opcje_regulacji
                      05377       
                      05378       
00162E EFC3 F00B      05379       goto        wykryto_up_exit     
                      05380 
                      05381 
                      05382 
                      05383 
001632                05384 wykryto_up_sprawdz_14
001632 0E0E           05385       movlw       opcja_regulacja2
001634 63EA           05386       cpfseq      numer_opcji
001636 EF29 F00B      05387       goto        wykryto_up_sprawdz_15
                      05388       
                      05389       
00163A 2BB8           05390       incf        czy_reguluje2,f
                      05391       
00163C 0E02           05392       movlw      max_procedury_regu-1
                      05393       
                      05394       ; cpfseq      czy_reguluje1
                      05395       ; cpfsgt      czy_reguluje1
                      05396       
00163E 65B8           05397       cpfsgt      czy_reguluje2
001640 EF23 F00B      05398       goto         wykryto_up_sprawdz_14_dalej
                      05399       
001644 6BB8           05400       clrf              czy_reguluje2
001646                05401 wykryto_up_sprawdz_14_dalej
001646 EE20 F0B8      05402       lfsr      FSR2,czy_reguluje2
00164A ECE3 F00A      05403       call      wyswietl_opcje_regulacji
                      05404 
                      05405       
00164E EFC3 F00B      05406       goto        wykryto_up_exit     
                      05407       
                      05408       
001652                05409 wykryto_up_sprawdz_15 
001652 0E0F           05410       movlw      opcja_czujnik_regulacji1 
001654 63EA           05411       cpfseq      numer_opcji
001656 EF41 F00B      05412       goto        wykryto_up_sprawdz_16
                      05413       
                      05414       ;jezeli juz jest ustawiona ilosc czujnikow to zeruj
                      05415       
00165A 0E06           05416       movlw       ilosc_czujnikow-1
00165C 5DB9           05417       subwf       ktory_czujnik_reguluje1,w
                      05418       ;jesli ktory czujnik jest wiekszy to C jest ustawione
                      05419       ; cpfsgt      ktory_czujnik_reguluje1
                      05420       
                      05421       
00165E A0D8           05422       btfss     STATUS,C
001660 EF35 F00B      05423       goto        wykryto_up_sprawdz15_increase
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 122


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05424       
001664 6BB9           05425       clrf        ktory_czujnik_reguluje1
001666 EF36 F00B      05426       goto        wykryto_up_sprawdz15_show
                      05427       
00166A                05428 wykryto_up_sprawdz15_increase      
00166A 2BB9           05429       incf        ktory_czujnik_reguluje1,f
                      05430       
                      05431             
                      05432       
00166C                05433 wykryto_up_sprawdz15_show      
00166C 51B9           05434       movf        ktory_czujnik_reguluje1,w
00166E 6F92           05435       movwf       tmp_hex
                      05436       
001670 6B93           05437       clrf        tmp_hex_H
001672 6B98           05438       clrf        dec1
001674 6B97           05439       clrf        dec10
001676 EC87 F002      05440       call        hex2dec18
                      05441 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      05442       ;wyświetlam obok nazwy opcji czyli 
00167A ECED F00D      05443       call        wykr_enter_gdzie_wysw_licz_bajt
                      05444       
00167E EFC3 F00B      05445       goto        wykryto_up_exit       
                      05446       
                      05447       
                      05448       
                      05449       
                      05450       
                      05451       
                      05452       
                      05453       
                      05454       
                      05455       
                      05456       
                      05457       
                      05458       
                      05459 
                      05460       
001682                05461 wykryto_up_sprawdz_16
                      05462      
001682 0E10           05463          movlw      opcja_czujnik_regulacji2
001684 63EA           05464       cpfseq      numer_opcji
001686 EF58 F00B      05465       goto        wykryto_up_sprawdz_17
                      05466       
                      05467       ;jezeli juz jest ustawiona ilosc czujnikow to zeruj
                      05468       
00168A 0E06           05469       movlw       ilosc_czujnikow-1
00168C 65BA           05470       cpfsgt      ktory_czujnik_reguluje2
00168E EF4C F00B      05471       goto        wykryto_up_sprawdz16_increase
                      05472       
001692 6BBA           05473       clrf        ktory_czujnik_reguluje2
001694 EF4D F00B      05474       goto        wykryto_up_sprawdz16_show
                      05475       
001698                05476 wykryto_up_sprawdz16_increase      
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 123


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001698 2BBA           05477       incf        ktory_czujnik_reguluje2,f
                      05478       
                      05479       
00169A                05480 wykryto_up_sprawdz16_show      
00169A 51BA           05481       movf        ktory_czujnik_reguluje2,w
00169C 6F92           05482       movwf       tmp_hex
                      05483       
00169E 6B93           05484       clrf        tmp_hex_H
0016A0 6B98           05485       clrf        dec1
0016A2 6B97           05486       clrf        dec10
0016A4 EC87 F002      05487       call        hex2dec18
                      05488 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      05489       ;wyświetlam obok nazwy opcji czyli 
0016A8 ECED F00D      05490       call        wykr_enter_gdzie_wysw_licz_bajt
                      05491       
0016AC EFC3 F00B      05492       goto        wykryto_up_exit       
                      05493       
                      05494      
                      05495      
                      05496      
0016B0                05497 wykryto_up_sprawdz_17
                      05498      
                      05499 
0016B0                05500 wykryto_up_sprawdz_20
                      05501 ;ustawienia zegara
0016B0 0E14           05502       movlw       opcja_ustaw_zegar
0016B2 63EA           05503       cpfseq      numer_opcji
0016B4 EFC3 F00B      05504       goto        wykryto_up_sprawdz_21
                      05505       
                      05506 ;sprawdzenie która wielkość zegara podlega zmianie
                      05507 ;jeżeli dzien_10 to zmniejszam o jeden dzien_1
                      05508 ;problem polega na tym, że nie mogę skorzystać z FSR2 bo  każda z wielkości
                      05509 ;czasu musi być indywidualnie rozpatrywana
0016B8 0EE0           05510       movlw       dzien_10
0016BA 63EF           05511       cpfseq      ustawianie_czasu_co_wyswietlam
0016BC EF75 F00B      05512       goto        wykryto_up_sprawdz_20_1
                      05513 
                      05514 ;jeżeli dzień_1 jest 9 (0x39) to jeżeli dzien_10 <> 0x39 zwieksz dzien_10
                      05515 
0016C0 0E39           05516       movlw       0x39
0016C2 63E1           05517       cpfseq      dzien_1
0016C4 EF72 F00B      05518       goto        zwieksz_dzien_1
                      05519       
                      05520       ;sprawdz czy dzien_10 == 0x39
0016C8 0E39           05521       movlw       0x39
0016CA 63E0           05522       cpfseq      dzien_10
0016CC EF6D F00B      05523       goto        zapisz_do_dzien_1_0
                      05524       
0016D0 0E30           05525       movlw       0x30 
0016D2 6FE1           05526       movwf       dzien_1            
0016D4 6FE0           05527       movwf       dzien_10
                      05528       
0016D6 EFBF F00B      05529       goto        wykryto_up_sprawdz_20_4
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 124


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05530       
0016DA                05531 zapisz_do_dzien_1_0
0016DA 0E30           05532       movlw       0x30
0016DC 6FE1           05533       movwf       dzien_1
0016DE 2BE0           05534       incf        dzien_10,f
0016E0 EFBF F00B      05535       goto        wykryto_up_sprawdz_20_4
                      05536       
                      05537       
0016E4                05538 zwieksz_dzien_1      
0016E4 2BE1           05539       incf        dzien_1,f
                      05540       
                      05541       
0016E6 EFBF F00B      05542       goto        wykryto_up_sprawdz_20_4
                      05543       
0016EA                05544 wykryto_up_sprawdz_20_1
0016EA 0EE2           05545       movlw       godziny_10
0016EC 63EF           05546       cpfseq      ustawianie_czasu_co_wyswietlam
0016EE EF92 F00B      05547       goto        wykryto_up_sprawdz_20_2
                      05548       
                      05549       ;najpierw sprawdze czy godziny_1 i godziny_10 == 23 godzina bo wtedy wpisuje 00
0016F2 0E33           05550       movlw       0x33
0016F4 63E3           05551       cpfseq      godziny_1
0016F6 EF86 F00B      05552       goto        sprawdz_zwiekszanie_godz_normal
0016FA 0E32           05553       movlw       0x32
0016FC 63E2           05554       cpfseq      godziny_10
0016FE EF86 F00B      05555       goto        sprawdz_zwiekszanie_godz_normal
                      05556       
                      05557 ;jest godzina 23 => zapisz do godzin 00      
001702 0E30           05558       movlw       0x30
001704 6FE2           05559       movwf       godziny_10      
001706 6FE3           05560       movwf       godziny_1
001708 EFBF F00B      05561       goto        wykryto_up_sprawdz_20_4
                      05562       
00170C                05563 sprawdz_zwiekszanie_godz_normal      
00170C 0E39           05564       movlw       0x39
00170E 63E3           05565       cpfseq      godziny_1
001710 EF8F F00B      05566       goto        zwieksz_godziny_1      
                      05567 
001714 0E30           05568       movlw       0x30
001716 6FE3           05569       movwf       godziny_1
001718 2BE2           05570       incf        godziny_10,f
00171A EFBF F00B      05571       goto        wykryto_up_sprawdz_20_4
                      05572             
00171E                05573 zwieksz_godziny_1      
00171E 2BE3           05574       incf        godziny_1,f
                      05575       
                      05576       
001720 EFBF F00B      05577       goto        wykryto_up_sprawdz_20_4
                      05578       
                      05579       
001724                05580 wykryto_up_sprawdz_20_2
001724 0EE4           05581       movlw       minuty_10
001726 63EF           05582       cpfseq      ustawianie_czasu_co_wyswietlam
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 125


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001728 EFAB F00B      05583       goto        wykryto_up_sprawdz_20_3
                      05584       
                      05585       
00172C 0E39           05586       movlw       0x39
00172E 63E5           05587       cpfseq      minuty_1
001730 EFA8 F00B      05588       goto        zwieksz_minuty_1
                      05589      
001734 0E35           05590       movlw       0x35
001736 63E4           05591       cpfseq      minuty_10
001738 EFA3 F00B      05592       goto        zapisz_do_minuty_1_0
                      05593       
00173C 0E30           05594       movlw       0x30
00173E 6FE4           05595       movwf       minuty_10
001740 6FE5           05596       movwf       minuty_1
                      05597       
001742 EFBF F00B      05598       goto        wykryto_up_sprawdz_20_4
                      05599       
001746                05600 zapisz_do_minuty_1_0
001746 0E30           05601       movlw       0x30
001748 6FE5           05602       movwf       minuty_1
00174A 2BE4           05603       incf        minuty_10,f
00174C EFBF F00B      05604       goto        wykryto_up_sprawdz_20_4
                      05605       
                      05606       
001750                05607 zwieksz_minuty_1      
001750 2BE5           05608       incf        minuty_1,f
                      05609       
001752 EFBF F00B      05610       goto        wykryto_up_sprawdz_20_4
                      05611       
001756                05612 wykryto_up_sprawdz_20_3
001756 0E30           05613       movlw       0x30
001758 63E7           05614       cpfseq      sekundy_1
00175A EFBE F00B      05615       goto        zwieksz_sekundy_1
                      05616       
                      05617       ;sprawdz czy dzien_10 == 0x30
00175E 0E30           05618       movlw       0x30
001760 63E6           05619       cpfseq      sekundy_10
001762 EFB9 F00B      05620       goto        zapisz_do_sekundy_1_0
                      05621       
001766 0E35           05622       movlw       0x35
001768 6FE6           05623       movwf       sekundy_10
00176A 0E39           05624       movlw       0x39
00176C 6FE7           05625       movwf       sekundy_1
                      05626       
00176E EFBF F00B      05627       goto        wykryto_up_sprawdz_20_4
                      05628       
001772                05629 zapisz_do_sekundy_1_0
001772 0E30           05630       movlw       0x30
001774 6FE7           05631       movwf       sekundy_1
001776 2BE6           05632       incf        sekundy_10,f
001778 EFBF F00B      05633       goto        wykryto_up_sprawdz_20_4
                      05634       
                      05635       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 126


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00177C                05636 zwieksz_sekundy_1      
00177C 2BE7           05637       incf        sekundy_1,f
                      05638       
00177E                05639 wykryto_up_sprawdz_20_4            
                      05640 
00177E EC1A F00E      05641       call        proc_wyswietl_kolej_liczb_zegara
001782 EFC3 F00B      05642       goto        wykryto_up_exit
                      05643 
                      05644      
                      05645 
                      05646      
                      05647      
001786                05648 wykryto_up_sprawdz_21
                      05649      
                      05650 
                      05651      
001786                05652 wykryto_up_exit
001786 B59E           05653       btfsc   znaczniki,czy_moge_juz_zmieniac
001788 EFCA F00B      05654       goto    wykryto_up_exit_trzymanie
00178C 9BA1           05655       bcf   markers3,dzialanie_po_klawiszu
00178E 6B99           05656       clrf  stan_key
001790 EF98 F00E      05657       goto  LOOP11
                      05658  
001794                05659 wykryto_up_exit_trzymanie
001794 959E           05660       bcf     znaczniki,czy_moge_juz_zmieniac
001796 0012           05661       return      
                      05662  
                      05663 
                      05664 
                      05665 
                      05666 
                      05667 ;############################################
                      05668 ;#####
                      05669 ;######PISZ na ekranie słowa z tablicy opcji menu
                      05670 
                      05671 
001798                05672 wyswietl_opcje_menu
001798 EC61 F001      05673       call        check_busy
00179C 0E80           05674       movlw       linia_gorna
00179E 0F01           05675       addlw       1        
0017A0 EC23 F001      05676       call        send
0017A4 EC61 F001      05677       call        check_busy
0017A8                05678 czytam_pierwsza_linie
                      05679       
                      05680       ;czytam aktualny adres i zwiekszam
0017A8 0009           05681       TBLRD       *+
                      05682       
0017AA 50F5           05683       movf        TABLAT,w
                      05684       ;jezeli 0 to skocz do wyswietlania slowa z linii 2
0017AC E006           05685       bz          czytam_druga_linie
0017AE EC34 F001      05686       call        write_lcd
0017B2 EC61 F001      05687       call        check_busy
0017B6 EFD4 F00B      05688       goto        czytam_pierwsza_linie
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 127


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05689       
0017BA                05690 czytam_druga_linie
                      05691       
0017BA 0EC0           05692       movlw       linia_dolna
0017BC 0F01           05693       addlw       1        
0017BE EC23 F001      05694       call        send
0017C2 EC61 F001      05695       call        check_busy
                      05696       
0017C6                05697 czytam_druga_linie2
                      05698       ;czytam aktualny adres i zwiekszam
0017C6 0009           05699       TBLRD       *+
                      05700       
0017C8 50F5           05701       movf        TABLAT,w
                      05702       ;jezeli 0 to skocz do wyswietlania slowa z linii 2
0017CA E006           05703       bz          czytam_trzecia_linie
0017CC EC34 F001      05704       call        write_lcd
0017D0 EC61 F001      05705       call        check_busy
                      05706       
0017D4 EFE3 F00B      05707       goto        czytam_druga_linie2
                      05708       
0017D8                05709 czytam_trzecia_linie
0017D8 0E90           05710       movlw       linia_trzecia
0017DA 0F01           05711       addlw       1        
0017DC EC23 F001      05712       call        send
0017E0 EC61 F001      05713       call        check_busy
0017E4                05714 czytam_trzecia_linie2      
0017E4 0009           05715       TBLRD       *+
                      05716       
0017E6 50F5           05717       movf        TABLAT,w
                      05718       ;jezeli 0 to skocz do wyswietlania slowa z linii 2
0017E8 E006           05719       bz          czytam_4_linie
0017EA EC34 F001      05720       call        write_lcd
0017EE EC61 F001      05721       call        check_busy
                      05722       
0017F2 EFF2 F00B      05723       goto        czytam_trzecia_linie2
                      05724       
0017F6                05725 czytam_4_linie
0017F6 0ED0           05726       movlw       linia_czwarta
0017F8 0F01           05727       addlw       1        
0017FA EC23 F001      05728       call        send
0017FE EC61 F001      05729       call        check_busy
                      05730       
001802                05731 czytam_4_linie2
001802 0009           05732       TBLRD       *+
                      05733       
001804 50F5           05734       movf        TABLAT,w
                      05735       ;jezeli 0 to skocz do wyswietlania slowa z linii 2
001806 E006           05736       bz          czytam_4_linie3
001808 EC34 F001      05737       call        write_lcd
00180C EC61 F001      05738       call        check_busy
                      05739       
001810 EF01 F00C      05740       goto        czytam_4_linie2
                      05741       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 128


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001814                05742 czytam_4_linie3
001814 0012           05743       return 
                      05744  
                      05745  
                      05746  
                      05747  
                      05748  
                      05749  
                      05750  
                      05751  
                      05752  
                      05753  
                      05754  
                      05755  
                      05756  
                      05757  
                      05758  
                      05759  
                      05760  
                      05761  
                      05762  
                      05763  
                      05764  
                      05765  
                      05766  
                      05767 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; ;   
                      05768 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                                ENTER
                      05769 
001816                05770 wykryto_enter
                      05771       ;co sie dzieje jezeli wykryje ze wcisnieto i puszczono klawisz enter
                      05772       
001816 BFE9           05773       btfsc       pozycja_menu,zmiana_opcji
001818 EF5A F00D      05774       goto        wykryto_enter_zmiana_opcji
                      05775       
00181C 51E9           05776       movf        pozycja_menu,w
00181E E121           05777       bnz         spr_czy_wchodze_do_zmiany_opcji
                      05778 ;jezeli pozycja menu ==0 to po nacisnieciu klawisza enter wyswietlane sa napisy ekranu menu 0 i gwiazdka
                             w linii pierwszej przy pierwszej opcji
                      05779       
                      05780       ;wylaczam wskazywanie temperatur i czasu
001820 9B9F           05781       bcf         markers,czy_wyswietlam_temp
001822 95A1           05782       bcf         markers3,czy_zegar_wyswietlac
                      05783       
                      05784       
                      05785       
001824 EC61 F001      05786       call        check_busy
001828 0E01           05787       movlw       display_clear
00182A EC23 F001      05788       call        send
00182E EC61 F001      05789       call        check_busy
                      05790       
001832 0E01           05791       movlw       1
001834 6FE9           05792       movwf       pozycja_menu
001836 6FEB           05793       movwf       polozenie_gwiazdki
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 129


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05794       
001838 6FEA           05795       movwf        numer_opcji
                      05796             
00183A EC61 F001      05797       call        check_busy
00183E 0E80           05798       movlw       linia_gorna
                      05799       
001840 EC23 F001      05800       call        send
001844 EC61 F001      05801       call        check_busy
001848 0E2A           05802       movlw       _star
00184A EC34 F001      05803       call        write_lcd
00184E EC61 F001      05804       call        check_busy
                      05805       
                      05806       
001852 0E1E           05807       movlw       HIGH tablica_pierwsza
001854 6EF7           05808       movwf       TBLPTRH
                      05809       
001856 0E08           05810       movlw       LOW tablica_pierwsza
001858 6EF6           05811       movwf       TBLPTRL
                      05812       
00185A ECCC F00B      05813       call  wyswietl_opcje_menu
                      05814       
00185E EFDE F00D      05815       goto        wykryto_enter_exit     
                      05816       
                      05817       
                      05818       
                      05819       
                      05820       
                      05821       
                      05822       
                      05823 ;;;; numery opcji odpowiadają 
                      05824 
                      05825 ;położeniu w menu      
                      05826       
001862                05827 spr_czy_wchodze_do_zmiany_opcji
001862 0E01           05828       movlw       opcja_czujniki
001864 63EA           05829       cpfseq      numer_opcji
001866 EF44 F00C      05830       goto        wykryto_enter_sprawdz_opcje2
                      05831       ;obok nazwy opcji wypisuje aktualna ilosc mierzonych temperatur
                      05832       ;naciskanie klawiszy gora/ dół to zmiana ilości kanałów mierzonych
                      05833       ;klawisz enter lub back powoduje zatwierdzenie pomiarów 
                      05834       
                      05835       ;opcja wyboru jest umieszczona na pierwszej linii ekranu
                      05836       ;
                      05837       ;*pomiar t   2
                      05838       ;na 12 znaku linii pierwszej piszemy aktualną cyfrę kanałów
00186A EC61 F001      05839       call     check_busy
00186E 0E80           05840       movlw    linia_gorna
001870 0F0A           05841       addlw       polozenie_liczby_menu
001872 EC23 F001      05842       call      send
                      05843       ;
001876 EC61 F001      05844       call     check_busy
00187A 51AC           05845       movf        ile_kanalow,w
00187C 0F30           05846       addlw       0x30
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 130


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00187E EC34 F001      05847       call        write_lcd
                      05848             
                      05849       ;zaznaczam ze jest zmiana opcji
001882 8FE9           05850       bsf         pozycja_menu,zmiana_opcji
                      05851       
001884 EFDE F00D      05852       goto        wykryto_enter_exit
                      05853       
                      05854       
                      05855       
                      05856       
                      05857       
                      05858       
                      05859       
                      05860       
                      05861       
                      05862       
                      05863       
                      05864       
                      05865       
                      05866       
                      05867       
                      05868       
                      05869       
                      05870       
001888                05871 wykryto_enter_sprawdz_opcje2
                      05872 
001888 0E02           05873       movlw       opcja_odstep
00188A 63EA           05874       cpfseq      numer_opcji
00188C EF54 F00C      05875       goto        wykryto_enter_sprawdz_opcje3
                      05876 
                      05877       ;pokaz na ekranie ustawienie aktualne odstępu w s.
001890 51AD           05878       movf        odstep_pomiarowy,w
001892 6F92           05879       movwf       tmp_hex
001894 6B93           05880       clrf        tmp_hex_H
001896 6B98           05881       clrf        dec1
001898 6B97           05882       clrf        dec10
00189A EC87 F002      05883       call        hex2dec18
                      05884 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      05885       ;wyświetlam obok nazwy opcji czyli 
00189E ECED F00D      05886       call        wykr_enter_gdzie_wysw_licz_bajt
                      05887       
                      05888       ;zaznaczam ze jest zmiana opcji
0018A2 8FE9           05889       bsf         pozycja_menu,zmiana_opcji
                      05890       
0018A4 EFDE F00D      05891       goto        wykryto_enter_exit
                      05892       
                      05893       
                      05894       
                      05895       
                      05896       
                      05897       
                      05898       
                      05899       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 131


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05900       
                      05901       
                      05902       
                      05903       
                      05904       
                      05905       
                      05906       
                      05907       
                      05908       
0018A8                05909 wykryto_enter_sprawdz_opcje3
                      05910 ;ustaw srednia
0018A8 0E03           05911       movlw       opcja_srednia
0018AA 63EA           05912       cpfseq      numer_opcji
0018AC EF64 F00C      05913       goto        wykryto_enter_sprawdz_opcje4
                      05914 
                      05915       ;pokaz na ekranie ustawienie aktualne odstępu w s.
0018B0 51AE           05916       movf        jak_duzo_probek,w
0018B2 6F92           05917       movwf       tmp_hex
0018B4 6B93           05918       clrf        tmp_hex_H
0018B6 6B98           05919       clrf        dec1
0018B8 6B97           05920       clrf        dec10
0018BA EC87 F002      05921       call        hex2dec18
                      05922 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      05923       ;wyświetlam obok nazwy opcji czyli 
0018BE ECED F00D      05924       call        wykr_enter_gdzie_wysw_licz_bajt
                      05925       
0018C2 8FE9           05926       bsf         pozycja_menu,zmiana_opcji
                      05927       
0018C4 EFDE F00D      05928       goto        wykryto_enter_exit
                      05929       
                      05930       
                      05931       
                      05932       
0018C8                05933 wykryto_enter_sprawdz_opcje4
0018C8 0E04           05934       movlw       opcja_pomiar_i
0018CA 63EA           05935       cpfseq      numer_opcji
0018CC EF6E F00C      05936       goto        wykryto_enter_sprawdz_opcje5
                      05937       
0018D0 0E02           05938       movlw       2
0018D2 6FDE           05939       movwf       jak_duzo_kanalow_pradu
0018D4 6BDF           05940       clrf        ktory_aktualnie_kanal_pradu
                      05941       
0018D6 71A1           05942       btg   markers3,pomiary_pradu
                      05943       
                      05944       
0018D8 EFDE F00D      05945       goto        wykryto_enter_exit
                      05946      
                      05947 
                      05948 
                      05949       
                      05950       
                      05951       
                      05952       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 132


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0018DC                05953 wykryto_enter_sprawdz_opcje5
0018DC 0E05           05954       movlw       opcja_ustaw_temp_R1
0018DE 63EA           05955       cpfseq      numer_opcji
0018E0 EF91 F00C      05956       goto        wykryto_enter_sprawdz_opcje6
                      05957       
                      05958       
                      05959       
                      05960                                           ;movf        jaka_wartosc_regulujeL,w      
                      05961                                           ;movwf       tmp_hex
                      05962                                           ;movf        jaka_wartosc_regulujeH,w
                      05963                                           ;movwf        tmp_hex_H
                      05964                                           ;clrf        dec1
                      05965                                           ;clrf        dec10
                      05966                                           ;call        hex2dec18
                      05967                                           ;call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      05968                                           
0018E4 EC77 F00C      05969       call  wyswietl_temp_w_opcjach
                      05970       
0018E8 8FE9           05971       bsf         pozycja_menu,zmiana_opcji
                      05972       
0018EA EFDE F00D      05973       goto        wykryto_enter_exit
                      05974       
0018EE                05975 wyswietl_temp_w_opcjach      
0018EE 51B0           05976       movf        jaka_wartosc_regulujeL1,w
                      05977            ;dziele przez 4
0018F0 0D40           05978       mullw       0x40
                      05979       
0018F2 50F3           05980       movf        PRODL,w
0018F4 6F9D           05981       movwf       wynik01
                      05982       
                      05983       ;temperatura jest w bajcie starszym
0018F6 50F4           05984       movf        PRODH,w
0018F8 6F92           05985       movwf       tmp_hex
                      05986       
0018FA 51AF           05987       movf        jaka_wartosc_regulujeH1,w
0018FC 6F93           05988       movwf        tmp_hex_H
                      05989       
0018FE EC87 F002      05990          call     hex2dec18
                      05991          
001902 0E1E           05992          movlw       HIGH tablica_gwiazdki
001904 6EF7           05993       movwf       TBLPTRH
                      05994       
001906 0ECC           05995       movlw       LOW tablica_gwiazdki
001908 6EF6           05996       movwf       TBLPTRL
                      05997       
                      05998       ;poniewaz najpierw zmniejszam polozenie
                      05999       
00190A 51EB           06000       movf       polozenie_gwiazdki,w
                      06001       
00190C 26F6           06002       addwf       TBLPTRL,f
                      06003       
                      06004       
                      06005       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 133


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00190E EC61 F001      06006       call        check_busy
                      06007        ;a nastepnie czytam to uzywam polecenia
001912 0008           06008       TBLRD *
001914 50F5           06009       movf        TABLAT,w
                      06010   ;teraz należy do adresu lini dodać miejsce położenia cyfry 100
                      06011   
                      06012 
001916 0F0A           06013       addlw       polozenie_liczby_menu
001918 EC23 F001      06014       call        send
                      06015          
00191C EC61 F004      06016        call     wyswietl_cyfry_temperatury_opcje
                      06017       
001920 0012           06018       return
                      06019 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      06020       ;wyświetlam obok nazwy opcji czyli 
                      06021       
                      06022       
                      06023       
                      06024       
                      06025       
                      06026       
                      06027       
                      06028       
                      06029       
001922                06030 wykryto_enter_sprawdz_opcje6
001922 0E06           06031       movlw       opcja_ustaw_temp_R2
001924 63EA           06032       cpfseq      numer_opcji
001926 EFB4 F00C      06033       goto        wykryto_enter_sprawdz_opcje7
                      06034       
                      06035       
                      06036       
                      06037                                           ;movf        jaka_wartosc_regulujeL,w      
                      06038                                           ;movwf       tmp_hex
                      06039                                           ;movf        jaka_wartosc_regulujeH,w
                      06040                                           ;movwf        tmp_hex_H
                      06041                                           ;clrf        dec1
                      06042                                           ;clrf        dec10
                      06043                                           ;call        hex2dec18
                      06044                                           ;call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      06045                                           
00192A EC9A F00C      06046       call  wyswietl_temp_w_opcjach2
                      06047       
00192E 8FE9           06048       bsf         pozycja_menu,zmiana_opcji
                      06049       
001930 EFDE F00D      06050       goto        wykryto_enter_exit
                      06051       
001934                06052 wyswietl_temp_w_opcjach2      
001934 51B2           06053       movf        jaka_wartosc_regulujeL2,w
                      06054           
001936 0D40           06055       mullw       0x40
                      06056       
001938 50F3           06057       movf        PRODL,w
00193A 6F9D           06058       movwf       wynik01
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 134


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06059       
                      06060       ;temperatura jest w bajcie starszym
00193C 50F4           06061       movf        PRODH,w
00193E 6F92           06062       movwf       tmp_hex
                      06063       
001940 51B1           06064       movf        jaka_wartosc_regulujeH2,w
001942 6F93           06065       movwf        tmp_hex_H
                      06066       
001944 EC87 F002      06067          call     hex2dec18
                      06068          
001948 0E1E           06069          movlw       HIGH tablica_gwiazdki
00194A 6EF7           06070       movwf       TBLPTRH
                      06071       
00194C 0ECC           06072       movlw       LOW tablica_gwiazdki
00194E 6EF6           06073       movwf       TBLPTRL
                      06074       
                      06075       ;poniewaz najpierw zmniejszam polozenie
                      06076       
001950 51EB           06077       movf       polozenie_gwiazdki,w
                      06078       
001952 26F6           06079       addwf       TBLPTRL,f
                      06080       
                      06081       
                      06082       
001954 EC61 F001      06083       call        check_busy
                      06084        ;a nastepnie czytam to uzywam polecenia
001958 0008           06085       TBLRD *
00195A 50F5           06086       movf        TABLAT,w
                      06087   ;teraz należy do adresu lini dodać miejsce położenia cyfry 100
                      06088   
                      06089 
00195C 0F0A           06090       addlw       polozenie_liczby_menu
00195E EC23 F001      06091       call        send
                      06092          
001962 EC61 F004      06093        call     wyswietl_cyfry_temperatury_opcje
                      06094       
001966 0012           06095       return
                      06096 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      06097       ;wyświetlam obok nazwy opcji czyli 
                      06098       
                      06099       
                      06100       
                      06101       
                      06102       
                      06103       
                      06104       
                      06105       
                      06106       
                      06107       
                      06108       
                      06109       
                      06110      
                      06111      
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 135


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06112      
                      06113      
                      06114      
                      06115      
                      06116      
                      06117      
                      06118      
                      06119      
                      06120      
                      06121      
                      06122      
                      06123      
                      06124      
                      06125      
                      06126      
                      06127      
                      06128      
                      06129      
                      06130      
                      06131      
                      06132      
001968                06133 wykryto_enter_sprawdz_opcje7
                      06134 
001968 0E07           06135       movlw       opcja_wlacz_1
00196A 63EA           06136       cpfseq      numer_opcji
00196C EFBB F00C      06137       goto        wykryto_enter_sprawdz_opcje8
                      06138       
001970 7081           06139       btg   port_triak,triak1
                      06140       
                      06141       
                      06142       
001972 EFDE F00D      06143       goto        wykryto_enter_exit
                      06144       
                      06145       
                      06146       
                      06147       
                      06148       
                      06149       
                      06150       
                      06151       
                      06152       
                      06153       
                      06154       
                      06155       
                      06156       
                      06157       
                      06158       
                      06159       
                      06160       
001976                06161 wykryto_enter_sprawdz_opcje8
001976 0E08           06162       movlw       opcja_wlacz_2
001978 63EA           06163       cpfseq      numer_opcji
00197A EFC2 F00C      06164       goto        wykryto_enter_sprawdz_opcje9
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 136


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06165       
00197E 7281           06166       btg   port_triak,triak2
                      06167       
                      06168       
                      06169       
001980 EFDE F00D      06170       goto        wykryto_enter_exit
                      06171       
                      06172       
                      06173       
                      06174       
                      06175       
                      06176       
                      06177       
                      06178       
                      06179       
                      06180       
                      06181       
                      06182       
                      06183       
                      06184       
                      06185       
001984                06186 wykryto_enter_sprawdz_opcje9
001984 0E09           06187       movlw       opcja_histereza_R1_1
001986 63EA           06188       cpfseq      numer_opcji
001988 EFD2 F00C      06189       goto        wykryto_enter_sprawdz_opcje10
                      06190       
                      06191       ;wlacz pomiar pradu
                      06192       ;jako test wlacz podswietlenie lub je wylacz
                      06193       
                      06194       ;btg   portlampka2,lampka2
00198C 51B3           06195       movf        histereza_R1_1,w
00198E 6F92           06196       movwf       tmp_hex
                      06197       
001990 6B93           06198       clrf        tmp_hex_H
001992 6B98           06199       clrf        dec1
001994 6B97           06200       clrf        dec10
001996 EC87 F002      06201       call        hex2dec18
                      06202 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      06203       ;wyświetlam obok nazwy opcji czyli 
00199A ECED F00D      06204       call        wykr_enter_gdzie_wysw_licz_bajt
                      06205       
00199E 8FE9           06206       bsf         pozycja_menu,zmiana_opcji
                      06207       
0019A0 EFDE F00D      06208       goto        wykryto_enter_exit
                      06209 
                      06210       
                      06211       
                      06212       
                      06213       
                      06214       
                      06215       
0019A4                06216 wykryto_enter_sprawdz_opcje10
0019A4 0E0A           06217          movlw       opcja_histereza_R1_2
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 137


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0019A6 63EA           06218       cpfseq      numer_opcji
0019A8 EFE2 F00C      06219       goto        wykryto_enter_sprawdz_opcje11
                      06220       
                      06221       ;wlacz pomiar pradu
                      06222       ;jako test wlacz podswietlenie lub je wylacz
                      06223       
                      06224       
0019AC 51B4           06225       movf        histereza_R1_2,w
0019AE 6F92           06226       movwf       tmp_hex
                      06227       
0019B0 6B93           06228       clrf        tmp_hex_H
0019B2 6B98           06229       clrf        dec1
0019B4 6B97           06230       clrf        dec10
0019B6 EC87 F002      06231       call        hex2dec18
                      06232 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      06233       ;wyświetlam obok nazwy opcji czyli 
0019BA ECED F00D      06234       call        wykr_enter_gdzie_wysw_licz_bajt
                      06235       
0019BE 8FE9           06236       bsf         pozycja_menu,zmiana_opcji
                      06237       
0019C0 EFDE F00D      06238       goto        wykryto_enter_exit
                      06239       
                      06240       
                      06241     
                      06242     
0019C4                06243 wykryto_enter_sprawdz_opcje11
0019C4 0E0B           06244       movlw       opcja_histereza_R2_1
0019C6 63EA           06245       cpfseq      numer_opcji
0019C8 EFF2 F00C      06246       goto        wykryto_enter_sprawdz_opcje12
                      06247       
                      06248       ;wlacz pomiar pradu
                      06249       ;jako test wlacz podswietlenie lub je wylacz
                      06250       
                      06251       
0019CC 51B5           06252       movf        histereza_R2_1,w
0019CE 6F92           06253       movwf       tmp_hex
                      06254       
0019D0 6B93           06255       clrf        tmp_hex_H
0019D2 6B98           06256       clrf        dec1
0019D4 6B97           06257       clrf        dec10
0019D6 EC87 F002      06258       call        hex2dec18
                      06259 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      06260       ;wyświetlam obok nazwy opcji czyli 
0019DA ECED F00D      06261       call        wykr_enter_gdzie_wysw_licz_bajt
                      06262       
0019DE 8FE9           06263       bsf         pozycja_menu,zmiana_opcji
                      06264       
0019E0 EFDE F00D      06265       goto        wykryto_enter_exit
                      06266 
                      06267             
                      06268       
                      06269       
                      06270       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 138


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06271       
0019E4                06272 wykryto_enter_sprawdz_opcje12
0019E4 0E0C           06273          movlw       opcja_histereza_R2_2
0019E6 63EA           06274       cpfseq      numer_opcji
0019E8 EF02 F00D      06275       goto        wykryto_enter_sprawdz_opcje13
                      06276       
                      06277       ;wlacz pomiar pradu
                      06278       ;jako test wlacz podswietlenie lub je wylacz
                      06279       
                      06280       
0019EC 51B6           06281       movf        histereza_R2_2,w
0019EE 6F92           06282       movwf       tmp_hex
                      06283       
0019F0 6B93           06284       clrf        tmp_hex_H
0019F2 6B98           06285       clrf        dec1
0019F4 6B97           06286       clrf        dec10
0019F6 EC87 F002      06287       call        hex2dec18
                      06288 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      06289       ;wyświetlam obok nazwy opcji czyli 
0019FA ECED F00D      06290       call        wykr_enter_gdzie_wysw_licz_bajt
                      06291       
0019FE 8FE9           06292       bsf         pozycja_menu,zmiana_opcji
                      06293       
001A00 EFDE F00D      06294       goto        wykryto_enter_exit
                      06295       
                      06296     
                      06297     
                      06298     
                      06299     
                      06300     
                      06301 
                      06302       
                      06303        
                      06304 
                      06305        
001A04                06306 wykryto_enter_sprawdz_opcje13
001A04 0E0D           06307       movlw       opcja_regulacja1
001A06 63EA           06308       cpfseq      numer_opcji
001A08 EF0D F00D      06309       goto        wykryto_enter_sprawdz_opcje14
                      06310       
                      06311       ; btg         markers_regulacja,reguluj1
                      06312       
                      06313       
                      06314       ; movf        czy_reguluje1,w
                      06315       ; movf        FSR2
001A0C EE20 F0B7      06316       lfsr      FSR2,czy_reguluje1
001A10 ECE3 F00A      06317       call       wyswietl_opcje_regulacji
                      06318       
                      06319       
001A14 8FE9           06320       bsf         pozycja_menu,zmiana_opcji
                      06321       
                      06322       
001A16 EFDE F00D      06323       goto        wykryto_enter_exit
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 139


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06324        
                      06325        
                      06326        
                      06327        
001A1A                06328 wykryto_enter_sprawdz_opcje14
001A1A 0E0E           06329       movlw       opcja_regulacja2
001A1C 63EA           06330       cpfseq      numer_opcji
001A1E EF18 F00D      06331       goto        wykryto_enter_sprawdz_opcje15
                      06332       
                      06333       ; btg         markers_regulacja,reguluj2
                      06334       
                      06335       
                      06336       
001A22 EE20 F0B8      06337       lfsr      FSR2,czy_reguluje2
001A26 ECE3 F00A      06338       call       wyswietl_opcje_regulacji
                      06339       
                      06340       
001A2A 8FE9           06341       bsf         pozycja_menu,zmiana_opcji
                      06342       
                      06343       
001A2C EFDE F00D      06344       goto        wykryto_enter_exit
                      06345 
                      06346 
                      06347       
                      06348       
001A30                06349 wykryto_enter_sprawdz_opcje15
001A30 0E0F           06350       movlw       opcja_czujnik_regulacji1
001A32 63EA           06351       cpfseq      numer_opcji
001A34 EF28 F00D      06352       goto        wykryto_enter_sprawdz_opcje16
                      06353       
                      06354       ;wlacz pomiar pradu
                      06355       ;jako test wlacz podswietlenie lub je wylacz
                      06356       
                      06357       
001A38 51B9           06358       movf        ktory_czujnik_reguluje1,w
001A3A 6F92           06359       movwf       tmp_hex
                      06360       
001A3C 6B93           06361       clrf        tmp_hex_H
001A3E 6B98           06362       clrf        dec1
001A40 6B97           06363       clrf        dec10
001A42 EC87 F002      06364       call        hex2dec18
                      06365 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      06366       ;wyświetlam obok nazwy opcji czyli 
001A46 ECED F00D      06367       call        wykr_enter_gdzie_wysw_licz_bajt
                      06368       
001A4A 8FE9           06369       bsf         pozycja_menu,zmiana_opcji
                      06370       
001A4C EFDE F00D      06371       goto        wykryto_enter_exit
                      06372 
                      06373 
                      06374       
                      06375       
001A50                06376 wykryto_enter_sprawdz_opcje16
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 140


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001A50 0E10           06377           movlw       opcja_czujnik_regulacji2
001A52 63EA           06378       cpfseq      numer_opcji
001A54 EF38 F00D      06379       goto        wykryto_enter_sprawdz_opcje17
                      06380       
                      06381       ;wlacz pomiar pradu
                      06382       ;jako test wlacz podswietlenie lub je wylacz
                      06383       
                      06384       ;btg   portlampka2,lampka2
001A58 51BA           06385       movf        ktory_czujnik_reguluje2 ,w
001A5A 6F92           06386       movwf       tmp_hex
                      06387       
001A5C 6B93           06388       clrf        tmp_hex_H
001A5E 6B98           06389       clrf        dec1
001A60 6B97           06390       clrf        dec10
001A62 EC87 F002      06391       call        hex2dec18
                      06392 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      06393       ;wyświetlam obok nazwy opcji czyli 
001A66 ECED F00D      06394       call        wykr_enter_gdzie_wysw_licz_bajt
                      06395       
001A6A 8FE9           06396       bsf         pozycja_menu,zmiana_opcji
                      06397       
001A6C EFDE F00D      06398       goto        wykryto_enter_exit
                      06399 
                      06400       
                      06401 ; wykryto_enter_sprawdz_opcje12
                      06402       ; movlw       opcja_ustaw_serial
                      06403       ; cpfseq      numer_opcji
                      06404       ; goto        wykryto_enter_sprawdz_opcje13
                      06405       ; btg         markers,czy_wysylac_pomiary_serial      
                      06406       ; goto        wykryto_enter_exit
                      06407       
                      06408       
                      06409       
                      06410       
                      06411       
                      06412       
001A70                06413 wykryto_enter_sprawdz_opcje17      
                      06414 
001A70 0E11           06415       movlw       opcja_wyswietl_zegar
001A72 63EA           06416       cpfseq      numer_opcji
001A74 EF3F F00D      06417       goto        wykryto_enter_sprawdz_opcje18
                      06418       
001A78 739E           06419       btg   znaczniki,czy_ponownie_wlaczyc_zegar
                      06420       
001A7A EFDE F00D      06421       goto        wykryto_enter_exit
                      06422       
                      06423 
                      06424       
001A7E                06425 wykryto_enter_sprawdz_opcje18
                      06426 
001A7E 0E12           06427       movlw       opcja_wyswietl_temp
001A80 63EA           06428       cpfseq      numer_opcji
001A82 EF46 F00D      06429       goto        wykryto_enter_sprawdz_opcje19
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 141


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06430       
001A86 719E           06431       btg   znaczniki,czy_ponownie_wlaczyc_temp
                      06432       
001A88 EFDE F00D      06433       goto        wykryto_enter_exit
                      06434 
                      06435       
                      06436 
                      06437       
001A8C                06438 wykryto_enter_sprawdz_opcje19
                      06439 
001A8C 0E13           06440       movlw       opcja_podswietlenie
001A8E 63EA           06441       cpfseq      numer_opcji
001A90 EF4D F00D      06442       goto        wykryto_enter_sprawdz_opcje20
                      06443       
001A94 7881           06444       btg   portlampka2,lampka2
                      06445       
001A96 EFDE F00D      06446       goto        wykryto_enter_exit
                      06447 
                      06448 
                      06449 
                      06450       
                      06451      
001A9A                06452 wykryto_enter_sprawdz_opcje20
001A9A 0E14           06453       movlw       opcja_ustaw_zegar
001A9C 63EA           06454       cpfseq      numer_opcji
001A9E EF58 F00D      06455       goto        wykryto_enter_sprawdz_opcje21
                      06456       ;czyszcze rejestr przechowujący wyświetlaną liczbę
001AA2 0EE0           06457       movlw       dzien_10
001AA4 6FEF           06458       movwf        ustawianie_czasu_co_wyswietlam
001AA6 8FE9           06459       bsf         pozycja_menu,zmiana_opcji
                      06460       
001AA8 EC1A F00E      06461       call        proc_wyswietl_kolej_liczb_zegara
                      06462       
                      06463       
001AAC EFDE F00D      06464       goto        wykryto_enter_exit
                      06465             
                      06466       
                      06467       
                      06468       
001AB0                06469 wykryto_enter_sprawdz_opcje21
001AB0 EFDE F00D      06470       goto        wykryto_enter_exit
                      06471       
                      06472       
                      06473       
                      06474       
                      06475       
                      06476       
                      06477 ;;;;;;;;;;
                      06478 
                      06479 ;;;;;;       kolejne opcje numery przy wyjsciu z nich
                      06480 ;;;;      
                      06481       
001AB4                06482 wykryto_enter_zmiana_opcji
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 142


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001AB4 0E01           06483       movlw       opcja_czujniki
001AB6 63EA           06484       cpfseq      numer_opcji
001AB8 EF6C F00D      06485       goto          wykryto_enter_wyjscie_opcje2
                      06486       
                      06487       
001ABC EC0D F00E      06488       call     enter_back_wyjsc_z_opcji_czujnik
                      06489       
                      06490       ;jeżeli zmieniam ilość obsługiwanych czujników temp
                      06491       ;to tu powinno być wyjście z opcji włączania czujników
                      06492       ;czyli jeżeli ile_kanalow > 0 to włącz pomiary
                      06493       
001AC0 51AC           06494       movf         ile_kanalow,w
001AC2 E07C           06495       bz          wykryto_enter_exit
                      06496       
                      06497       
001AC4 6FAB           06498       movwf    ktory_kanal_mierze
                      06499       
                      06500       
001AC6 51AD           06501       movf    odstep_pomiarowy,w
                      06502       
001AC8 6FA6           06503       movwf    aktualny_odstep
                      06504       
                      06505       
001ACA 85A0           06506       bsf      markers2,pomiary
001ACC 859F           06507       bsf      markers,pomiary_zrobione
001ACE 819F           06508       bsf       markers,czy_usrednianie
                      06509       ;włączyć trzeba moduł A/D
001AD0 0E01           06510       movlw    b'00000001'
001AD2 6EC2           06511       movwf    ADCON0
                      06512       ;bsf      markers,czy_wyswietlam_temp
001AD4 EFDE F00D      06513       goto        wykryto_enter_exit
                      06514             
                      06515       
                      06516       
                      06517       
                      06518       
001AD8                06519 wykryto_enter_wyjscie_opcje2
                      06520 ;opcja z liczbą      
001AD8 0E02           06521       movlw       opcja_odstep
001ADA 63EA           06522       cpfseq      numer_opcji
001ADC EF74 F00D      06523       goto          wykryto_enter_wyjscie_opcje3
001AE0 EC4B F00E      06524       call  enter_back_wyjsc_z_op_wys_liczb
                      06525       
                      06526       ;call  wykryto_enter_back_wyjsc_z_opcji_skasuj_liczbe
                      06527       
                      06528       
                      06529       
001AE4 EFDE F00D      06530       goto        wykryto_enter_exit
                      06531       
                      06532       
                      06533       
                      06534       
                      06535       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 143


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001AE8                06536 wykryto_enter_wyjscie_opcje3
                      06537       
001AE8 0E03           06538       movlw       opcja_srednia
001AEA 63EA           06539       cpfseq      numer_opcji
001AEC EF7C F00D      06540       goto          wykryto_enter_wyjscie_opcje4
001AF0 EC4B F00E      06541       call  enter_back_wyjsc_z_op_wys_liczb
                      06542       
                      06543      ; bcf        pozycja_menu,zmiana_opcji
                      06544       
001AF4 EFDE F00D      06545       goto        wykryto_enter_exit
                      06546       
                      06547 
001AF8                06548 wykryto_enter_wyjscie_opcje4
                      06549 
                      06550 
                      06551 
                      06552 
                      06553 
001AF8                06554 wykryto_enter_wyjscie_opcje5
                      06555 
001AF8 0E05           06556       movlw       opcja_ustaw_temp_R1
001AFA 63EA           06557       cpfseq      numer_opcji
001AFC EF84 F00D      06558       goto          wykryto_enter_wyjscie_opcje6
001B00 EC4B F00E      06559       call  enter_back_wyjsc_z_op_wys_liczb
                      06560       
                      06561       ;bcf        pozycja_menu,zmiana_opcji
                      06562       
001B04 EFDE F00D      06563       goto        wykryto_enter_exit
                      06564       
                      06565       
                      06566       
                      06567       
001B08                06568 wykryto_enter_wyjscie_opcje6
                      06569 
                      06570 
001B08 0E06           06571       movlw       opcja_ustaw_temp_R2
001B0A 63EA           06572       cpfseq      numer_opcji
001B0C EF8C F00D      06573       goto          wykryto_enter_wyjscie_opcje7
001B10 EC4B F00E      06574       call  enter_back_wyjsc_z_op_wys_liczb
                      06575       
                      06576       ;bcf        pozycja_menu,zmiana_opcji
                      06577       
001B14 EFDE F00D      06578       goto        wykryto_enter_exit
                      06579       
001B18                06580 wykryto_enter_wyjscie_opcje7
                      06581 
001B18                06582 wykryto_enter_wyjscie_opcje9
                      06583 
001B18 0E09           06584       movlw       opcja_histereza_R1_1
001B1A 63EA           06585       cpfseq      numer_opcji
001B1C EF94 F00D      06586       goto          wykryto_enter_wyjscie_opcje10
001B20 EC4B F00E      06587       call  enter_back_wyjsc_z_op_wys_liczb
                      06588       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 144


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06589       ;bcf        pozycja_menu,zmiana_opcji
                      06590       
001B24 EFDE F00D      06591       goto        wykryto_enter_exit
                      06592 
                      06593 
001B28                06594 wykryto_enter_wyjscie_opcje10
001B28 0E0A           06595          movlw       opcja_histereza_R1_2
001B2A 63EA           06596       cpfseq      numer_opcji
001B2C EF9C F00D      06597       goto          wykryto_enter_wyjscie_opcje11
001B30 EC4B F00E      06598       call  enter_back_wyjsc_z_op_wys_liczb
                      06599       
                      06600       ;bcf        pozycja_menu,zmiana_opcji
                      06601       
001B34 EFDE F00D      06602       goto        wykryto_enter_exit
                      06603       
                      06604       
                      06605       
001B38                06606 wykryto_enter_wyjscie_opcje11
001B38 0E0B           06607          movlw       opcja_histereza_R2_1
001B3A 63EA           06608       cpfseq      numer_opcji
001B3C EFA4 F00D      06609       goto          wykryto_enter_wyjscie_opcje12
001B40 EC4B F00E      06610       call  enter_back_wyjsc_z_op_wys_liczb
                      06611       
                      06612       ;bcf        pozycja_menu,zmiana_opcji
                      06613       
001B44 EFDE F00D      06614       goto        wykryto_enter_exit
                      06615 
                      06616 
001B48                06617 wykryto_enter_wyjscie_opcje12
001B48 0E0C           06618          movlw       opcja_histereza_R2_2
001B4A 63EA           06619       cpfseq      numer_opcji
001B4C EFAC F00D      06620       goto          wykryto_enter_wyjscie_opcje13
001B50 EC4B F00E      06621       call  enter_back_wyjsc_z_op_wys_liczb
                      06622       
                      06623       ;bcf        pozycja_menu,zmiana_opcji
                      06624       
001B54 EFDE F00D      06625       goto        wykryto_enter_exit
                      06626 
                      06627 
                      06628 
                      06629 
001B58                06630 wykryto_enter_wyjscie_opcje13
001B58 0E0D           06631         movlw       opcja_regulacja1
001B5A 63EA           06632       cpfseq      numer_opcji
001B5C EFB4 F00D      06633       goto          wykryto_enter_wyjscie_opcje14
001B60 EC4B F00E      06634       call  enter_back_wyjsc_z_op_wys_liczb
                      06635       
                      06636       ;bcf        pozycja_menu,zmiana_opcji
                      06637       
001B64 EFDE F00D      06638       goto        wykryto_enter_exit
                      06639 
001B68                06640 wykryto_enter_wyjscie_opcje14
001B68 0E0E           06641         movlw       opcja_regulacja2
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 145


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001B6A 63EA           06642       cpfseq      numer_opcji
001B6C EFBC F00D      06643       goto          wykryto_enter_wyjscie_opcje15
001B70 EC4B F00E      06644       call  enter_back_wyjsc_z_op_wys_liczb
                      06645       
                      06646       ;bcf        pozycja_menu,zmiana_opcji
                      06647       
001B74 EFDE F00D      06648       goto        wykryto_enter_exit
                      06649 
                      06650 
                      06651 
001B78                06652 wykryto_enter_wyjscie_opcje15
001B78 0E0F           06653       movlw       opcja_czujnik_regulacji1
001B7A 63EA           06654       cpfseq      numer_opcji
001B7C EFC4 F00D      06655       goto          wykryto_enter_wyjscie_opcje16
001B80 EC4B F00E      06656       call  enter_back_wyjsc_z_op_wys_liczb
                      06657       
                      06658       ;bcf        pozycja_menu,zmiana_opcji
                      06659       
001B84 EFDE F00D      06660       goto        wykryto_enter_exit      
                      06661       
                      06662       
                      06663       
                      06664 
001B88                06665 wykryto_enter_wyjscie_opcje16
001B88 0E10           06666       movlw       opcja_czujnik_regulacji2
001B8A 63EA           06667       cpfseq      numer_opcji
001B8C EFCC F00D      06668       goto          wykryto_enter_wyjscie_opcje17
001B90 EC4B F00E      06669       call  enter_back_wyjsc_z_op_wys_liczb
                      06670       
                      06671       ;bcf        pozycja_menu,zmiana_opcji
                      06672       
001B94 EFDE F00D      06673       goto        wykryto_enter_exit      
                      06674       
                      06675       
                      06676 
                      06677 
001B98                06678 wykryto_enter_wyjscie_opcje17
                      06679 
                      06680 
                      06681 
001B98                06682 wykryto_enter_wyjscie_opcje20
001B98 0E14           06683       movlw       opcja_ustaw_zegar
001B9A 63EA           06684       cpfseq      numer_opcji
001B9C EFDE F00D      06685       goto        wykryto_enter_wyjscie_opcje21
                      06686 
                      06687       
                      06688       
                      06689       ; movlw       dzien_10
                      06690       ; cpfseq      ustawianie_czasu_co_wyswietlam
                      06691       ; goto        wykryto_enter_wyjscie_opcje11_D
                      06692       
                      06693       ; movlw       godziny_10
                      06694       ; cpfseq      ustawianie_czasu_co_wyswietlam
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 146


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06695       ; goto        wykryto_enter_wyjscie_opcje11_H
                      06696       
                      06697       
001BA0 0EE6           06698       movlw      sekundy_10
001BA2 63EF           06699       cpfseq      ustawianie_czasu_co_wyswietlam
001BA4 EFD8 F00D      06700       goto        wykryto_enter_wyjscie_opcje11_1
                      06701       
                      06702       ;jezeli jest w tej chwili sekundy_10 tzn ze wychodze z wyswietlania ustawien zegara
                      06703             
001BA8 EC4B F00E      06704       call  enter_back_wyjsc_z_op_wys_liczb
                      06705       
                      06706             
001BAC EFDE F00D      06707       goto        wykryto_enter_exit
                      06708       
                      06709 
                      06710 ; wykryto_enter_wyjscie_opcje11_D
                      06711 
                      06712       ; movlw       godziny_10
                      06713       ; movwf       ustawianie_czasu_co_wyswietlam
                      06714       
                      06715       ; call        procedura_wyswietlania_kolejnych_liczb_zegara
                      06716       ; goto        wykryto_enter_exit
                      06717       
                      06718 
                      06719 ; wykryto_enter_wyjscie_opcje11_H
                      06720       ; movlw       minuty_10
                      06721       ; movwf       ustawianie_czasu_co_wyswietlam
                      06722       ; call        procedura_wyswietlania_kolejnych_liczb_zegara
                      06723       ; goto        wykryto_enter_exit
                      06724       
                      06725 
                      06726       
001BB0                06727 wykryto_enter_wyjscie_opcje11_1
001BB0 0E02           06728       movlw       2
001BB2 27EF           06729       addwf       ustawianie_czasu_co_wyswietlam,f
001BB4 EC1A F00E      06730       call        proc_wyswietl_kolej_liczb_zegara
001BB8 EFDE F00D      06731       goto        wykryto_enter_exit
                      06732 
                      06733 
                      06734 
                      06735 
                      06736 
                      06737 
                      06738 
001BBC                06739 wykryto_enter_wyjscie_opcje21
                      06740 
                      06741 ;             
                      06742 ;       call     check_busy
                      06743 ;       movlw    linia_czwarta
                      06744 ;       call      send
                      06745 ;         
                      06746 ;       call     check_busy
                      06747 ; ;czy gasze czy wyswietlam      
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 147


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06748 ;       btfsc       markers,test
                      06749 ;       goto        zamaz_E
                      06750 ; napisz_E
                      06751 ;       bsf   markers,test
                      06752 ;       movlw       _E
                      06753 ;       goto  wykryto_back_pisz
                      06754 ; zamaz_E
                      06755 ;       bcf   markers,test
                      06756 ;       movlw       _puste
                      06757 ;       
                      06758 ; wykryto_enter_pisz
                      06759 ;       call     write_lcd
                      06760       
                      06761       
                      06762       
001BBC                06763 wykryto_enter_exit 
001BBC 9BA1           06764       bcf   markers3,dzialanie_po_klawiszu
001BBE 6B99           06765       clrf  stan_key
001BC0 EF98 F00E      06766       goto  LOOP11
                      06767  
                      06768  
                      06769  
                      06770  
                      06771  
                      06772  
                      06773  
                      06774 ;wykryto_enter_back_wyjsc_z_opcji_skasuj_liczbe
                      06775 ;odczytaj_polozenie_gwiazdki_wybierz_linie
                      06776  
001BC4                06777 odczytaj_adr_polozenia_gwiazdki
001BC4 0E1E           06778       movlw       HIGH tablica_gwiazdki
001BC6 6EF7           06779       movwf       TBLPTRH
                      06780       
001BC8 0ECC           06781       movlw       LOW tablica_gwiazdki
001BCA 6EF6           06782       movwf       TBLPTRL
                      06783       
                      06784       ;poniewaz najpierw zmniejszam polozenie
                      06785       
001BCC 51EB           06786       movf       polozenie_gwiazdki,w
                      06787       
001BCE 26F6           06788       addwf       TBLPTRL,f
                      06789       
                      06790       
                      06791       
001BD0 EC61 F001      06792       call        check_busy
                      06793        ;a nastepnie czytam to uzywam polecenia
001BD4 0008           06794       TBLRD *
001BD6 50F5           06795       movf        TABLAT,w
                      06796 ;na zakończenie procedury adres linii z gwiazdką jest umieszczany w rejestrze W
001BD8 0012           06797       return
                      06798       
                      06799       
                      06800 ; wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 148


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001BDA                06801 wykr_enter_gdzie_wysw_licz_bajt
                      06802 ;aby liczba wyświetlana znalazła się obok swojej opcji w menu, należy wcześniej odczytać aktualne 
                            położenie gwiazdki
                      06803 ;z tablicy
                      06804 ;dzięki temu uniknięte zostanie wielokrotne powtarzanie procedur wyświetlania liczb w zależności od
                             opcji przy której umieszczona ma być wartośc liczby
                      06805 ;poza tym w wypadku zmiany położenia opcji w tablicy opcji menu ( z linii 2 na 3) to zmiana nastąpi a
                            utomatycznie
                      06806 ;gdyż to położenie gwiazdki decyduje o położeniu cyfr
001BDA 0E1E           06807       movlw       HIGH tablica_gwiazdki
001BDC 6EF7           06808       movwf       TBLPTRH
                      06809       
001BDE 0ECC           06810       movlw       LOW tablica_gwiazdki
001BE0 6EF6           06811       movwf       TBLPTRL
                      06812       
                      06813       ;poniewaz najpierw zmniejszam polozenie
                      06814       
001BE2 51EB           06815       movf       polozenie_gwiazdki,w
                      06816       
001BE4 26F6           06817       addwf       TBLPTRL,f
                      06818       
                      06819       
                      06820       
001BE6 EC61 F001      06821       call        check_busy
                      06822        ;a nastepnie czytam to uzywam polecenia
001BEA 0008           06823       TBLRD *
001BEC 50F5           06824       movf        TABLAT,w
                      06825   ;teraz należy do adresu lini dodać miejsce położenia cyfry 100
                      06826   
                      06827 
001BEE 0F0A           06828       addlw       polozenie_liczby_menu
001BF0 EC23 F001      06829       call        send
001BF4 EC61 F001      06830       call        check_busy
                      06831  
                      06832  ;i wyswietlic wszystkie cyfry
001BF8 5196           06833       movf        dec100,w
001BFA 0F30           06834       addlw       0x30
001BFC EC34 F001      06835       call        write_lcd      
001C00 EC61 F001      06836       call        check_busy
                      06837       
001C04 5197           06838       movf        dec10,w      
001C06 0F30           06839       addlw       0x30
001C08 EC34 F001      06840       call        write_lcd      
                      06841       
001C0C EC61 F001      06842       call        check_busy
001C10 5198           06843       movf        dec1,w
001C12 0F30           06844       addlw       0x30
001C14 EC34 F001      06845       call        write_lcd      
                      06846       
001C18 0012           06847       return
                      06848       
                      06849 
                      06850 
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 149


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06851 
                      06852 
                      06853       
                      06854 ; enter_back_wyjsc_z_opcji_czujniki
001C1A                06855 enter_back_wyjsc_z_opcji_czujnik
                      06856 
                      06857       ;czysc ustawienia opcji i zgas bit zmiana_opcji
                      06858        
001C1A 9FE9           06859        bcf        pozycja_menu,zmiana_opcji
001C1C EC61 F001      06860        call     check_busy
001C20 0E80           06861       movlw    linia_gorna
001C22 0F0A           06862       addlw       polozenie_liczby_menu
001C24 EC23 F001      06863       call      send
                      06864       ;
                      06865       
001C28 EC61 F001      06866       call     check_busy
001C2C 0E20           06867       movlw       _puste
001C2E EC34 F001      06868       call        write_lcd
                      06869       
001C32 0012           06870       return
                      06871        
                      06872        
                      06873        
                      06874        
                      06875        
                      06876        
                      06877        
                      06878        
                      06879        
                      06880        
                      06881        
                      06882        
                      06883        
                      06884        
                      06885        
                      06886        
                      06887        
                      06888        
                      06889        
                      06890        
                      06891        
                      06892 ; procedura_wyswietlania_kolejnych_liczb_zegara
001C34                06893 proc_wyswietl_kolej_liczb_zegara
                      06894 
001C34 ECE2 F00D      06895       call  odczytaj_adr_polozenia_gwiazdki
001C38 0F0C           06896       addlw       0x0c
001C3A EC23 F001      06897       call        send
                      06898       
001C3E EC61 F001      06899       call        check_busy
                      06900       
                      06901 ;która litera jest wyświetlana obok cyfr = D - day, H - hours, M - minute, S- seconds      
001C42 0EE0           06902       movlw       dzien_10
001C44 63EF           06903       cpfseq      ustawianie_czasu_co_wyswietlam
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 150


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001C46 EF28 F00E      06904       goto        wyswi_kolejnych_liczb_zegara_1
001C4A 0E44           06905       movlw       _D
001C4C EF37 F00E      06906       goto        wysw_kolejnych_liczb_zegara_4
                      06907 
                      06908 
                      06909 
                      06910 
                      06911       
                      06912 ; procedura_wyswietlania_kolejnych_liczb_zegara_1
001C50                06913 wyswi_kolejnych_liczb_zegara_1
                      06914 
001C50 0EE2           06915       movlw       godziny_10
001C52 63EF           06916       cpfseq      ustawianie_czasu_co_wyswietlam
001C54 EF2F F00E      06917       goto        wysw_kolejnych_liczb_zegara_2
001C58 0E48           06918       movlw       _H
001C5A EF37 F00E      06919       goto        wysw_kolejnych_liczb_zegara_4
                      06920       
                      06921 
                      06922 
                      06923 
                      06924       
                      06925 ; procedura_wyswietlania_kolejnych_liczb_zegara_2
001C5E                06926 wysw_kolejnych_liczb_zegara_2
                      06927 
001C5E 0EE4           06928       movlw       minuty_10
001C60 63EF           06929       cpfseq      ustawianie_czasu_co_wyswietlam
001C62 EF36 F00E      06930       goto        wysw_kolejnych_liczb_zegara_3
001C66 0E4D           06931       movlw       _M
001C68 EF37 F00E      06932       goto        wysw_kolejnych_liczb_zegara_4
                      06933 
                      06934 
                      06935 
                      06936 
                      06937       
001C6C                06938 wysw_kolejnych_liczb_zegara_3     
                      06939 
                      06940       ; movlw       sekundy_10
                      06941       ; cpfseq      ustawianie_czasu_co_wyswietlam
                      06942       ; goto        procedura_wyswietlania_kolejnych_liczb_zegara_1
001C6C 0E53           06943       movlw       _S
                      06944 
                      06945 
                      06946 
                      06947 
                      06948       
                      06949 ; procedura_wyswietlania_kolejnych_liczb_zegara_4            
001C6E                06950 wysw_kolejnych_liczb_zegara_4            
                      06951       
001C6E EC34 F001      06952       call        write_lcd
                      06953       
001C72 6ADA           06954       clrf        FSR2H
001C74 51EF           06955       movf        ustawianie_czasu_co_wyswietlam,w
001C76 6ED9           06956       movwf      FSR2L      
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 151


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06957       
001C78 EC61 F001      06958       call        check_busy
001C7C 50DF           06959       movf        INDF2,w      
001C7E EC34 F001      06960       call        write_lcd
                      06961       
001C82 EC61 F001      06962       call        check_busy
                      06963       
001C86 2AD9           06964       incf        FSR2L,f
001C88 50DF           06965       movf        INDF2,w      
001C8A EC34 F001      06966       call        write_lcd
                      06967       
001C8E EC61 F001      06968       call        check_busy
                      06969       
001C92 2AD9           06970       incf        FSR2L,f       
                      06971        
001C94 0012           06972       return
                      06973 
                      06974 
                      06975 
                      06976 
                      06977 
                      06978 
                      06979 
                      06980 
                      06981 
                      06982 
                      06983 
                      06984 
                      06985 
                      06986 
                      06987 
                      06988 
                      06989 
                      06990       
                      06991 
                      06992 ; enter_back_wyjsc_z_opcji_wyswietlanie_liczby
001C96                06993 enter_back_wyjsc_z_op_wys_liczb
                      06994 
                      06995 ;procedrura analogiczna to tej związanej z obsługą wyświetlania rejestru
001C96 0E1E           06996       movlw       HIGH tablica_gwiazdki
001C98 6EF7           06997       movwf       TBLPTRH
                      06998       
001C9A 0ECC           06999       movlw       LOW tablica_gwiazdki
001C9C 6EF6           07000       movwf       TBLPTRL
                      07001       
                      07002       ;poniewaz najpierw zmniejszam polozenie
                      07003       
001C9E 51EB           07004       movf       polozenie_gwiazdki,w
                      07005       
001CA0 26F6           07006       addwf       TBLPTRL,f
                      07007       
                      07008        ;a nastepnie czytam to uzywam polecenia
001CA2 0008           07009       TBLRD *
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 152


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      07010       
001CA4 EC61 F001      07011       call        check_busy
                      07012       
001CA8 50F5           07013       movf        TABLAT,w
                      07014 ;teraz należy do adresu lini dodać miejsce położenia cyfry 100
001CAA 0F0A           07015       addlw       polozenie_liczby_menu
001CAC EC23 F001      07016       call        send
                      07017       
001CB0 EC61 F001      07018       call        check_busy       
001CB4 0E20           07019       movlw       _puste
001CB6 EC34 F001      07020       call        write_lcd      
                      07021       
001CBA EC61 F001      07022       call        check_busy
001CBE 0E20           07023       movlw       _puste
001CC0 EC34 F001      07024       call        write_lcd      
                      07025       
001CC4 EC61 F001      07026       call        check_busy
001CC8 0E20           07027       movlw       _puste
001CCA EC34 F001      07028       call        write_lcd      
                      07029       
001CCE EC61 F001      07030       call        check_busy       
001CD2 0E20           07031       movlw       _puste
001CD4 EC34 F001      07032       call        write_lcd      
                      07033       
                      07034       
001CD8 EC61 F001      07035       call        check_busy
001CDC 0E20           07036       movlw       _puste
001CDE EC34 F001      07037       call        write_lcd 
                      07038       
001CE2 EC61 F001      07039       call        check_busy
001CE6 0E20           07040       movlw       _puste
001CE8 EC34 F001      07041       call        write_lcd 
                      07042       
001CEC EC61 F001      07043       call        check_busy
001CF0 0E20           07044       movlw       _puste
001CF2 EC34 F001      07045       call        write_lcd 
                      07046       
001CF6 9FE9           07047       bcf        pozycja_menu,zmiana_opcji
                      07048       
001CF8 0012           07049       return
                      07050 
                      07051       
                      07052       
                      07053       
                      07054       
                      07055       
                      07056       
                      07057       
                      07058       
                      07059       
                      07060       
                      07061       
                      07062       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 153


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      07063 
                      07064 
                      07065 
                      07066 
                      07067 
                      07068 
                      07069 
                      07070 
                      07071 
                      07072 
                      07073 
                      07074 
                      07075 
                      07076 
                      07077 
                      07078 ;;;; tu jest procedura PETLI
                      07079 
                      07080 
                      07081 
                      07082 
                      07083 
                      07084 
                      07085 
                      07086 
                      07087 
                      07088       
                      07089     
001CFA                07090 LOOP
                      07091 
001CFA ABA1           07092       btfss       markers3,dzialanie_po_klawiszu
001CFC EF8C F00E      07093       goto        LOOP_sprawdz_keys        
                      07094 
                      07095 
                      07096       
001D00 B199           07097       btfsc   stan_key,latch_back
001D02 EF78 F007      07098       goto    wykryto_back
                      07099                   
001D06 B399           07100       btfsc    stan_key,latch_down
001D08 EF8B F007      07101       goto     wykryto_down
                      07102                            
001D0C B599           07103       btfsc    stan_key,latch_up
001D0E EF81 F009      07104       goto     wykryto_up
                      07105          
001D12 B799           07106       btfsc    stan_key,latch_enter
001D14 EF0B F00C      07107       goto     wykryto_enter 
                      07108       
                      07109 ;jeżeli zaznaczono że należy zmieniać już wartości to sprawdź które klawisze i które procedury 
                            wywołuję      
                      07110 ;      btfss       znaczniki,czy_moge_juz_zmieniac
                      07111  ;     goto        
                      07112       
                      07113       
                      07114       
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 154


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001D18                07115 LOOP_sprawdz_keys
001D18 A083           07116       btfss   latch_keys,latch_back
001D1A EC39 F007      07117       call    wcisnieto_back
                      07118                   
001D1E A283           07119       btfss    latch_keys,latch_down
001D20 EC40 F007      07120       call     wcisnieto_down
                      07121                            
001D24 A483           07122       btfss    latch_keys,latch_up
001D26 EC4C F007      07123       call     wcisnieto_up
                      07124          
001D2A A683           07125       btfss    latch_keys,latch_enter
001D2C EC71 F007      07126       call     wcisnieto_enter
                      07127 
001D30                07128 LOOP11      
001D30 B7A1           07129       btfsc markers3,odswiezanie_zegara
001D32 EFBA F002      07130       goto  napisz_czas
                      07131       
001D36                07132 LOOP_temperatury      
                      07133 ;jezeli jest ustawiony bit pomiary to sprawdz 
001D36 A5A0           07134          btfss    markers2,pomiary
001D38 EFAA F00E      07135          goto     LOOP1
                      07136 
                      07137          
                      07138 ;jezeli ustawiony jest bit czy_wlaczyc_ponownie_temp to nawet nie sprawdzaj
001D3C B7A1           07139             btfsc      markers3,odswiezanie_zegara
001D3E EFAA F00E      07140             goto        LOOP1   
                      07141          
001D42 B59F           07142          btfsc    markers,pomiary_zrobione
001D44 EFAA F00E      07143          goto     LOOP1
                      07144          
001D48 B79F           07145          btfsc    markers,inicjuj_pomiary
001D4A EC04 F003      07146          call     rozpocznij_pomiary
                      07147                   
001D4E B9A0           07148          btfsc    markers2,wyslij_pomiar
001D50 ECF8 F004      07149          call     wysylanie_pomiaru
001D54                07150 LOOP1         
001D54 B3A0           07151          btfsc    markers2,przerwanie_t1
001D56 EC18 F003      07152          call     procedura_obslugi_zegara
                      07153          
001D5A B7A0           07154          btfsc    markers2,sprawdz_odebrane
001D5C ECF5 F003      07155          call     sprawdz_czy_polecenie
                      07156 
                      07157 
                      07158 ;          btfsc    markers2,wyswietl
                      07159 ;          call     wyswietl_litere
                      07160                   
                      07161 ;        btfsc    markers2,blad_transmisji
                      07162 ;        call     wyswietl_error
                      07163          
                      07164          
                      07165          
                      07166 ;        btfsc    markers2,poczatkowy_bit
                      07167 ;        call     poczatek_odbioru
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 155


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      07168          
001D60                07169 LOOP2    
                      07170          
                      07171 
001D60 EF7D F00E      07172          goto     LOOP
                      07173          
                      07174 
                      07175 
                      07176          
                      07177          
                      07178          
                      07179          
                      07180          
                      07181          
                      07182          
                      07183          
                      07184          
                      07185          
                      07186          
                      07187          
                      07188          
                      07189          
                      07190          
                      07191          
                      07192          
                      07193          
                      07194          
                      07195          
                      07196          
                      07197          
                      07198          
                      07199          
                      07200          
                      07201          
                      07202          
                      07203          
                      07204          
                      07205          
                      07206          
                      07207          
                      07208          
                      07209          
                      07210          
                      07211 ;tu sa procedury inicjacyjne!
                      07212 
                      07213 
                      07214 
                      07215 
                      07216 
                      07217 
                      07218 
                      07219          
                      07220 ; org    800h
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 156


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      07221 ;ta funkcja zlicza nacisniecia klawisza rb0ółńżą
                      07222 ;funkcja odczekuj?ca
                      07223 
                      07224 
                      07225 
                      07226          
                      07227 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      07228 
                      07229 ;POCZATEK
                      07230 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;       
                      07231          ;org      0800h    
                      07232 
                      07233 
                      07234                 
001D64                07235 inicjacja
                      07236 ;czestotliwosc
                      07237 ;4,194MHz
                      07238         
001D64 6AF2           07239         clrf    INTCON
001D66 6AA0           07240         clrf    PIE2
001D68 92A1           07241         bcf     PIR2,TMR3IF
                      07242         
001D6A 0ED9           07243         movlw       b'11011001'
001D6C 6EB1           07244         movwf       T3CON
001D6E 0E02           07245         movlw    0x2
001D70 6F8B           07246         movwf    n
001D72                07247 czekaj05sek_1
001D72 A2A1           07248         btfss  PIR2,TMR3IF
001D74 EFB9 F00E      07249         goto     czekaj05sek_1
001D78 92A1           07250         bcf     PIR2,TMR3IF
001D7A 2F8B           07251         decfsz   n,f
001D7C EFB9 F00E      07252         goto     czekaj05sek_1
                      07253          
                      07254          
                      07255 ; czekaj05sek_2
                      07256         ; btfss  PIR2,TMR3IF
                      07257         ; goto     czekaj05sek_2
                      07258          
                      07259          ;ulamek 0,25 - tzn 1 
                      07260           ;movlw    0x0
                      07261           ;movlw   numer_opcji_koncowej
                      07262           ;movwf   
                      07263           ;movwf    tmp
                      07264           ;decf    tmp,f
                      07265           ;bsf   tmp,(menu_opcje_end)
                      07266           ;btfss   STATUS,C
                      07267           ;incf    tmp,f
                      07268 ;          
                      07269 ;          addlw    0xc3
                      07270          ;movwf    tmp7
                      07271          ;mnoze 2,5 * 0x30 tzn 
                      07272          ;movlw    0x30
                      07273          ;ulamek
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 157


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      07274          ;mulwf    tmp
                      07275          ;movf     PRODH,w
                      07276          ;movwf    dec10
                      07277          ;movf    PRODL,w
                      07278          ;movwf    dec1
                      07279          
                      07280          ;movlw    0x30
                      07281          
                      07282          
                      07283          ;mulwf    tmp7
                      07284          
                      07285          
001D80 6AD8           07286          clrf    STATUS ;czyszcze status
                      07287          ;movlw    
                      07288          ;clrf    czas;
001D82 6A80           07289          clrf     PORTA
001D84 6A81           07290          clrf     PORTB
001D86 6A82           07291          clrf     PORTC
001D88 6A83           07292           clrf     PORTD
001D8A 6A84           07293          clrf     PORTE
001D8C 6A89           07294          clrf     LATA
001D8E 6A8A           07295          clrf     LATB
001D90 6A8B           07296          clrf     LATC
001D92 6A8C           07297          clrf     LATD
001D94 6A8D           07298          clrf     LATE
                      07299 ;przerwania kompatybilne z 16fxx
001D96 8ED0           07300          bsf      RCON,IPEN         
                      07301          
                      07302 ;ustawiam TMR1
                      07303                                     ;Timer 1 ustawiony jako 1/16 sekundy
001D98 0E01           07304          movlw    b'00000001'
001D9A 6ECD           07305          movwf    T1CON
                      07306 ;pzrerwania
001D9C 6AF2           07307          clrf     INTCON
001D9E 8EF2           07308          bsf      INTCON,GIE
001DA0 8CF2           07309          bsf      INTCON,PEIE
                      07310          
                      07311          
001DA2 6AF0           07312          clrf     INTCON3
001DA4 0E80           07313          movlw    b'10000000'
001DA6 6EF1           07314          movwf    INTCON2
001DA8 9AF2           07315          bcf     INTCON,TMR0IE
001DAA 9896           07316          bcf      TRISE,PSPMODE
001DAC 9AC6           07317          bcf      SSPCON1,SSPEN
001DAE 9EAB           07318          BCF      RCSTA,SPEN
                      07319          
                      07320          ;ustawienia comparatora
001DB0 0E00           07321          movlw    b'00000000'
001DB2 6EB5           07322          movwf    CVRCON
                      07323          ;komparator wylaczony
001DB4 0E07           07324          movlw    b'00000111'
001DB6 6EB4           07325          movwf    CMCON
                      07326          ;movlw   b'00000000'       ;wszystkie linie na wysoko
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 158


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      07327          ;ovwf    PORTB
                      07328          
001DB8                07329 CCP_init         
001DB8 0E00           07330          movlw    0
001DBA 6EBD           07331          movwf    CCP1CON
001DBC 6EBA           07332          movwf    CCP2CON
                      07333          ;BCF     
001DBE 6ACC           07334          clrf     TMR2
                      07335          
001DC0                07336 Timer3_init                      
                      07337                            ;ustawienie zegara tmr3
                      07338                            
                      07339                            
                      07340                            ;zegar odpowiada za przyciski
001DC0 0E51           07341             movlw       b'01010001'
001DC2 6EB1           07342             movwf       T3CON
                      07343          
                      07344          
001DC4                07345 BEGIN2lcd_init
                      07346          ;bsf      STATUS,RP0        ;bank 1
001DC4 6A9D           07347          clrf     PIE1
001DC6 6AA0           07348          clrf     PIE2
001DC8 809D           07349          bsf      PIE1,TMR1IE
                      07350          
                      07351      ;ustawiam na wyjscia 1 -wejscie
                      07352         ;movlw   b'11111111'
                      07353          
001DCA 0E3F           07354          movlw    b'00111111'
001DCC 6E92           07355          movwf    TRISA
                      07356          
                      07357         IF (czy_ekran==1)
001DCE 0EE0           07358          movlw   b'11100000'
001DD0 6E93           07359          movwf    TRISB
                      07360         ENDIF
                      07361 
                      07362         IF (czy_ekran==0)
                      07363          movlw   b'11111111'
                      07364          movwf    TRISB
                      07365         ENDIF
                      07366 
001DD2 0EA0           07367         movlw   b'10100000'
001DD4 6E94           07368          movwf    TRISC
                      07369          
                      07370 ;tu sie zminienia dla kabli
                      07371         ;movlw   b'11111111'
                      07372         IF (czy_ekran==1)        
001DD6 0E0F           07373          movlw    normalne_ustawienie_tris_lcd
001DD8 6E95           07374          movwf    TRISD
                      07375         ENDIF
                      07376          
                      07377         IF (czy_ekran==0)
                      07378          movlw    0x0F
                      07379          movwf    TRISD
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 159


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      07380         ENDIF
                      07381          
001DDA 0E07           07382          movlw   b'00000111'
001DDC 6E96           07383          movwf    TRISE
                      07384          
                      07385          
                      07386 ;ustawienia timera 0
001DDE 0EC7           07387          movlw    b'11000111'
001DE0 6ED5           07388          movwf    T0CON
                      07389  ;dopiero teraz w??cz zegar
                      07390          
                      07391     
                      07392 
                      07393 ;90  czyli 5a
                      07394 ;50      32
                      07395 ;210(200us) d2
                      07396 ;196(190us) c4    
                      07397 ;        movlw    b'11010010'
001DE2 0E80           07398          movlw    0x80
001DE4 6ECB           07399          movwf    PR2
                      07400          
                      07401 ;bank 0
                      07402          ;bcf      STATUS,RP0
                      07403 ;        movlw    b'01000000'
                      07404 ;        movwf    ADCON0
                      07405          
                      07406 ;ustawiam TMR2 z licznikiem 1:1
                      07407          
                      07408 ;wyczyscic trzeba pamiec na zmienne
                      07409 ;jezeli tego nie zrobie to
                      07410 ;po wlaczeniu zasilani moga pojawic
                      07411 ; sie problemy bo moga tam byc losowe dane
                      07412 ;od 000 do f7f
001DE6 0E80           07413          movlw    0x80
001DE8 6EE9           07414          movwf    FSR0L
001DEA 6AEA           07415          clrf     FSR0H
001DEC                07416 next
                      07417          ;movlw   0
001DEC 6AEF           07418          clrf     INDF0
001DEE 2AE9           07419          INCF     FSR0L,f
                      07420          ;movlw    0ffh
                      07421          
001DF0 A0D8           07422          btfss    STATUS,C
001DF2 EFF6 F00E      07423          goto     next
                      07424          
001DF6 2AEA           07425          incf     FSR0H,f
001DF8 0E02           07426          movlw    b'00000010' ;02 banki
001DFA 18EA           07427          xorwf    FSR0H,w
001DFC A4D8           07428          BTFSS    STATUS,Z
                      07429          ;btfss    FSR0H,4
001DFE EFF6 F00E      07430          goto     next
                      07431          
                      07432          
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 160


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      07433          
                      07434          
001E02                07435 test_koniec
                      07436          
                      07437          ;bcf      PCLATH,3
                      07438          ;bcf      PCLATH,4
001E02 6AFA           07439          clrf     PCLATH
001E04 EFCB F001      07440          goto    Start
                      07441                   
                      07442 ;test ustawiania probkowania
                      07443 ;0x2a 0x93 probka         
                      07444 
                      07445 
                      07446 
                      07447       
                      07448 ;menu wyswietlane w ten sposob, ze na jednym ekranie umieszczone sa cztery opcje
                      07449 ;a do kazdej linii odnosi sie zwiazana z nia tablica nazw opcji
                      07450 ;przy przejsciu do kolejnego ekranu opcji nastepuje zmiana tych opcji na kolejne
                      07451 
                      07452          ; org         0x1e00
                      07453          
                      07454       
                      07455       
                      07456         
001E08                07457 tablica_pierwsza
001E08 6F70 696D 7261 07458       db   "pomiar t",0,"odstep",0,"srednia",0, "pomiar i" ,0
       7420 6F00 7364 
       6574 0070 7273 
       6465 696E 0061 
       6F70 696D 7261 
       6920 0000 
                      07459       
001E2A                07460 tablica_druga
001E2A 7375 6174 2077 07461       db    "ustaw t1",0,"ustaw t2",0,"wlacz1" ,0, "wlacz2" ,0
       3174 7500 7473 
       7761 7420 0032 
       6C77 6361 317A 
       7700 616C 7A63 
       0032 
                      07462       
001E4A                07463 tablica_trzecia
001E4A 6968 2073 3172 07464       db     "his r1 1",0,"his r1 2",0x19,0,"his r2 1" ,0,"his r2 2" ,0
       3120 6800 7369 
       7220 2031 1932 
       6800 7369 7220 
       2032 0031 6968 
       2073 3272 3220 
       0000 
                      07465 ;,0x5e  - ^
001E70                07466 tablica_czwarta
001E70 6572 7567 616C 07467       db     "regulacja1",0,"regulacja2",0,"czuj r 1",0,"czuj r 2",0
       6A63 3161 7200 
       6765 6C75 6361 
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 161


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

       616A 0032 7A63 
       6A75 7220 3120 
       6300 757A 206A 
       2072 0032 
                      07468       ;"przesyl serial",0
                      07469       
001E98                07470 tablica_piata
001E98 7977 7773 6569 07471       db     "wyswietl. zegar",0,"wyswietl. temp",0,"podswietlenie",0,"zegar",0      
       6C74 202E 657A 
       6167 0072 7977 
       7773 6569 6C74 
       202E 6574 706D 
       7000 646F 7773 
       6569 6C74 6E65 
       6569 7A00 6765 
       7261 0000 
                      07472 ;####################  TABLICA POLOZEN gwiazdki
                      07473 
001ECC                07474 tablica_gwiazdki        
001ECC 8000 90C0 01D0 07475       db    0,linia_gorna,linia_dolna,linia_trzecia,linia_czwarta,1
                      07476 
                      07477 
                      07478 
                      07479 
                      07480 
                      07481 
                      07482 
                      07483 
                      07484          end
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 162


SYMBOL TABLE
  LABEL                             VALUE 

A                                 00000000
ACCESS                            00000000
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACQT0                             00000003
ACQT1                             00000004
ACQT2                             00000005
ADCON0                            00000FC2
ADCON1                            00000FC1
ADCON2                            00000FC0
ADCS0                             00000000
ADCS1                             00000001
ADCS2                             00000002
ADDEN                             00000003
ADEN                              00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADIP                              00000006
ADON                              00000000
ADRES                             00000FC3
ADRESH                            00000FC4
ADRESL                            00000FC3
AN0                               00000000
AN1                               00000001
AN10                              00000001
AN11                              00000004
AN12                              00000000
AN2                               00000002
AN3                               00000003
AN4                               00000005
AN5                               00000000
AN6                               00000001
AN7                               00000002
AN8                               00000002
AN9                               00000003
BANKED                            00000001
BCLIE                             00000003
BCLIF                             00000003
BCLIP                             00000003
BEGIN                             00000000
BEGIN2lcd_init                    00001DC4
BF                                00000000
BOR                               00000000
BRGH                              00000002
BSR                               00000FE0
C                                 00000000
C1INV                             00000004
C1OUT_CMCON                       00000006
C1OUT_PORTA                       00000004
C2INV                             00000005
C2OUT_CMCON                       00000007
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 163


SYMBOL TABLE
  LABEL                             VALUE 

C2OUT_PORTA                       00000005
CCP1                              00000002
CCP1CON                           00000FBD
CCP1IE                            00000002
CCP1IF                            00000002
CCP1IP                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2A                             00000003
CCP2CON                           00000FBA
CCP2IE                            00000000
CCP2IF                            00000000
CCP2IP                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCP2_PORTB                        00000003
CCP2_PORTC                        00000001
CCPR1                             00000FBE
CCPR1H                            00000FBF
CCPR1L                            00000FBE
CCPR2                             00000FBB
CCPR2H                            00000FBC
CCPR2L                            00000FBB
CCP_init                          00001DB8
CFGS                              00000006
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CIS                               00000003
CK                                00000006
CKE                               00000006
CKP                               00000004
CLKI                              00000007
CLKO                              00000006
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             00000FB4
CMIE                              00000006
CMIF                              00000006
CMIP                              00000006
CREN                              00000004
CS                                00000002
CSRC                              00000007
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 164


SYMBOL TABLE
  LABEL                             VALUE 

CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            00000FB5
CVREF                             00000002
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC2B0                             00000004
DC2B1                             00000005
DCP1X                             00000005
DCP1Y                             00000004
DCP2X                             00000005
DCP2Y                             00000004
DDRA                              TRISA
DDRB                              TRISB
DDRC                              TRISC
DDRD                              TRISD
DDRE                              TRISE
DONE                              00000001
D_A                               00000005
D_NOT_A                           00000005
ECCPAS                            00000FB6
ECCPAS0                           00000004
ECCPAS1                           00000005
ECCPAS2                           00000006
ECCPASE                           00000007
EEADR                             00000FA9
EECON1                            00000FA6
EECON2                            00000FA7
EEDATA                            00000FA8
EEIE                              00000004
EEIF                              00000004
EEIP                              00000004
EEPGD                             00000007
FAST                              00000001
FERR                              00000002
FLTS                              00000002
FREE                              00000004
FSR0                              00000000
FSR0H                             00000FEA
FSR0L                             00000FE9
FSR1                              00000001
FSR1H                             00000FE2
FSR1L                             00000FE1
FSR2                              00000002
FSR2H                             00000FDA
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 165


SYMBOL TABLE
  LABEL                             VALUE 

FSR2L                             00000FD9
GCEN                              00000007
GIE                               00000007
GIEH                              00000007
GIEL                              00000006
GIE_GIEH                          00000007
GO                                00000001
GO_DONE                           00000001
GO_NOT_DONE                       00000001
I2C_DAT                           00000005
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
IDLEN                             00000007
INDF0                             00000FEF
INDF1                             00000FE7
INDF2                             00000FDF
INT0                              00000000
INT0E                             00000004
INT0F                             00000001
INT0IE                            00000004
INT0IF                            00000001
INT1                              00000001
INT1E                             00000003
INT1F                             00000000
INT1IE                            00000003
INT1IF                            00000000
INT1IP                            00000006
INT1P                             00000006
INT2                              00000002
INT2E                             00000004
INT2F                             00000001
INT2IE                            00000004
INT2IF                            00000001
INT2IP                            00000007
INT2P                             00000007
INTCON                            00000FF2
INTCON2                           00000FF1
INTCON3                           00000FF0
INTE                              00000004
INTEDG0                           00000006
INTEDG1                           00000005
INTEDG2                           00000004
INTF                              00000001
IOFS                              00000002
IPEN                              00000007
IPR1                              00000F9F
IPR2                              00000FA2
IRCF0                             00000004
IRCF1                             00000005
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 166


SYMBOL TABLE
  LABEL                             VALUE 

IRCF2                             00000006
IRVST                             00000005
IVRST                             00000005
KBI0                              00000004
KBI1                              00000005
KBI2                              00000006
KBI3                              00000007
LATA                              00000F89
LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA3                             00000003
LATA4                             00000004
LATA5                             00000005
LATA6                             00000006
LATA7                             00000007
LATB                              00000F8A
LATB0                             00000000
LATB1                             00000001
LATB2                             00000002
LATB3                             00000003
LATB4                             00000004
LATB5                             00000005
LATB6                             00000006
LATB7                             00000007
LATC                              00000F8B
LATC0                             00000000
LATC1                             00000001
LATC2                             00000002
LATC3                             00000003
LATC4                             00000004
LATC5                             00000005
LATC6                             00000006
LATC7                             00000007
LATD                              00000F8C
LATD0                             00000000
LATD1                             00000001
LATD2                             00000002
LATD3                             00000003
LATD4                             00000004
LATD5                             00000005
LATD6                             00000006
LATD7                             00000007
LATE                              00000F8D
LATE0                             00000000
LATE1                             00000001
LATE2                             00000002
LOOP                              00001CFA
LOOP1                             00001D54
LOOP11                            00001D30
LOOP2                             00001D60
LOOP_sprawdz_keys                 00001D18
LOOP_temperatury                  00001D36
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 167


SYMBOL TABLE
  LABEL                             VALUE 

LVDCON                            00000FD2
LVDEN                             00000004
LVDIE                             00000002
LVDIF                             00000002
LVDIN                             00000005
LVDIP                             00000002
LVDL0                             00000000
LVDL1                             00000001
LVDL2                             00000002
LVDL3                             00000003
MCLR                              00000003
N                                 00000004
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BOR                           00000000
NOT_CS                            00000002
NOT_DONE                          00000001
NOT_PD                            00000002
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RD                            00000000
NOT_RI                            00000004
NOT_SS                            00000005
NOT_T1SYNC                        00000002
NOT_T3SYNC                        00000002
NOT_TO                            00000003
NOT_W                             00000002
NOT_WR                            00000001
NOT_WRITE                         00000002
OBF                               00000006
OERR                              00000001
OSC1                              00000007
OSC2                              00000006
OSCCON                            00000FD3
OSCFIE                            00000007
OSCFIF                            00000007
OSCFIP                            00000007
OSCTUN2                           00000F9A
OSCTUNE                           00000F9B
OSTS                              00000003
OV                                00000003
P                                 00000004
P1A                               00000002
P1B                               00000005
P1C                               00000006
P1D                               00000007
P1M0                              00000006
P1M1                              00000007
PC                                00000FF9
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 168


SYMBOL TABLE
  LABEL                             VALUE 

PCL                               00000FF9
PCLATH                            00000FFA
PCLATU                            00000FFB
PD                                00000002
PDC0                              00000000
PDC1                              00000001
PDC2                              00000002
PDC3                              00000003
PDC4                              00000004
PDC5                              00000005
PDC6                              00000006
PEIE                              00000006
PEIE_GIEL                         00000006
PEN                               00000002
PGC                               00000006
PGD                               00000007
PGM                               00000005
PIE1                              00000F9D
PIE2                              00000FA0
PIR1                              00000F9E
PIR2                              00000FA1
PLUSW0                            00000FEB
PLUSW1                            00000FE3
PLUSW2                            00000FDB
POR                               00000001
PORTA                             00000F80
PORTB                             00000F81
PORTC                             00000F82
PORTD                             00000F83
PORTE                             00000F84
POSTDEC0                          00000FED
POSTDEC1                          00000FE5
POSTDEC2                          00000FDD
POSTINC0                          00000FEE
POSTINC1                          00000FE6
POSTINC2                          00000FDE
PR2                               00000FCB
PREINC0                           00000FEC
PREINC1                           00000FE4
PREINC2                           00000FDC
PROD                              00000FF3
PRODH                             00000FF4
PRODL                             00000FF3
PRSEN                             00000007
PSA                               00000003
PSP0                              00000000
PSP1                              00000001
PSP2                              00000002
PSP3                              00000003
PSP4                              00000004
PSP5                              00000005
PSP6                              00000006
PSP7                              00000007
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 169


SYMBOL TABLE
  LABEL                             VALUE 

PSPIE                             00000007
PSPIF                             00000007
PSPIP                             00000007
PSPMODE                           00000004
PSSAC0                            00000002
PSSAC1                            00000003
PSSBD0                            00000000
PSSBD1                            00000001
PWM1CON                           00000FB7
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RA6                               00000006
RA7                               00000007
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RBIP                              00000000
RBPU                              00000007
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCIP                              00000005
RCON                              00000FD0
RCREG                             00000FAE
RCSTA                             00000FAB
RD                                00000000
RD0                               00000000
RD1                               00000001
RD16                              00000007
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 170


SYMBOL TABLE
  LABEL                             VALUE 

RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
RE3                               00000003
READ_WRITE                        00000002
RI                                00000004
RSEN                              00000001
RX                                00000007
RX9                               00000006
RX9D                              00000000
RXD                               00000007
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SCK                               00000003
SCL                               00000003
SCS                               00000000
SCS0                              00000000
SCS1                              00000001
SDA                               00000004
SDI                               00000004
SDO                               00000005
SEN                               00000000
SMP                               00000007
SP0                               00000000
SP1                               00000001
SP2                               00000002
SP3                               00000003
SP4                               00000004
SPBRG                             00000FAF
SPEN                              00000007
SREN                              00000005
SS                                00000005
SSPADD                            00000FC8
SSPBUF                            00000FC9
SSPCON1                           00000FC6
SSPCON2                           00000FC5
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPIP                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000FC7
STATUS                            00000FD8
STKFUL                            00000007
STKOVF                            00000007
STKPTR                            00000FFC
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 171


SYMBOL TABLE
  LABEL                             VALUE 

STKPTR0                           00000000
STKPTR1                           00000001
STKPTR2                           00000002
STKPTR3                           00000003
STKPTR4                           00000004
STKUNF                            00000006
SWDTE                             00000000
SWDTEN                            00000000
SYNC                              00000004
Start                             00000396
T016BIT                           00000006
T08BIT                            00000006
T0CKI                             00000004
T0CON                             00000FD5
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0IP                              00000002
T0PS0                             00000000
T0PS1                             00000001
T0PS2                             00000002
T0PS3                             00000003
T0SE                              00000004
T13CKI                            00000000
T1CKI                             00000000
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000FCD
T1OSCEN                           00000003
T1OSI                             00000001
T1OSO                             00000000
T1RUN                             00000006
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000FCA
T3CCP1                            00000003
T3CCP2                            00000006
T3CKPS0                           00000004
T3CKPS1                           00000005
T3CON                             00000FB1
T3SYNC                            00000002
TABLAT                            00000FF5
TBLPTR                            00000FF6
TBLPTRH                           00000FF7
TBLPTRL                           00000FF6
TBLPTRU                           00000FF8
TMR0                              00000FD6
TMR0H                             00000FD7
TMR0IE                            00000005
TMR0IF                            00000002
TMR0IP                            00000002
TMR0L                             00000FD6
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 172


SYMBOL TABLE
  LABEL                             VALUE 

TMR0ON                            00000007
TMR1                              00000FCE
TMR1CS                            00000001
TMR1H                             00000FCF
TMR1IE                            00000000
TMR1IF                            00000000
TMR1IP                            00000000
TMR1L                             00000FCE
TMR1ON                            00000000
TMR2                              00000FCC
TMR2IE                            00000001
TMR2IF                            00000001
TMR2IP                            00000001
TMR2ON                            00000002
TMR3                              00000FB2
TMR3CS                            00000001
TMR3H                             00000FB3
TMR3IE                            00000001
TMR3IF                            00000001
TMR3IP                            00000001
TMR3L                             00000FB2
TMR3ON                            00000000
TMR_nie_pusty                     0000063A
TO                                00000003
TOS                               00000FFD
TOSH                              00000FFE
TOSL                              00000FFD
TOSU                              00000FFF
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000F92
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISA6                            00000006
TRISA7                            00000007
TRISB                             00000F93
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000F94
TRISC0                            00000000
TRISC1                            00000001
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 173


SYMBOL TABLE
  LABEL                             VALUE 

TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000F95
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000F96
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TUN5                              00000005
TUNSEL                            00000007
TX                                00000006
TX9                               00000006
TX9D                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXIP                              00000004
TXREG                             00000FAD
TXREG_nie_pusty                   00000640
TXSTA                             00000FAC
Timer3_init                       00001DC0
UA                                00000001
VCFG0                             00000004
VCFG1                             00000005
VREFM                             00000002
VREFP                             00000003
W                                 00000000
WCOL                              00000007
WDTCON                            00000FD1
WR                                00000001
WREG                              00000FE8
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_1                                00000031
_16K                              000000FD
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 174


SYMBOL TABLE
  LABEL                             VALUE 

_1K                               000000F5
_2                                00000032
_2K                               000000F7
_3                                00000033
_32K                              000000FF
_4                                00000034
_4K                               000000F9
_5                                00000035
_6                                00000036
_7                                00000037
_8                                00000038
_8K                               000000FB
_9                                00000039
_A                                00000041
_B                                00000042
_BORV_20_2L                       000000FF
_BORV_27_2L                       000000FB
_BORV_42_2L                       000000F7
_BORV_45_2L                       000000F3
_BOR_OFF_2L                       000000FD
_BOR_ON_2L                        000000FF
_C                                00000043
_CCP2MX_B3                        000000FE
_CCP2MX_B3_3H                     000000FE
_CCP2MX_C1                        000000FF
_CCP2MX_C1_3H                     000000FF
_CCP2MX_OFF                       000000FE
_CCP2MX_OFF_3H                    000000FE
_CCP2MX_ON                        000000FF
_CCP2MX_ON_3H                     000000FF
_CONFIG1H                         00300001
_CONFIG2H                         00300003
_CONFIG2L                         00300002
_CONFIG3H                         00300005
_CONFIG4L                         00300006
_CONFIG5H                         00300009
_CONFIG5L                         00300008
_CONFIG6H                         0030000B
_CONFIG6L                         0030000A
_CONFIG7H                         0030000D
_CONFIG7L                         0030000C
_CP0_OFF_5L                       000000FF
_CP0_ON_5L                        000000FE
_CP1_OFF_5L                       000000FF
_CP1_ON_5L                        000000FD
_CP2_OFF_5L                       000000FF
_CP2_ON_5L                        000000FB
_CP3_OFF_5L                       000000FF
_CP3_ON_5L                        000000F7
_CPB_OFF_5H                       000000FF
_CPB_ON_5H                        000000BF
_CPD_OFF_5H                       000000FF
_CPD_ON_5H                        0000007F
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 175


SYMBOL TABLE
  LABEL                             VALUE 

_D                                00000044
_DEBUG_OFF_4L                     000000FF
_DEBUG_ON_4L                      0000007F
_DEVID1                           003FFFFE
_DEVID2                           003FFFFF
_E                                00000045
_EBTR0_OFF_7L                     000000FF
_EBTR0_ON_7L                      000000FE
_EBTR1_OFF_7L                     000000FF
_EBTR1_ON_7L                      000000FD
_EBTR2_OFF_7L                     000000FF
_EBTR2_ON_7L                      000000FB
_EBTR3_OFF_7L                     000000FF
_EBTR3_ON_7L                      000000F7
_EBTRB_OFF_7H                     000000FF
_EBTRB_ON_7H                      000000BF
_ECIOP_OSC                        000000F5
_ECIOP_OSC_1H                     000000F5
_ECIO_OSC_1H                      000000F5
_EC_OSC                           000000F4
_EC_OSC_1H                        000000F4
_F                                00000046
_FSCM_OFF_1H                      000000BF
_FSCM_ON_1H                       000000FF
_G                                00000047
_H                                00000048
_HSPLL_OSC                        000000F6
_HSPLL_OSC_1H                     000000F6
_HS_OSC                           000000F2
_HS_OSC_1H                        000000F2
_I                                00000049
_IDLOC0                           00200000
_IDLOC1                           00200001
_IDLOC2                           00200002
_IDLOC3                           00200003
_IDLOC4                           00200004
_IDLOC5                           00200005
_IDLOC6                           00200006
_IDLOC7                           00200007
_IESO_OFF_1H                      0000007F
_IESO_ON_1H                       000000FF
_INTIO1_OSC                       000000F9
_INTIO1_OSC_1H                    000000F9
_INTIO2_OSC                       000000F8
_INTIO2_OSC_1H                    000000F8
_J                                0000004A
_K                                0000004B
_L                                0000004C
_LP_OSC                           000000F0
_LP_OSC_1H                        000000F0
_LVP_OFF_4L                       000000FB
_LVP_ON_4L                        000000FF
_M                                0000004D
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 176


SYMBOL TABLE
  LABEL                             VALUE 

_MCLRE_OFF_3H                     0000007F
_MCLRE_ON_3H                      000000FF
_N                                0000004E
_O                                0000004F
_P                                00000050
_PBAD_ANA_3H                      000000FF
_PBAD_DIG_3H                      000000FD
_PWRT_OFF_2L                      000000FF
_PWRT_ON_2L                       000000FE
_Q                                00000051
_R                                00000052
_RCIO_OSC                         000000F7
_RCIO_OSC_1H                      000000F7
_RC_OSC                           000000FC
_RC_OSC_1H                        000000FC
_S                                00000053
_STVR_OFF_4L                      000000FE
_STVR_ON_4L                       000000FF
_T                                00000054
_U                                00000055
_V                                00000056
_W                                00000057
_WDTPS_128_2H                     000000EF
_WDTPS_16K_2H                     000000FD
_WDTPS_16_2H                      000000E9
_WDTPS_1K_2H                      000000F5
_WDTPS_1_2H                       000000E1
_WDTPS_256_2H                     000000F1
_WDTPS_2K_2H                      000000F7
_WDTPS_2_2H                       000000E3
_WDTPS_32K_2H                     000000FF
_WDTPS_32_2H                      000000EB
_WDTPS_4K_2H                      000000F9
_WDTPS_4_2H                       000000E5
_WDTPS_512_2H                     000000F3
_WDTPS_64_2H                      000000ED
_WDTPS_8K_2H                      000000FB
_WDTPS_8_2H                       000000E7
_WDT_OFF_2H                       000000FE
_WDT_ON_2H                        000000FF
_WRT0_OFF_6L                      000000FF
_WRT0_ON_6L                       000000FE
_WRT1_OFF_6L                      000000FF
_WRT1_ON_6L                       000000FD
_WRT2_OFF_6L                      000000FF
_WRT2_ON_6L                       000000FB
_WRT3_OFF_6L                      000000FF
_WRT3_ON_6L                       000000F7
_WRTB_OFF_6H                      000000FF
_WRTB_ON_6H                       000000BF
_WRTC_OFF_6H                      000000FF
_WRTC_ON_6H                       000000DF
_WRTD_OFF_6H                      000000FF
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 177


SYMBOL TABLE
  LABEL                             VALUE 

_WRTD_ON_6H                       0000007F
_X                                00000058
_XT_OSC                           000000F1
_XT_OSC_1H                        000000F1
_Y                                00000059
_Z                                0000005A
__18F4320                         00000001
_a                                00000061
_b                                00000062
_c                                00000063
_d                                00000064
_dwukropek                        0000003A
_e                                00000065
_f                                00000066
_g                                00000067
_h                                00000068
_i                                00000069
_j                                0000006A
_k                                0000006B
_kropka                           0000002E
_l                                0000006C
_linia_pionowa                    0000007C
_m                                0000006D
_minus                            0000002D
_mniejszosci                      0000003C
_n                                0000006E
_o                                0000006F
_p                                00000070
_plus                             0000002B
_przecinek                        0000002C
_puste                            00000020
_q                                00000071
_r                                00000072
_s                                00000073
_star                             0000002A
_stopni                           000000DF
_t                                00000074
_u                                00000075
_up                               0000005E
_v                                00000076
_w                                00000077
_wiekszosci                       0000003E
_x                                00000078
_y                                00000079
_z                                0000007A
aktualny_odstep                   000000A6
bajt_ds                           000000D3
bez_wlaczania_pomiarow            00000630
bez_wyswietlania_pradu            00000B36
bez_wyswietlania_pradu2           00000B82
bez_wyswietlania_temp1            00000A6A
bez_wyswietlania_temp2            00000AF4
bit                               0000008C
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 178


SYMBOL TABLE
  LABEL                             VALUE 

bsr_temp                          00000083
check                             000002D0
check_busy                        000002C2
check_if_write                    00000374
clear_line                        000002A4
clear_line_old                    00000276
clear_line_old2                   0000028A
clear_line_petla                  000002AA
cmd_off                           00000272
cyfry_0_9                         000006EE
czekaj05sek                       00000228
czekaj05sek_1                     00001D72
czujnik_ds1820                    00000005
czy_ekran                         00000001
czy_moge_juz_zmieniac             00000002
czy_pomiary_na_ekran              00000001
czy_ponownie_wlaczyc_temp         00000000
czy_ponownie_wlaczyc_zegar        00000001
czy_reguluje1                     000000B7
czy_reguluje2                     000000B8
czy_usrednianie                   00000000
czy_wlaczyc_ponownie_temp         00000006
czy_wyswietlam_temp               00000005
czy_wysylac_pomiary_serial        00000004
czy_wysylanie                     00000001
czy_zegar_wyswietlac              00000002
czytaj_eeprom                     0000036A
czytam_4_linie                    000017F6
czytam_4_linie2                   00001802
czytam_4_linie3                   00001814
czytam_druga_linie                000017BA
czytam_druga_linie2               000017C6
czytam_pierwsza_linie             000017A8
czytam_trzecia_linie              000017D8
czytam_trzecia_linie2             000017E4
dana                              00000003
dane_lcd                          000000A3
dane_odebraneH                    00000001
dane_odebraneL                    00000000
dd_addres_set                     00000080
dec1                              00000098
dec10                             00000097
dec100                            00000096
disp_home                         00000002
display1_4b                       00000000
display2_4b                       0000000F
display_2                         0000000F
display_clear                     00000001
display_clear1_4b                 00000000
display_clear2_4b                 00000001
display_off                       00000008
display_on                        0000000C
dlugosc_oczekiwania_na_zmiane     00000004
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 179


SYMBOL TABLE
  LABEL                             VALUE 

do_sekundy                        000000E8
dzialanie_po_klawiszu             00000005
dzien_1                           000000E1
dzien_10                          000000E0
enable                            00000003
enter_back_wyjsc_z_op_wys_liczb   00001C96
enter_back_wyjsc_z_opcji_czujnik  00001C1A
entry                             00000006
entry1_4b                         00000000
entry2_4b                         0000000C
fsrh1_temp                        000000EE
fsrh_temp                         00000085
fsrl1_temp                        000000ED
fsrl_temp                         00000084
function_set1_4b                  00000003
function_set2                     00000008
function_set2_4b                  00000008
godziny_1                         000000E3
godziny_10                        000000E2
hex2_dec_koniec                   00000572
hex2dec18                         0000050E
hex2dec18_brak_setek              00000544
hex2dec18_nie_przekroczono_1      00000532
hex2dec_temperatur_popraw_o_128   00000562
hex2dec_temperatur_popraw_o_64    00000556
histereza_R1_1                    000000B3
histereza_R1_2                    000000B4
histereza_R2_1                    000000B5
histereza_R2_2                    000000B6
ile_kanalow                       000000AC
ile_znakow                        00000010
ilosc_czujnikow                   00000007
inicjacja                         00001D64
inicjuj_pomiar                    000006F8
inicjuj_pomiary                   00000003
init_4bit                         0000002A
init_8bit                         00000030
jak_duzo_kanalow_pradu            000000DE
jak_duzo_probek                   000000AE
jak_duzo_zliczen_tmr1_na_sekunde  00000010
jaka_wartosc_regulujeH1           000000AF
jaka_wartosc_regulujeH2           000000B1
jaka_wartosc_regulujeL1           000000B0
jaka_wartosc_regulujeL2           000000B2
juz_wysylac_znak_LF               00000E06
kalibracja                        00000000
kb_change                         00000004
kb_cofnij                         00000005
kb_enter                          00000006
kb_minus                          00000007
koncz_z_moca                      00000D6E
koncz_z_moca2                     00000D8C
koniec_mierzenia                  00000D90
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 180


SYMBOL TABLE
  LABEL                             VALUE 

koniec_pomiarow                   00000E16
koniec_wyswietlania               000008A2
kopiuj_liczbe_przeslana           000006C6
ktora_probka                      000000BB
ktore_bity_lcd_tris               000000F0
ktore_bity_uzywane_na_lcd         0000000F
ktory_aktualnie_kanal_pradu       000000DF
ktory_czujnik_reguluje1           000000B9
ktory_czujnik_reguluje2           000000BA
ktory_kanal                       000000BC
ktory_kanal_mierze                000000AB
ktory_rejestr_zapisuje            000000A7
lampka                            00000004
lampka2                           00000004
latch_back                        00000000
latch_down                        00000001
latch_enter                       00000003
latch_keys                        00000F83
latch_lcd                         00000F8C
latch_lcd_e                       00000F8B
latch_lcd_rs                      00000F8A
latch_lcd_rw                      00000F8A
latch_moc                         00000F8A
latch_multiplekser                00000F8B
latch_up                          00000002
lcd_init                          000002F6
letter                            0000008A
liczba1                           0000008E
liczba2                           0000008F
liczba3                           00000090
linia1                            00000086
linia2                            00000087
linia3                            00000088
linia4                            00000089
linia_czwarta                     000000D0
linia_dolna                       000000C0
linia_druga                       000000C0
linia_gorna                       00000080
linia_pierwsza                    00000080
linia_trzecia                     00000090
ma                                00000002
mala_petla                        00000218
mamy_back                         00000000
mamy_down                         00000001
mamy_enter                        00000003
mamy_up                           00000002
markers                           0000009F
markers2                          000000A0
markers3                          000000A1
markers_regulacja                 000000A2
max_procedury_regu                00000003
mb                                00000001
mc                                00000000
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 181


SYMBOL TABLE
  LABEL                             VALUE 

menu_opcje1                       00000000
menu_opcje2                       00000001
menu_opcje3                       00000002
menu_opcje4                       00000003
menu_opcje5                       00000004
menu_opcje_end                    00000005
minuty_1                          000000E5
minuty_10                         000000E4
n                                 0000008B
napisz_czas                       00000574
napisz_czas_dalej1                00000592
napisz_czas_litera_r              00000590
napisz_minus                      00000006
napisz_wartosc_temperatury        00000AC8
next                              00001DEC
nie                               00000001
nie_czysc_rejestru_polozenia      00000A7C
nie_pisz_litery_r                 0000058A
nie_przekroczono_bajtu_ulamka     000009DC
normalne_ustawienie_tris_lcd      0000000F
numer_opcji                       000000EA
numer_opcji_koncowej              00000014
odczytaj_adr_polozenia_gwiazdki   00001BC4
odczytuje_opcje_z_eeprom          00000416
odebrano_liter                    0000008D
odejmij_512_od_wyniku_sredniej    00000990
odstep_pomiarowy                  000000AD
odswiezanie_zegara                00000003
odznacz_by_znow_mierzyc           000005F6
opcja_czujnik_regulacji1          0000000F
opcja_czujnik_regulacji2          00000010
opcja_czujniki                    00000001
opcja_histereza_R1_1              00000009
opcja_histereza_R1_2              0000000A
opcja_histereza_R2_1              0000000B
opcja_histereza_R2_2              0000000C
opcja_odstep                      00000002
opcja_podswietlenie               00000013
opcja_pomiar_i                    00000004
opcja_regulacja1                  0000000D
opcja_regulacja2                  0000000E
opcja_srednia                     00000003
opcja_ustaw_temp_R1               00000005
opcja_ustaw_temp_R2               00000006
opcja_ustaw_zegar                 00000014
opcja_wlacz_1                     00000007
opcja_wlacz_2                     00000008
opcja_wyswietl_temp               00000012
opcja_wyswietl_zegar              00000011
pclath_temp                       00000082
petla_dzielenia                   000009AA
petla_napisz_czas                 000005BC
petla_napisz_czas_dwukropek       000005B2
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 182


SYMBOL TABLE
  LABEL                             VALUE 

petla_odczytu_poprawek_z_eeprom   000003A4
petla_odczytuje_opcje_z_eeprom    0000041E
petla_spr_nastaw                  000004A6
petla_spr_nastaw_dalej            000004B2
petla_spr_nastaw_dalej2           000004C0
petla_zapisu                      00000202
pin_A                             00000000
pin_B                             00000001
pin_C                             00000002
pin_e_4724                        00000001
pisz_cyfre_1                      00000912
pisz_cyfre_10                     00000906
pisz_cyfre_100                    000008FA
pisz_ulamek_00                    00000938
pisz_ulamek_25                    0000094E
pisz_ulamek_50                    00000964
pisz_ulamek_75                    0000097A
pokaz_rejestr                     000006F4
pokazuje_temperatury_47           00000007
polecenie_wysylane                000000BE
polozenie_danych_lcd              00000001
polozenie_gwiazdki                000000EB
polozenie_liczby_menu             0000000A
pomiar0H                          000000BF
pomiar0L                          000000C0
pomiar1H                          000000C1
pomiar1L                          000000C2
pomiar2H                          000000C3
pomiar2L                          000000C4
pomiar3H                          000000C5
pomiar3L                          000000C6
pomiar4H                          000000C7
pomiar4L                          000000C8
pomiar5H                          000000C9
pomiar5L                          000000CA
pomiar6H                          000000CB
pomiar6L                          000000CC
pomiar7H                          000000CD
pomiar7L                          000000CE
pomiarH                           000000A8
pomiarL                           000000A9
pomiar_prad1                      00000002
pomiar_prad1H                     000000CF
pomiar_prad1L                     000000D0
pomiar_prad2                      00000004
pomiar_prad2H                     000000D1
pomiar_prad2L                     000000D2
pomiar_ulamek                     000000AA
pomiary                           00000002
pomiary_pradu                     00000000
pomiary_zrobione                  00000002
poprawka0                         000000D4
poprawka0_ee                      00000000
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 183


SYMBOL TABLE
  LABEL                             VALUE 

poprawka1                         000000D5
poprawka1_ee                      00000001
poprawka2                         000000D6
poprawka2_ee                      00000002
poprawka3                         000000D7
poprawka3_ee                      00000003
poprawka4                         000000D8
poprawka4_ee                      00000004
poprawka5                         000000D9
poprawka5_ee                      00000005
poprawka6                         000000DA
poprawka6_ee                      00000006
poprawka7                         000000DB
poprawka7_ee                      00000007
poprawka_prad1                    000000DC
poprawka_prad1_ee                 00000008
poprawka_prad2                    000000DD
poprawka_prad2_ee                 00000009
port_CTS                          00000F82
port_RTS                          00000F82
port_ds1820                       00000F82
port_keys                         00000F83
port_lcd                          00000F83
port_lcd_e                        00000F82
port_lcd_rs                       00000F81
port_lcd_rw                       00000F81
port_multiplekser                 00000F82
port_serial                       00000F81
port_triak                        00000F81
portlampka2                       00000F81
powlaczaj_moc_reg2                00000D72
powrot_z_polecen                  00000844
pozycja_menu                      000000E9
proc_wyswietl_kolej_liczb_zegara  00001C34
procedura_obslugi_zegara          00000630
procedura_regulacji_dwu_2         00000C5A
procedura_regulacji_dwu_cool1     00000C02
procedura_regulacji_dwu_cool2     00000CD6
procedura_regulacji_dwu_grzanie1  00000BAA
procedura_regulacji_dwu_grzanie2  00000C7E
procedura_regulacji_dwustawnej    00000B86
procedura_sumowania_wyniku        000009CA
procek                            018F4320
przerwanie                        00000008
przerwanie_1                      0000002E
przerwanie_2                      0000003A
przerwanie_3                      00000046
przerwanie_4                      00000052
przerwanie_5                      0000005E
przerwanie_6                      00000064
przerwanie_7                      00000070
przerwanie_pomiaru                00000190
przerwanie_t0                     00000000
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 184


SYMBOL TABLE
  LABEL                             VALUE 

przerwanie_t1                     00000001
przerwanie_wysylania              0000017C
rcsta_temp                        000000A5
regulacja_dwu_moc_OFF             00000BCE
regulacja_dwu_moc_OFF2            00000CA2
regulacja_dwu_moc_ON              00000BE6
regulacja_dwu_moc_ON2             00000CBA
regulacja_dwu_moc_ON_wyl_cool2    00000D24
regulacja_dwu_moc_ON_wylacz       00000BF8
regulacja_dwu_moc_ON_wylacz2      00000CCC
regulacja_dwu_moc_ON_wylacz_cool  00000C50
regulacja_dwu_moc_cool_OFF        00000C26
regulacja_dwu_moc_cool_OFF2       00000CFA
regulacja_dwu_moc_cool_ON         00000C3E
regulacja_dwu_moc_cool_ON2        00000D12
reguluj1                          00000001
reguluj2                          00000003
rozkaz_rejestracji_poprawki_temp  000007B6
rozpocznij_pomiary                00000608
rs                                00000003
rw                                00000002
sa_rowne_nic_nie_rob              00000BFE
sa_rowne_nic_nie_rob2             00000CD2
sa_rowne_sprawdz_Lbajt            00000BC8
sa_rowne_sprawdz_Lbajt2           00000C9C
sa_rowne_sprawdz_Lbajt_cool       00000C20
sa_rowne_sprawdz_Lbajt_cool2      00000CF4
sekundy_1                         000000E7
sekundy_10                        000000E6
send                              00000246
send4bit_petla                    0000024C
set_4bit                          00000028
set_8bit                          0000003C
spr_czy_mam_dalej_mierz_prad      00000D40
spr_czy_wchodze_do_zmiany_opcji   00001862
spr_czy_wylaczyc_triak            000015F8
sprawdz_10                        000008CC
sprawdz_RTS_prad                  00000D96
sprawdz_czy_mam_dalej_mierzyc     00000D2E
sprawdz_czy_mam_wyswietlac_47     00000A96
sprawdz_czy_mozna_wysylac         0000063A
sprawdz_czy_odebrano_litere       0000068E
sprawdz_czy_odebrano_mala_litere  000006AE
sprawdz_czy_polecenie             000007EA
sprawdz_czy_wlacz_szybka_zmiane2  00000EBC
sprawdz_czy_wlacz_szybka_zmiane3  00000EC8
sprawdz_czy_wlacz_szybka_zmiane4  00000ED4
sprawdz_druga_nastawe             000004E8
sprawdz_dzien                     000000E8
sprawdz_godziny                   00000102
sprawdz_ktore_polecenie           000007FC
sprawdz_odebrane                  00000003
sprawdz_pierwsza_nastawe          000004DE
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 185


SYMBOL TABLE
  LABEL                             VALUE 

sprawdz_zwiekszanie_godz_normal   0000170C
stan2_key                         0000009A
stan_key                          00000099
status_temp                       00000081
szybka_zmiana_wartosci            000000EC
tab_poprawnych_nastaw             000004CE
tablica_czwarta                   00001E70
tablica_druga                     00001E2A
tablica_gwiazdki                  00001ECC
tablica_piata                     00001E98
tablica_pierwsza                  00001E08
tablica_trzecia                   00001E4A
test_koniec                       00001E02
tmp                               00000091
tmp6                              00000094
tmp7                              00000095
tmp_hex                           00000092
tmp_hex_H                         00000093
tmp_lcd                           000000A4
triak1                            00000000
triak2                            00000001
tris_lcd                          00000F95
trzymanie_klawisza                00000007
usrednianie_przez_co_mnoze        000000BD
usrednianie_wartosci              000009A6
ustaw_linie_druga                 00000AB8
ustaw_linie_trzecia               00000AA8
ustaw_opcje_standartowe           000004BA
ustaw_probki                      0000078C
ustaw_regulator                   00000768
ustaw_spr_szybkiej_zmiany         00000ED8
ustaw_wartosc_dziel_usredniania   0000076C
ustaw_wyswietlanie_czasu_na_lcd   0000010E
ustawianie_czasu_co_wyswietlam    000000EF
ustawienia_low_voltage            000004F2
ustawienia_low_voltage_loop       000004F6
w_temp                            00000080
wait                              00000238
wait_kilka_sekund                 0000021C
wait_petla                        0000023A
wcisnieto_back                    00000E72
wcisnieto_down                    00000E80
wcisnieto_enter                   00000EE2
wcisnieto_klawisz                 00000004
wcisnieto_up                      00000E98
wlacz_przerwanie_tmr3             00000E66
wlaczenie_rejestracji_pradu       000007B2
write                             00000040
write_4bit                        00000010
write_lcd                         00000268
wybor_czujnika_regulatora         000007E6
wyjscie_przerwanie                00000076
wyk_down_spr_czy_wys_kolej_opcje  00000F34
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 186


SYMBOL TABLE
  LABEL                             VALUE 

wyk_down_wyswietl_opcje_tabl_2    00000FA6
wyk_up_spr_czy_wyswi_kol_opcje    00001320
wyk_up_wyswietl_opcje_tabl_dwa    0000139C
wykonano_pom_wszystkich_kanalow   00000D54
wykr_down_zmian_opcji_wysw_kanal  00001030
wykr_enter_gdzie_wysw_licz_bajt   00001BDA
wykr_up_wysw_opcje_tab_pierwsza   00001374
wykr_up_wysw_opcje_tabli_cztery   000013EC
wykr_up_wyswietl_opcje_tab_trzy   000013C4
wykr_up_wyswietl_opcje_tabl_5     00001414
wykr_up_wyswietl_opcje_tabl_end   00001414
wykr_up_zmiana_opcji_wysw_kanaly  0000148C
wykryto_back                      00000EF0
wykryto_back_exit                 00000F0E
wykryto_back_nic_nie_rob          00000F0E
wykryto_blad                      0000018A
wykryto_down                      00000F16
wykryto_down_3_wyswietl           00001090
wykryto_down_exit                 000012F0
wykryto_down_exit_trzymanie       000012FE
wykryto_down_spr15_nie_ma_zero    000011D6
wykryto_down_spr16_nie_ma_zero    00001206
wykryto_down_spr_3_zmni_probki    00001084
wykryto_down_spr_5_zawracanie     000010CA
wykryto_down_spr_6_zawracanie     000010F2
wykryto_down_sprawdz15_show       000011D8
wykryto_down_sprawdz16_show       00001208
wykryto_down_sprawdz21            000012F0
wykryto_down_sprawdz_10           0000111E
wykryto_down_sprawdz_11           0000113E
wykryto_down_sprawdz_11_1         00001258
wykryto_down_sprawdz_11_2         0000128C
wykryto_down_sprawdz_11_3         000012C0
wykryto_down_sprawdz_11_4         000012E8
wykryto_down_sprawdz_12           0000115E
wykryto_down_sprawdz_13           0000117E
wykryto_down_sprawdz_13_zero      00001192
wykryto_down_sprawdz_14           0000119E
wykryto_down_sprawdz_14_zero      000011B2
wykryto_down_sprawdz_15           000011BE
wykryto_down_sprawdz_16           000011EE
wykryto_down_sprawdz_17           0000121E
wykryto_down_sprawdz_2            0000104C
wykryto_down_sprawdz_20           0000121E
wykryto_down_sprawdz_3            0000106C
wykryto_down_sprawdz_4            000010AE
wykryto_down_sprawdz_5            000010AE
wykryto_down_sprawdz_5_zero       000010CE
wykryto_down_sprawdz_6            000010D6
wykryto_down_sprawdz_6_zero       000010F6
wykryto_down_sprawdz_7            000010FE
wykryto_down_sprawdz_9            000010FE
wykryto_down_wys_opcje_tab_trzy   00000FB6
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 187


SYMBOL TABLE
  LABEL                             VALUE 

wykryto_down_wysw_opcje_tab_4     00000FC6
wykryto_down_wysw_opcje_tab_5     00000FD6
wykryto_down_zmiana_opcji         0000101A
wykryto_down_zmiana_pol_gwiazdki  00000FE6
wykryto_enter                     00001816
wykryto_enter_exit                00001BBC
wykryto_enter_sprawdz_opcje10     000019A4
wykryto_enter_sprawdz_opcje11     000019C4
wykryto_enter_sprawdz_opcje12     000019E4
wykryto_enter_sprawdz_opcje13     00001A04
wykryto_enter_sprawdz_opcje14     00001A1A
wykryto_enter_sprawdz_opcje15     00001A30
wykryto_enter_sprawdz_opcje16     00001A50
wykryto_enter_sprawdz_opcje17     00001A70
wykryto_enter_sprawdz_opcje18     00001A7E
wykryto_enter_sprawdz_opcje19     00001A8C
wykryto_enter_sprawdz_opcje2      00001888
wykryto_enter_sprawdz_opcje20     00001A9A
wykryto_enter_sprawdz_opcje21     00001AB0
wykryto_enter_sprawdz_opcje3      000018A8
wykryto_enter_sprawdz_opcje4      000018C8
wykryto_enter_sprawdz_opcje5      000018DC
wykryto_enter_sprawdz_opcje6      00001922
wykryto_enter_sprawdz_opcje7      00001968
wykryto_enter_sprawdz_opcje8      00001976
wykryto_enter_sprawdz_opcje9      00001984
wykryto_enter_wyjscie_opcje10     00001B28
wykryto_enter_wyjscie_opcje11     00001B38
wykryto_enter_wyjscie_opcje11_1   00001BB0
wykryto_enter_wyjscie_opcje12     00001B48
wykryto_enter_wyjscie_opcje13     00001B58
wykryto_enter_wyjscie_opcje14     00001B68
wykryto_enter_wyjscie_opcje15     00001B78
wykryto_enter_wyjscie_opcje16     00001B88
wykryto_enter_wyjscie_opcje17     00001B98
wykryto_enter_wyjscie_opcje2      00001AD8
wykryto_enter_wyjscie_opcje20     00001B98
wykryto_enter_wyjscie_opcje21     00001BBC
wykryto_enter_wyjscie_opcje3      00001AE8
wykryto_enter_wyjscie_opcje4      00001AF8
wykryto_enter_wyjscie_opcje5      00001AF8
wykryto_enter_wyjscie_opcje6      00001B08
wykryto_enter_wyjscie_opcje7      00001B18
wykryto_enter_wyjscie_opcje9      00001B18
wykryto_enter_zmiana_opcji        00001AB4
wykryto_low_voltage               000001E0
wykryto_odbior                    00000138
wykryto_odbior_CR                 00000168
wykryto_odbior_odczyt             00000138
wykryto_oerr                      00000180
wykryto_rb                        0000011C
wykryto_t0                        00000128
wykryto_t1                        00000092
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 188


SYMBOL TABLE
  LABEL                             VALUE 

wykryto_t1_wyjscie                00000116
wykryto_t2                        00000132
wykryto_t3                        000001AC
wykryto_t3_nie_puszczono          000001C4
wykryto_up                        00001302
wykryto_up_3_wyswietl             000014F0
wykryto_up_exit                   00001786
wykryto_up_exit_trzymanie         00001794
wykryto_up_spr_3_zwieksz_probki   000014E2
wykryto_up_sprawdz15_increase     0000166A
wykryto_up_sprawdz15_show         0000166C
wykryto_up_sprawdz16_increase     00001698
wykryto_up_sprawdz16_show         0000169A
wykryto_up_sprawdz_10             00001566
wykryto_up_sprawdz_11             00001586
wykryto_up_sprawdz_12             000015A6
wykryto_up_sprawdz_13             00001612
wykryto_up_sprawdz_13_dalej       00001626
wykryto_up_sprawdz_14             00001632
wykryto_up_sprawdz_14_dalej       00001646
wykryto_up_sprawdz_15             00001652
wykryto_up_sprawdz_16             00001682
wykryto_up_sprawdz_17             000016B0
wykryto_up_sprawdz_2              000014A8
wykryto_up_sprawdz_20             000016B0
wykryto_up_sprawdz_20_1           000016EA
wykryto_up_sprawdz_20_2           00001724
wykryto_up_sprawdz_20_3           00001756
wykryto_up_sprawdz_20_4           0000177E
wykryto_up_sprawdz_21             00001786
wykryto_up_sprawdz_3              000014C8
wykryto_up_sprawdz_4              00001506
wykryto_up_sprawdz_5              00001506
wykryto_up_sprawdz_5_dalej        0000151E
wykryto_up_sprawdz_6              00001526
wykryto_up_sprawdz_6_dalej        0000153E
wykryto_up_sprawdz_7              00001546
wykryto_up_sprawdz_9              00001546
wykryto_up_zmiana_opcji           00001478
wykryto_up_zmiana_polozeni_gwiaz  00001444
wylacz_moc1                       00000002
wylacz_moc2                       00000005
wylacz_pomiary                    00000740
wylacz_regulator                  0000075C
wylaczam_moc                      00000D6C
wylaczam_moc2                     00000D8A
wynik                             0000009C
wynik01                           0000009D
wynik_to_po_prostu_L              000009A4
wynikh                            0000009B
wyslij_na_ekran_to_co_odebralem   0000084E
wyslij_pomiar                     00000004
wyslij_znak                       00000648
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 189


SYMBOL TABLE
  LABEL                             VALUE 

wyslij_znak_koniec                00000668
wyslij_znak_petla                 00000650
wysw_kolejnych_liczb_zegara_2     00001C5E
wysw_kolejnych_liczb_zegara_3     00001C6C
wysw_kolejnych_liczb_zegara_4     00001C6E
wyswi_kolejnych_liczb_zegara_1    00001C50
wyswietl_1                        000005CE
wyswietl_cyfry_temperatury        000008A8
wyswietl_cyfry_temperatury2       000008D6
wyswietl_cyfry_temperatury_opcje  000008C2
wyswietl_litere_petla             00000864
wyswietl_litere_petla2            0000087E
wyswietl_litere_petla3            0000089C
wyswietl_opcje_menu               00001798
wyswietl_opcje_regulacji          000015C6
wyswietl_opcje_regulacji1         000015D2
wyswietl_opcje_regulacji2         000015DE
wyswietl_opcje_regulacji3         00001602
wyswietl_puste                    000005CC
wyswietl_temp_w_opcjach           000018EE
wyswietl_temp_w_opcjach2          00001934
wysylanie_pomiaru                 000009F0
zalacz_chlodzenie1                00000C18
zalacz_chlodzenie2                00000CEC
zalacz_grzanie                    00000BC0
zalacz_grzanie2                   00000C94
zalacz_moc1                       00000000
zalacz_moc2                       00000004
zamien_na_hex                     000006DC
zapis_do_pamieci_prad             00000AF8
zapis_do_pamieci_temperatury      00000A08
zapis_eeprom                      00000374
zapisz_do_dzien_1_0               000016DA
zapisz_do_dzien_1_99              00001248
zapisz_do_godziny_1_9             0000127C
zapisz_do_minuty_1_0              00001746
zapisz_do_minuty_1_9              000012B0
zapisz_do_pam_nie_spr_przekrocz   00000A20
zapisz_do_pamieci                 00000A02
zapisz_do_pamieci_czy_mam_send    00000A20
zapisz_do_pamieci_juz_po_SERIAL   00000A58
zapisz_do_sekundy_1_0             00001772
zapisz_do_sekundy_1_9             000012DC
zla_dana_wez_0                    000006C2
zmiana_opcji                      00000007
zmierz_nast_czujnik_temperatury   00000E30
zmierz_nastepny_kanal             00000E3C
zmierz_nastepny_nie_3             00000E54
zmierz_prad                       00000E26
zmniejsz_dzien_1                  00001252
zmniejsz_godziny_1                00001286
zmniejsz_minuty_1                 000012BA
zmniejsz_sekundy_1                000012E6
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 190


SYMBOL TABLE
  LABEL                             VALUE 

znacznik_CTS                      00000004
znacznik_RTS                      00000005
znacznik_pomiaru_pradu            00000001
znaczniki                         0000009E
znak_I                            000000CC
znak_cr                           0000000D
znak_lf                           0000000A
znow_kaz_mierzyc                  000009EA
zwieksz_dzien_1                   000016E4
zwieksz_godziny_1                 0000171E
zwieksz_minuty_1                  00001750
zwieksz_sekundy_1                 0000177C
﻿                               00000000


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XXXX----XXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
02C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
03C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
04C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0580 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
05C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0600 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0640 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0680 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
06C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0700 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 191


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


0740 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0780 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
07C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0800 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0840 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0880 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
08C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0900 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0940 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0980 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
09C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0AC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0BC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0CC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0DC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0EC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0FC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
10C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
11C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 192


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


12C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
13C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
14C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1580 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
15C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1600 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1640 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1680 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
16C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1700 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1740 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1780 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
17C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1800 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1840 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1880 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
18C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1900 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1940 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1980 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
19C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1A00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1A40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1A80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1AC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1B00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1B40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1B80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1BC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1C00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1C40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1C80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1CC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1D00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1D40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1D80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1DC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1E00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM  5.51   SERIAL_DWA_REGULATORY_MPLAB.ASM   5-15-2014  2:12:03         PAGE 193


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


1E40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1E80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1EC0 : XXXXXXXXXXXXXXXX XX-------------- ---------------- ----------------
0000 : -XXX-XX-XXXXXX-- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Bytes Used:  7897
Program Memory Bytes Free:   295


Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :     0 reported,     0 suppressed

