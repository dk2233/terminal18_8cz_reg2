MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000000                00001 ﻿;program dopasowany do wspolpracy z ukladem 
                      00002 ;z pracy statutowej2007
                      00003 ;tzn tylko rejestracja danych
                      00004 
                      00005 ;procek = 18f4320
                      00006 
                      00007 ;procek = 18f442
                      00008 
                      00009 
                      00010 ;dodano  prezentacja  
                      00011 ;poprawa 
  00000010            00012 jak_duzo_zliczen_tmr1_na_sekunde    equ   0x10
                      00013 
  018F4320            00014 procek = 18f4320
                      00015 
Warning[205]: Found directive in column 1. (IF)
                      00016 IF (procek == 18f442)
                      00017 list p=18f442
                      00018 include  "p18f442.inc"
                      00019 
                      00020          __CONFIG _CONFIG1H, _OSCS_OFF_1H & _XT_OSC_1H 
                      00021          __CONFIG _CONFIG2L, _BOR_OFF_2L & _PWRT_ON_2L
                      00022          __CONFIG _CONFIG2H, _WDT_OFF_2H
                      00023          
                      00024          __CONFIG _CONFIG4L, _DEBUG_OFF_4L & _LVP_OFF_4L & _STVR_OFF_4L
                      00025         
                      00026 ENDIF
                      00027 
Warning[205]: Found directive in column 1. (IF)
                      00028 IF (procek==18f4320)
Warning[205]: Found directive in column 1. (list)
                      00029 list p=18f4320
Warning[205]: Found directive in column 1. (include)
                      00030 include  "p18f4320.inc"
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC18F4320 processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2010 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      01403         LIST
                      00031 
Warning[230]: __CONFIG has been deprecated for PIC18 devices.  Use directive CONFIG.
300000 71FF           00032          __CONFIG _CONFIG1H, _IESO_OFF_1H & _XT_OSC_1H 
Warning[230]: __CONFIG has been deprecated for PIC18 devices.  Use directive CONFIG.
                      00033          __CONFIG _CONFIG2L, _BOR_ON_2L & _BORV_45_2L & _PWRT_ON_2L
Warning[230]: __CONFIG has been deprecated for PIC18 devices.  Use directive CONFIG.
300002 FEF2           00034          __CONFIG _CONFIG2H, _WDT_OFF_2H
Warning[230]: __CONFIG has been deprecated for PIC18 devices.  Use directive CONFIG.
300004 FDFF           00035          __CONFIG _CONFIG3H, _PBAD_DIG_3H & _MCLRE_ON_3H
Warning[230]: __CONFIG has been deprecated for PIC18 devices.  Use directive CONFIG.
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

300006 FF7A           00036          __CONFIG _CONFIG4L, _DEBUG_ON_4L & _LVP_OFF_4L & _STVR_OFF_4L
Warning[205]: Found directive in column 1. (ENDIF)
                      00037 ENDIF
                      00038          
                      00039          ;__CONFIG _XT_OSC & _WDT_OFF & _PWRTE_ON & _BODEN_OFF & _LVP_OFF & _CPD_OFF & _WRT_OFF & _CP_OF
                            F & _DEBUG_OFF
                      00040 
                      00041 ;definicje są w odzielnym pliku
                      00042 
Warning[205]: Found directive in column 1. (include)
                      00043 include "def_var.h"
                      00001 
                      00002 
                      00003          
                      00004 
                      00005 
                      00006 
                      00007          cblock   80h
  00000080            00008          w_temp
  00000081            00009          status_temp
  00000082            00010          pclath_temp
  00000083            00011          bsr_temp
  00000084            00012          fsrl_temp
  00000085            00013          fsrh_temp
  00000086            00014          linia1
  00000087            00015          linia2
  00000088            00016          linia3
  00000089            00017          linia4
  0000008A            00018          letter
  0000008B            00019          n
  0000008C            00020          bit
  0000008D            00021          odebrano_liter
  0000008E            00022          liczba1
  0000008F            00023          liczba2
  00000090            00024          liczba3
  00000091            00025          tmp                       ; uzywany w odbiorze danych i procedurach poleceń
  00000092            00026          tmp_hex                    ;uzywany w procedurze hex2dec
  00000093            00027          tmp_hex_H                  ;starszy bajt 
  00000094            00028          tmp6                       ; uzywany w poprawce temp
  00000095            00029          tmp7                        ; uzywany do odbioru danych z rs232
  00000096            00030          dec100
  00000097            00031          dec10
  00000098            00032          dec1
  00000099            00033          stan_key
  0000009A            00034          stan2_key
  0000009B            00035          wynikh
  0000009C            00036          wynik
  0000009D            00037          wynik01
  0000009E            00038          znaczniki ;0x09a
  0000009F            00039          markers
  000000A0            00040          markers2
  000000A1            00041          markers3
  000000A2            00042          dane_lcd
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  000000A3            00043          tmp_lcd              ; używany w procedurach lcd
  000000A4            00044          rcsta_temp
  000000A5            00045          ile_kanalow ;0x09f
  000000A6            00046            ktory_kanal_mierze ; 0x0a0
  000000A7            00047          odstep_pomiarowy
  000000A8            00048          aktualny_odstep
  000000A9            00049           ktory_rejestr_zapisuje
  000000AA            00050           pomiarH
  000000AB            00051           pomiarL
  000000AC            00052           pomiar_ulamek
                      00053            
  000000AD            00054           jaka_wartosc_regulujeH
  000000AE            00055           jaka_wartosc_regulujeL
  000000AF            00056           jak_duzo_probek ; 0x0a9
                      00057           
  000000B0            00058           ktora_probka
  000000B1            00059           ktory_kanal
  000000B2            00060           usrednianie_przez_co_mnoze
  000000B3            00061           znaczniki_ds
  000000B4            00062           polecenie_wysylane
  000000B5            00063          jak_duzo_bajtow_odbieram_z_ds
                      00064          
  000000B6            00065          pomiar0H
  000000B7            00066          pomiar0L
  000000B8            00067          pomiar1H
  000000B9            00068          pomiar1L
  000000BA            00069          pomiar2H
  000000BB            00070          pomiar2L
  000000BC            00071          pomiar3H
  000000BD            00072          pomiar3L
  000000BE            00073          pomiar4H
  000000BF            00074          pomiar4L
  000000C0            00075          pomiar5H
  000000C1            00076          pomiar5L
  000000C2            00077          pomiar6H
  000000C3            00078          pomiar6L
  000000C4            00079          pomiar7H
  000000C5            00080          pomiar7L
  000000C6            00081          pomiar_prad1H
  000000C7            00082          pomiar_prad1L
  000000C8            00083          pomiar_prad2H
  000000C9            00084          pomiar_prad2L
  000000CA            00085          bajt_ds
  000000CB            00086          poprawka0
  000000CC            00087          poprawka1
  000000CD            00088          poprawka2
  000000CE            00089          poprawka3
  000000CF            00090          poprawka4
  000000D0            00091          poprawka5
  000000D1            00092          poprawka6
  000000D2            00093          poprawka7
  000000D3            00094          poprawka_prad1
  000000D4            00095          poprawka_prad2
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  000000D5            00096          jak_duzo_kanalow_pradu
  000000D6            00097          ktory_aktualnie_kanal_pradu
                      00098          
  000000D7            00099          dzien_10
  000000D8            00100          dzien_1
  000000D9            00101          godziny_10
  000000DA            00102          godziny_1
  000000DB            00103          minuty_10
  000000DC            00104          minuty_1
  000000DD            00105          sekundy_10
  000000DE            00106          sekundy_1
                      00107          
  000000DF            00108          do_sekundy
  000000E0            00109          pozycja_menu    
  000000E1            00110          numer_opcji
  000000E2            00111          polozenie_gwiazdki
  000000E3            00112          szybka_zmiana_wartosci
                      00113          
  000000E4            00114          fsrl1_temp
  000000E5            00115          fsrh1_temp
  000000E6            00116          histereza
                      00117          
  000000E7            00118          ustawianie_czasu_co_wyswietlam
  000000E8            00119          ktory_czujnik_reguluje
                      00120          endc
                      00121 ;0xbe                           
                      00122         
                      00123          
                      00124 ;        cblock 100h
                      00125                   
                      00126 ;        endc
                      00127 
                      00128 ;eeprom                  
                      00129          cblock   0
  00000000            00130          poprawka0_ee
  00000001            00131          poprawka1_ee
  00000002            00132          poprawka2_ee
  00000003            00133          poprawka3_ee
  00000004            00134          poprawka4_ee
  00000005            00135          poprawka5_ee
  00000006            00136          poprawka6_ee
  00000007            00137          poprawka7_ee
  00000008            00138          poprawka_prad1_ee
  00000009            00139          poprawka_prad2_ee
                      00140          
                      00141          endc
                      00142 ;rejestry nieuzywane wykorzystuje jako dane
                      00143 
                      00144 ;        equ      TMR1L
                      00145 
                      00146 ;        equ      TMR1H
                      00147 
                      00148 ;                 equ      CCPR1H
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00149 ;linia            equ      CCPR1L
                      00150                   
                      00151          
  00000004            00152 lampka            equ      4
  00000004            00153 lampka2           equ      4
                      00154 
  00000005            00155 czujnik_ds1820    equ      5                  
                      00156 
  00000F81            00157 portlampka2       equ      PORTB
  00000F82            00158 port_ds1820       equ      PORTC
  00000F82            00159 port_CTS      equ      PORTC                  
  00000F82            00160 port_RTS      equ          PORTC 
                      00161          
  00000004            00162 znacznik_CTS      equ      4
  00000005            00163 znacznik_RTS      equ      5
                      00164 ;klawisze
                      00165 
                      00166 
                      00167 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;markers
                      00168 ;/*wyswietl */     
  00000000            00169 czy_usrednianie   equ      0
  00000001            00170 czy_wysylanie     equ      1
  00000002            00171 pomiary_zrobione  equ      2  ;znacznik tego czy pomiary zostaly skonczone
  00000003            00172 inicjuj_pomiary   equ         3
  00000004            00173 czy_wysylac_pomiary_serial    equ       4
  00000005            00174 czy_wyswietlam_temp     equ   5  
  00000006            00175 czy_wlaczyc_ponownie_temp    equ    6
  00000007            00176 trzymanie_klawisza            equ   7
                      00177              
                      00178 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;markers2
                      00179 
  00000000            00180 przerwanie_t0     equ      0
  00000001            00181 przerwanie_t1     equ      1
  00000002            00182 pomiary           equ      2
  00000003            00183 sprawdz_odebrane  equ      3
  00000004            00184 wyslij_pomiar     equ      4
  00000005            00185 zalacz_moc        equ      5
  00000006            00186 reguluj           equ      6
  00000007            00187 wylacz_moc        equ      7
                      00188 
                      00189 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;markers3
                      00190 
  00000000            00191 pomiary_pradu           equ   0
  00000001            00192 znacznik_pomiaru_pradu  equ   1
  00000002            00193 czy_zegar_wyswietlac    equ   2
  00000003            00194 odswiezanie_zegara      equ   3
  00000004            00195 wcisnieto_klawisz       equ   4
  00000005            00196 dzialanie_po_klawiszu   equ    5
  00000006            00197 napisz_minus            equ   6
  00000007            00198 pokazuje_temperatury_47       equ   7
                      00199 
                      00200 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;znaczniki
  00000000            00201 czy_ponownie_wlaczyc_temp     equ   0
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000001            00202 czy_ponownie_wlaczyc_zegar    equ   1
  00000002            00203 czy_moge_juz_zmieniac         equ   2 ; dotyczy momentu w którym trzymanie klawisza trwa 1 s -> zmiana 
                            wartości
                      00204 
                      00205 
                      00206 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;pozycja_menu
                      00207 ;jezeli jest 0 to ekran główny
                      00208 ;ekran_glowny      equ   0
  00000000            00209 menu_opcje1       equ   0
  00000001            00210 menu_opcje2       equ   1
  00000002            00211 menu_opcje3       equ   2
  00000003            00212 menu_opcje4       equ   3
                      00213 
  00000007            00214 zmiana_opcji      equ   7
  00000004            00215 menu_opcje_end    equ   4
  00000010            00216 numer_opcji_koncowej    equ   0x10
                      00217 
                      00218 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;numery opcji
  00000001            00219 opcja_czujniki            equ        1
  00000002            00220 opcja_odstep            equ         2
  00000003            00221 opcja_srednia                  equ       3
  00000004            00222 opcja_regulacja                equ        4
  00000005            00223 opcja_ustaw_temp              equ   5
                      00224 ;;;
  00000006            00225 opcja_pomiar_i             equ   6
  00000007            00226 opcja_wlacz_1                 equ   7
  00000008            00227 opcja_wlacz_2                 equ   8
  00000009            00228 opcja_histereza               equ   9
  0000000A            00229 opcja_ustaw_moc               equ  0xa
  0000000B            00230 opcja_ustaw_zegar                   equ   0xb
  0000000C            00231 opcja_ustaw_serial                   equ   0xc
  0000000D            00232 opcja_wyswietl_zegar          equ   0xd
  0000000E            00233 opcja_wyswietl_temp           equ   0xe
  0000000F            00234 opcja_podswietlenie           equ   0xf
  00000010            00235 opcja_czujnik_regulacji       equ   0x10           
                      00236 ;;
                      00237 ;poprawki_czuj           equ   
                      00238 
  0000000C            00239 polozenie_liczby_menu         equ   0xc
                      00240 
                      00241 ;;;
  00000001            00242 nie      equ      1
  00000010            00243 ile_znakow        equ      10h
                      00244 
                      00245 
                      00246 ;znaczniki
  00000000            00247 kalibracja        equ 0
                      00248 
                      00249 
  00000F81            00250 port_serial       equ      PORTB
  00000007            00251 RXD               equ      7
                      00252 
                      00253 
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00254 ;
  00000002            00255 ma       equ      2
  00000001            00256 mb       equ      1
  00000000            00257 mc       equ      0
  00000003            00258 dana     equ      3        
  00000004            00259 kb_change         equ      4
  00000005            00260 kb_cofnij         equ      5
  00000006            00261 kb_enter    equ      6
  00000007            00262 kb_minus    equ      7
                      00263 
                      00264 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;klawisze
  00000004            00265 dlugosc_oczekiwania_na_zmiane       equ   4
  00000F83            00266 latch_keys        equ      PORTD
  00000F83            00267 port_keys         equ      PORTD
  00000000            00268 latch_back        equ   0
  00000001            00269 latch_down        equ   1
  00000002            00270 latch_up          equ   2
  00000003            00271 latch_enter       equ   3
                      00272 
                      00273 ;stan_key
  00000000            00274 mamy_back    equ   0
  00000001            00275 mamy_down   equ   1
  00000002            00276 mamy_up     equ   2
  00000003            00277 mamy_enter  equ   3
                      00278 
                      00279 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00280 
                      00281 
                      00282 
                      00283 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;LCD
                      00284 
  00000028            00285 set_4bit          equ   b'00101000'
  0000000C            00286 display_on        equ   b'00001100'
  00000F8C            00287 latch_lcd          equ      LATD
  00000F8B            00288 latch_lcd_e        equ      LATC
  00000F8A            00289 latch_lcd_rw       equ      LATB
  00000F8A            00290 latch_lcd_rs       equ      LATB
                      00291 
                      00292 ;definicja bitow uzywanych w 4 bitowym przesylaniu 0 - uzywany 1 - nieuzywany
                      00293 ;zwiazane z opcja kasowania
  0000000F            00294 ktore_bity_uzywane_na_lcd     equ   0x0f
  000000F0            00295 ktore_bity_lcd_tris           equ   0xf0
  0000000F            00296 normalne_ustawienie_tris_lcd  equ   0x0f
                      00297 
                      00298 
  00000F83            00299 port_lcd          equ      PORTD
                      00300 
  00000F82            00301 port_lcd_e      equ     PORTC
  00000F81            00302 port_lcd_rw     equ     PORTB
  00000F81            00303 port_lcd_rs     equ     PORTB
                      00304 
  00000F95            00305 tris_lcd          equ      TRISD
                      00306 ;0 to pomiar
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00307 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00308 
  00000001            00309 pin_e_4724        equ      1
                      00310 
                      00311 ;3 to ref+
                      00312 
                      00313 
  00000003            00314 enable          equ     3
  00000003            00315 rs              equ     3
  00000002            00316 rw              equ     2
                      00317 
                      00318 ;znaki transmisyjne
  0000000D            00319 znak_cr           equ      0dh
  0000000A            00320 znak_lf           equ      0ah
  000000CC            00321 znak_I            equ      0cch
                      00322 
                      00323 ;znaczniki_ds
                      00324                   ;inicjacja         equ      0
                      00325                   ;skip_rom          equ      1             
  00000001            00326 dane_odebraneH    equ      1
  00000000            00327 dane_odebraneL    equ      0   
                      00328 
                      00329  
                      00330 
  00000F81            00331 port_triak        equ      PORTB
  00000F8A            00332 latch_moc         equ       LATB
                      00333 
  00000000            00334 triak1            equ      0
  00000001            00335 triak2            equ      1
                      00336 
  00000002            00337 pomiar_prad1      equ      2
  00000004            00338 pomiar_prad2      equ      4
                      00339 
                      00340 ;histereza         equ   4
  00000F82            00341 port_multiplekser equ   PORTC
  00000F8B            00342 latch_multiplekser equ   LATC
  00000000            00343 pin_A                  equ    0
  00000001            00344 pin_B                   equ   1
  00000002            00345 pin_C                   equ   2
                      00044 
  00000001            00045 czy_ekran         equ      1
  00000001            00046 czy_pomiary_na_ekran       equ      1
  00000001            00047 polozenie_danych_lcd equ 1
                      00048 ;2007-06-07
                      00049 ;
                      00050 ;dodano obsluge ds1820
                      00051 ;poprawiono bledy
                      00052 ;ten program odbiera dane korzystajac z modulu obslugi USART
                      00053 ;w procesorze
                      00054 
                      00055 ;jest to "karta" zbioru danych z 2 czujników temp
                      00056 ;LM35 i
                      00057 ;
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00058 ;
                      00059 ;PORTD -0 -Klawisz Back
                      00060 ;PORTD -1 -Klawisz down
                      00061 ;PORTD -2 - klawisz up
                      00062 ;PORTD -3 -Klawisz enter
                      00063 ;PORTD -4 - LCD Data
                      00064 ;PORTD -5 - Lcd Data
                      00065 ;PORTD -6 - Lcd Data
                      00066 ;PORTD -7 - Lcd Data
                      00067 
                      00068 ;PORTB -0 -Triak 1 
                      00069 ;PORTB -1 -Triak 2
                      00070 ;PORTB -2 -R/W
                      00071 ;PORTB -3 - RS
                      00072 ;PORTB -4 -
                      00073 ;PORTB -5 -
                      00074 ;PORTB -6 - 
                      00075 ;PORTB -7 -
                      00076          
                      00077 ;PORTC - 0 -  A 4051
                      00078 ;PORTC - 1 -   B 4051
                      00079 ;PORTC-  2 -  C 4051
                      00080 ;POrtc - 3 -   Enable
                      00081 ;POrtc - 4 -  CTS (czyli ze procek wysyla) (dane z procka)
                      00082 ;POrtc - 5 - RTS (czyli znacznik ze komputer cos wysyla) (dane do procka)
                      00083 ;POrtc - 6 - transmit
                      00084 ;POrtc - 7 - receive
                      00085 
                      00086 ;PORTA - 0 - Anlog - 8 wejsc lm35 przez mulitplesker
                      00087 ;PORTA - 1 - 
                      00088 ;PORTA - 2 - pomiar pradu 1
                      00089 ;PORTA - 3 - REferencyjne+2,560 V
                      00090 ;PORTA - 4 - 
                      00091 ;PORTA - 5 - pomiar pradu 2 
                      00092 ;PORTE - 0 - 
                      00093 ;PORTE - 1 - 
                      00094 ;PORTE - 2 - 
                      00095 
                      00096 ;TMR0L - czekanie miedzy kanalami analoga na pomiar
                      00097 ;tmr1  - odliczanie sekund pomiaru
                      00098 ;tmr2  - ewentualnie ds1820
                      00099 ;tmr3  -zegar systemowy (przyciski systemu)
                      00100 
                      00101 ;bledy przy pomiarach - tzn gdzies sie wiesza gdy wylaczy sie pomiary
                      00102 ;zaczyna wyrzucac na ekran wszystkie pomiary nie usredniajac  
                      00103 ;to wynika z faktu ze przy wysylaniu danych pojawia sie powrotne wysylania
                      00104 
                      00105 ;okazuje sie ze wlaczenie odbioru "cat /dev/ttyS0" powoduje przeskok RTS w stan 0 (tzn informacja o nada
                            waniu)
                      00106 
                      00107 ;trzeba zrobic tak by odczyt przez komputer byl tylko w czasie wysylania danych tzn 
                      00108 ;gdy CTS jest na wysoko poza tym powinien byc brak odczytu
                      00109 
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00110 ;INDF0 (FSR0L i FSR0H) - uzywane tylko w odbiorze danych, tzn w komunikacji z portem szeregowym, oraz w 
                            poleceniach 
                      00111 ;INDF1   - uzywane w operacjach Analog oraz w procedurze obróbki danej zmierzonej przez A/D
                      00112 ;INDF2  - używany w procedurach czasu, oraz w 
                      00113 
                      00114 
                      00115 ;2008.03.01
                      00116 ;dodano obsluge zegara i jego wyswietlanie
                      00117 ;brak procedury miganie :zamieniona na procedura_obslugi_zegara
                      00118 
                      00119 ;program działa zupełnie nieźle, jednak wiesza się przy większej liczbie czujników
                      00120 
                      00121 ;2008.03.31
                      00122 
                      00123 
                      00124 
                      00125 ;2008.04.14
                      00126 
                      00127 ;wciąż się wiesza podczas pomiarów temperatury  - próba wyłączania wskazania zegara w trakcie pom
                            iarów nie wpłynęła na poprawę pracy
                      00128 ;wyłączanie wskazywania temperatur również nie wpłynęło na stabilność pracy
                      00129 
                      00130 ;poprawa czyszczenia ekranu kiedy zmieniam wskazania temp na ekranie głównym
                      00131 
                      00132 ;poprawa pracy pokazywania zawartości rejestru
                      00133 ;
                      00134 ;obsługa  wpisywania histerezy, temperatury regulowanej, średniej, ilości próbek,
                      00135                                                                                                         
                                                                                                                            
                      00136 ;2008.04.15
                      00137 ;wieszanie programu w trakcie pomiarów wynikają z błędów w algorytmie uśredniania wyników
                      00138 ;po zmniejszeniu średniej do 32 próbek nie następuje wieszanie
                      00139 ;wyraźnie na błędy wpływa ilość próbek 64 i 128
                      00140 
                      00141 ;próba zmiany algorytmu uśredniania uzyskanego wyniku
                      00142 ;uśrednianie liczb:
                      00143 ;0x80 (128 próbek) to mnożenie przez 0x02 (2/256)
                      00144 ;0x40 (64 próbki) 0x04
                      00145 ;0x20 (32)  0x08
                      00146 ;0x10 (16)   0x10
                      00147 ;0x08 (8)    0x20 
                      00148 ;0x04 (4 próbki) 0x64
                      00149 ;0x02 (2 próbki) 0x80 (128/256 czyli 0.5) 
                      00150 
                      00151 ;usunięcie procedury przesuwania
                      00152 ;2008.04.16
                      00153 ;poprawiony algorytm usredniania pomiarow
                      00154 ;
                      00155 ;dodano możliwość zmiany wartości przez trzymanie przycisku
                      00156 ;ustaw temp, odstep, 
                      00157 
                      00158 ;2008.04.17
                      00159 ;ostatecznie poprawiłem wieszanie układu, poprawiłem błędy podczas wyświetlania danych na ekranie 
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            -> błędy były przy powrocie z
                      00160 ;procedur przerwań, tzn W z W_temp wracał najpierw, a potem jeszcze do W zapisywane były inne wartoś
                            ci
                      00161 ;poza tym błędy były przy wywoływaniu procedur klawisza. Otóż każde naciśnięcie klawisza wywoł
                            ywało przeskok do procedury
                      00162 ;w przypadku gdy trzymany był klawisz i procedury wykryły że należy zmieniać wskazanie liczby, nast
                            ępował przekok do procedur wykrycia klawisza up lub down,
                      00163 ;jednak powrót następował za pomocą procedury "goto". Stąd problem, bowiem wywołanie funkcji trzym
                            ania klawisza są za pomocą call. To powodowało brak
                      00164 ;powrotu z funkcji call, i w końcu zapchanie stosu.
                      00165 ;układowi brakuje wciąż:
                      00166 ;           - zmiany ustawień zegara
                      00167 ;           - wybór wartości mocy dostarczanej do układu
                      00168 ;           - błędy - przy wyświetlaniu prądu triaka 2 jego wartosć jest dodawana do wskazania temp
                            eratury 1, 
                      00169 ;           - dodać wybór wskazania który czujnik temperatury jest czujnikiem regulatora
                      00170 ;           - dodać  procedurę regulatora P
                      00171 ;           - regulator PID
                      00172 ;           - dodać przeliczanie wartości zmierzonej prądu na wskazanie amperów
                      00173 ;Poprawić procedurę liczenia średniej wartości pomiarów z pewnego czasu - mieszać ze sobą pomiary
                             w postaci
                      00174 ; pomiar czujnika 1,2,3,4,5 - dłuższa przerwa, 1,2,3,4,5, dłuższa przerwa, etc
                      00175 
                      00176 ;2008.04.26
                      00177 ;błędne działanie procedur pomiaru temperatury - zły pomiar temperatur ujemnych 
                      00178 ;zamiast poprawnej wartości ujemnych po osiągnięciu 0 oC wyświetlana jest wartość -64 oC.
                      00179 ;poza tym zamiast 0 wyświetlane były temperatury na poziomie 1.25 - 1.5 oC. 
                      00180 ;Zważywszy że czujnik był wyskalowany dla temperatur 23 - 20 C, wskazuje to na nierównomierną
                      00181 ;skalę błędu - zmiana być może liniowa - należy to sprawdzić
                      00182 
                      00183 ;2008.04.27
                      00184 ;dodano ustawianie wartości zegara
                      00185 ;
                      00186 ;2009.04.22
                      00187 ;poprawa działania histerezy regulacji dwustawnej
                      00188 
000000                00189          org      0000h
000000                00190 BEGIN
                      00191          ;bsf      PCLATH,3
                      00192          ;bcf      PCLATH,4
                      00193          
000000 EF8A F00D      00194          goto     inicjacja
                      00195                   
                      00196          
000008                00197          org      0008h
                      00198          
000008                00199 przerwanie
                      00200 ;zachowuje rejestr W
000008 CFD8 F081      00201       movff    STATUS,status_temp
00000C 6F80           00202          movwf    w_temp
                      00203 ;zachowuje rejestr STATUS
                      00204          
00000E CFE0 F083      00205          movff    BSR,bsr_temp
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00206          
000012 50E9           00207          movf     FSR0L,w
000014 6F84           00208          movwf    fsrl_temp
000016 50EA           00209          movf     FSR0H,w
000018 6F85           00210          movwf    fsrh_temp
                      00211          
00001A 50E1           00212          movf     FSR1L,w
00001C 6FE4           00213          movwf    fsrl1_temp
00001E 50E2           00214          movf     FSR1H,w
000020 6FE5           00215          movwf    fsrh1_temp
                      00216          
                      00217 ;po to by wszystkie ustawienia banki itd byly na 0    
                      00218          ;bsf      STATUS,RP0
000022 AA9D           00219          btfss    PIE1,RCIE
000024 EF17 F000      00220          goto     przerwanie_1
                      00221          
                      00222          ;bcf      STATUS,RP0
000028 BA9E           00223          btfsc    PIR1,RCIF
00002A EF99 F000      00224          goto     wykryto_odbior    
                      00225 
00002E                00226 przerwanie_1
                      00227          ;bsf      STATUS,RP0
                      00228          
00002E A09D           00229          btfss    PIE1,TMR1IE
000030 EF1D F000      00230          goto     przerwanie_2
                      00231          
                      00232          ;bcf      STATUS,RP0
000034 B09E           00233          btfsc    PIR1,TMR1IF
000036 EF46 F000      00234          goto     wykryto_t1
                      00235 
00003A                00236 przerwanie_2      
                      00237         
                      00238          
00003A A89D           00239          btfss    PIE1,TXIE
00003C EF23 F000      00240          goto     przerwanie_3
                      00241          
                      00242          ;bcf      STATUS,RP0
000040 B89E           00243          btfsc    PIR1,TXIF
000042 EFBB F000      00244          goto     przerwanie_wysylania
                      00245          
000046                00246 przerwanie_3      
                      00247          
                      00248          
000046 AC9D           00249          btfss    PIE1,ADIE
000048 EF29 F000      00250          goto     przerwanie_4
                      00251          
                      00252          ;bcf      STATUS,RP0
00004C BC9E           00253          btfsc    PIR1,ADIF
00004E EFC5 F000      00254          goto     przerwanie_pomiaru
                      00255          
000052                00256 przerwanie_4
                      00257          
                      00258          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000052 A29D           00259          btfss    PIE1,TMR2IE
000054 EF2F F000      00260          goto     przerwanie_5
                      00261          
                      00262          ;bcf      STATUS,RP0
000058 B29E           00263          btfsc    PIR1,TMR2IF
00005A EF96 F000      00264          goto     wykryto_t2
00005E                00265 przerwanie_5
                      00266          
                      00267 ;        goto     wykryto_rb
                      00268         
                      00269         
00005E B4F2           00270         btfsc    INTCON,TMR0IF
000060 EF91 F000      00271         goto     wykryto_t0
                      00272 
000064                00273 przerwanie_6
000064 A2A0           00274         btfss    PIE2,TMR3IE
000066 EF38 F000      00275         goto     przerwanie_7
                      00276          
                      00277         
00006A B2A1           00278         btfsc    PIR2,TMR3IF
00006C EFD3 F000      00279         goto     wykryto_t3   
                      00280         
000070                00281 przerwanie_7        
                      00282 ;        btfsc    PIR1,TMR2IF
                      00283 ;        goto     wykryto_t2
                      00284          
                      00285 ;        btfsc    PIR1,TMR2IF
                      00286 ;        goto     wykryto_t2
                      00287          
000070                00288 wyjscie_przerwanie
                      00289 
000070 C083 FFE0      00290          movff    bsr_temp,BSR
                      00291          
                      00292          
000074 5184           00293          movf     fsrl_temp,w
000076 6EE9           00294          movwf    FSR0L
000078 5185           00295          movf     fsrh_temp,w
00007A 6EEA           00296          movwf    FSR0H
                      00297          
00007C 51E4           00298          movf     fsrl1_temp,w
00007E 6EE1           00299          movwf    FSR1L
000080 51E5           00300          movf     fsrh1_temp,w
000082 6EE2           00301          movwf    FSR1H
                      00302          
000084 5180           00303          movf     w_temp,w
000086 C081 FFD8      00304          movff    status_temp,STATUS
                      00305 
00008A 0010           00306          retfie
                      00307          
                      00308          
                      00309          
00008C                00310 wykryto_t1
                      00311 
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00312                                                       ;Procedury obslugi czasu
00008C 909E           00313       bcf      PIR1,TMR1IF
                      00314       
                      00315       
                      00316          ;czy minelo 16 sekund
00008E 83A0           00317       bsf      markers2,przerwanie_t1   
                      00318          
000090 0E10           00319       movlw jak_duzo_zliczen_tmr1_na_sekunde
000092 19DF           00320       xorwf do_sekundy,w
                      00321 ;jezeli    nie  0 w wyniku to skok do procedury 
000094 E13D           00322       bnz   wykryto_t1_wyjscie      
                      00323 ;jezeli 0 to zwiększ sekunda o 1      
                      00324       
000096 6BDF           00325       clrf  do_sekundy
000098 2BDE           00326       incf  sekundy_1,f
                      00327            
                      00328 ;sprawdz czy cyfra jednosci nie przekroczyla 9 sekund
00009A 0E3A           00329       movlw 0x3a
00009C 19DE           00330       xorwf sekundy_1,w
00009E E134           00331       bnz   ustaw_wyswietlanie_czasu_na_lcd
                      00332 ;czyszcze    liczbe jednosci i zwiekszam o jeden liczbe 
0000A0 0E30           00333       movlw 0x30
0000A2 6FDE           00334       movwf  sekundy_1
0000A4 2BDD           00335       incf  sekundy_10,f
                      00336       
0000A6 0E36           00337       movlw 0x36
0000A8 19DD           00338       xorwf sekundy_10,w
0000AA E12E           00339       bnz   ustaw_wyswietlanie_czasu_na_lcd
0000AC 0E30           00340       movlw 0x30
0000AE 6FDD           00341       movwf  sekundy_10
                      00342       
0000B0 2BDC           00343       incf  minuty_1,f
                      00344 ;sprawdzam czy nie przekroczylem  
                      00345       
0000B2 0E3A           00346       movlw 0x3a
0000B4 19DC           00347       xorwf minuty_1,w
                      00348       
0000B6 E128           00349       bnz   ustaw_wyswietlanie_czasu_na_lcd
0000B8 0E30           00350       movlw 0x30
0000BA 6FDC           00351       movwf minuty_1
0000BC 2BDB           00352       incf  minuty_10,f
                      00353       
0000BE 0E36           00354       movlw 0x36
0000C0 19DB           00355       xorwf minuty_10,w
0000C2 E122           00356       bnz   ustaw_wyswietlanie_czasu_na_lcd
0000C4 0E30           00357       movlw 0x30
0000C6 6FDB           00358       movwf minuty_10
                      00359                                           ;godziny      
0000C8 2BDA           00360       incf  godziny_1,f
                      00361 ;sprawdz czy jezeli jest 4 czy nie ma 2 na godziny_10
0000CA 0E34           00362       movlw       0x34
0000CC 63DA           00363       cpfseq      godziny_1
0000CE EF7E F000      00364       goto        sprawdz_godziny
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0000D2 0E32           00365       movlw       0x32
0000D4 63D9           00366       cpfseq      godziny_10
0000D6 EF7E F000      00367       goto        sprawdz_godziny
0000DA 0E30           00368       movlw       0x30
0000DC 6FD9           00369       movwf godziny_10
0000DE 6FDA           00370       movwf godziny_1
0000E0 2BD8           00371       incf  dzien_1,f
                      00372       
                      00373             
0000E2                00374 sprawdz_dzien
0000E2 0E3A           00375       movlw 0x3a
0000E4 19D8           00376       xorwf dzien_1,w
0000E6 E110           00377       bnz   ustaw_wyswietlanie_czasu_na_lcd
0000E8 0E30           00378       movlw 0x30
0000EA 6FD8           00379       movwf  dzien_1
0000EC 2BD7           00380       incf  dzien_10,f
                      00381       
0000EE 0E3A           00382       movlw 0x3a
0000F0 19D9           00383       xorwf godziny_10,w
0000F2 E10A           00384       bnz   ustaw_wyswietlanie_czasu_na_lcd
0000F4 0E30           00385       movlw 0x30
0000F6 6FD7           00386       movwf dzien_10
                      00387       
0000F8 EF84 F000      00388       goto  ustaw_wyswietlanie_czasu_na_lcd
0000FC                00389 sprawdz_godziny      
0000FC 0E3A           00390       movlw 0x3a
0000FE 19DA           00391       xorwf godziny_1,w
000100 E103           00392       bnz   ustaw_wyswietlanie_czasu_na_lcd
000102 0E30           00393       movlw 0x30
000104 6FDA           00394       movwf godziny_1
000106 2BD9           00395       incf  godziny_10,f
                      00396       
                      00397       
                      00398       
                      00399 
                      00400 
000108                00401 ustaw_wyswietlanie_czasu_na_lcd
                      00402       ;czy system obsluguje zegar, bo nie musi i nie powinien przy bardzo częstym pomiarze i wysyłaniu
                             danych
                      00403       ;czyli co 1/16
                      00404       
000108 A5A1           00405       btfss markers3,czy_zegar_wyswietlac
00010A EF88 F000      00406       goto  wykryto_t1_wyjscie 
                      00407       
                      00408       ;a jezeli ma odswiezyc wszystkie znaki:
00010E 87A1           00409       bsf   markers3,odswiezanie_zegara
                      00410       
                      00411       ;jezeli mam odswiezyc zegar to wylaczam na chwilke pomiary i dopiero po wyswietleniu 
                      00412       ;sprawdz czy byly wlaczone pomiary
                      00413       ;btfss       markers2,pomiary
                      00414       ;goto        wykryto_t1_wyjscie 
                      00415       
                      00416       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00417       ;bsf   markers,pomiary_zrobione
                      00418       ;i zaznacz zeby je jeszcze raz wlaczyl po wyswietleniu czasu
                      00419       ;bsf   markers,czy_wlaczyc_ponownie_temp
                      00420       
                      00421       
                      00422       
000110                00423 wykryto_t1_wyjscie  
000110 2BDF           00424       incf     do_sekundy,f
                      00425       
000112 EF38 F000      00426       goto     wyjscie_przerwanie                  
                      00427          
000116                00428 wykryto_rb
                      00429 ;wlaczam przerwanie tmr2 i ustawiam przy pomocy TMR2 na 100us tzn 
                      00430 ;
                      00431 ;
                      00432          
000116 90F2           00433          bcf      INTCON,RBIF
                      00434          
                      00435 ;        btfsc    markers2,odbior
                      00436 ;        goto     wyjscie_przerwanie
                      00437          
000118 BE81           00438          btfsc    port_serial,RXD
00011A EF38 F000      00439          goto     wyjscie_przerwanie         
                      00440 ;        btfsc    bit,7
                      00441 ;        goto     wylaczam_odbior
                      00442 ;        bsf      markers2,poczatkowy_bit
                      00443          
00011E EF38 F000      00444          goto     wyjscie_przerwanie
                      00445 
000122                00446 wykryto_t0
                      00447 ;uzywam do wykrywania czy juz zrobic pomiar
Warning[205]: Found directive in column 1. (IF)
                      00448 IF (procek == 18f442)
                      00449          bcf      INTCON,T0IF
                      00450          bcf      INTCON,T0IE
                      00451          
                      00452 ENDIF
                      00453 
Warning[205]: Found directive in column 1. (IF)
                      00454 IF (procek == 18f4320)
000122 94F2           00455          bcf      INTCON,TMR0IF
000124 9AF2           00456          bcf      INTCON,TMR0IE
                      00457          
Warning[205]: Found directive in column 1. (ENDIF)
                      00458 ENDIF
                      00459          
000126 82C2           00460          bsf      ADCON0,GO 
                      00461          ;clrf     pomiarH
                      00462          ;clrf     pomiarL
                      00463          ;clrf     pomiar_ulamek        
000128 EF38 F000      00464          goto     wyjscie_przerwanie
                      00465          
00012C                00466 wykryto_t2
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00467 ;uzywam do odmierzania czasu dla DS1820
                      00468 ;1 - 
                      00469 ;oczekuje kolejne max 480 us. jezeli po tym czasie nie wystapi jeden to napisz blad
                      00470 
                      00471 ;
                      00472 
                      00473 ;
00012C 929E           00474          bcf      PIR1,TMR2IF
                      00475          
                      00476 ;jezeli tesuje czas     
                      00477 ;          bcf     PORTC,2         
                      00478          ;bsf      STATUS,RP0
00012E 929D           00479          bcf     PIE1,TMR2IE
                      00480          ;bcf      STATUS,RP0
000130 94CA           00481          bcf      T2CON,TMR2ON
                      00482              
                      00483          
                      00484          
                      00485 ;        btfss    markers2,
                      00486 ;        goto     wyjscie_przerwanie
                      00487          
                      00488 ;        bsf      markers2,odbierz_bit
                      00489         
                      00490 
000132                00491 wykryto_odbior
                      00492 ;        btfsc    odebrano_liter,4
                      00493          ;call     miganie
                      00494 ;czytanie rcsta go kasuje
000132                00495 wykryto_odbior_odczyt
                      00496 ;jezeli mam ustawione na ekran to nic nie odbieraj    
000132 B7A0           00497          btfsc    markers2,sprawdz_odebrane
000134 EF38 F000      00498          goto     wyjscie_przerwanie
                      00499 ;wylacz inne przerwania
                      00500 ;        bsf      STATUS,RP0
                      00501 ;        bcf      PIE1,TMR1IE
                      00502 ;        bcf      STATUS,RP0
                      00503          
                      00504 ;          bcf      markers2,blad_transmisji
                      00505 ;czy jest framing error
000138 B4AB           00506          btfsc    RCSTA,FERR
00013A EFC2 F000      00507          goto     wykryto_blad
                      00508 ;        bsf      markers2,blad_transmisji
                      00509          
00013E B2AB           00510          btfsc    RCSTA,OERR
000140 EFBD F000      00511          goto     wykryto_oerr
                      00512          
                      00513          
000144 518D           00514          movf     odebrano_liter,w
000146 0F00           00515          addlw    dane_odebraneL
000148 6EE9           00516          movwf    FSR0L
00014A 0E01           00517          movlw    dane_odebraneH
00014C 6EEA           00518          movwf    FSR0H
                      00519          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00014E 50AE           00520          movf     RCREG,w
000150 6EEF           00521          movwf    INDF0
                      00522 ;jezeli blad transmisji to nie zapamietuj         
                      00523 ;          btfsc    markers2,blad_transmisji
                      00524 ;          goto     wykryto_odbior_odczyt_dalej  
                      00525 ;                    
                      00526          
                      00527          
                      00528          
000152 0E0A           00529          movlw    0x0a
000154 18EF           00530          xorwf    INDF0,w
000156 B4D8           00531          btfsc    STATUS,Z
000158 EFB1 F000      00532          goto     wykryto_odbior_CR
                      00533          
                      00534 ;        movlw    0x0a
                      00535 ;        xorwf    INDF0,w
                      00536 ;        btfss    STATUS,Z
00015C 2B8D           00537         incf     odebrano_liter,f
                      00538          
00015E EF38 F000      00539          goto     wyjscie_przerwanie
                      00540 ;        goto     wykryto_odbior_wyjscie
                      00541 ;        
                      00542          
                      00543 ;        movlw    0x0A
                      00544 ;        xorwf    INDF0,w
                      00545 ;        btfss    STATUS,Z
                      00546 ;        goto     wykryto_odbior_wyjscie
                      00547          
                      00548                   
000162                00549 wykryto_odbior_CR 
                      00550 ;sprawdz czy pierwszym znakiem jest *
                      00551          
000162 87A0           00552          bsf      markers2,sprawdz_odebrane
                      00553 ;        clrf     odebrano_liter
                      00554 ;        movf     RCREG,w
                      00555 ;        movwf    INDF0
                      00556 ;        
                      00557 ;        czysc dwa bwyswietlajty na zero -> znacznik konca wyswietlania         
                      00558 ;        
                      00559          
000164 0E0D           00560         movlw     0x0d
000166 6EEF           00561          movwf    INDF0
                      00562           
000168 2AE9           00563         incf    FSR0L,f
00016A 6EEF           00564         movwf    INDF0
00016C 2AE9           00565         incf    FSR0L,f
00016E 6AEF           00566         clrf     INDF0
000170 2AE9           00567          incf    FSR0L,f
000172 6AEF           00568         clrf     INDF0
                      00569 ;wylaczam szeregowy odbior
000174 98AB           00570          bcf      RCSTA,CREN        
                      00571 
000176                00572 przerwanie_wysylania       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000176 EF38 F000      00573          goto     wyjscie_przerwanie
                      00574 
00017A                00575 wykryto_oerr      
00017A 98AB           00576          bcf      RCSTA,CREN        
00017C 0000           00577          nop
00017E 88AB           00578          bsf      RCSTA,CREN
                      00579                                     
000180 EF38 F000      00580          goto     wyjscie_przerwanie
000184                00581 wykryto_blad
000184 50AE           00582          movf     RCREG,w
000186 EF38 F000      00583          goto     wyjscie_przerwanie
                      00584 
00018A                00585 przerwanie_pomiaru
00018A 9C9E           00586          bcf      PIR1,ADIF
                      00587 ;kopiuje pomiar do rejestru
                      00588 ;sprawdz czy ustawiono 1 lub 0 - wtedy nic nie dziele 
                      00589          
00018C 0E9B           00590          movlw    wynikh
00018E A19F           00591          btfss    markers,czy_usrednianie
000190 0EAA           00592          movlw    pomiarH
                      00593 ;        addwf    ktory_rejestr_zapisuje,w
000192 6EE1           00594          movwf    FSR1L
000194 6AE2           00595          clrf     FSR1H
                      00596          
000196 50C4           00597          movf     ADRESH,w
000198 6EE7           00598          movwf    INDF1
00019A 2AE1           00599          incf     FSR1L,f
                      00600 
00019C 50C3           00601          movf     ADRESL,w
                      00602 
00019E 6EE7           00603          movwf    INDF1
0001A0 89A0           00604          bsf      markers2,wyslij_pomiar
                      00605 ;nastepnym razem zapisze do kolejnego rejestru        
                      00606 ;        incf     ktory_rejestr_zapisuje,f
0001A2 EF38 F000      00607          goto     wyjscie_przerwanie
                      00608    
                      00609 
0001A6                00610 wykryto_t3
                      00611 
0001A6 92A1           00612       bcf   PIR2,TMR3IF
                      00613       ;sprawdzam czy klawisz jest dalej wcisniety
                      00614       
                      00615       ;robie and z zawartoscia stan_key
                      00616       ;jezeli jest w wyniku 0 (tzn ze klawisz wciaz jest trzymany
                      00617       ;np dla klawisza back stan latch_keys:  xxxx1110 - jezeli wcisniety 
                      00618       ;                                      stan_keys          xxxx001  
                      00619       ;w wyniku 0 chyba że klawisz puszczono i jest 1
0001A8 5199           00620       movf        stan_key,w
0001AA 1483           00621       andwf       latch_keys,w
                      00622 ;tzn ze wciaz przycisk jest wcisniety
                      00623       ;i nic nie robie czyli wychodze
0001AC B4D8           00624       btfsc       STATUS,Z
0001AE EFDF F000      00625       goto         wykryto_t3_nie_puszczono
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00626       
                      00627       ;natomiast jezeli wyszlo 1 to sprawdz ktory przycisk zostal puszczony  
                      00628       ;i wymus sprawdzenie i dalsze podprogramy zwiazane z danym klawiszem
0001B2 99A1           00629       bcf         markers3,wcisnieto_klawisz
0001B4 9F9F           00630       bcf         markers,trzymanie_klawisza
0001B6 959E           00631       bcf         znaczniki,czy_moge_juz_zmieniac
                      00632       
                      00633       ;wylacz przerwanie tmr3
0001B8 8BA1           00634       bsf         markers3,dzialanie_po_klawiszu
0001BA EF38 F000      00635       goto        wyjscie_przerwanie
                      00636       
0001BE                00637 wykryto_t3_nie_puszczono
                      00638 ;jeżeli zaznaczony jest bit trzymanie_klawisza to pozwól na szybką zmianę wartości w trakcie 
                      00639 ;trzymania przycisku
                      00640 
                      00641 ;jeżeli już zaznaczono ze moge zmieniac to nie sprawdzaj miniecia sekundy
0001BE B59E           00642       btfsc       znaczniki,czy_moge_juz_zmieniac
0001C0 EF38 F000      00643       goto        wyjscie_przerwanie
                      00644 
0001C4 AF9F           00645       btfss       markers,trzymanie_klawisza
0001C6 EF38 F000      00646       goto        wyjscie_przerwanie
                      00647 ;szybka zmiana dopiero po sekundzie - czyli dwa zliczenia
0001CA 2FE3           00648       decfsz      szybka_zmiana_wartosci,f
0001CC EF38 F000      00649       goto        wyjscie_przerwanie
                      00650 
0001D0 0E01           00651       movlw       1
0001D2 6FE3           00652       movwf       szybka_zmiana_wartosci
                      00653 ;jeżeli już jest 0 to pozwól na zmianę       
0001D4 859E           00654       bsf         znaczniki,czy_moge_juz_zmieniac
0001D6 EF38 F000      00655       goto        wyjscie_przerwanie
                      00656       
                      00657 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;       
                                      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;KOniec Przerwan   
                      00658 ;;;;;;;;;;;;;;;;;;;;;;;;
                      00659 ;;;PROGRAM
                      00660 ;;;;;;;;;;;;;;;;;;;;;;;;;
Warning[205]: Found directive in column 1. (include)
                      00661 include  "../libs/lcd.h"
                      00001  ;;ten dokument zawiera definicje wszystkich funkcji
                      00002 ;;uytych do wywietlania danych na LCD
                      00003 ;;wywietlanie 8 bitowe
                      00004 
                      00005 ;def lcd
                      00006 ;cay port RB0-RB7 uyty jako dane do LCD
                      00007 ;init
                      00008 ;to idzie na port zwizany z danymi
                      00009 
                      00010 
                      00011 
  00000030            00012 init_8bit       equ     b'00110000'
  0000003C            00013 set_8bit        equ     b'00111100' ; 8bit, 2 linie,font 5x8
  00000008            00014 function_set2   equ     b'00001000' ;ustawia 2 linie i 5x8 font
  00000022            00015 init_4bit          equ      b'00100010' ;ustawia 2 linie i 5x8 font
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00016 
  00000008            00017 display_off     equ     b'00001000' ;ustawia blinking,cursor,
  00000006            00018 entry           equ     b'00000110' ;increment
  00000080            00019 dd_addres_set   equ     b'10000000' ;od rb6 do rb0 wstawi�adres
                      00020 
  00000001            00021 display_clear   equ     b'00000001'
  0000000C            00022 display_on      equ     b'00001100';bez kursora
  0000000F            00023 display_2       equ     b'00001111'
  00000010            00024 write_4bit      equ     b'00010000' ;pisz na ekranie
  00000040            00025 write           equ     b'01000000' ;zacz rd6 - rs
                      00026 
  00000002            00027 disp_home       equ     b'00000010'
                      00028 
                      00029 
                      00030 ;;dla 4bit�
  00000003            00031 function_set1_4b        equ     b'00000011' ;- ustawia 4 bit
  00000008            00032 function_set2_4b        equ     b'00001000' ;ustawia 2 linie i 5x8 font
  00000000            00033 display1_4b     equ     b'00000000'
  0000000F            00034 display2_4b     equ     b'00001111' ;ustawia blinking,cursor,
  00000000            00035 entry1_4b               equ     b'00000000'
  0000000C            00036 entry2_4b               equ     b'00001100' ;increment
  00000000            00037 display_clear1_4b       equ     b'00000000'
  00000001            00038 display_clear2_4b       equ     b'00000001'
                      00039 
                      00040 
  00000030            00041 _0              equ     b'00110000'
  00000031            00042 _1              equ     b'00110001'
  00000032            00043 _2              equ     b'00110010'
  00000033            00044 _3              equ     b'00110011'
  00000034            00045 _4              equ     b'00110100'
  00000035            00046 _5              equ     b'00110101'
  00000036            00047 _6              equ     b'00110110'
  00000037            00048 _7              equ     b'00110111'
  00000038            00049 _8              equ     b'00111000'
  00000039            00050 _9              equ     b'00111001'
  0000003A            00051 _dwukropek      equ     b'00111010'
  00000020            00052 _puste          equ     b'00100000'
  0000002E            00053 _kropka         equ     b'00101110'
  000000DF            00054 _stopni         equ     b'11011111'
  0000002D            00055 _minus          equ     0x2d
  0000002B            00056 _plus           equ     0x2b
  00000041            00057 _A              equ     b'01000001'
  00000042            00058 _B              equ     b'01000010'
  00000043            00059 _C              equ     b'01000011'
  00000044            00060 _D              equ     b'01000100'
  00000045            00061 _E              equ     b'01000101'
  00000046            00062 _F              equ     b'01000110'
  00000047            00063 _G              equ     b'01000111'
  00000048            00064 _H              equ     b'01001000'
  00000049            00065 _I              equ     b'01001001'
  0000004A            00066 _J              equ     b'01001010'
  0000004B            00067 _K              equ     b'01001011'
  0000004C            00068 _L              equ     b'01001100'
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  0000004D            00069 _M              equ     b'01001101'
  0000004E            00070 _N              equ     b'01001110'
  0000004F            00071 _O              equ     b'01001111'
  00000050            00072 _P              equ     b'01010000'
  00000051            00073 _Q              equ     b'01010001'
  00000052            00074 _R              equ     b'01010010'
  00000053            00075 _S              equ     b'01010011'
  00000054            00076 _T              equ     b'01010100'
  00000055            00077 _U              equ     b'01010101'
  00000056            00078 _V              equ     b'01010110'
  00000057            00079 _W              equ     b'01010111'
  00000058            00080 _X              equ     b'01011000'
  00000059            00081 _Y              equ     b'01011001'
  0000005A            00082 _Z              equ     b'01011010'
                      00083 
  00000061            00084 _a              equ     b'01100001'
  00000062            00085 _b              equ     b'01100010'
  00000063            00086 _c              equ     b'01100011'
  00000064            00087 _d              equ     b'01100100'
  00000065            00088 _e              equ     b'01100101'
  00000066            00089 _f              equ     b'01100110'
  00000067            00090 _g              equ     b'01100111'
  00000068            00091 _h              equ     b'01101000'
  00000069            00092 _i              equ     b'01101001'
  0000006A            00093 _j              equ     b'01101010'
  0000006B            00094 _k              equ     b'01101011'
  0000006C            00095 _l              equ     b'01101100'
  0000006D            00096 _m              equ     b'01101101'
  0000006E            00097 _n              equ     b'01101110'
  0000006F            00098 _o              equ     b'01101111'
  00000070            00099 _p              equ     b'01110000'
  00000071            00100 _q              equ     b'01110001'
  00000072            00101 _r              equ     b'01110010'
  00000073            00102 _s              equ     b'01110011'
  00000074            00103 _t              equ     b'01110100'
  00000075            00104 _u              equ     b'01110101'
  00000076            00105 _v              equ     b'01110110'
  00000077            00106 _w              equ     b'01110111'
  00000078            00107 _x              equ     b'01111000'
  00000079            00108 _y              equ     b'01111001'
  0000007A            00109 _z              equ     b'01111010'
                      00110 
  0000002A            00111 _star           equ     0x2a
  0000005E            00112 _up             equ     b'01011110'
  0000002C            00113 _przecinek      equ     0x2c
  0000003C            00114 _mniejszosci      equ      0x3c
  0000003E            00115 _wiekszosci       equ      0x3e
  0000007C            00116 _linia_pionowa    equ         0x7c
                      00117 
                      00118 
  00000080            00119 linia_pierwsza  equ     0x80
  00000080            00120 linia_gorna     equ     0x80
                      00121 
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  000000C0            00122 linia_dolna     equ     0xc0
  000000C0            00123 linia_druga     equ     0xc0
                      00124 
  00000090            00125 linia_trzecia   equ     0x90
  000000D0            00126 linia_czwarta   equ     0xd0
                      00127 ;
                      00128 
                      00662 
Warning[205]: Found directive in column 1. (include)
                      00663 include  "../libs/lcd4bit18.asm"
                      00001 ;wersja 2007-12-07
                      00002 ;dla prockow serji 18fxxx
                      00003 ;do odczekania 64ms uzywam komendy cpfsgt
                      00004 ;zmienne
                      00005 ;ktore_bity_uzywane_na_lcd - ktore porty ekranu sa uzywane jako dane
                      00006 ;ktore_bity_lcd_tris   - definiuje ktore bity maja byc zamieniane na wejscie podczas check busy
                      00007 ;tris_lcd   -definiuje ktory tris wplywa na tris lcd
                      00008 ;set_4bit   - ustawienia dla lcd
                      00009 ;tmp_lcd - tymczasowa zmienna uywana tylko w procedurach lcd
                      00010 
0001DA                00011 wait
                      00012          
                      00013         ;bsf      portlampka,lampka              
Warning[205]: Found directive in column 1. (IF)
                      00014 IF (procek == 18f442)
                      00015         bcf     INTCON,T0IF
                      00016 wait_petla                   
                      00017         btfss   INTCON,T0IF      
                      00018         goto    wait_petla
                      00019         bcf     INTCON,T0IF            
                      00020 ENDIF
                      00021 
Warning[205]: Found directive in column 1. (IF)
                      00022 IF (procek == 18f4320)
0001DA 94F2           00023          bcf     INTCON,TMR0IF
0001DC                00024 wait_petla         
0001DC A4F2           00025         btfss   INTCON,TMR0IF      
0001DE EFEE F000      00026         goto    wait_petla
0001E2 94F2           00027         bcf     INTCON,TMR0IF
0001E4 9AF2           00028         bcf      INTCON,TMR0IE
                      00029               
Warning[205]: Found directive in column 1. (ENDIF)
                      00030 ENDIF        
                      00031         ;bcf      portlampka,lampka              
0001E6 0012           00032         return
                      00033         
                      00034          
                      00035 ;funkcja wysy?aj?ca 4 bitowa
                      00036 ;LCD
                      00037 ;;;;;;;;;;;;;;;;;;;;;;;;;
                      00038 
0001E8                00039 send
                      00040 ;np PORTA bity 0-3  sa uzywane przez 4 bitowy ekran lcd
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00041 ;najpierw wysylane sa 4bity gorne
0001E8 6FA2           00042          movwf    dane_lcd
0001EA 0E02           00043          movlw    2
0001EC 6FA3           00044          movwf    tmp_lcd
0001EE                00045 send4bit_petla
                      00046          
                      00047 ;przenosze PORTA tak aby gorne bity nieulegly zmianie
0001EE 0E0F           00048          movlw    ktore_bity_uzywane_na_lcd
0001F0 168C           00049          andwf    latch_lcd,f
                      00050                           
Warning[205]: Found directive in column 1. (IF)
                      00051 IF (polozenie_danych_lcd == 0)        
                      00052 ;jesli na gorze bitow port d
                      00053          
                      00054          swapf    dane_lcd,f
                      00055 ENDIF
                      00056 
                      00057          
0001F2 0EF0           00058          movlw    ktore_bity_lcd_tris
0001F4 15A2           00059          andwf    dane_lcd,w
0001F6 268C           00060          addwf    latch_lcd,f
                      00061          
0001F8 8682           00062          bsf      port_lcd_e,enable
0001FA 0000           00063          nop
0001FC 0000           00064          nop
0001FE 9682           00065          bcf      port_lcd_e,enable
Warning[205]: Found directive in column 1. (IF)
                      00066 IF (polozenie_danych_lcd == 1)        
                      00067 ;jesli na gorze bitow port d
                      00068          
000200 3BA2           00069          swapf    dane_lcd,f
Warning[205]: Found directive in column 1. (ENDIF)
                      00070 ENDIF
                      00071             
000202 2FA3           00072          decfsz   tmp_lcd,f
000204 EFF7 F000      00073          goto     send4bit_petla
000208 0012           00074          return
                      00075          ;movwf    latch_lcd
                      00076          
                      00077          
                      00078 ;funkcja pisz?ca na ekranie
00020A                00079 write_lcd
                      00080 
                      00081          
00020A 868A           00082          bsf      latch_lcd_rs,rs
                      00083          ;bsf      PORTB,rs
                      00084          
00020C ECF4 F000      00085          call     send
                      00086          
000210 968A           00087          bcf      latch_lcd_rs,rs    
                      00088          ;bcf      PORTB,rs
000212 0012           00089          return
                      00090 
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00091 ;funkcja czyszcz?ca ekran
                      00092 
                      00093 ;funkcja czyszcz?ca ekran
                      00094 
000214                00095 cmd_off
                      00096 
                      00097          
000214 968A           00098          bcf      latch_lcd_rs,rs
                      00099          
                      00100          
000216 0012           00101         return
                      00102          
                      00103 
                      00104 
                      00105 ;funkcja czysci cala linie
                      00106 ; przed jej wywolaniem w W umi#1esc adres linii
                      00107 ;po zakonczeniu z powrotem w niej umieszcza adres
                      00108 ;stara wersja - dziala na cala linie
                      00109 
000218                00110 clear_line_old
000218 6F8B           00111          movwf    n
00021A 9681           00112          bcf      port_lcd_rs,rs
                      00113          
00021C 518B           00114          movf     n,w
00021E 6FA2           00115          movwf    dane_lcd
000220 ECF4 F000      00116          call     send
000224 0E10           00117          movlw    ile_znakow
000226 6F95           00118          movwf    tmp7
000228 0FFF           00119          addlw    0xff
00022A 6FA3           00120          movwf    tmp_lcd
00022C                00121 clear_line_old2
00022C EC32 F001      00122          call     check_busy
000230 0E20           00123          movlw    _puste
000232 6FA2           00124          movwf    dane_lcd
000234 EC05 F001      00125          call     write_lcd
                      00126          
000238 2F95           00127          decfsz   tmp7,f
00023A EF16 F001      00128          goto     clear_line_old2
                      00129          
00023E EC0A F001      00130          call     cmd_off
000242 518B           00131          movf     n,w
000244 0012           00132          return
                      00133          
000246                00134 clear_line
                      00135 ;przed wywolaniem do n trzeba wrzucic ilosc kasowanych znakow
                      00136 ;a w W musi byc adres linii         
000246 6FA2           00137          movwf    dane_lcd
000248 ECF4 F000      00138          call     send
                      00139          
00024C                00140 clear_line_petla
00024C EC32 F001      00141          call     check_busy
000250 0E20           00142          movlw    _puste
000252 6FA2           00143          movwf    dane_lcd
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000254 EC05 F001      00144          call     write_lcd
                      00145          
000258 2F8B           00146          decfsz   n,f
00025A EF26 F001      00147          goto     clear_line_petla
                      00148          
00025E EC0A F001      00149          call     cmd_off
                      00150         
000262 0012           00151          return
                      00152 
                      00153          
                      00154          
000264                00155 check_busy
                      00156 
Warning[205]: Found directive in column 1. (IF)
                      00157 IF (polozenie_danych_lcd == 1)        
                      00158 ;jesli na gorze bitow port d
000264 0E0F           00159          movlw    0x0f
                      00160          
000266 168C           00161          andwf    latch_lcd,f
Warning[205]: Found directive in column 1. (ENDIF)
                      00162 ENDIF
                      00163 
Warning[205]: Found directive in column 1. (IF)
                      00164 IF (polozenie_danych_lcd == 0)        
                      00165 ;jesli w dolnej polowce  bajtu rejestru  portd
                      00166          movlw    0xf0
                      00167          
                      00168          andwf    latch_lcd,f
                      00169 ENDIF
                      00170          
                      00171          ;clrf     port_lcd
                      00172          ;clrf     PORTD
                      00173 ;przesylam dane np tris 00000001
                      00174 ;chce zrobic tak by bylo 
                      00175 ;  11110001
                      00176        
000268 5095           00177          movf     tris_lcd,w
00026A 09F0           00178          iorlw    ktore_bity_lcd_tris
00026C 6E95           00179          movwf    tris_lcd    
                      00180          
                      00181       
                      00182          
                      00183          
                      00184                   
00026E 848A           00185          bsf      latch_lcd_rw,rw
000270 968A           00186          bcf      latch_lcd_rs,rs
                      00187 
000272                00188 check
                      00189          
000272 868B           00190          bsf      latch_lcd_e,enable
                      00191          
                      00192  IF (polozenie_danych_lcd == 0) 
                      00193 ;jezli dolne bity portud 
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00194          swapf    port_lcd,w
                      00195 ENDIF
                      00196             
Warning[205]: Found directive in column 1. (IF)
                      00197 IF (polozenie_danych_lcd == 1)        
                      00198 ;jesli na gorze bitow port d
                      00199             
000274 5083           00200          movf    port_lcd,w
Warning[205]: Found directive in column 1. (ENDIF)
                      00201 ENDIF
000276 0BF0           00202          andlw    0xf0
                      00203          
000278 6FA3           00204          movwf    tmp_lcd
                      00205          
00027A 968B           00206          bcf      latch_lcd_e,enable
                      00207             
00027C 0000           00208          nop 
                      00209          
00027E 868B           00210          bsf      latch_lcd_e,enable
                      00211          
Warning[205]: Found directive in column 1. (IF)
                      00212 IF (polozenie_danych_lcd == 1) 
                      00213 ;jesli na gorze bitow port d
000280 3883           00214          swapf    port_lcd,w
Warning[205]: Found directive in column 1. (ENDIF)
                      00215 ENDIF
                      00216             
Warning[205]: Found directive in column 1. (IF)
                      00217 IF (polozenie_danych_lcd == 0)        
                      00218 
                      00219             
                      00220          movf    port_lcd,w
                      00221 ENDIF         
                      00222      
000282 0B0F           00223          andlw    0x0f
                      00224          
000284 27A3           00225          addwf    tmp_lcd,f
                      00226          
000286 968B           00227          bcf      latch_lcd_e,enable    
                      00228             
000288 BFA3           00229          btfsc    tmp_lcd,7
00028A EF39 F001      00230          goto     check
                      00231          
00028E 0E0F           00232          movlw   normalne_ustawienie_tris_lcd
000290 6E95           00233          movwf    tris_lcd
                      00234          
                      00235          
000292 948A           00236          bcf      latch_lcd_rw,rw
000294 968A           00237          bcf      latch_lcd_rs,rs
000296 0012           00238          return
                      00239 
                      00240 
                      00241 
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00242 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                           
                      00243 ;poczatek dzialania 4 bitowego ekranu
                      00244 
000298                00245 lcd_init
000298 EC0A F001      00246          call     cmd_off
Warning[205]: Found directive in column 1. (IF)
                      00247 IF (polozenie_danych_lcd == 1)        
                      00248 ;jesli na gorze bitow port d
00029C 0E0F           00249          movlw    0x0f
                      00250          
00029E 168C           00251          andwf    latch_lcd,f
Warning[205]: Found directive in column 1. (ENDIF)
                      00252 ENDIF
                      00253 
Warning[205]: Found directive in column 1. (IF)
                      00254 IF (polozenie_danych_lcd == 0)        
                      00255 ;jesli w dolnej polowce  bajtu rejestru  portd
                      00256          movlw    0xf0
                      00257          
                      00258          andwf    latch_lcd,f
                      00259 ENDIF
                      00260 
0002A0 948A           00261          bcf      latch_lcd_rw,rw
0002A2 968B           00262          bcf      latch_lcd_e,enable
                      00263 ;wylaczam przerwanie         
                      00264         
0002A4 6AD6           00265          clrf     TMR0L
Warning[205]: Found directive in column 1. (IF)
                      00266 IF (procek == 18f442)
                      00267          bcf      INTCON,T0IE
                      00268          
                      00269 ENDIF
Warning[205]: Found directive in column 1. (IF)
                      00270 IF (procek == 18f4320)
0002A6 9AF2           00271          bcf      INTCON,TMR0IE
                      00272          
                      00273          
Warning[205]: Found directive in column 1. (ENDIF)
                      00274 ENDIF         
                      00275          
                      00276 ;wylaczam przerwania tmr0         
                      00277         
0002A8 ECED F000      00278          call     wait     ;64ms
                      00279 
0002AC 0E22           00280          movlw    init_4bit
0002AE 0BF0           00281          andlw    ktore_bity_lcd_tris
                      00282 ;teraz w W mam postac 0011 w tym nibbles ktory jest port lcd , jezeli gorne to 00110000
0002B0 128C           00283          iorwf    latch_lcd,f
                      00284          
0002B2 868B           00285          bsf     latch_lcd_e,enable
0002B4 0000           00286          nop
0002B6 968B           00287          bcf     latch_lcd_e,enable
                      00288          ;call     send    ;zalaczam
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0002B8 6AD6           00289          clrf     TMR0L ;64 ms
0002BA ECED F000      00290          call     wait
                      00291          
0002BE 0E22           00292          movlw    init_4bit
0002C0 0BF0           00293          andlw    ktore_bity_lcd_tris
                      00294 ;teraz w W mam postac 0011 w tym nibbles ktory jest port lcd , jezeli gorne to 00110000
0002C2 128C           00295          iorwf    latch_lcd,f
                      00296          
0002C4 868B           00297          bsf     latch_lcd_e,enable
0002C6 0000           00298          nop
0002C8 968B           00299          bcf     latch_lcd_e,enable
                      00300          ;call     send    ;zalaczam
0002CA 6AD6           00301          clrf     TMR0L ;64 ms
0002CC ECED F000      00302          call     wait
                      00303          
0002D0 0E22           00304          movlw    init_4bit
0002D2 0BF0           00305          andlw    ktore_bity_lcd_tris
                      00306 ;teraz w W mam postac 0011 w tym nibbles ktory jest port lcd , jezeli gorne to 00110000
0002D4 128C           00307          iorwf    latch_lcd,f
                      00308          
0002D6 868B           00309          bsf     latch_lcd_e,enable
0002D8 0000           00310          nop
0002DA 968B           00311          bcf     latch_lcd_e,enable
                      00312          ;call     send    ;zalaczam
0002DC 6AD6           00313          clrf     TMR0L ;64 ms
0002DE ECED F000      00314          call     wait
                      00315          
0002E2 0E28           00316          movlw    set_4bit
0002E4 ECF4 F000      00317          call     send
                      00318          
0002E8 EC32 F001      00319          call     check_busy
                      00320          
0002EC 0E01           00321          movlw    display_clear
                      00322          ;movwf    port_lcd,ACCESS
0002EE ECF4 F000      00323          call     send
0002F2 EC32 F001      00324          call     check_busy
                      00325          
0002F6 0E0C           00326          movlw   display_on
                      00327          ;movwf    port_lcd,ACCESS
0002F8 ECF4 F000      00328          call     send
                      00329          
                      00330          ;clrf   TMR0L;64 ms
                      00331          ;call     wait
0002FC EC32 F001      00332          call     check_busy
                      00333          
                      00334         
                      00335         ;clrf   TMR0L;64 ms
                      00336          ;call     wait
                      00337 
                      00338          ;call    check_busy
000300 0E06           00339          movlw   entry
                      00340         ;movwf   port_lcd,ACCESS
000302 ECF4 F000      00341         call    send
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000306 EC32 F001      00342         call     check_busy
00030A 0012           00343         return
                      00664 
                      00665 ;include  "../../libs/dziel_przez2_18.asm"
                      00666 
Warning[205]: Found directive in column 1. (include)
                      00667 include  "../libs/eeprom18.asm"
00030C                00001 czytaj_eeprom
                      00002 
                      00003        
                      00004 ;IF procek==1         
00030C 6EA9           00005          movwf    EEADR
                      00006 ;ENDIF         
                      00007 ;IF procek==2
                      00008  ;        movwf    EEADRL
                      00009 ;ENDIF         
                      00010            
00030E 9EA6           00011          bcf      EECON1,EEPGD
000310 80A6           00012          bsf      EECON1,RD
                      00013          
                      00014        
                      00015 
000312 50A8           00016          movf     EEDATA,w
                      00017 
000314 0012           00018          return
                      00019          
000316                00020 zapis_eeprom
                      00021 ;do w adres pod ktory zapisuje
                      00022 ;do FSR (INDF) co zapisuje         
                      00023 ;poprawka ze zapisuje dana spod INDF1         
                      00024          
000316                00025 check_if_write
000316 B2A6           00026          btfsc    EECON1,WR
000318 EF8B F001      00027          goto     check_if_write
                      00028     
                      00029  
                      00030          
                      00031 ;IF procek==1         
00031C 6EA9           00032          movwf    EEADR
                      00033 ;ENDIF         
                      00034 
                      00035        
00031E 50E7           00036          movf     INDF1,w
                      00037         
000320 6EA8           00038          movwf     EEDATA
                      00039       
000322 9EA6           00040          bcf      EECON1,EEPGD
000324 84A6           00041          bsf      EECON1,WREN
                      00042   ;bez przerwan       
000326 9EF2           00043          bcf      INTCON,GIE
                      00044          
000328 0E55           00045          movlw    55h
00032A 6EA7           00046          movwf    EECON2
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00032C 0EAA           00047          movlw    0aah
00032E 6EA7           00048          movwf    EECON2
                      00049          
000330 82A6           00050          bsf      EECON1,WR                  
                      00051          
000332 8EF2           00052          bsf      INTCON,GIE
000334 94A6           00053          bcf      EECON1,WREN
                      00054          
                      00055          
                      00056                   
000336 0012           00057          return         
                      00668 
000338                00669 Start
                      00670 ;odczytuje wartosci poprawek czujnikow temperatury
000338 0E00           00671       movlw     poprawka0_ee
00033A 6EE9           00672       movwf      FSR0L
00033C 6AEA           00673       clrf       FSR0H
00033E 0ECB           00674       movlw      poprawka0
000340 6EE1           00675       movwf      FSR1L
000342 6AE2           00676       clrf       FSR1H
                      00677       
000344                00678 petla_odczytu_poprawek_z_eeprom
000344 50E9           00679       movf       FSR0L,w
000346 EC86 F001      00680       call        czytaj_eeprom
00034A 6EE7           00681       movwf      INDF1
                      00682       
00034C 2AE9           00683       incf       FSR0L,f
00034E 2AE1           00684       incf       FSR1L,f
000350 0E0A           00685       movlw      0x0a
000352 18E9           00686       xorwf      FSR0L,w
000354 A4D8           00687       btfss      STATUS,Z
000356 EFA2 F001      00688       goto        petla_odczytu_poprawek_z_eeprom
                      00689       
                      00690       
                      00691 
Warning[205]: Found directive in column 1. (IF)
                      00692 IF  (czy_ekran==1)
00035A EC4C F001      00693          call     lcd_init
00035E EC32 F001      00694          call     check_busy
000362 EC0A F001      00695          call    cmd_off
                      00696          
                      00697          
                      00698 ;        call     check_busy
000366 0E80           00699          movlw   linia_gorna
000368 ECF4 F000      00700          call    send
00036C EC32 F001      00701          call     check_busy
000370 0E45           00702          movlw    _E
000372 EC05 F001      00703          call     write_lcd
Warning[205]: Found directive in column 1. (ENDIF)
                      00704 ENDIF
                      00705          
                      00706 ;konfiguruje port szeregowy
                      00707 ;ustawiam baud rate
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00708          ;bsf      STATUS,RP0
                      00709          ;bcf      STATUS,RP1
                      00710 ;        movlw    0x1a
                      00711 ;         movlw    0x1a
                      00712 ;         movlw    0x1a
000376 0E0C           00713          movlw    0x0c
000378 6EAF           00714          movwf    SPBRG
00037A 6AAC           00715          clrf     TXSTA
00037C 84AC           00716          bsf      TXSTA,BRGH
00037E 8AAC           00717          bsf      TXSTA,TXEN
                      00718          
                      00719 
                      00720          
                      00721 ;wlaczam przerwanie szeregu
000380 8A9D           00722          bsf      PIE1,RCIE
                      00723 ;        bsf      PIE1,TXIE
                      00724          ;bcf      STATUS,RP0
000382 0E90           00725          movlw    b'10010000'
000384 6EAB           00726          movwf    RCSTA
                      00727          
                      00728          
                      00729 
000386 0E00           00730          movlw    0
000388 6FA9           00731          movwf    ktory_rejestr_zapisuje
                      00732                   
                      00733          
                      00734          
00038A 6FB0           00735          movwf   ktora_probka
                      00736          
                      00737 
00038C 0E08           00738          movlw    8
00038E 6FB5           00739          movwf    jak_duzo_bajtow_odbieram_z_ds
                      00740          
000390 8882           00741          bsf      port_CTS,znacznik_CTS
                      00742          
                      00743          
                      00744          ;tu ustawiam napiecia referencyjne jako AN3 i Vss 
                      00745 ;wszystkie 
Warning[205]: Found directive in column 1. (IF)
                      00746 IF  (procek==18f442)
                      00747          movlw    b'10000001'
                      00748          movwf    ADCON1
                      00749 ENDIF         
Warning[205]: Found directive in column 1. (IF)
                      00750 IF  (procek==18f4320)         
000392 0E1A           00751          movlw    b'00011010'
000394 6EC1           00752          movwf    ADCON1
                      00753          
000396 0EA6           00754          movlw    b'10100110'
000398 6EC0           00755          movwf    ADCON2
Warning[205]: Found directive in column 1. (ENDIF)
                      00756 ENDIF
                      00757 
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00039A 85A1           00758       bsf   markers3,czy_zegar_wyswietlac
                      00759 
00039C 0E30           00760          movlw    0x30
00039E 6FD7           00761          movwf    dzien_10
0003A0 6FD8           00762          movwf    dzien_1
0003A2 6FD9           00763          movwf    godziny_10
0003A4 6FDA           00764          movwf    godziny_1
0003A6 6FDB           00765          movwf    minuty_10
0003A8 6FDC           00766          movwf    minuty_1
0003AA 6FDD           00767          movwf    sekundy_10
0003AC 6FDE           00768          movwf    sekundy_1
                      00769          
                      00770          
                      00771          ;ustawienie opcji pomiarowych dla menu
0003AE 0E00           00772          movlw          0
0003B0 6FA5           00773          movwf          ile_kanalow
0003B2 0E20           00774          movlw          0x20
0003B4 6FA7           00775          movwf          odstep_pomiarowy
0003B6 0E80           00776          movlw          0x80
0003B8 6FAF           00777          movwf          jak_duzo_probek
                      00778          
0003BA EC8E F003      00779          call           ustaw_wartosc_dzielenia_usredniania
                      00780          
0003BE 819F           00781          bsf            markers,czy_usrednianie
                      00782          
0003C0 0E00           00783          movlw    0
0003C2 6FAD           00784          movwf    jaka_wartosc_regulujeH
0003C4 0E80           00785          movlw    0x80
0003C6 6FAE           00786          movwf    jaka_wartosc_regulujeL
                      00787          
0003C8 0E04           00788          movlw    4
0003CA 6FE6           00789          movwf    histereza
                      00790          
                      00791          ;włączam znaczniki sprawiające że przy opuszczeniu menu następuje ponowne włączenie
                      00792 ;zegara oraz pokazywania temperatury
                      00793 ;z poziomu menu można zmienić te znaczniki tak by nie nastąpiło ponowne wyświetlanie zegara i tempe
                            ratur
0003CC 0E00           00794          movlw    0
0003CE 6FE8           00795          movwf    ktory_czujnik_reguluje
                      00796          
0003D0 839E           00797          bsf            znaczniki,czy_ponownie_wlaczyc_zegar
0003D2 819E           00798          bsf            znaczniki,czy_ponownie_wlaczyc_temp
                      00799          
0003D4 EF55 F00D      00800          goto     LOOP
                      00801   
                      00802          
0003D8                00803 hex2dec18
                      00804       ;zamiana wartosci szesnastkowej na dziesietne
                      00805       ;dziele przez 10 tzn mnoze przez 0x1a/256 (0x26) lub przez 0x19/256 (25)
                      00806 ;      i wynik jednosci w PRODH, a ulamek w ProdL
                      00807       ;w młodszym bajcie wyniku jest ułamek
                      00808       ;należy przed uruchomieniem procedury 
                      00809       ; umieścić liczbę dzieloną w rejestrze  
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00810       ;tmp_hex
                      00811       ;bajt starszy w tmp_hex_H
                      00812       
                      00813       
                      00814       ;clrf        dec1
                      00815       ;clrf        dec10
0003D8 6B96           00816       clrf        dec100
                      00817       
                      00818       ;dziele przez 5
                      00819       ;mullw       0x33
                      00820       ;wynik jest w starszym bajcie
                      00821       ;movf        PRODH,w
                      00822       ;dzielę przez 2 - 0x80
                      00823       ;dzielę przez 0.0976 - mnoże przez 0x19
0003DA 5192           00824       movf        tmp_hex,w
0003DC 0D19           00825       mullw       0x19
0003DE 50F4           00826       movf        PRODH,w
                      00827       
0003E0 6F97           00828       movwf       dec10
0003E2 0D0A           00829       mullw       0xa
0003E4 50F3           00830       movf        PRODL,w
                      00831       ;tmp_hex - dec10*10 = liczba jednosci
0003E6 5D92           00832       subwf       tmp_hex,w
0003E8 6F98           00833       movwf       dec1
                      00834 ;sprawdzam czy liczba jedności nie przekracza 10, czyli czy nie jest większa > 9
0003EA 0E09           00835       movlw       0x9
0003EC 6598           00836       cpfsgt      dec1  
0003EE EFFE F001      00837       goto        hex2dec18_nie_przekroczono_1
                      00838       
0003F2 0E0A           00839       movlw       0xa
0003F4 5F98           00840       subwf       dec1,f
0003F6 2B97           00841       incf        dec10,f
                      00842       
0003F8 B0D8           00843       btfsc       STATUS,C
0003FA 2B96           00844       incf        dec100,f
                      00845       
                      00846       
0003FC                00847 hex2dec18_nie_przekroczono_1
                      00848 ;sprawdz czy liczba dziesiatek  nie przekracza liczby 10 tzn podziel liczbę przez 10 (mnożę przez 0x1
                            a)
                      00849       ;przez 5
0003FC 5197           00850       movf       dec10,w
                      00851       ;mullw       0x33
                      00852       
                      00853       ;movf        PRODH,w
                      00854       ;dzielę przez 26
0003FE 0D1A           00855       mullw       0x1a
                      00856       
000400 50F4           00857       movf        PRODH,w
                      00858 ;jezeli jest 0 to skocz dalej
000402 E005           00859       bz          hex2dec18_brak_setek
                      00860 ;jezeli brak 0 tzn ze w wyniku mamy jakies liczby setek
000404 6F96           00861       movwf       dec100
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00862       ;a ile zostalo liczb 10 - 
000406 0E0A           00863       movlw       0xa
000408 0396           00864       mulwf       dec100
                      00865       ;mnoze dec100*100 i wynik odejmuje od liczby 10
00040A 50F3           00866       movf        PRODL,w
00040C 5F97           00867       subwf       dec10,f
                      00868 ; i juz mam ilosc dziesiatek i setek i jednosci z wyniku zamiany jednego bajta na postać dziesiętną
                      00869       
00040E                00870 hex2dec18_brak_setek
                      00871 ;teraz sprawdzam czy w starszym bajcie liczby dzielonej stoi jakas wartość jezeli tak to zwiekszam ilo
                            sc setek i dziesiatek
                      00872 ;jezeli w starszym bajcie stoi cos:
                      00873       
00040E 5193           00874       movf       tmp_hex_H,w
                      00875             
                      00876       
                      00877       ;jezeli 0 to koncz prace procedury
000410 E015           00878       bz          hex2_dec_koniec
                      00879       ;jezeli nie to popraw wyniki o poprawke
000412 0A01           00880       xorlw       0x01
000414 E005           00881       bz          hex2dec_temperatur_popraw_o_64
                      00882       
000416 5193           00883       movf       tmp_hex_H,w
000418 0A02           00884       xorlw       0x02
00041A E008           00885       bz          hex2dec_temperatur_popraw_o_128
                      00886 
00041C EF1E F002      00887       goto        hex2_dec_koniec
                      00888       
000420                00889 hex2dec_temperatur_popraw_o_64
000420 0E06           00890       movlw       0x06
000422 2797           00891       addwf       dec10,f
000424 0E04           00892       movlw       0x04
000426 2798           00893       addwf       dec1,f
000428 EF1E F002      00894       goto        hex2_dec_koniec
                      00895       
00042C                00896 hex2dec_temperatur_popraw_o_128
00042C 0E01           00897       movlw       0x01
00042E 2796           00898       addwf       dec100,f
000430 0E02           00899       movlw       0x02
000432 2797           00900       addwf       dec10,f
000434 0E08           00901       movlw       0x08
000436 2798           00902       addwf       dec1,f
000438 EF1E F002      00903       goto        hex2_dec_koniec
                      00904       
00043C                00905 hex2_dec_koniec
00043C 0012           00906       return
                      00907 
                      00908 
                      00909                                                                                                 ;ZEGAR  
                              Systemowy  
                      00910  
                      00911 
00043E                00912 napisz_czas
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00043E 97A1           00913       bcf   markers3,odswiezanie_zegara
                      00914       ;wyswietlam wszyskie wielkosci czasowe na 1 linii ekranu
000440 EC32 F001      00915       call     check_busy
000444 0E80           00916       movlw   linia_gorna
000446 ECF4 F000      00917       call    send
00044A EC32 F001      00918       call     check_busy
                      00919       
00044E 0E20           00920      movlw  _puste 
                      00921      ;jeżeli praca w trybie regulacji to pisz r
000450 BDA0           00922      btfsc  markers2,reguluj
000452 0E72           00923      movlw  _r
000454 EC05 F001      00924      call   write_lcd
                      00925      
000458 EC32 F001      00926      call     check_busy
                      00927      
                      00928      ;jeżeli praca w trybie transferu szeregowego
00045C 0E20           00929      movlw  _puste 
00045E B99F           00930      btfsc  markers,czy_wysylac_pomiary_serial
000460 0E73           00931      movlw  _s
000462 EC05 F001      00932      call   write_lcd
000466 EC32 F001      00933      call     check_busy 
                      00934       
                      00935       
                      00936       
                      00937       ;addlw 2
                      00938       
                      00939       
                      00940             
00046A 0ED7           00941       movlw       dzien_10
00046C 6ED9           00942       movwf       FSR2L      
00046E 6ADA           00943       clrf        FSR2H
000470 EF3F F002      00944       goto        petla_napisz_czas
                      00945       
000474                00946 petla_napisz_czas_dwukropek      
                      00947 ;po kazdych dwóch cyfrach pisz dwukropek
000474 0E3A           00948       movlw       _dwukropek
000476 EC05 F001      00949       call        write_lcd
00047A EC32 F001      00950       call        check_busy
                      00951             
                      00952 ;w FSR2l umieszczam adres komorki dzien_10, zwiekszajac ten adres o 1 mam dostep po kolei do wszystkich 
                            wartosci 
                      00953 ;czasowych
00047E                00954 petla_napisz_czas
                      00955 ;sprawdz czy cyfra 10 jest 0 - jezeli tak to wyswietl puste
00047E 0E30           00956       movlw 0x30
000480 18D9           00957       xorwf FSR2L,w
000482 B4D8           00958       btfsc STATUS,Z
000484 EF47 F002      00959       goto  wyswietl_puste
                      00960 ;jezeli wyswietlam zawartosc rejestru      
000488 50DF           00961       movf  INDF2,w
00048A EF48 F002      00962       goto  wyswietl_1
                      00963       
00048E                00964 wyswietl_puste
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00048E 0E20           00965       movlw _puste
                      00966       
000490                00967 wyswietl_1      
                      00968       
                      00969       
000490 EC05 F001      00970       call  write_lcd
000494 EC32 F001      00971       call  check_busy
                      00972       
000498 2AD9           00973       incf  FSR2L,f
00049A 50DF           00974       movf  INDF2,w
00049C EC05 F001      00975       call  write_lcd
0004A0 EC32 F001      00976       call  check_busy
                      00977       
0004A4 2AD9           00978       incf  FSR2L,f
                      00979       
0004A6 0EDF           00980       movlw       sekundy_1+1
0004A8 18D9           00981       xorwf       FSR2L,w
0004AA E1E4           00982       bnz         petla_napisz_czas_dwukropek
                      00983       
                      00984       ;po wyswietleniu zegara znow kaz mierzyc
                      00985       
0004AC AD9F           00986       btfss       markers,czy_wlaczyc_ponownie_temp
0004AE EF55 F00D      00987       goto        LOOP 
                      00988       
                      00989       
                      00990       ;bcf   markers,pomiary_zrobione
                      00991       ;i zaznacz zeby je jeszcze raz wlaczyl po wyswietleniu czasu
0004B2 9D9F           00992       bcf   markers,czy_wlaczyc_ponownie_temp
                      00993       
0004B4 EF55 F00D      00994       goto  LOOP
                      00995       ;sprawdz czy INDF2 ==    sekundy_1 + 1
                      00996       
                      00997       
                      00998  
                      00999 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                                                 SPRAWDZANIE CZY nast
                            apilo 0  
0004B8                01000 odznacz_by_znow_mierzyc
                      01001                                     ;sprawdz czy odstep miedzy pomiarami juz minal
                      01002       
                      01003       ;incf  aktualny_odstep,w
                      01004       
                      01005       ;movf  aktualny_odstep,w
                      01006       ;bnz   bez_wlaczania_pomiarow
                      01007       
0004B8 2FA8           01008          decfsz   aktualny_odstep,f
0004BA 0012           01009          return                
                      01010          
0004BC 51A7           01011          movf     odstep_pomiarowy,w
0004BE 6FA8           01012          movwf    aktualny_odstep
                      01013          
0004C0 A59F           01014          btfss    markers,pomiary_zrobione
0004C2 0012           01015          return
                      01016          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0004C4 959F           01017          bcf      markers,pomiary_zrobione
0004C6 879F           01018          bsf      markers,inicjuj_pomiary
0004C8 0012           01019          return
                      01020 
                      01021 
                      01022 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                       ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; 
                                                  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;  KAZDE ROZPOCZEcie POMIAROW         
0004CA                01023 rozpocznij_pomiary         
                      01024 ;dokonuj pomiaru  na pierwszym kanale
                      01025 ;wlaczam tez przerwanie analogowego pomiaru
                      01026          
                      01027 ;wlacz przerwanie jak skonczy mierzyc zeby wyslac
                      01028 ;wystarczy ze 000 do bitow kanalu
0004CA 6B87           01029       clrf  linia2
0004CC 6B89           01030       clrf  linia4
0004CE 99A0           01031          bcf      markers2,wyslij_pomiar 
                      01032          ;
0004D0 51A5           01033          movf     ile_kanalow,w
0004D2 6FA6           01034          movwf    ktory_kanal_mierze 
                      01035          
0004D4 51AF           01036          movf    jak_duzo_probek,w
0004D6 6FB0           01037          movwf   ktora_probka
0004D8 6BB1           01038          clrf     ktory_kanal
                      01039          
                      01040          ;movwf   ktore_dzielenie_przez2
                      01041          
0004DA 5082           01042          movf     port_multiplekser,w
                      01043 ;czyszcze aktualne ustawienia multipleksera
                      01044 ;jezeli byl tu b'01010001'     
0004DC 0BF8           01045          andlw    b'11111000'
                      01046 ;w wyniku mamy b'01010000'      
0004DE 6E8B           01047          movwf    latch_multiplekser   
                      01048          
0004E0 50C2           01049          movf     ADCON0,w
                      01050          
                      01051          ;bsf      STATUS,RP0
                      01052          ;bcf      STATUS,RP1
                      01053 ;        movlw    0x1a
                      01054          
                      01055          ;bcf      STATUS,RP0    
                      01056          ;clrf     TMR0L
Warning[205]: Found directive in column 1. (IF)
                      01057 IF (procek == 18f442)
                      01058          ;bcf      INTCON,T0IF
                      01059          ;bsf      INTCON,T0IE
                      01060          andlw    b'11000111'
                      01061          movwf    ADCON0
                      01062          
                      01063 ENDIF
Warning[205]: Found directive in column 1. (IF)
                      01064 IF (procek == 18f4320)
                      01065          ;bcf      INTCON,TMR0IF
                      01066          ;bsf      INTCON,TMR0IE
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0004E2 0BC3           01067          andlw    b'11000011'
0004E4 6EC2           01068          movwf    ADCON0
                      01069          
Warning[205]: Found directive in column 1. (ENDIF)
                      01070 ENDIF
                      01071          
                      01072          ;jezeli mam wykonywac pomiary to zapisz z rejestru ile mam robic pomiarow
0004E6 B1A1           01073          btfsc    markers3,pomiary_pradu
0004E8 6BD6           01074          clrf     ktory_aktualnie_kanal_pradu
                      01075          
0004EA 979F           01076          bcf      markers,inicjuj_pomiary
                      01077          
0004EC 82C2           01078          bsf      ADCON0,GO
0004EE 8C9D           01079          bsf      PIE1,ADIE
                      01080          
0004F0 0012           01081         return             
                      01082 
                      01083          
0004F2                01084 bez_wlaczania_pomiarow
                      01085 
                      01086          
                      01087       
0004F2                01088 procedura_obslugi_zegara
                      01089 ;najpierw sprawdz czy minelo 16 zliczen?
                      01090       
                      01091 
                      01092 
                      01093       ;jezeli pomiary to cy je robic?
0004F2 B5A0           01094          btfsc    markers2,pomiary
0004F4 EC5C F002      01095          call     odznacz_by_znow_mierzyc
                      01096       ;odznacz    
0004F8 93A0           01097          bcf      markers2,przerwanie_t1
                      01098       
                      01099       
                      01100          ;btfss    portlampka,lampka
                      01101          ;goto     zapal    
                      01102          ;bcf      portlampka,lampka
                      01103                   
0004FA 0012           01104          return
                      01105 ;zapal    
                      01106  ;        bsf      portlampka,lampka
                      01107   ;       return
                      01108 
0004FC                01109 zapal_lampke
0004FC 7881           01110          btg    portlampka2,lampka2
                      01111          
                      01112          ; goto     zapal_lampke2
                      01113          ; bcf      portlampka2,lampka2
                      01114                   
                      01115          ; goto     powrot_z_polecen
                      01116 ; zapal_lampke2
                      01117          ; bsf      portlampka2,lampka2
                      01118          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0004FE EF27 F005      01119           goto     powrot_z_polecen
                      01120 
                      01121 
                      01122 
000502                01123 sumuj_liczby
000502 6B8F           01124          clrf     liczba2
000504 6B8E           01125          clrf     liczba1
                      01126          
                      01127          ;incf     FSR0L,f
                      01128          
000506                01129 sumuj_liczby_do_kropki
                      01130          
000506 ECEF F002      01131          call     kopiuj_liczbe_przeslana
00050A C091 F08E      01132          movff    tmp,liczba1
                      01133                            
                      01134 ;sprawdz czy przekroczono bajt
                      01135          ;btfsc    STATUS,C
                      01136          ;incf     liczba2,f
                      01137          ;                  
                      01138          ;incf     FSR0L,f
                      01139          ;movlw    _kropka
                      01140          ;xorwf    INDF0,w
                      01141          ;btfsc    STATUS,Z
                      01142          ;incf     FSR0L,f
                      01143          
                      01144          ;movlw    0x0a
                      01145          ;xorwf    INDF0,w
                      01146          ;btfss    STATUS,Z
                      01147          ;goto     sumuj_liczby_do_kropki     
00050E ECEF F002      01148          call     kopiuj_liczbe_przeslana
000512 C091 F08F      01149          movff     tmp,liczba2
                      01150          
                      01151          
000516 38F4           01152          swapf    PRODH,w
000518 0B0F           01153          andlw    0x0f
00051A ECFA F002      01154          call     zamien_na_hex
00051E 6EAD           01155          movwf    TXREG
                      01156          
000520 ECA9 F002      01157          call     sprawdz_czy_mozna_wysylac
                      01158          
000524 50F4           01159          movf     PRODH,w
                      01160 ;robiac taka operacje kasuje starszy bajt na 3 a mlodszy bez zmian      
000526 0B0F           01161          andlw    0x0f
000528 ECFA F002      01162          call     zamien_na_hex
00052C 6EAD           01163          movwf    TXREG
00052E ECA9 F002      01164          call     sprawdz_czy_mozna_wysylac
                      01165          
000532 38F3           01166          swapf    PRODL,w
000534 0B0F           01167          andlw    0x0f
000536 ECFA F002      01168          call     zamien_na_hex
00053A 6EAD           01169          movwf    TXREG
                      01170          
00053C ECA9 F002      01171          call     sprawdz_czy_mozna_wysylac
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01172          
000540 50F3           01173          movf     PRODL,w
                      01174 ;robiac taka operacje kasuje starszy bajt na 3 a mlodszy bez zmian      
000542 0B0F           01175          andlw    0x0f
000544 ECFA F002      01176          call     zamien_na_hex
000548 6EAD           01177          movwf    TXREG
                      01178          
00054A ECA9 F002      01179          call     sprawdz_czy_mozna_wysylac
                      01180 ;zapisz  cyfra
                      01181          
                      01182          ;call     wyswietlanie_liczby
00054E EF27 F005      01183          goto     powrot_z_polecen
                      01184 
000552                01185 sprawdz_czy_mozna_wysylac
                      01186          ;bsf      STATUS,RP0
000552                01187 TMR_nie_pusty     
000552 A2AC           01188          btfss    TXSTA,TRMT
000554 EFA9 F002      01189          goto     TMR_nie_pusty     
                      01190          ;bcf      STATUS,RP0
000558                01191 TXREG_nie_pusty   
000558 A89E           01192          btfss    PIR1,TXIF
00055A EFAC F002      01193          goto     TXREG_nie_pusty
00055E 0012           01194          return   
                      01195          
000560                01196 wyslij_znak
                      01197 ;sprawdz czy USART transmit buffer jest pusty
000560 0E00           01198          movlw    dane_odebraneL
                      01199          
000562 6EE9           01200          movwf    FSR0L
000564 0E01           01201          movlw    dane_odebraneH
000566 6EEA           01202          movwf    FSR0H
                      01203          
000568                01204 wyslij_znak_petla 
000568 ECA9 F002      01205          call     sprawdz_czy_mozna_wysylac
                      01206 ;laduje dane do wyslania   
00056C 2AE9           01207          incf     FSR0L,f
                      01208          
                      01209 ;        movf     INDF0,w
                      01210 ;        call     write_lcd
                      01211 ;        call     check_busy
                      01212          
00056E 0E0D           01213          movlw    0x0d
000570 18EF           01214         xorwf    INDF0,w
000572 B4D8           01215          btfsc    STATUS,Z
000574 EFC0 F002      01216          goto     wyslij_znak_koniec
                      01217          
000578 50EF           01218          movf    INDF0,w
00057A 6EAD           01219          movwf    TXREG
00057C EFB4 F002      01220          goto     wyslij_znak_petla
000580                01221 wyslij_znak_koniec
000580 ECA9 F002      01222          call     sprawdz_czy_mozna_wysylac
000584 0E20           01223          movlw    _puste
000586 6EAD           01224          movwf    TXREG
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000588 ECA9 F002      01225          call     sprawdz_czy_mozna_wysylac
00058C 0E3A           01226          movlw    _dwukropek
00058E 6EAD           01227          movwf    TXREG
000590 ECA9 F002      01228          call     sprawdz_czy_mozna_wysylac
000594 0E2D           01229          movlw    _minus
000596 6EAD           01230          movwf    TXREG
000598 ECA9 F002      01231          call     sprawdz_czy_mozna_wysylac
00059C 0E0A           01232          movlw    znak_lf
00059E 6EAD           01233          movwf    TXREG
                      01234          
0005A0 06E9           01235          decf     FSR0L,f
                      01236 ;        call     sprawdz_czy_mozna_wysylac
                      01237 ;        movlw    znak_lf
                      01238 ;        movwf    TXREG
                      01239          
0005A2 EF27 F005      01240          goto     powrot_z_polecen
                      01241          
0005A6                01242 sprawdz_czy_odebrano_litere
0005A6 0E30           01243          movlw    0x30
0005A8 5CEF           01244          subwf    INDF0,w
0005AA 6F95           01245          movwf    tmp7
                      01246 ;sprawdzam czy zostaly jakies bity w gornej polowce bajtu
                      01247          
0005AC 0BF0           01248          andlw    0xf0 
0005AE B4D8           01249          btfsc    STATUS,Z
0005B0 0012           01250          return
                      01251 ;jezeli odebrano litere duza (A,B,C,D,E,F) to po odjeciu 0x41 nic nie powinno zostac w                  
                              
0005B2 0E41           01252          movlw    0x41
0005B4 5CEF           01253          subwf    INDF0,w
0005B6 6F95           01254          movwf    tmp7
                      01255 
0005B8 0BF0           01256          andlw    0xf0 
0005BA A4D8           01257          btfss    STATUS,Z
0005BC EFE3 F002      01258          goto     sprawdz_czy_odebrano_mala_litere
                      01259 ;zasada taka to co zostalo po odjeciu 0x41 to 0 dla A 1 dla B etc
                      01260 ;aby miec prawdziwy znak dodaje do tego 0x0a         
0005C0 0E0A           01261          movlw    0x0A
0005C2 2795           01262          addwf    tmp7,f
0005C4 0012           01263          return
0005C6                01264 sprawdz_czy_odebrano_mala_litere
0005C6 0E61           01265          movlw    0x61
0005C8 5CEF           01266          subwf    INDF0,w
0005CA 6F95           01267          movwf    tmp7
0005CC 0BF0           01268          andlw    0xf0 
0005CE A4D8           01269          btfss    STATUS,Z
0005D0 EFED F002      01270          goto     zla_dana_wez_0
0005D4 0E0A           01271          movlw    0x0A
0005D6 2795           01272          addwf    tmp7,f
0005D8 0012           01273          return
0005DA                01274 zla_dana_wez_0
0005DA 6B95           01275          clrf     tmp7
0005DC 0012           01276          return
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01277          
0005DE                01278 kopiuj_liczbe_przeslana
                      01279 ;procedura dziala na tej zasadzie
                      01280 ;ze znaki 0123456789;:<=>?
                      01281 ;wysłane na ekran 
                      01282 ;po odjeciu 0x30 sa 4bitami liczby
                      01283 ;pierwszy znak jest wyzszym bajtem
                      01284 ;drugi znak nizszym
                      01285 
                      01286 ;dodano obsluge literek a,b,c,d,e,f
                      01287 ;zamiast znakow ;:<=>?
0005DE 2AE9           01288          incf     FSR0L,f
                      01289          
0005E0 ECD3 F002      01290          call   sprawdz_czy_odebrano_litere  
                      01291          
                      01292          
0005E4 3995           01293          swapf    tmp7,w
0005E6 6F91           01294          movwf    tmp
                      01295          
0005E8 2AE9           01296          incf     FSR0L,f
0005EA ECD3 F002      01297          call     sprawdz_czy_odebrano_litere
0005EE 5195           01298          movf     tmp7,w
0005F0 2791           01299          addwf    tmp,f
                      01300          
0005F2 0012           01301          return
                      01302                   
0005F4                01303 zamien_na_hex
                      01304 ;jezeli po odjeciu 0a jest niezanaczony bit C
                      01305 ;to znaczy ze dodaj 
0005F4 6F95           01306          movwf    tmp7
0005F6 0E0A           01307          movlw    0x0a
0005F8 5D95           01308          subwf    tmp7,w
0005FA A0D8           01309          btfss    STATUS,C
0005FC EF03 F003      01310          goto     cyfry_0_9
000600 5195           01311          movf     tmp7,w
000602 0F37           01312          addlw    0x37
000604 0012           01313          return
000606                01314 cyfry_0_9         
000606 5195           01315          movf     tmp7,w
000608 0F30           01316          addlw    0x30
00060A 0012           01317          return
                      01318          
00060C                01319 ustaw_spbrg
                      01320          
                      01321          
00060C ECEF F002      01322          call     kopiuj_liczbe_przeslana
000610 5191           01323          movf     tmp,w
                      01324 ;zmieniam SPBRG
                      01325          ;bsf      STATUS,RP0
                      01326          ;bcf      STATUS,RP1
                      01327 ;        movlw    0x1a
000612 6EAF           01328          movwf    SPBRG    
                      01329          ;bcf      STATUS,RP0
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000614 EF27 F005      01330          goto     powrot_z_polecen
                      01331 
000618                01332 pokaz_rejestr     
                      01333          
000618 ECEF F002      01334          call     kopiuj_liczbe_przeslana
                      01335          
                      01336 ;przechowuje FSR0L gdzies    
                      01337          
                      01338          
00061C 5191           01339          movf     tmp,w
00061E 6EDA           01340          movwf    FSR2H
000620 ECEF F002      01341          call     kopiuj_liczbe_przeslana
000624 5191           01342          movf     tmp,w
000626 6ED9           01343          movwf    FSR2L
                      01344 ;        movf     INDF0,w
                      01345 ;teraz rodzielam bajt na 4 bity starsze i 4 bity mlodsze
000628 38DF           01346          swapf    INDF2,w
00062A 0B0F           01347          andlw    0x0f
00062C ECFA F002      01348          call     zamien_na_hex
000630 6EAD           01349          movwf    TXREG
                      01350          
000632 ECA9 F002      01351          call     sprawdz_czy_mozna_wysylac
                      01352          
000636 50DF           01353          movf     INDF2,w
                      01354 ;robiac taka operacje kasuje starszy bajt na 3 a mlodszy bez zmian      
000638 0B0F           01355          andlw    0x0f
00063A ECFA F002      01356          call     zamien_na_hex
00063E 6EAD           01357          movwf    TXREG
000640 ECA9 F002      01358          call     sprawdz_czy_mozna_wysylac
000644 0E0A           01359          movlw    znak_lf
000646 6EAD           01360          movwf    TXREG
000648 ECA9 F002      01361          call     sprawdz_czy_mozna_wysylac
                      01362          
00064C EF27 F005      01363          goto     powrot_z_polecen
                      01364 
                      01365 
                      01366 ;inicjuje pomiar co ile sekund na ktoryms z kanalow     
000650                01367 zle_polecenie
000650 6B91           01368          clrf     tmp
000652                01369 zle_polecenie_petla
                      01370 ;jestem w pamieci gdzie skok musi byc wykonany w  
                      01371 ;250 komorce stad do 
                      01372 ;PCLATH musze zaladowac 0x2
000652 0E02           01373          movlw    0x02
000654 6EFA           01374          movwf    PCLATH
000656 5191           01375          movf     tmp,w
000658 EC39 F003      01376         call    Tab_zle_polecenie
00065C 6AFA           01377         clrf      PCLATH
                      01378 ;je?eli przeczytał 0 to kończ wyświetlanie
00065E 0A00           01379          xorlw    0
000660 B4D8           01380          btfsc    STATUS,Z
000662 EF27 F005      01381          goto     powrot_z_polecen
000666 ECA9 F002      01382          call     sprawdz_czy_mozna_wysylac
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 45


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00066A 6EAD           01383          movwf    TXREG
00066C 2B91           01384          incf     tmp,f
00066E EF29 F003      01385          goto    zle_polecenie_petla
                      01386          
000672                01387 Tab_zle_polecenie         
000672 26F9           01388          addwf    PCL,f
000674 0C7A           01389          retlw    _z
000676 0C6C           01390          retlw    _l
000678 0C65           01391          retlw    _e
00067A 0C20           01392          retlw    _puste
00067C 0C70           01393          retlw    _p
00067E 0C6F           01394          retlw    _o
000680 0C6C           01395          retlw    _l
000682 0C65           01396          retlw    _e
000684 0C63           01397          retlw    _c
000686 0C65           01398          retlw    _e
000688 0C6E           01399          retlw    _n
00068A 0C69           01400          retlw    _i
00068C 0C65           01401          retlw    _e
00068E 0C0D           01402          retlw    znak_cr
000690 0C00           01403          retlw    0
                      01404          
000692                01405 inicjuj_pomiar
                      01406 ;odbierz cyfre ile mam wlaczyc portow analogowych
                      01407          
                      01408 ;do pomiarow potrzebuje rejestr TMR2         
000692 2AE9           01409          incf     FSR0L,f
000694 50EF           01410          movf     INDF0,w
000696 B4D8           01411          btfsc    STATUS,Z
000698 EF71 F003      01412          goto     wylacz_pomiary
                      01413          
00069C 0E30           01414          movlw    0x30
00069E 5CEF           01415          subwf    INDF0,w
0006A0 B4D8           01416          btfsc    STATUS,Z
0006A2 EF71 F003      01417          goto     wylacz_pomiary
0006A6 6FA5           01418          movwf    ile_kanalow
                      01419          
0006A8 6FA6           01420          movwf    ktory_kanal_mierze
                      01421          
                      01422             
                      01423 ;sprawdz czy liczba kanalow nie jest wieksza od 8
                      01424 ;jezeli od ile_kanalow odejme 8 i nie wyjdzie bit C
                      01425 ;tzn pozyczki to przyjmij 0x07
0006AA 0808           01426          sublw    0x08
0006AC A0D8           01427          btfss    STATUS,C
0006AE EF28 F003      01428          goto     zle_polecenie
                      01429 ;jezeli nie ma kropki to koncz
0006B2 2AE9           01430          incf     FSR0L,f
0006B4 0E2E           01431          movlw    _kropka
0006B6 18EF           01432          xorwf    INDF0,w
0006B8 A4D8           01433          btfss    STATUS,Z
0006BA EF27 F005      01434          goto     powrot_z_polecen
                      01435 ;odbierz kolejne cyfry
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 46


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01436         
0006BE ECEF F002      01437          call     kopiuj_liczbe_przeslana
0006C2 5191           01438          movf     tmp,w
0006C4 6FA7           01439          movwf    odstep_pomiarowy
0006C6 6FA8           01440          movwf    aktualny_odstep
                      01441 ;wlacz analog/cyfre
0006C8 0E01           01442          movlw    b'00000001'
0006CA 6EC2           01443          movwf    ADCON0
0006CC 85A0           01444          bsf      markers2,pomiary
                      01445          ;bcf      portlampka2,lampka2
                      01446          ;clrf     TMR2
                      01447          ;movlw    b'00000000'
                      01448          ;movwf    T2CON
0006CE 51AF           01449          movf    jak_duzo_probek,w
                      01450          
0006D0 6FB0           01451          movwf   ktora_probka
0006D2 5082           01452          movf     port_multiplekser,w
                      01453          
                      01454 ;czyszcze aktualne ustawienia 
                      01455 ;jezeli byl tu b'01010001'     
0006D4 0BF8           01456          andlw    b'11111000'
                      01457 ;w wyniku mamy b'01010000'      
0006D6 6E8B           01458          movwf    latch_multiplekser
                      01459          
                      01460 ;IF  (czy_ekran==1)
                      01461 ;         
                      01462 ;         movlw   linia_gorna+4
                      01463 ;         call    send
                      01464  ;        call     check_busy
                      01465 ;         movlw    _B
                      01466 ;         call     write_lcd
                      01467 ;ENDIF
0006D8 8B9F           01468          bsf      markers,czy_wyswietlam_temp
0006DA 859F           01469          bsf      markers,pomiary_zrobione
0006DC 899F           01470          bsf   markers,czy_wysylac_pomiary_serial
                      01471          
0006DE EF27 F005      01472          goto     powrot_z_polecen    
                      01473 
0006E2                01474 wylacz_pomiary
0006E2 999F           01475       bcf   markers,czy_wysylac_pomiary_serial
0006E4 0E00           01476          movlw    b'00000000'
0006E6 6EC2           01477          movwf    ADCON0
0006E8 95A0           01478          bcf      markers2,pomiary
0006EA 99A0           01479          bcf     markers2,wyslij_pomiar
0006EC 9881           01480          bcf     portlampka2,lampka2
0006EE 9DA0           01481          bcf      markers2,reguluj
                      01482          ;bcf      markers2,
0006F0 9B9F           01483          bcf      markers,czy_wyswietlam_temp
0006F2 EF27 F005      01484          goto     powrot_z_polecen                      
                      01485 ;polecenie ustawia regulator -> pokazuje wzgledem ktorego pomiaru ma regulowac wyjscie regulatora wybran
                            e arbitralnie np PORTC0
                      01486 ;i do tego portu podlaczam wyjscie na przekaznik lub triac     
                      01487 ;
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 47


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01488 ;*Rx.yyyy
0006F6                01489 wylacz_regulator
0006F6 9DA0           01490          bcf      markers2,reguluj
0006F8 9881           01491          bcf      portlampka2,lampka2
0006FA EF27 F005      01492          goto     powrot_z_polecen              
0006FE                01493 ustaw_regulator
                      01494 ;jezeli nie wlaczylem wczesniej analoga to nie wlaczam regulatora
                      01495 
0006FE A5A0           01496          btfss    markers2,pomiary
000700 EF7B F003      01497          goto     wylacz_regulator
                      01498          
000704 2AE9           01499          incf     FSR0L,f
000706 ECD3 F002      01500          call     sprawdz_czy_odebrano_litere
00070A 5195           01501          movf     tmp7,w
                      01502 ;         btfsc    STATUS,Z
                      01503 ;         goto     wylacz_regulator
                      01504          
00070C 6FAD           01505         movwf    jaka_wartosc_regulujeH
00070E ECEF F002      01506          call     kopiuj_liczbe_przeslana
000712 5191           01507          movf     tmp,w 
000714 6FAE           01508          movwf    jaka_wartosc_regulujeL
                      01509          
000716 8DA0           01510          bsf      markers2,reguluj
000718 EF27 F005      01511          goto     powrot_z_polecen    
                      01512 
                      01513          
Warning[208]: Label truncated at 32 characters. (ustaw_wartosc_dzielenia_usredniania)
00071C                01514 ustaw_wartosc_dzielenia_usredniania         
                      01515 ;sprawdzam    który bit jest ustawiony
                      01516 ;jeżeli jak_duzo_probek == 0x80 to ustawiony jest bit 7
00071C BFAF           01517       btfsc       jak_duzo_probek,7
00071E 0E02           01518       movlw       0x02
                      01519 ;bit 6 = 0x40   
000720 BDAF           01520       btfsc       jak_duzo_probek,6
000722 0E04           01521       movlw       0x04
                      01522       
000724 BBAF           01523       btfsc       jak_duzo_probek,5
000726 0E08           01524       movlw       0x08
                      01525 ;0x10      
000728 B9AF           01526       btfsc       jak_duzo_probek,4
00072A 0E10           01527       movlw       0x10
                      01528 ;0x20      
00072C B7AF           01529       btfsc       jak_duzo_probek,3
00072E 0E20           01530       movlw       0x20
                      01531 ;0x40      
000730 B5AF           01532       btfsc       jak_duzo_probek,2
000732 0E40           01533       movlw       0x40
                      01534       
                      01535 ;2 próbki      
000734 B3AF           01536       btfsc       jak_duzo_probek,1
000736 0E80           01537       movlw       0x80
                      01538       
000738 6FB2           01539       movwf       usrednianie_przez_co_mnoze
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 48


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01540       
00073A 0012           01541       return
                      01542       
00073C                01543 ustaw_probki                              ;                 PROBKI
00073C 6BAA           01544          clrf     pomiarH
00073E 6BAB           01545          clrf     pomiarL
000740 6BAC           01546          clrf     pomiar_ulamek
000742 6B9B           01547          clrf     wynikh
000744 6B9C           01548          clrf     wynik
                      01549 ;zawsze wyłącz na początku usrednianie
000746 919F           01550          bcf      markers,czy_usrednianie
                      01551          
000748 ECEF F002      01552          call     kopiuj_liczbe_przeslana
00074C 5191           01553          movf     tmp,w
00074E 6FAF           01554          movwf    jak_duzo_probek
                      01555          
                      01556          ;movwf   ktora_probka
                      01557          
                      01558 ;sprawdz czy usredniamy czy nie tzn czy wartosc jak_duzo_probek < 2
000750 0801           01559          sublw    1
000752 B0D8           01560          btfsc    STATUS,C
000754 EF27 F005      01561          goto     powrot_z_polecen
000758 819F           01562          bsf      markers,czy_usrednianie
                      01563 ;ustaw wartość liczby przez którą mnoże każdy z pomiarów -> tzn przez ile dzielę
                      01564          
00075A EC8E F003      01565          call     ustaw_wartosc_dzielenia_usredniania
                      01566          
00075E EF27 F005      01567          goto     powrot_z_polecen
                      01568 
000762                01569 rozkaz_wysylania_znaku_na_lcd
000762 ECEF F002      01570          call     kopiuj_liczbe_przeslana
000766 5191           01571          movf     tmp,w
000768 ECF4 F000      01572          call     send
00076C ECEF F002      01573          call     kopiuj_liczbe_przeslana
000770 5191           01574          movf     tmp,w
000772 EC05 F001      01575          call     write_lcd
000776 EF27 F005      01576          goto     powrot_z_polecen
                      01577 
                      01578                                                                   ;*                                  **
                            ***********************POLecenie DS1820
00077A                01579 PIN_HI
                      01580         
00077A 8A94           01581         BSF     TRISC, czujnik_ds1820           ; high impedance
                      01582         
                      01583         
00077C 0012           01584         RETURN
                      01585 
00077E                01586 PIN_LO
00077E 9A82           01587         BCF     port_ds1820,czujnik_ds1820
                      01588         
000780 9A94           01589         BCF     TRISC, czujnik_ds1820           ; low impedance zero
                      01590         
                      01591         
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 49


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000782 0012           01592         RETURN
000784                01593 send_1
000784 6ACC           01594          clrf     TMR2
000786 929E           01595          bcf      PIR1,TMR2IF
000788 ECBF F003      01596          call     PIN_LO
00078C 0000           01597          nop
00078E ECBD F003      01598          call     PIN_HI
                      01599          ;bcf      port_ds1820,czujnik_ds1820
                      01600          ;nop
                      01601          ;nop
                      01602          ;nop
                      01603          ;nop
                      01604          ;nop
                      01605          ;nop
                      01606          ;bsf      port_ds1820,czujnik_ds1820
000792                01607 petla_send1
000792 A29E           01608          btfss    PIR1,TMR2IF        
000794 EFC9 F003      01609          goto     petla_send1
                      01610          
000798 0012           01611          return
                      01612 
00079A                01613 send_0
                      01614          ;bsf      port_ds1820,czujnik_ds1820
00079A ECBF F003      01615          call     PIN_LO
00079E 6ACC           01616          clrf     TMR2
0007A0 0000           01617          nop
                      01618          
0007A2 929E           01619          bcf      PIR1,TMR2IF
                      01620          
0007A4 9A82           01621          bcf      port_ds1820,czujnik_ds1820
0007A6                01622 petla_send0
0007A6 A29E           01623          btfss    PIR1,TMR2IF        
0007A8 EFD3 F003      01624          goto     petla_send0
0007AC ECBD F003      01625          call     PIN_HI
                      01626          
0007B0 0012           01627          return
                      01628 
                      01629 
                      01630 
0007B2                01631 inicjacja_ds1820
                      01632 ;wysyla 0 na linie danych do ds1820 przez 
                      01633 ;inicjalizacja 0 na wyjsciu okolo 480us tzn dla ustawienia 1:2 
                      01634 ;        dokladnie 256 z liczeniem TMR2 co 2, pozniej otwarcie portu na wejscie przejscie do 1 i po kilk
                            unastu us otwarcie portu na wejscie
                      01635 ;        powinien byc obecny sygnal 0 do okolo 240 us.
                      01636 ;otwieram port na wyjscie
0007B2 98AB           01637          bcf      RCSTA,CREN
                      01638          
0007B4 9A94           01639          bcf      TRISC,czujnik_ds1820
                      01640          
                      01641 ;ustawiam tmr2 na zliczanie 2 
0007B6 0EFF           01642          movlw    0xff
                      01643          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 50


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0007B8 6ECB           01644          movwf    PR2
                      01645          
                      01646          
0007BA 0E0C           01647          movlw    b'00001100'
0007BC 6ECA           01648          movwf    T2CON
0007BE 929E           01649          bcf      PIR1,TMR2IF
                      01650 ;wlaczam przerwanie Tmr2
                      01651          ;bsf      STATUS,RP0
                      01652          ;bsf      PIE1,TMR2IE2
                      01653          ;bcf      STATUS,RP0         
0007C0 ECBD F003      01654          call     PIN_HI
0007C4 ECBF F003      01655          call     PIN_LO
                      01656 ;daje znacznik ze dotyczy to inicjacji ds1820
                      01657          ;bsf      znaczniki_ds,inicjacja
                      01658 ;petla czekania na koniec inicjacji
0007C8                01659 petla_inicjacji1
                      01660          
0007C8 A29E           01661          btfss    PIR1,TMR2IF
0007CA EFE4 F003      01662          goto     petla_inicjacji1
                      01663 ;teraz przelaczam sie na odbior danych z ds1820
                      01664          
0007CE 8A94           01665          bsf      TRISC,czujnik_ds1820
                      01666          
0007D0 0000           01667          nop
0007D2 929E           01668          bcf      PIR1,TMR2IF
                      01669 ;sprawdzam czy w ciagu 480us pojawilo sie 0 na porcie czujnika
0007D4                01670 petla_inicjacji2
0007D4 AA82           01671          btfss    port_ds1820,czujnik_ds1820
0007D6 EFFE F003      01672          goto     petla_inicjacji3
0007DA A29E           01673          btfss    PIR1,TMR2IF
0007DC EFEA F003      01674          goto     petla_inicjacji2
                      01675          
0007E0                01676 blad_inicjacji_ds
0007E0 ECA9 F002      01677          call    sprawdz_czy_mozna_wysylac
0007E4 0E0A           01678          movlw    znak_lf
0007E6 6EAD           01679          movwf   TXREG
0007E8 ECA9 F002      01680          call    sprawdz_czy_mozna_wysylac
0007EC 0E35           01681          movlw    0x35
                      01682          
0007EE 6EAD           01683          movwf   TXREG
0007F0 ECA9 F002      01684          call    sprawdz_czy_mozna_wysylac
0007F4 0E0A           01685          movlw    znak_lf
0007F6 6EAD           01686          movwf   TXREG
0007F8 EF27 F005      01687          goto     powrot_z_polecen   
0007FC                01688 petla_inicjacji3
0007FC BA82           01689          btfsc    port_ds1820,czujnik_ds1820
0007FE EF04 F004      01690          goto     inicjacja_ok
000802 A29E           01691          btfss    PIR1,TMR2IF
000804 EFFE F003      01692          goto     petla_inicjacji3
                      01693          
000808                01694 inicjacja_ok
000808 B39F           01695          btfsc    markers,czy_wysylanie
00080A EF1E F004      01696          goto     wysylanie_danych_rozkaz
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 51


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01697          
00080E ECA9 F002      01698          call    sprawdz_czy_mozna_wysylac
000812 0E0A           01699          movlw    znak_lf
000814 6EAD           01700          movwf   TXREG
000816 ECA9 F002      01701          call    sprawdz_czy_mozna_wysylac
00081A 0E4F           01702          movlw    _O
                      01703          
00081C 6EAD           01704          movwf   TXREG
00081E ECA9 F002      01705          call    sprawdz_czy_mozna_wysylac
000822 0E4B           01706          movlw    _K
000824 6EAD           01707          movwf   TXREG
000826 ECA9 F002      01708          call    sprawdz_czy_mozna_wysylac
00082A 0E0A           01709          movlw    znak_lf
00082C 6EAD           01710          movwf   TXREG
00082E ECA9 F002      01711          call    sprawdz_czy_mozna_wysylac
                      01712          
000832 EF27 F005      01713          goto     powrot_z_polecen
                      01714          
                      01715          
                      01716              
                      01717 ;jezeli otrzyma 1 to na ekran wysyla informacje 'ds ok'         
                      01718 
                      01719 
000836                01720 wysylanie_danych
000836 839F           01721          bsf      markers,czy_wysylanie
000838 EFD9 F003      01722          goto     inicjacja_ds1820
00083C                01723 wysylanie_danych_rozkaz
00083C 939F           01724          bcf      markers,czy_wysylanie
                      01725          
                      01726         
                      01727 ;ustawiam tmr2 na 60us bo tyle trwa jeden bit  
00083E 0E3C           01728          movlw    0x3c
                      01729          
000840 6ECB           01730          movwf    PR2
                      01731          
                      01732          ;bcf      TRISC,czujnik_ds1820
                      01733         
                      01734          ;bcf      STATUS,RP0
                      01735 ;zliczanie 1:1         
000842 0E04           01736          movlw    b'00000100'
000844 6ECA           01737          movwf    T2CON
000846 929E           01738          bcf      PIR1,TMR2IF
                      01739 ;wlaczam przerwanie Tmr2
                      01740          
000848                01741 wysylanie_bajtu_rozkazu
                      01742 ;zczytuje dana do wyslania
000848 ECEF F002      01743         call      kopiuj_liczbe_przeslana
00084C 5191           01744         movf      tmp,w
00084E 6FB4           01745         movwf     polecenie_wysylane
000850 6ACC           01746         clrf      TMR2
000852 0E08           01747         movlw     8
000854 6F8B           01748         movwf     n
000856                01749 petla_sending        
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 52


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01750 ;jezeli 0 to wyslij   0
000856 A1B4           01751         btfss     polecenie_wysylane,0
000858 ECCD F003      01752         call      send_0
00085C B1B4           01753         btfsc     polecenie_wysylane,0
00085E ECC2 F003      01754         call      send_1
000862 8A82           01755         bsf       port_ds1820,czujnik_ds1820
000864 90D8           01756         bcf       STATUS,C
000866 33B4           01757         rrcf       polecenie_wysylane,f
                      01758         ;bcf       STATUS,C
                      01759         ;movf      polecenie_wysylane,w
                      01760         ;btfss     STATUS,Z
000868 2F8B           01761         decfsz    n,f
00086A EF2B F004      01762         goto      petla_sending
                      01763         
                      01764 ;sprawdzam czy kolejny bajt jest 0x0d        
00086E 2AE9           01765         incf     FSR0L,f
000870 50EF           01766         movf      INDF0,w
000872 0A0D           01767         xorlw     0x0d
000874 B4D8           01768         btfsc     STATUS,Z
000876 EF40 F004      01769         goto     sprawdz_czy_ds1820_wysyla
                      01770         
00087A 06E9           01771         decf      FSR0L,f
00087C EF24 F004      01772         goto      wysylanie_bajtu_rozkazu
                      01773         
                      01774         
000880                01775 sprawdz_czy_ds1820_wysyla
000880 0ECA           01776          movlw    bajt_ds
000882 6EE9           01777          movwf    FSR0L
000884 51B5           01778          movf     jak_duzo_bajtow_odbieram_z_ds,w
000886 6F8E           01779          movwf    liczba1
                      01780             
                      01781         ;goto     powrot_z_polecen
                      01782 ;procedura sprawdza czy ds1820 cos wysyla jezeli tak to sprawdza przez 60 us czy jest choc na chwile 0
                      01783 ;normalnie jezeli ds1820 nic nie wysyla to jest caly czas 1 bez rzadnych zmian
000888                01784 petla_odbioru_ds1820
000888 0E08           01785         movlw     8
00088A 6F8B           01786         movwf     n
00088C 6ACC           01787         clrf      TMR2
00088E 6AEF           01788         clrf      INDF0
000890 929E           01789         bcf       PIR1,TMR2IF
                      01790         
000892                01791 petla_czy_jest_0
000892 ECBF F003      01792          call     PIN_LO
000896 0000           01793          nop
000898 ECBD F003      01794          call     PIN_HI
00089C 0000           01795          nop
00089E 0000           01796          nop
0008A0 0000           01797          nop
0008A2 0000           01798          nop
0008A4 0000           01799          nop
0008A6 0000           01800          nop
0008A8 0000           01801          nop
0008AA 5082           01802          movf     port_ds1820,w
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 53


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0008AC 6F8F           01803          movwf    liczba2
0008AE AB8F           01804          btfss    liczba2,czujnik_ds1820
0008B0 90D8           01805          bcf      STATUS,C
0008B2 BB8F           01806          btfsc    liczba2,czujnik_ds1820
0008B4 80D8           01807          bsf      STATUS,C
0008B6 32EF           01808          rrcf      INDF0,f
                      01809          
0008B8                01810 czekam_na_kolejny_bit
0008B8 A29E           01811         btfss    PIR1,TMR2IF
0008BA EF5C F004      01812         goto      czekam_na_kolejny_bit
0008BE 929E           01813         bcf       PIR1,TMR2IF
                      01814         
0008C0 2F8B           01815         decfsz    n,f
0008C2 EF49 F004      01816         goto      petla_czy_jest_0
0008C6 2AE9           01817         incf      FSR0L,f
                      01818 ;czy juz przeszly wszystkie linie (4 bajty odebrano)  
0008C8 2F8E           01819         decfsz    liczba1,f
0008CA EF44 F004      01820         goto      petla_odbioru_ds1820
                      01821         
                      01822 ;jezeli minelo 60us i nic sie nie dzialo to przerwij odbieranie 
                      01823         ;btfsc    PIR1,TMR2IF
0008CE 51B5           01824         movf     jak_duzo_bajtow_odbieram_z_ds,w
0008D0 6F8B           01825         movwf     n
0008D2 0ECA           01826         movlw    bajt_ds
0008D4 6EE9           01827         movwf    FSR0L
Warning[208]: Label truncated at 32 characters. (petla_wysylania_odebranych_bajtow)
0008D6                01828 petla_wysylania_odebranych_bajtow        
0008D6 ECA9 F002      01829         call    sprawdz_czy_mozna_wysylac
                      01830          
0008DA 38EF           01831          swapf    INDF0,w
0008DC 0B0F           01832          andlw    0x0f
0008DE ECFA F002      01833          call     zamien_na_hex
0008E2 6EAD           01834          movwf   TXREG
                      01835          
0008E4 ECA9 F002      01836          call    sprawdz_czy_mozna_wysylac
                      01837          
0008E8 50EF           01838          movf     INDF0,w
0008EA 0B0F           01839          andlw    0x0f
0008EC ECFA F002      01840          call     zamien_na_hex
0008F0 6EAD           01841          movwf   TXREG     
0008F2 2AE9           01842          incf     FSR0L,f
0008F4 2F8B           01843          decfsz   n,f
0008F6 EF6B F004      01844          goto     petla_wysylania_odebranych_bajtow
                      01845          
0008FA ECA9 F002      01846          call    sprawdz_czy_mozna_wysylac
0008FE 0E0A           01847          movlw    znak_lf
000900 6EAD           01848          movwf   TXREG   
000902 EF27 F005      01849         goto     powrot_z_polecen
                      01850         
Warning[208]: Label truncated at 32 characters. (ustawienie_liczby_odbieranych_bajtow)
000906                01851 ustawienie_liczby_odbieranych_bajtow
                      01852          
000906 2AE9           01853          incf     FSR0L,f
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 54


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000908 ECD3 F002      01854          call     sprawdz_czy_odebrano_litere
00090C 5195           01855          movf     tmp7,w
00090E 080B           01856          sublw    0x0b
000910 A0D8           01857          btfss    STATUS,C
000912 EF83 F004      01858          goto     ustawienie_liczby_odbieranych_bajtow_zero
                      01859          
000916 5195           01860          movf     tmp7,w
000918 6FB5           01861          movwf    jak_duzo_bajtow_odbieram_z_ds
00091A EF27 F005      01862          goto     powrot_z_polecen
                      01863          
Warning[208]: Label truncated at 32 characters. (ustawienie_liczby_odbieranych_bajtow_zero)
Error[116]  : Address label duplicated or different in second pass (ustawienie_liczby_odbieranych_ba)
00091E                01864 ustawienie_liczby_odbieranych_bajtow_zero
00091E 0E04           01865          movlw    0x04
000920 6FB5           01866          movwf    jak_duzo_bajtow_odbieram_z_ds
000922 EF27 F005      01867          goto     powrot_z_polecen
                      01868          
                      01869 ;zarejestrowalem 0
                      01870         
                      01871 ;tzn czy przez czas 8  bitow cos         
000926                01872 rozkazy_ds1820
000926 2AE9           01873         incf     FSR0L,f
000928 0E69           01874         movlw    _i
00092A 18EF           01875         xorwf    INDF0,w
00092C B4D8           01876         btfsc    STATUS,Z 
00092E EFD9 F003      01877         goto      inicjacja_ds1820
                      01878         
000932 0E73           01879         movlw    _s
000934 18EF           01880         xorwf    INDF0,w
000936 B4D8           01881         btfsc    STATUS,Z 
000938 EF1B F004      01882         goto     wysylanie_danych
                      01883         
00093C 0E62           01884         movlw    _b
00093E 18EF           01885         xorwf    INDF0,w
000940 B4D8           01886         btfsc    STATUS,Z 
000942 EF83 F004      01887         goto     ustawienie_liczby_odbieranych_bajtow
                      01888         
000946 EF27 F005      01889         goto     powrot_z_polecen
                      01890         
                      01891 ;*********KOniec ds1820
00094A                01892 wlaczenie_rejestracji_pradu
00094A ECEF F002      01893       call     kopiuj_liczbe_przeslana
                      01894       
00094E 5191           01895       movf     tmp,w
                      01896       
                      01897 ;sprawdzenie czy nie podano liczby większej od 2 (mniejszą od 3)
000950 0E03           01898       movlw       3
000952 6191           01899       cpfslt    tmp
                      01900 ;jezeli wyszlo C tzn ze przekroczono
000954 EF27 F005      01901       goto        powrot_z_polecen
                      01902       
000958 5191           01903       movf     tmp,w
00095A E005           01904       bz       wylaczenie_rejestarcji_pradu
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 55


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00095C 6FD5           01905       movwf       jak_duzo_kanalow_pradu
                      01906       
00095E 81A1           01907       bsf   markers3,pomiary_pradu
000960 6BD6           01908       clrf        ktory_aktualnie_kanal_pradu
                      01909       
000962 EF27 F005      01910       goto        powrot_z_polecen
                      01911       
000966                01912 wylaczenie_rejestarcji_pradu
000966 91A1           01913       bcf   markers3,pomiary_pradu
000968 EF27 F005      01914       goto        powrot_z_polecen
                      01915       
Warning[208]: Label truncated at 32 characters. (rozkaz_rejestracji_poprawki_pomiaru_temperatury)
00096C                01916 rozkaz_rejestracji_poprawki_pomiaru_temperatury
                      01917       ;incf     FSR0L,f   
00096C ECEF F002      01918       call     kopiuj_liczbe_przeslana
                      01919 
                      01920         
000970 5191           01921       movf     tmp,w
                      01922 ;tmp6 przechowuje pod ktory adres zapisac poprawke      
000972 6F94           01923       movwf    tmp6
000974 0809           01924       sublw    9
                      01925 ;jezeli wyszlo C tzn ze przekroczono a kanalow mamy tylko 8 + 2 pradowe
000976 A0D8           01926       btfss       STATUS,C
000978 EF27 F005      01927       goto        powrot_z_polecen
                      01928       
                      01929       
                      01930 ;sprawdz czy przeslana dana nie jest wieksza od 7 jezeli jest to przerwij
                      01931 ;odbierz kolejna liczbe
                      01932       ;incf     FSR0L,f
00097C ECEF F002      01933       call     kopiuj_liczbe_przeslana
                      01934 
                      01935       ;jest w tmp  poprawka
000980 0ECB           01936       movlw    poprawka0
                      01937       ;dec100 przechowuje ktorego czujnika to dotyczy
000982 2594           01938       addwf    tmp6,w
000984 6EE1           01939       movwf    FSR1L
000986 6AE2           01940       clrf     FSR1H
                      01941       ;zapisuje do rejestru poprawek
000988 5191           01942       movf     tmp,w
00098A 6EE7           01943       movwf    INDF1
                      01944       ;movwf    poprawka
00098C 0E91           01945       movlw       tmp
00098E 6EE1           01946       movwf    FSR1L
                      01947       
000990 0E00           01948       movlw poprawka0_ee
000992 2594           01949       addwf tmp6,w
000994 EC8B F001      01950       call  zapis_eeprom
000998 EF27 F005      01951       goto        powrot_z_polecen
                      01952 
00099C                01953 wybor_czujnika_regulatora
00099C ECEF F002      01954       call     kopiuj_liczbe_przeslana
                      01955       
                      01956       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 56


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01957       ;sprawdzam czy nie jest większe od 7
0009A0 0E08           01958       movlw    8
0009A2 6191           01959       cpfslt   tmp
0009A4 EFD8 F004      01960       goto     wybrano_czujnik_regulatora_wiekszy_od_7
                      01961       
0009A8 5191           01962       movf     tmp,w
                      01963       
0009AA 6FE8           01964       movwf    ktory_czujnik_reguluje
                      01965       
0009AC EF27 F005      01966       goto        powrot_z_polecen
                      01967 
Warning[208]: Label truncated at 32 characters. (wybrano_czujnik_regulatora_wiekszy_od_7)
0009B0                01968 wybrano_czujnik_regulatora_wiekszy_od_7
0009B0 0E00           01969       movlw       0
0009B2 6FE8           01970       movwf       ktory_czujnik_reguluje
0009B4 EF27 F005      01971       goto        powrot_z_polecen
                      01972       
0009B8                01973 sprawdz_czy_polecenie                  
                      01974 ;sprawdz czy odebrano 'znak_cr'
0009B8 0E00           01975          movlw    0x00
0009BA 6EE9           01976          movwf    FSR0L
0009BC 0E01           01977          movlw    1
0009BE 6EEA           01978          movwf    FSR0H
                      01979          
0009C0 0E2A           01980          movlw    _star
0009C2 18EF           01981          xorwf    INDF0,w
0009C4 A4D8           01982          btfss    STATUS,Z
Warning[205]: Found directive in column 1. (IF)
                      01983 IF (czy_ekran==1)         
0009C6 EF2C F005      01984          goto     wyslij_na_ekran_to_co_odebralem
Warning[205]: Found directive in column 1. (ENDIF)
                      01985 ENDIF         
Warning[205]: Found directive in column 1. (IF)
                      01986 IF       (czy_ekran==0)
                      01987         goto     powrot_z_polecen
                      01988 ENDIF         
                      01989    
                      01990 
                      01991 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;         
0009CA                01992 sprawdz_ktore_polecenie
                      01993 ;polecenia:
                      01994 ;
                      01995 ;        *L-zapal lub zgas lampke lampke
                      01996 ;        *Px.y - pomiar kanal x wyrzucany na port szeregowy co y czasu (y to 1/2 sekundy)
                      01997 ;                 konfiguruje kanal 0 i referencyjne zasilajace
                      01998 ;        *P - puste przerywa pomiary
                      01999 ;        *Cx - czysci x linie ekranu i zeruje kursor
                      02000 ;        *Ryyy    - reguluj odczyt x(ktory kanal) na poziom y ustawienia w ilosc odczytanej cyfry
                      02001 ;        *+x.y - dodaje x + y i wynik na 4 linii ekranu
                      02002 ;        *>x      przeslij znak x
                      02003 ;        **xx   ustaw zegar szeregowego xxx->do SPBRG 
                      02004 ;        xx -> zapis szesnastkowy tzn **:: ustawia SPBRG na 0xaa
                      02005 ;        *#xxxx - pokaz zawartosc rejestru xxxx (podobnie jak powyzej) - podaje dwa bajty np 0fff
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 57


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02006 ;        *S00 - ustawienie ilosci probek na jeden pomiar
                      02007 ;        
                      02008 ;        *Di  -  inicjuje ds1820
                      02009 ;        *Dr  -read rom (only one ds)
                      02010 ;        *Ds      -skip rom (whitout rom identification)
                      02011 
                      02012 ;        *exxyy  - na ekran w miejscu xx wyrzuc znak yy
                      02013 ;        *p0xyy  - poprawka kanalu x o yy
                      02014 ;           *i0x - pomiar pradu z kanalow 2     
                      02015 ;           *A    - który czujnik użyty jest w regulacji
                      02016 ;zacznij robic
                      02017 ;sprawdzam czy
0009CA 2AE9           02018          incf     FSR0L,f
                      02019          
0009CC 0E4C           02020          movlw    _L
0009CE 18EF           02021          xorwf    INDF0,w
0009D0 B4D8           02022          btfsc    STATUS,Z
0009D2 EF7E F002      02023          goto     zapal_lampke
                      02024          
                      02025          
                      02026          
0009D6 0E2B           02027          movlw    _plus
0009D8 18EF           02028          xorwf    INDF0,w
0009DA B4D8           02029          btfsc    STATUS,Z
0009DC EF81 F002      02030          goto     sumuj_liczby
                      02031 ;*> - znak wysylania
0009E0 0E3E           02032          movlw    0x3e
0009E2 18EF           02033          xorwf    INDF0,w
0009E4 B4D8           02034          btfsc    STATUS,Z
0009E6 EFB0 F002      02035          goto     wyslij_znak
                      02036 ;**         
0009EA 0E2A           02037          movlw    _star
0009EC 18EF           02038          xorwf    INDF0,w
0009EE B4D8           02039          btfsc    STATUS,Z
0009F0 EF06 F003      02040          goto     ustaw_spbrg
                      02041 ;*# - pokaz komorke pamieci         
0009F4 0E23           02042          movlw    0x23
0009F6 18EF           02043          xorwf    INDF0,w
0009F8 B4D8           02044          btfsc    STATUS,Z
0009FA EF0C F003      02045          goto     pokaz_rejestr
                      02046 ;*P -> pomiar     
0009FE 0E50           02047          movlw    _P
000A00 18EF           02048          xorwf    INDF0,w
000A02 B4D8           02049          btfsc    STATUS,Z
000A04 EF49 F003      02050          goto     inicjuj_pomiar
                      02051 
                      02052 
                      02053 ;*r ->Reguluj
000A08 0E52           02054          movlw    _R
000A0A 18EF           02055          xorwf    INDF0,w
000A0C B4D8           02056          btfsc    STATUS,Z
000A0E EF7F F003      02057          goto     ustaw_regulator
                      02058          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 58


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02059 ;*S ->probki
000A12 0E53           02060          movlw    _S
000A14 18EF           02061          xorwf    INDF0,w
000A16 B4D8           02062          btfsc    STATUS,Z
000A18 EF9E F003      02063          goto     ustaw_probki
                      02064 ;*D rozkazy Ds1820
000A1C 0E44           02065          movlw    _D
000A1E 18EF           02066          xorwf    INDF0,w
000A20 B4D8           02067          btfsc    STATUS,Z
000A22 EF93 F004      02068          goto     rozkazy_ds1820
                      02069 ;*e 
000A26 0E65           02070          movlw    _e
000A28 18EF           02071          xorwf    INDF0,w
000A2A B4D8           02072          btfsc    STATUS,Z
000A2C EFB1 F003      02073          goto     rozkaz_wysylania_znaku_na_lcd
                      02074          
                      02075          
                      02076 ;*p - poprawka  czujnika temperatury i o ile np: *p0009 czyli 0 o 9 (ujemne to uzupelnienia czyli *p00fe
                             to poprawka o -1
000A30 0E70           02077          movlw    _p
000A32 18EF           02078          xorwf    INDF0,w
000A34 B4D8           02079          btfsc    STATUS,Z
000A36 EFB6 F004      02080          goto     rozkaz_rejestracji_poprawki_pomiaru_temperatury
                      02081          
                      02082 ;*i - pomiar pradu np *i0x
                      02083          
000A3A 0E69           02084          movlw    _i
000A3C 18EF           02085          xorwf    INDF0,w
000A3E B4D8           02086          btfsc    STATUS,Z
000A40 EFA5 F004      02087          goto     wlaczenie_rejestracji_pradu
                      02088          
000A44 0E41           02089          movlw    _A
000A46 18EF           02090          xorwf    INDF0,w
000A48 B4D8           02091          btfsc    STATUS,Z
000A4A EFCE F004      02092          goto     wybor_czujnika_regulatora
                      02093          
                      02094 ;ustaw szybkosc portu szeregowego
                      02095 ;ustawienie jest zapisane do EEPROM i w momencie startu urzadzenia stamtad czytane
                      02096 ;mozliwe ustawienia:
                      02097 ;0x1a - 11200 baudow
                      02098 ;0x0c - 19200 baudow
                      02099 ;
                      02100          
                      02101                            
000A4E                02102 powrot_z_polecen
                      02103 ;        movlw    _up
000A4E 2AE9           02104          incf     FSR0L,f
000A50 97A0           02105          bcf      markers2,sprawdz_odebrane
000A52 6B8D           02106          clrf     odebrano_liter
000A54 88AB           02107          bsf      RCSTA,CREN
                      02108 ;        clrf     FSR0L
                      02109 ;        movwf    INDF
000A56 0012           02110          return
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 59


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02111          
                      02112          
000A58                02113 wyslij_na_ekran_to_co_odebralem
000A58 EC32 F001      02114       call     check_busy
000A5C 0EC0           02115          movlw    linia_dolna
000A5E ECF4 F000      02116          call     send
000A62 EC32 F001      02117          call     check_busy
000A66 0E00           02118          movlw    dane_odebraneL
000A68 6EE9           02119          movwf    FSR0L      
000A6A 0E01           02120          movlw    dane_odebraneH
000A6C 6EEA           02121          movwf    FSR0H      
                      02122          
000A6E                02123 wyswietl_litere_petla
                      02124          
000A6E 0E0D           02125          movlw    0x0d
000A70 18EF           02126          xorwf    INDF0,w
000A72 B4D8           02127          btfsc    STATUS,Z
000A74 EF56 F005      02128          goto     koniec_wyswietlania
                      02129          
                      02130 ;sprawdz czy odebrano pusty znak...
                      02131 ;        movlw    0x0a
                      02132 ;        xorwf    INDF,w
                      02133 ;        btfsc    STATUS,Z
                      02134 ;        goto     koniec_wyswietlania        
                      02135          
000A78 50EF           02136          movf     INDF0,w
000A7A B4D8           02137          btfsc    STATUS,Z
000A7C EF56 F005      02138          goto     koniec_wyswietlania
                      02139 
                      02140 
000A80 518D           02141          movf     odebrano_liter,w
000A82 A4D8           02142          btfss    STATUS,Z
000A84 EF44 F005      02143          goto     wyswietl_litere_petla2
                      02144          
                      02145          
                      02146 ;        goto     koniec_wyswietlania
                      02147 
000A88                02148 wyswietl_litere_petla2
                      02149          ;movlw    linia_dolna
                      02150          ;addwf    linia2,w
                      02151          ;call     send
                      02152          ;call     check_busy
                      02153          
000A88 50EF           02154          movf     INDF0,w
000A8A EC05 F001      02155          call     write_lcd
000A8E EC32 F001      02156          call     check_busy
                      02157 ;        clrf     odebrana_litera
000A92 2B87           02158          incf     linia2,f
                      02159          
                      02160 ;        movlw    0A
                      02161 ;        xorwf    linia2
000A94 A987           02162          btfss    linia2,4
000A96 EF53 F005      02163          goto     wyswietl_litere_petla3
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 60


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02164          
000A9A 6B87           02165          clrf     linia2
000A9C 0E0F           02166          movlw    0x0f
000A9E 6F8B           02167          movwf    n
000AA0 0EC0           02168          movlw    linia_dolna
000AA2 EC23 F001      02169          call     clear_line
                      02170          
000AA6                02171 wyswietl_litere_petla3
000AA6 2AE9           02172          incf     FSR0L,f
                      02173 ;        decfsz   odebrano_liter,f
000AA8 EF37 F005      02174          goto     wyswietl_litere_petla
                      02175          
000AAC                02176 koniec_wyswietlania        
                      02177          ;clrf     odebrano_liter
                      02178          ;bcf      markers2,wyswietl
000AAC 88AB           02179          bsf      RCSTA,CREN
000AAE EF27 F005      02180          goto     powrot_z_polecen
                      02181 
                      02182 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                                                     ;;
                            ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                                     
                      02183 
                      02184             
000AB2                02185 wyswietl_cyfry_temperatury
                      02186       ;sprawdz czy rzadna z cyfr nie przekracza 10
000AB2 0E0A           02187       movlw       0x0a
000AB4 5D98           02188       subwf       dec1,w
000AB6 E302           02189       bnc         sprawdz_10
000AB8 6F98           02190       movwf       dec1
000ABA 2B97           02191       incf        dec10,f
                      02192       
000ABC                02193 sprawdz_10
000ABC 0E0A           02194      movlw       0x0a
000ABE 5D97           02195       subwf       dec10,w
000AC0 E302           02196       bnc         wyswietl_cyfry_temperatury2
000AC2 6F97           02197       movwf       dec10
000AC4 2B96           02198       incf        dec100,f
                      02199   
000AC6                02200 wyswietl_cyfry_temperatury2  
000AC6 EC32 F001      02201       call     check_busy
000ACA 0E20           02202       movlw       _puste
                      02203       
000ACC BDA1           02204       btfsc       markers3,napisz_minus
000ACE 0E2D           02205       movlw       _minus
000AD0 EC05 F001      02206       call        write_lcd
                      02207       
                      02208       
                      02209          
000AD4 EC32 F001      02210       call     check_busy
000AD8 5196           02211       movf     dec100,w
000ADA E10E           02212       bnz       pisz_cyfre_100
                      02213       
000ADC 0E20           02214       movlw    _puste
000ADE EC05 F001      02215       call     write_lcd
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 61


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000AE2 EC32 F001      02216       call     check_busy
000AE6 5197           02217       movf     dec10,w
000AE8 E10D           02218       bnz      pisz_cyfre_10
                      02219       
000AEA 0E20           02220       movlw    _puste
000AEC EC05 F001      02221       call     write_lcd
000AF0 EC32 F001      02222       call     check_busy
000AF4 EF88 F005      02223       goto     pisz_cyfre_1
                      02224       
000AF8                02225 pisz_cyfre_100
000AF8 5196           02226       movf        dec100,w
000AFA 0F30           02227       addlw       0x30
000AFC EC05 F001      02228       call     write_lcd
000B00 EC32 F001      02229       call     check_busy
                      02230 
000B04                02231 pisz_cyfre_10
000B04 5197           02232       movf        dec10,w
000B06 0F30           02233       addlw       0x30
000B08 EC05 F001      02234       call     write_lcd
000B0C EC32 F001      02235       call     check_busy
                      02236       
000B10                02237 pisz_cyfre_1
000B10 5198           02238       movf        dec1,w
000B12 0F30           02239       addlw       0x30
000B14 EC05 F001      02240       call     write_lcd
000B18 EC32 F001      02241       call     check_busy
                      02242       
000B1C 0E2E           02243       movlw    _kropka
000B1E EC05 F001      02244       call     write_lcd
                      02245       
                      02246       
                      02247 ;sprawdz ktory ulamek
000B22 519D           02248       movf     wynik01,w
000B24 E008           02249       bz       pisz_ulamek_00
                      02250       
000B26 0A40           02251       xorlw    0x40
000B28 E011           02252       bz       pisz_ulamek_25
                      02253       
000B2A 519D           02254       movf     wynik01,w
000B2C 0A80           02255       xorlw    0x80
000B2E E019           02256       bz       pisz_ulamek_50
                      02257       
000B30 519D           02258       movf     wynik01,w
000B32 0AC0           02259       xorlw    0xc0
000B34 E021           02260       bz       pisz_ulamek_75
                      02261       
                      02262       
000B36                02263 pisz_ulamek_00
000B36 EC32 F001      02264       call     check_busy
000B3A 0E30           02265       movlw    0x30
000B3C EC05 F001      02266       call     write_lcd
000B40 EC32 F001      02267       call     check_busy
000B44 0E20           02268       movlw    _puste
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 62


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000B46 EC05 F001      02269       call     write_lcd
                      02270       
                      02271       
000B4A 0012           02272       return
                      02273 
000B4C                02274 pisz_ulamek_25
000B4C EC32 F001      02275       call     check_busy
000B50 0E32           02276       movlw    0x32
000B52 EC05 F001      02277       call     write_lcd
                      02278       
000B56 EC32 F001      02279       call     check_busy
000B5A 0E35           02280       movlw    0x35
000B5C EC05 F001      02281       call     write_lcd
000B60 0012           02282       return
                      02283       
000B62                02284 pisz_ulamek_50
000B62 EC32 F001      02285       call     check_busy
000B66 0E35           02286       movlw    0x35
000B68 EC05 F001      02287       call     write_lcd
000B6C EC32 F001      02288       call     check_busy
000B70 0E30           02289       movlw    0x30
000B72 EC05 F001      02290       call     write_lcd
000B76 0012           02291       return
                      02292       
000B78                02293 pisz_ulamek_75
000B78 EC32 F001      02294       call     check_busy
000B7C 0E37           02295       movlw    0x37
000B7E EC05 F001      02296       call     write_lcd
000B82 EC32 F001      02297       call     check_busy
000B86 0E35           02298       movlw    0x35
000B88 EC05 F001      02299       call     write_lcd
000B8C 0012           02300       return
                      02301       
                      02302       
000B8E                02303 odejmij_512_od_wyniku_sredniej
                      02304 
000B8E 0E02           02305          movlw    0x02
000B90 5FAA           02306          subwf    pomiarH,f
                      02307          ;jezeli jest 0 to nic wiecej nie trzeba robic
                      02308          
000B92 B4D8           02309          btfsc    STATUS,Z
000B94 EFD1 F005      02310          goto     wynik_to_po_prostu_L
                      02311          
                      02312        ;jezeli w wyniku nie ma bitu 7 to oznacza brak liczby ujemnej
000B98 AFAA           02313        btfss      pomiarH,7
000B9A EFD1 F005      02314        goto       wynik_to_po_prostu_L
                      02315        
                      02316        
                      02317        
                      02318       ;w wyniku mamy np ff90 - brak 0
                      02319       ;tego nie trzeba bo polecenie negf - działa z -1 przed zastosowaniem
                      02320       ;decf  pomiarL,f
                      02321       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 63


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02322       ;przy odejmowaniu C jest normalnie ustawione
                      02323       ;btfss STATUS,C
                      02324       
                      02325       ;ale to trzeba bo tak samo zadziała dla starszego bajtu, a on nie ma być -1
000B9E 2BAA           02326       incf  pomiarH,f
                      02327       
                      02328       ;zaznacz ze pisz minus
000BA0 8DA1           02329       bsf   markers3,napisz_minus
                      02330       ;negf  pomiarL,f
                      02331       ;negf  pomiarH,f
                      02332 
000BA2                02333 wynik_to_po_prostu_L
000BA2 0012           02334       return
                      02335 
                      02336 
000BA4                02337 usrednianie_wartosci
                      02338 ;oblicz srednia dzielac za pomoca ilosc probek pobieranych
                      02339          
000BA4 51AF           02340         movf    jak_duzo_probek,w
                      02341         
                      02342         ;movwf   ktore_dzielenie_przez2
                      02343         
                      02344         
                      02345         
                      02346 
000BA6 6B9D           02347         clrf      wynik01
                      02348         
000BA8                02349 petla_dzielenia
                      02350                                                                     ; bcf     STATUS,C
                      02351                                                                     ; call     dzielenie_przez_przesuwan
                            ie
                      02352                                                                   ;mam na poczatku w ktore dzieleni_prze
                            z2 b'10000000'
                      02353                                                                   ;po jednym dzieleniu mam b'01000000'
                      02354                                                                     ; bcf       STATUS,C
                      02355                                                                     ; rrcf     ktore_dzielenie_przez2,f
                      02356                                                                     ; btfss   ktore_dzielenie_przez2,0
                      02357                                                                     ; goto     petla_dzielenia
                      02358                                                                      
                      02359 
                      02360 
000BA8 51B2           02361       movf    usrednianie_przez_co_mnoze,w
000BAA 039C           02362       mulwf     wynik
                      02363       
                      02364       ;w PRODH jest wartość do wynik, a w ProdL do wynik01
000BAC 50F4           02365       movf        PRODH,w
000BAE 6F9C           02366       movwf       wynik
000BB0 50F3           02367       movf        PRODL,w
000BB2 6F9D           02368       movwf       wynik01
                      02369       
000BB4 519B           02370       movf        wynikh,w
000BB6 E008           02371       bz          procedura_sumowania_wyniku
                      02372       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 64


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000BB8 51B2           02373       movf      usrednianie_przez_co_mnoze,w
000BBA 039B           02374       mulwf     wynikh
                      02375       
000BBC 50F4           02376       movf        PRODH,w
000BBE 6F9B           02377       movwf       wynikh
000BC0 50F3           02378       movf        PRODL,w
000BC2 279C           02379       addwf       wynik,f
                      02380       ;jeżeli przekroczyłem bajt to zwiększ o 1
                      02381       
000BC4 B0D8           02382       btfsc       STATUS,C
000BC6 2B9B           02383       incf        wynikh,f
                      02384          
000BC8                02385 procedura_sumowania_wyniku
000BC8 519D           02386          movf     wynik01,w
000BCA 27AC           02387          addwf    pomiar_ulamek,f
                      02388 ;jezeli przekroczono pomiarL
000BCC A0D8           02389          btfss    STATUS,C
000BCE EFED F005      02390          goto     nie_przekroczono_bajtu_ulamka
000BD2 0E01           02391          movlw    1
000BD4 27AB           02392          addwf    pomiarL,f
                      02393 
                      02394          
000BD6 B0D8           02395          btfsc    STATUS,C
000BD8 2BAA           02396          incf     pomiarH,f
                      02397          
000BDA                02398 nie_przekroczono_bajtu_ulamka         
000BDA 519C           02399          movf     wynik,w
000BDC 27AB           02400          addwf    pomiarL,f
000BDE B0D8           02401          btfsc    STATUS,C
000BE0 2BAA           02402          incf     pomiarH,f
                      02403         
000BE2 519B           02404          movf     wynikh,w
000BE4 27AA           02405          addwf    pomiarH,f
000BE6 0012           02406          return
                      02407          
000BE8                02408 znow_kaz_mierzyc
                      02409 
                      02410 ;         bsf      STATUS,RP0
                      02411  ;        bcf      STATUS,RP1
                      02412 ;        movlw    0x1a
                      02413   ;       bsf      PIE1,ADIE
                      02414    ;      bcf      STATUS,RP0
                      02415     ;     bsf      ADCON0,2 
                      02416          ;clrf     TMR0L
                      02417          ;bcf      INTCON,T0IF
                      02418          ;bsf      INTCON,T0IE
Warning[205]: Found directive in column 1. (IF)
                      02419 IF (procek== 18f442)         
                      02420          
                      02421 ENDIF
Warning[205]: Found directive in column 1. (IF)
                      02422 IF (procek== 18f4320)         
                      02423          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 65


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Warning[205]: Found directive in column 1. (ENDIF)
                      02424 ENDIF
000BE8 82C2           02425          bsf      ADCON0,GO
000BEA 99A0           02426          bcf      markers2,wyslij_pomiar
                      02427          
000BEC 0012           02428          return
                      02429           
                      02430 ;na koniec dodaj do pomiarH i pomiarL i pomiar_ulamek
                      02431 
000BEE                02432 wysylanie_pomiaru
                      02433 ;najpierw sprawdzam czy wysylam od razu czy nie
000BEE 99A0           02434          bcf      markers2,wyslij_pomiar
000BF0 A19F           02435          btfss    markers,czy_usrednianie
000BF2 EF00 F006      02436          goto     zapisz_do_pamieci
                      02437          ;goto     juz_wysylac
                      02438 
000BF6 ECD2 F005      02439          call     usrednianie_wartosci
                      02440 
000BFA 2FB0           02441          decfsz   ktora_probka,f
000BFC EFF4 F005      02442          goto     znow_kaz_mierzyc
                      02443          ;return        
000C00                02444 zapisz_do_pamieci
                      02445 ;przed zapisem pomiaru w pamieci ulamki > 0x80 (tzn od 0.5 ) zamieniam na +1 do pomiarL 
                      02446 ;w przeciwnym wypadku pomijam
                      02447          ;movlw    0x81
                      02448          ;subwf    pomiar_ulamek,w
                      02449          ;btfss    STATUS,C
                      02450          ;goto     zapisz_starszy
                      02451          ;bcf      STATUS,C
                      02452          ;movlw    1
                      02453          ;addwf    pomiarL,f
                      02454          ;btfsc    STATUS,C
                      02455          ;incf     pomiarH,f
                      02456 ;                                                              
                      02457          
                      02458          
                      02459          
                      02460          
000C00 B3A1           02461          btfsc    markers3,znacznik_pomiaru_pradu
000C02 EF5F F006      02462          goto     zapis_do_pamieci_prad
                      02463          
000C06                02464 zapis_do_pamieci_temperatury  
                      02465 
                      02466                         ;                                         POPRAWKA temperatury
000C06 6AE2           02467          clrf     FSR1H
000C08 0ECB           02468          movlw    poprawka0
                      02469          
                      02470          
                      02471          ;ktora poprawka
000C0A 6EE1           02472          movwf    FSR1L
000C0C 51B1           02473          movf     ktory_kanal,w
000C0E 26E1           02474          addwf    FSR1L,f
000C10 50E7           02475          movf     INDF1,w
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 66


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02476          
                      02477 
000C12 27AB           02478          addwf    pomiarL,f
                      02479          
                      02480          ;sprawdz czy poprawka jest ujemna
                      02481       ;tzn czy jest zaznaczony bit 7
                      02482       ;jezeli tak to nie sprawdzaj przekroczenia
000C14 BEE7           02483         btfsc     INDF1,7
000C16 EF0F F006      02484         goto      zapisz_do_pamieci_nie_sprawdzaj_przekroczenia
                      02485          ;jezeli przekroczylem to
                      02486          
000C1A B0D8           02487          btfsc    STATUS,C
000C1C 2BAA           02488          incf     pomiarH,f
                      02489          
Warning[208]: Label truncated at 32 characters. (zapisz_do_pamieci_nie_sprawdzaj_przekroczenia)
000C1E                02490 zapisz_do_pamieci_nie_sprawdzaj_przekroczenia
                      02491                         ;koniec poprawiania wyniku o blad kanalu pomiarowego i skalowanie czujnika
                      02492                         
                      02493 ;dopiero teraz zamieniam na wartość -512                        
                      02494               
                      02495           ;                                         teraz odejmuje od starszego bajtu 0x02 
000C1E ECC7 F005      02496          call     odejmij_512_od_wyniku_sredniej
                      02497         
                      02498         
000C22 0EB6           02499          movlw    pomiar0H
000C24 6EE1           02500          movwf    FSR1L
                      02501                   
000C26 51B1           02502          movf     ktory_kanal,w
000C28 26E1           02503          addwf    FSR1L,f
000C2A 26E1           02504          addwf    FSR1L,f
                      02505                   
000C2C 51AA           02506          movf     pomiarH,w         
000C2E 6EE7           02507          movwf    INDF1
                      02508                               ;IF (czy_pomiary_na_ekran==1)  
                      02509                               ;sprawdz czy mam wyswietlac 
                      02510                               ;jezeli wszedlem do menu ekranu to nie wyswietlam temperatur
                      02511                                     
                      02512                                     ; btfss      markers,czy_wyswietlam_temp
                      02513                                     ; goto        bez_wyswietlania_temp1
                      02514 
                      02515                                     
                      02516                               ;         movf     INDF1,w
                      02517                                        ;tu wlaczam procedurę zamiany szesnastkowej wartości na dziesi
                            tną liczbę
                      02518                                        
                      02519                                        
                      02520                                ;        addlw    0x30
                      02521                                 ;       call     write_lcd
                      02522                                  ;      incf     linia2,f
                      02523                               ;ENDIF         
                      02524 
000C30                02525 bez_wyswietlania_temp1
000C30 2AE1           02526          incf     FSR1L,f
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 67


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000C32 51AB           02527          movf     pomiarL,w
                      02528                   
000C34 6EE7           02529          movwf    INDF1
Warning[205]: Found directive in column 1. (IF)
                      02530 IF (czy_pomiary_na_ekran==1)   
                      02531 
000C36 AB9F           02532       btfss      markers,czy_wyswietlam_temp
000C38 EF5D F006      02533       goto        bez_wyswietlania_temp2
                      02534       
                      02535             
                      02536       ;sprawdz czy rejestr linia2 > 13
000C3C 0E0C           02537       movlw       0x0c
                      02538       ; sprawdzam                  rejestr > W
000C3E 6187           02539       cpfslt      linia2      
000C40 6B87           02540       clrf        linia2
                      02541       
                      02542       
000C42                02543 nie_czysc_rejestru_polozenia  
                      02544   ;temperatury 0-3 na ekranie sa wyswietlane jezeli niezaznaczono bitu markers3,pokazuje_temperatury_47
                      02545       ;aby to sprawdzic dokonuje operacji odjecia od 3 - ktory_kanal
                      02546       
000C42 0E04           02547       movlw       0x04
                      02548       ; sprawdzam                  rejestr > W
000C44 61B1           02549       cpfslt        ktory_kanal
000C46 EF2E F006      02550       goto          sprawdz_czy_mam_wyswietlac_47       
                      02551  
                      02552       ;jezeli wynik wskazuje na pomiary na kanale 0 - 3 to sprawdz czy nie wlaczony jest bit 
                      02553       
000C4A BFA1           02554       btfsc       markers3,pokazuje_temperatury_47
000C4C EF5D F006      02555       goto        bez_wyswietlania_temp2
                      02556       
000C50 0E01           02557       movlw 1
                      02558       ;bit      0-1 ida na linie 2  -> 00000011
                      02559       ; ktory_kanal   > 1 to na linii3
000C52 65B1           02560       cpfsgt  ktory_kanal
000C54 EF3F F006      02561       goto         ustaw_linie_druga
                      02562       ;jezeli kanal 2-3
000C58 EF37 F006      02563       goto        ustaw_linie_trzecia
                      02564             
                      02565       
000C5C                02566 sprawdz_czy_mam_wyswietlac_47
                      02567  ;jezeli wyswietlam kanal 4 -7
                      02568  ; i zaznaczono ten bit tzn ze mam wyswietlac na ekranie pomiary czujnikow 4-7
                      02569  
000C5C AFA1           02570       btfss       markers3,pokazuje_temperatury_47
000C5E EF5D F006      02571       goto        bez_wyswietlania_temp2
                      02572       
000C62 0E05           02573       movlw 5
                      02574       ;bit      0-1 ida na linie 2  -> 00000011
                      02575       ; ktory_kanal   > 5 to na linii3
000C64 65B1           02576       cpfsgt  ktory_kanal
000C66 EF3F F006      02577       goto         ustaw_linie_druga
                      02578       ;jezeli kanal ma wartosc 6-7
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 68


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000C6A EF37 F006      02579       goto        ustaw_linie_trzecia
                      02580       
                      02581       
000C6E                02582 ustaw_linie_trzecia
000C6E EC32 F001      02583       call     check_busy
000C72 0E90           02584          movlw    linia_trzecia
000C74 2587           02585          addwf    linia2,w
000C76 ECF4 F000      02586          call      send      
000C7A EF47 F006      02587          goto     napisz_wartosc_temperatury
                      02588       
000C7E                02589 ustaw_linie_druga      
000C7E EC32 F001      02590       call     check_busy
000C82 0EC0           02591          movlw    linia_dolna
000C84 2587           02592          addwf    linia2,w
000C86 ECF4 F000      02593          call      send
000C8A EF47 F006      02594          goto     napisz_wartosc_temperatury
                      02595          
                      02596  
                      02597          ;call     check_busy      
                      02598          ;call     check_busy
                      02599          ;swapf    INDF1,w
                      02600          ;andlw    0x0f
                      02601          ;call     zamien_na_hex
                      02602                          
                      02603          ;call     write_lcd
                      02604          
                      02605          ;call     check_busy
                      02606          ;movf     INDF1,w
                      02607          ;andlw    0x0f
                      02608          ;call     zamien_na_hex
                      02609          ;call     write_lcd
                      02610          ;call     check_busy
                      02611          ;movlw    _puste
                      02612          ;call     write_lcd
                      02613          
                      02614          
                      02615          
000C8E                02616 napisz_wartosc_temperatury         
000C8E 50E7           02617       movf        INDF1,w
000C90 6F92           02618       movwf       tmp_hex
                      02619       
000C92 06E1           02620       decf        FSR1L,f ; - FSR1L pokazuje teraz wartosc starszego bajtu liczby zamienianej
000C94 50E7           02621       movf        INDF1,w
                      02622       
000C96 6F93           02623       movwf       tmp_hex_H
                      02624       
000C98 BDA1           02625       btfsc       markers3,napisz_minus
000C9A 6D92           02626       negf        tmp_hex
                      02627       
000C9C BDA1           02628       btfsc       markers3,napisz_minus
000C9E 6D93           02629       negf        tmp_hex_H
                      02630       
000CA0 5192           02631       movf        tmp_hex,w
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 69


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02632       ;dziele przez 4
000CA2 0D40           02633       mullw       0x40
                      02634       
000CA4 50F3           02635       movf        PRODL,w
000CA6 6F9D           02636       movwf       wynik01
                      02637       
                      02638       ;temperatura jest w bajcie starszym
000CA8 50F4           02639       movf        PRODH,w
000CAA 6F92           02640       movwf       tmp_hex
                      02641       
000CAC ECEC F001      02642          call     hex2dec18
                      02643          
000CB0 EC59 F005      02644          call     wyswietl_cyfry_temperatury
                      02645          
                      02646          ;call     check_busy
                      02647          ;movlw    _linia_pionowa
                      02648          
                      02649          ;call     write_lcd
000CB4 9DA1           02650          bcf      markers3,napisz_minus
000CB6 0E08           02651          movlw    8
                      02652          
000CB8 2787           02653          addwf     linia2,f
                      02654          ;bcf      markers3,pokazuje_temperatury_47
Warning[205]: Found directive in column 1. (ENDIF)
                      02655 ENDIF         
                      02656 
000CBA                02657 bez_wyswietlania_temp2
                      02658 
000CBA EF9F F006      02659       goto  procedura_regulacji_dwustawnej
                      02660       
000CBE                02661 zapis_do_pamieci_prad
000CBE 6AE2           02662       clrf     FSR1H
000CC0 0ED3           02663       movlw    poprawka_prad1
                      02664          
                      02665          ;ktora poprawka
000CC2 6EE1           02666          movwf    FSR1L
000CC4 05D6           02667          decf     ktory_aktualnie_kanal_pradu,w
000CC6 26E1           02668          addwf    FSR1L,f
000CC8 50E7           02669          movf     INDF1,w
000CCA 27AB           02670          addwf    pomiarL,f
                      02671          ;jezeli przekroczylem to
000CCC B0D8           02672          btfsc    STATUS,C
000CCE 2BAA           02673          incf     pomiarH,f
                      02674         ;movwf     
                      02675 
                      02676                   
000CD0 0EC6           02677          movlw    pomiar_prad1H        
000CD2 6EE1           02678          movwf    FSR1L
                      02679                   
000CD4 05D6           02680          decf     ktory_aktualnie_kanal_pradu,w
000CD6 26E1           02681          addwf    FSR1L,f
000CD8 26E1           02682          addwf    FSR1L,f
                      02683                   
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 70


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000CDA 51AA           02684          movf     pomiarH,w         
000CDC 6EE7           02685          movwf    INDF1 
Warning[205]: Found directive in column 1. (IF)
                      02686 IF (czy_pomiary_na_ekran==1)  
                      02687 ;sprawdz czy mam wyswietlac 
                      02688 ;jezeli wszedlem do menu ekranu to nie wyswietlam temperatur
                      02689       
000CDE AB9F           02690       btfss      markers,czy_wyswietlam_temp
000CE0 EF7F F006      02691       goto        bez_wyswietlania_pradu
                      02692 
000CE4 EC32 F001      02693       call     check_busy
000CE8 0ED0           02694          movlw    linia_czwarta
000CEA 2589           02695          addwf    linia4,w
000CEC ECF4 F000      02696          call      send
                      02697          
                      02698          
                      02699  
000CF0 EC32 F001      02700          call     check_busy
000CF4 50E7           02701          movf     INDF1,w
                      02702          ;tu wlaczam procedurę zamiany szesnastkowej wartości na dziesiętną liczbę
                      02703          
                      02704          
000CF6 0F30           02705          addlw    0x30
000CF8 EC05 F001      02706          call     write_lcd
000CFC 2B89           02707          incf     linia4,f
Warning[205]: Found directive in column 1. (ENDIF)
                      02708 ENDIF         
                      02709 
000CFE                02710 bez_wyswietlania_pradu
                      02711 
                      02712          
000CFE 2AE1           02713       incf     FSR1L,f
000D00 51AB           02714       movf     pomiarL,w
                      02715                   
000D02 6EE7           02716       movwf    INDF1    
                      02717       
Warning[205]: Found directive in column 1. (IF)
                      02718 IF (czy_pomiary_na_ekran==1)
                      02719 
000D04 AB9F           02720       btfss      markers,czy_wyswietlam_temp
000D06 EF9D F006      02721       goto        bez_wyswietlania_pradu2
                      02722        
000D0A EC32 F001      02723          call     check_busy
000D0E 38E7           02724          swapf    INDF1,w
000D10 0B0F           02725          andlw    0x0f
000D12 ECFA F002      02726          call     zamien_na_hex
                      02727                          
000D16 EC05 F001      02728          call     write_lcd
                      02729          
000D1A EC32 F001      02730          call     check_busy
000D1E 50E7           02731          movf     INDF1,w
000D20 0B0F           02732          andlw    0x0f
000D22 ECFA F002      02733          call     zamien_na_hex
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 71


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000D26 EC05 F001      02734          call     write_lcd
000D2A EC32 F001      02735          call     check_busy
000D2E 0E20           02736          movlw    _puste
000D30 EC05 F001      02737          call     write_lcd
000D34 2B89           02738          incf     linia4,f
000D36 2B89           02739          incf     linia4,f
000D38 2B89           02740          incf     linia4,f
Warning[205]: Found directive in column 1. (ENDIF)
                      02741 ENDIF       
                      02742 
000D3A                02743 bez_wyswietlania_pradu2
                      02744       
000D3A EFCF F006      02745       goto     sprawdz_czy_mam_dalej_mierzyc_prad
                      02746       
000D3E                02747 procedura_regulacji_dwustawnej         
                      02748       
                      02749 ;jezeli ostatni kanal to wyslij wszystkie, jezeli nie ostatni to zmierz kolejny
000D3E ADA0           02750          btfss    markers2,reguluj
000D40 EFC6 F006      02751          goto     sprawdz_czy_mam_dalej_mierzyc
                      02752 ;jezeli mierze prad to nic nie sprawdzaj
                      02753 
                      02754      
                      02755 ;porownaj wartosc pomierzona z zadana
                      02756                   
                      02757 
                      02758 ;regulacja z 0 kanalu
                      02759          
                      02760          ;movf        ktory_kanal,w
                      02761          ;xorlw         0         
                      02762          ;btfsc          STATUS,Z
000D44 51E8           02763          movf    ktory_czujnik_reguluje,w
000D46 63B1           02764          cpfseq   ktory_kanal
000D48 EFC6 F006      02765          goto           sprawdz_czy_mam_dalej_mierzyc
                      02766          
                      02767          
                      02768          
                      02769          
000D4C 51AD           02770          movf     jaka_wartosc_regulujeH,w
                      02771          ;pomiarh - jaka_wartosc_regulujeH
000D4E 5DAA           02772          subwf    pomiarH,w
                      02773 ;sprawdz czy to samo czy wieksze
000D50 B4D8           02774          btfsc    STATUS,Z
000D52 EFB5 F006      02775          goto     sa_rowne_sprawdz_Lbajt
000D56 A0D8           02776          btfss    STATUS,C 
000D58 EFB1 F006      02777          goto     zalacz_grzanie
                      02778 ;tzn reguluj<pomiaru w starszym bajcie wiec wylacz grzanie
000D5C 8FA0           02779          bsf      markers2,wylacz_moc
000D5E EFC6 F006      02780          goto     sprawdz_czy_mam_dalej_mierzyc
                      02781          
000D62                02782 zalacz_grzanie    
                      02783 ;jezeli jakikolwiek pomiar wykazal ze trzeba wylaczyc to nie wlaczaj grzania
                      02784 ;        
000D62 AFA0           02785          btfss    markers2,wylacz_moc
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 72


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000D64 8BA0           02786          bsf      markers2,zalacz_moc
                      02787          
000D66 EFC6 F006      02788          goto     sprawdz_czy_mam_dalej_mierzyc
                      02789 
                      02790                            
000D6A                02791 sa_rowne_sprawdz_Lbajt
                      02792 ;tak samo
000D6A 51AE           02793          movf     jaka_wartosc_regulujeL,w
                      02794          ;sprawdz czy moc wylaczona - jezeli tak to wlacz 1  stopien nizej czyli 4 nizej
                      02795 ;jezeli jest wlaczona energia to dodaj wartosc histerezy tj wylacza pozniej
                      02796          ;btfsc    latch_moc,lampka2
000D6C B081           02797          btfsc    port_triak,triak1
000D6E 25E6           02798          addwf    histereza,w
                      02799 
000D70 5DAB           02800          subwf    pomiarL,w
                      02801 ;sprawdz czy to samo czy wieksze
000D72 B4D8           02802          btfsc    STATUS,Z
000D74 EFC2 F006      02803          goto     sa_rowne_nic_nie_rob
000D78 A0D8           02804          btfss    STATUS,C 
000D7A EFB1 F006      02805          goto     zalacz_grzanie
                      02806 ;tzn reguluj<pomiaru w mlodszym bajcie wiec wylacz grzanie
000D7E 8FA0           02807          bsf      markers2,wylacz_moc
000D80 EFC6 F006      02808          goto     sprawdz_czy_mam_dalej_mierzyc                         
000D84                02809 sa_rowne_nic_nie_rob
000D84 EFB1 F006      02810          goto     zalacz_grzanie    
000D88 EFC6 F006      02811          goto     sprawdz_czy_mam_dalej_mierzyc       
                      02812 
000D8C                02813 sprawdz_czy_mam_dalej_mierzyc
                      02814 ;sprawdzam tu czy mam wykonac pomiary dla kolejnego 
                      02815 ;kanalu
                      02816 ;tu czyszcze zawartosc rejestrow pomiaru
000D8C 6BAA           02817          clrf     pomiarH
000D8E 6BAB           02818          clrf     pomiarL
000D90 6BAC           02819          clrf     pomiar_ulamek
                      02820          
                      02821          
000D92 2FA6           02822          decfsz   ktory_kanal_mierze,f
000D94 EF62 F007      02823          goto     zmierz_nastepny_czujnik_temperatury
                      02824 
                      02825 ;zmierz jeszcze prady          
                      02826          
000D98 A1A1           02827          btfss    markers3,pomiary_pradu
000D9A EFD9 F006      02828          goto     wykonano_pomiary_wszystkich_kanalow
                      02829         
                      02830         ;jeszcze mierze prady jezeli ustawiono bit pomiary_pradu
                      02831          
Warning[208]: Label truncated at 32 characters. (sprawdz_czy_mam_dalej_mierzyc_prad)
000D9E                02832 sprawdz_czy_mam_dalej_mierzyc_prad
                      02833 
                      02834          ;sprawdz czy rejestr przechowujący aktualne wskazanie mierzonej temperatury nie wskazuje 0
000D9E 51D6           02835          movf     ktory_aktualnie_kanal_pradu,w;zwiększam o jeden żeby skala obydwu rejestrów była i
                            dentyczna
                      02836          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 73


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000DA0 19D5           02837          xorwf    jak_duzo_kanalow_pradu,w
                      02838          ;jezeli 0 tzn ze juz zmierzylem co trzeba
000DA2 B4D8           02839          btfsc    STATUS,Z
000DA4 EFD9 F006      02840          goto     wykonano_pomiary_wszystkich_kanalow
                      02841          
                      02842       ;wlaczam pomiar pradu na 1 kanale
                      02843       
                      02844       ;do kanalu aktualnego trzeba dodać 8*2 by uzyskac kanal pradowy
                      02845       ;bo aby zmierzyc 1 kanal pradu to z AN0 przeskok do AN2
                      02846       ;z kanalu AN2 do AN4
                      02847       
000DA8 0E08           02848       movlw    8
                      02849             
000DAA 26C2           02850       addwf   ADCON0,f
000DAC 2BD6           02851       incf     ktory_aktualnie_kanal_pradu,f
                      02852       ;movlw    b'00111100'
                      02853       ;andwf    ADCON0,w
000DAE EF5D F007      02854       goto  zmierz_prad
                      02855       
                      02856       ;goto     zmierz_nastepny_czujnik_temperatury   
                      02857          
Warning[208]: Label truncated at 32 characters. (wykonano_pomiary_wszystkich_kanalow)
000DB2                02858 wykonano_pomiary_wszystkich_kanalow
                      02859 ;jezeli juz skonczylem wszystkie mierzyc to sprawdz czy mam wlaczyc grzanie
                      02860 ;jezeli ustawiono bit o nie wlaczaniu to olej
000DB2 ADA0           02861          btfss    markers2,reguluj
000DB4 EFE9 F006      02862          goto     juz_wysylac
                      02863          
000DB8 BFA0           02864          btfsc    markers2,wylacz_moc
000DBA EFE6 F006      02865          goto    wylaczam_moc
                      02866          
000DBE ABA0           02867          btfss    markers2,zalacz_moc
000DC0 EFE6 F006      02868          goto    wylaczam_moc
                      02869          
000DC4 A081           02870          btfss    port_triak,triak1
000DC6 8081           02871          bsf      port_triak,triak1
                      02872          
000DC8 EFE7 F006      02873          goto    koncz_z_moca
000DCC                02874 wylaczam_moc
000DCC 9081           02875          bcf      port_triak,triak1
                      02876          
000DCE                02877 koncz_z_moca
000DCE 9BA0           02878          bcf      markers2,zalacz_moc
000DD0 9FA0           02879          bcf      markers2,wylacz_moc
                      02880          
                      02881          
                      02882          
                      02883          
                      02884                                                 ;juz wszystkie kanaly i wysylaj pomiary
000DD2                02885 juz_wysylac
                      02886 ;wysylam po kolei bajty zmierzone
                      02887 ;tu petla tyle razy powtarzana ile kanalow mierze
                      02888 
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 74


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000DD2 A99F           02889       btfss       markers,czy_wysylac_pomiary_serial
000DD4 EF55 F007      02890       goto        jezeli_nie_wysylam_pomiarow
                      02891       
000DD8 9882           02892          bcf      port_CTS,znacznik_CTS
                      02893 
000DDA 6BB1           02894          clrf     ktory_kanal
000DDC 51A5           02895          movf     ile_kanalow,w
                      02896          
000DDE 6FA6           02897          movwf    ktory_kanal_mierze
                      02898          
000DE0 0EB6           02899          movlw    pomiar0H
000DE2 6EE1           02900          movwf    FSR1L
000DE4 6AE2           02901          clrf     FSR1H
000DE6 98AB           02902          bcf      RCSTA,CREN
000DE8 EFF7 F006      02903          goto     wyslij_starszy
000DEC                02904 zwieksz_przy_wysylaniu_FSR
000DEC 2AE1           02905          incf     FSR1L,f
000DEE                02906 wyslij_starszy
                      02907 ;przed wysylaniem pomiaru wylaczam modul odbioru
                      02908          ;sprawdz czy RTS nie jest na 0
000DEE                02909 sprawdz_RTS
                      02910          ;btfss    port_RTS,znacznik_RTS
                      02911          ;goto     sprawdz_RTS
                      02912          
000DEE ECA9 F002      02913          call    sprawdz_czy_mozna_wysylac
                      02914          
000DF2 50E7           02915          movf     INDF1,w
000DF4 0F30           02916          addlw    0x30
000DF6 6EAD           02917          movwf   TXREG
                      02918            
000DF8 ECA9 F002      02919          call    sprawdz_czy_mozna_wysylac
                      02920          
000DFC 2AE1           02921          incf     FSR1L,f
000DFE 38E7           02922          swapf    INDF1,w
000E00 0B0F           02923          andlw    0x0f
000E02 ECFA F002      02924          call     zamien_na_hex
000E06 6EAD           02925          movwf   TXREG
                      02926          
                      02927          
000E08 ECA9 F002      02928          call    sprawdz_czy_mozna_wysylac
                      02929          
000E0C 50E7           02930          movf     INDF1,w
000E0E 0B0F           02931          andlw    0x0f
000E10 ECFA F002      02932          call     zamien_na_hex
000E14 6EAD           02933          movwf   TXREG     
                      02934          
                      02935 
000E16 ECA9 F002      02936          call    sprawdz_czy_mozna_wysylac
                      02937          
000E1A 0E2C           02938          movlw    _przecinek
                      02939         
000E1C 6EAD           02940          movwf   TXREG     
                      02941          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 75


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02942          
                      02943          
                      02944          
                      02945 ;sprawdz czy aktualnie mam regulowac
                      02946          
                      02947           
                      02948          
                      02949 ;wylacz wysylanie pomiaru           
                      02950          
                      02951          ;call    sprawdz_czy_mozna_wysylac
                      02952 ;wlacz odbior
000E1E 2FA6           02953          decfsz   ktory_kanal_mierze,f
000E20 EFF6 F006      02954          goto     zwieksz_przy_wysylaniu_FSR
                      02955  
                      02956 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                            ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;koniec wysylania pomiarow 
                      02957          ;jezeli mierzylem prady to sprawdz to, maxymalnie dwa prady podaje
000E24 A1A1           02958          btfss    markers3,pomiary_pradu
000E26 EF4D F007      02959          goto     juz_wysylac_znak_LF
                      02960          
000E2A                02961 sprawdz_RTS_prad
                      02962          ;btfss    port_RTS,znacznik_RTS
                      02963          ;goto     sprawdz_RTS_prad
                      02964       
                      02965       ;jak duzo mialem mierzyc pradow
000E2A ECA9 F002      02966          call    sprawdz_czy_mozna_wysylac
000E2E 0E69           02967          movlw    _i
                      02968         
000E30 6EAD           02969          movwf   TXREG    
000E32 ECA9 F002      02970          call    sprawdz_czy_mozna_wysylac
                      02971          
                      02972          
                      02973          
000E36 51C6           02974          movf     pomiar_prad1H,w
000E38 0F30           02975          addlw    0x30
000E3A 6EAD           02976          movwf   TXREG        
                      02977          
000E3C ECA9 F002      02978          call    sprawdz_czy_mozna_wysylac
                      02979          
000E40 39C7           02980          swapf     pomiar_prad1L,w
000E42 0B0F           02981          andlw    0x0f
000E44 ECFA F002      02982          call     zamien_na_hex
000E48 6EAD           02983          movwf   TXREG
                      02984                   
000E4A ECA9 F002      02985          call    sprawdz_czy_mozna_wysylac
                      02986          
000E4E 51C7           02987          movf    pomiar_prad1L,w
000E50 0B0F           02988          andlw    0x0f
000E52 ECFA F002      02989          call     zamien_na_hex
000E56 6EAD           02990          movwf   TXREG   
                      02991          
000E58 ECA9 F002      02992          call    sprawdz_czy_mozna_wysylac
                      02993          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 76


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02994          ;czy mialem mierzyc dwa prady czy tylko 1
                      02995          ;movf     jak_duzo_kanalow_pradu,w
                      02996          ;xorlw    2
                      02997          ;btfss    STATUS,Z   
                      02998          ;goto     juz_wysylac_znak_LF 
                      02999 
                      03000          
                      03001          
000E5C 0E2C           03002          movlw    _przecinek
                      03003         
000E5E 6EAD           03004          movwf   TXREG    
000E60 ECA9 F002      03005          call    sprawdz_czy_mozna_wysylac
                      03006          
000E64 0E69           03007          movlw    _i
                      03008         
000E66 6EAD           03009          movwf   TXREG    
000E68 ECA9 F002      03010          call    sprawdz_czy_mozna_wysylac
                      03011          
000E6C 51C8           03012          movf     pomiar_prad2H,w
000E6E 0F30           03013          addlw    0x30
000E70 6EAD           03014          movwf   TXREG        
                      03015          
000E72 ECA9 F002      03016          call    sprawdz_czy_mozna_wysylac
                      03017          
000E76 39C9           03018          swapf     pomiar_prad2L,w
000E78 0B0F           03019          andlw    0x0f
000E7A ECFA F002      03020          call     zamien_na_hex
000E7E 6EAD           03021          movwf   TXREG
                      03022                   
000E80 ECA9 F002      03023          call    sprawdz_czy_mozna_wysylac
                      03024          
000E84 51C9           03025          movf    pomiar_prad2L,w
000E86 0B0F           03026          andlw    0x0f
000E88 ECFA F002      03027          call     zamien_na_hex
000E8C 6EAD           03028          movwf   TXREG     
000E8E ECA9 F002      03029          call    sprawdz_czy_mozna_wysylac
                      03030          
000E92 0E2C           03031           movlw    _przecinek
                      03032         
000E94 6EAD           03033          movwf   TXREG    
000E96 ECA9 F002      03034          call    sprawdz_czy_mozna_wysylac
                      03035          
                      03036 ;jezeli moc zalaczona wyslij 1,
                      03037 ;jezeli wylaczona wyslik 0,
                      03038          
                      03039          ;call    sprawdz_czy_mozna_wysylac
                      03040          
                      03041          ;btfsc    portlampka2,lampka2
                      03042          ;movlw    0x31
                      03043          
                      03044          ;btfss    portlampka2,lampka2
                      03045          ;movlw    0x30
                      03046          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 77


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000E9A                03047 juz_wysylac_znak_LF         
                      03048          ;movwf   TXREG
                      03049          ;wysylam znak konca linii
000E9A ECA9 F002      03050          call    sprawdz_czy_mozna_wysylac
000E9E 0E0A           03051          movlw    znak_lf
000EA0 6EAD           03052          movwf   TXREG
                      03053          
000EA2 88AB           03054          bsf      RCSTA,CREN 
000EA4 0000           03055          nop
000EA6 0000           03056          nop
                      03057          
000EA8 8882           03058          bsf      port_CTS,znacznik_CTS
                      03059          
                      03060          
000EAA                03061 jezeli_nie_wysylam_pomiarow
                      03062 
000EAA 6BAA           03063          clrf     pomiarH
000EAC 6BAB           03064          clrf     pomiarL
000EAE 6BAC           03065          clrf     pomiar_ulamek
                      03066 
000EB0 859F           03067          bsf      markers,pomiary_zrobione
000EB2 99A0           03068          bcf      markers2,wyslij_pomiar
000EB4 93A1           03069          bcf   markers3,znacznik_pomiaru_pradu
000EB6 6B89           03070          clrf     linia4
000EB8 0012           03071          return         
                      03072  
                      03073 
000EBA                03074 zmierz_prad
000EBA 51AF           03075       movf     jak_duzo_probek,w
000EBC 6FB0           03076       movwf    ktora_probka
000EBE 83A1           03077       bsf   markers3,znacznik_pomiaru_pradu
000EC0 EF74 F007      03078       goto     zmierz_nastepny_nie_3
                      03079       
Warning[208]: Label truncated at 32 characters. (zmierz_nastepny_czujnik_temperatury)
000EC4                03080 zmierz_nastepny_czujnik_temperatury
                      03081 ;tzn kanal analogowy ten sam, ale zmienia sie ustawienie multipleksera
000EC4 2BB1           03082       incf     ktory_kanal,f
000EC6 51AF           03083       movf     jak_duzo_probek,w
000EC8 6FB0           03084       movwf    ktora_probka
                      03085       ;movf     port_multiplekser,w
                      03086 ;czyszcze aktualne ustawienia 
                      03087 ;jezeli byl tu b'01010001'     
                      03088       ;andlw    b'11111000'
                      03089 ;w wyniku mamy b'01010000'      
                      03090       ;addwf    ktory_kanal,w
000ECA 2A8B           03091       incf  latch_multiplekser,f
                      03092       ;movwf    latch_multiplekser   
000ECC EF74 F007      03093       goto     zmierz_nastepny_nie_3
                      03094       
000ED0                03095 zmierz_nastepny_kanal
                      03096 ;zwiekaszam na kolejne wejscie  multipleksera
                      03097             
000ED0 2BB1           03098          incf     ktory_kanal,f
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 78


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000ED2 51AF           03099          movf     jak_duzo_probek,w
000ED4 6FB0           03100          movwf    ktora_probka
000ED6 50C2           03101          movf     ADCON0,w
                      03102 ;musze zwiekszyc o jeden ten wycinek bitowy
                      03103 ;b'xx000xxx' - czyli nawet nie starszy 4 bit
                      03104 ;tylko cos w srodku
                      03105 ;aby to zrobic stosuje prosty wybieg + 8 do ADCON0
                      03106 
                      03107 ;dla 18f4x20 mamy troszke zmian
                      03108 ;ADCON0  wyglada ;b'xx0000xx'
Warning[205]: Found directive in column 1. (IF)
                      03109 IF (procek == 18f442)
                      03110          addlw    8
                      03111          movwf    ADCON0
                      03112          movlw    b'00111000'
                      03113          andwf    ADCON0,w
                      03114          xorlw    b'00011000'
                      03115          bnz      zmierz_nastepny_nie_3
                      03116 ;drugi raz zwiekszam ADCON0 dla pominiecia 3 kanalu         
                      03117          movlw    8
                      03118          addwf    ADCON0,f
                      03119 ENDIF
                      03120 
Warning[205]: Found directive in column 1. (IF)
                      03121 IF (procek == 18f4320)
000ED8 0F04           03122          addlw    4
000EDA 6EC2           03123          movwf    ADCON0
000EDC 0E3C           03124          movlw    b'00111100'
000EDE 14C2           03125          andwf    ADCON0,w
000EE0 0A0C           03126          xorlw    b'00001100'
000EE2 E102           03127          bnz      zmierz_nastepny_nie_3
                      03128 ;drugi raz zwiekszam ADCON0 dla pominiecia 3 kanalu         
000EE4 0E04           03129          movlw    4
000EE6 26C2           03130          addwf    ADCON0,f
Warning[205]: Found directive in column 1. (ENDIF)
                      03131 ENDIF
                      03132          
000EE8                03133 zmierz_nastepny_nie_3
                      03134 ;wlaczam pomiar i przerwanie
                      03135          
000EE8 8C9D           03136          bsf      PIE1,ADIE
                      03137          
                      03138 ;rozpocznij pomiar      
                      03139 ;wedlug opisu procka tu trzeba czekac okolo 20-30us  
                      03140 ;dla pewnosci bede czekal 120us wykozystujac TMR2
                      03141 ;czyszcze obecny TMR2
000EEA 6BAA           03142          clrf     pomiarH
000EEC 6BAB           03143          clrf     pomiarL
000EEE 6BAC           03144          clrf     pomiar_ulamek
000EF0 6AD6           03145          clrf     TMR0L
Warning[205]: Found directive in column 1. (IF)
                      03146 IF (procek == 18f442)
                      03147          bcf      INTCON,T0IF
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 79


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03148          bsf      INTCON,T0IE
                      03149 ENDIF
Warning[205]: Found directive in column 1. (IF)
                      03150 IF (procek == 18f4320)
000EF2 94F2           03151          bcf      INTCON,TMR0IF
000EF4 8AF2           03152          bsf      INTCON,TMR0IE
Warning[205]: Found directive in column 1. (ENDIF)
                      03153 ENDIF
                      03154          
                      03155          ;clrf     TMR2
                      03156          ;bsf    T2CON,TMR2ON
                      03157         
                      03158 ;tzn wlaczam przerwanie TMR2
                      03159          ;bsf      STATUS,RP0
                      03160          ;bsf     PIE1,TMR2IE
                      03161          ;bcf      STATUS,RP0
                      03162 ;przetestowanie czy dobry czas  
                      03163 ;          bsf     PORTC,2         
000EF6 99A0           03164          bcf      markers2,wyslij_pomiar
000EF8 0012           03165          return   
                      03166     
                      03167     
                      03168     
                      03169     
                      03170     
                      03171     
                      03172     
                      03173     
                      03174 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;procedury 
                            klawiszy
000EFA                03175 wlacz_przerwanie_tmr3
                      03176 
000EFA 92A0           03177       bcf   PIE2,TMR3IE
000EFC 6AB3           03178       clrf  TMR3H
000EFE 6AB2           03179       clrf  TMR3L
000F00 92A1           03180       bcf   PIR2,TMR3IF
                      03181       
000F02 82A0           03182       bsf   PIE2,TMR3IE
                      03183 
000F04 0012           03184       return
                      03185       
000F06                03186 wcisnieto_back
000F06 B9A1           03187       btfsc   markers3,wcisnieto_klawisz
000F08 0012           03188       return
                      03189       
000F0A 89A1           03190       bsf   markers3,wcisnieto_klawisz
000F0C 6B99           03191       clrf  stan_key
000F0E 8199           03192       bsf   stan_key,mamy_back
                      03193       
000F10 EF7D F007      03194       goto  wlacz_przerwanie_tmr3
                      03195       
                      03196       
                      03197 
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 80


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03198       
                      03199       
000F14                03200 wcisnieto_down
                      03201 ;jeżeli zaznaczono że upłynął czas oczekiwania to wybierz procedurę zmiany      
000F14 B59E           03202       btfsc   znaczniki,czy_moge_juz_zmieniac
000F16 EFCF F007      03203       goto  wykryto_down
                      03204       
                      03205       ;goto    wykryto_down_zmiana_opcji
                      03206       
000F1A B9A1           03207       btfsc   markers3,wcisnieto_klawisz
000F1C 0012           03208       return
                      03209       
000F1E 89A1           03210       bsf   markers3,wcisnieto_klawisz
000F20 6B99           03211       clrf  stan_key
000F22 8399           03212       bsf   stan_key,mamy_down
                      03213       
                      03214       ;btfsc       pozycja_menu,zmiana_opcji
                      03215       ;goto        sprawdz_czy_wlaczyc_szybka_zmiane
                      03216       
000F24 EFB0 F007      03217       goto        ustaw_sprawdzanie_szybkiej_zmiany
                      03218       
000F28 EF7D F007      03219       goto  wlacz_przerwanie_tmr3
                      03220 
                      03221       
000F2C                03222 wcisnieto_up
000F2C B59E           03223       btfsc   znaczniki,czy_moge_juz_zmieniac
000F2E EF36 F009      03224       goto        wykryto_up
                      03225       ;goto    wykryto_up_zmiana_opcji
                      03226       
000F32 B9A1           03227       btfsc   markers3,wcisnieto_klawisz
000F34 0012           03228       return
                      03229       
000F36 89A1           03230       bsf   markers3,wcisnieto_klawisz
000F38 6B99           03231       clrf  stan_key
000F3A 8599           03232       bsf   stan_key,mamy_up
                      03233       
                      03234 ;jeżeli klawisz up wcisnieto w momencie gdy uzytkownik wybral juz zmiane wartosci
                      03235       ;btfsc       pozycja_menu,zmiana_opcji
                      03236       ;goto        sprawdz_czy_wlaczyc_szybka_zmiane
                      03237       
000F3C EFB0 F007      03238       goto        ustaw_sprawdzanie_szybkiej_zmiany
                      03239       
000F40 EF7D F007      03240       goto        wlacz_przerwanie_tmr3
                      03241       
Warning[208]: Label truncated at 32 characters. (sprawdz_czy_wlaczyc_szybka_zmiane)
000F44                03242 sprawdz_czy_wlaczyc_szybka_zmiane
                      03243 ;jest w menu na pozycji     
                      03244 ;opcja_odstep
                      03245 ;opcja_ustaw_temp
                      03246 
000F44 0E02           03247       movlw       opcja_odstep
000F46 63E1           03248       cpfseq      numer_opcji
000F48 EFA2 F007      03249       goto        sprawdz_czy_wlaczyc_szybka_zmiane2
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 81


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03250 
000F4C EFB0 F007      03251       goto        ustaw_sprawdzanie_szybkiej_zmiany
                      03252       
Warning[208]: Label truncated at 32 characters. (sprawdz_czy_wlaczyc_szybka_zmiane2)
Error[116]  : Address label duplicated or different in second pass (sprawdz_czy_wlaczyc_szybka_zmian)
000F50                03253 sprawdz_czy_wlaczyc_szybka_zmiane2      
000F50 0E05           03254       movlw       opcja_ustaw_temp
000F52 63E1           03255       cpfseq      numer_opcji
000F54 EFA2 F007      03256       goto        sprawdz_czy_wlaczyc_szybka_zmiane3
                      03257 
000F58 EFB0 F007      03258       goto        ustaw_sprawdzanie_szybkiej_zmiany
                      03259       
Warning[208]: Label truncated at 32 characters. (sprawdz_czy_wlaczyc_szybka_zmiane3)
Error[116]  : Address label duplicated or different in second pass (sprawdz_czy_wlaczyc_szybka_zmian)
000F5C                03260 sprawdz_czy_wlaczyc_szybka_zmiane3
                      03261       
000F5C EF7D F007      03262       goto  wlacz_przerwanie_tmr3
                      03263  
Warning[208]: Label truncated at 32 characters. (ustaw_sprawdzanie_szybkiej_zmiany)
000F60                03264 ustaw_sprawdzanie_szybkiej_zmiany
                      03265 ;jak długo trzymam przycisk zanim zaczne zmieniac wartości
000F60 0E04           03266       movlw       dlugosc_oczekiwania_na_zmiane
000F62 6FE3           03267       movwf       szybka_zmiana_wartosci
                      03268 ;zaznaczam że procedury sprawdzają zmianę opcji w czasie trzymania przycisku      
000F64 8F9F           03269       bsf         markers,trzymanie_klawisza
000F66 EF7D F007      03270       goto  wlacz_przerwanie_tmr3
                      03271  
000F6A                03272 wcisnieto_enter
000F6A B9A1           03273       btfsc   markers3,wcisnieto_klawisz
000F6C 0012           03274       return
                      03275       
000F6E 89A1           03276       bsf   markers3,wcisnieto_klawisz
000F70 6B99           03277       clrf  stan_key
000F72 8799           03278       bsf   stan_key,mamy_enter
                      03279       
000F74 EF7D F007      03280       goto  wlacz_przerwanie_tmr3
                      03281 
                      03282 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; ;                       ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                            ;;;;;;;;                                BACK
000F78                03283 wykryto_back
                      03284       ;co sie dzieje jezeli wykryje ze wcisnieto i puszczono klawisz cofnij
                      03285       
                      03286       ;jezeli jestem w menu to wyswietl ponownie czas i temperatury
                      03287       ;movf        pozycja_menu,w
                      03288       ;bz         wykryto_back_nic_nie_rob
                      03289       
                      03290 ;jezeli pozycja menu jest różna od 0 to po nacisnieciu klawisza back
                      03291 ;następuje powrót do ekranu z pomiarami temperatury oraz z zegarem systemowym
                      03292 ;oraz z prądami
                      03293       ;czyszczę wszystkie linie ekranu - polecenie clear display
000F78 EC32 F001      03294       call        check_busy
000F7C 0E01           03295       movlw       display_clear
000F7E ECF4 F000      03296       call        send
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 82


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000F82 EC32 F001      03297       call        check_busy
                      03298       
                      03299       ;następnie włączam wyświetlanie czasu i temperatur
                      03300 ;jeżeli znaczniki są ustawione to przy wyjściu
                      03301       
000F86 B19E           03302       btfsc       znaczniki,czy_ponownie_wlaczyc_temp
000F88 8B9F           03303       bsf         markers,czy_wyswietlam_temp
                      03304       
000F8A B39E           03305       btfsc       znaczniki,czy_ponownie_wlaczyc_zegar
000F8C 85A1           03306       bsf         markers3,czy_zegar_wyswietlac
                      03307       
000F8E 6BE0           03308       clrf       pozycja_menu
000F90 6BE1           03309       clrf        numer_opcji
                      03310       
000F92 EFCB F007      03311       goto  wykryto_back_exit
                      03312       
                      03313 
                      03314      
                      03315       ;jezeli w ekranie zegara to nic nie rob
                      03316       
                      03317       ;dla testow wyswietl na dole ekranu litere b
                      03318       
                      03319       
                      03320 ; wykryto_back_pisz
                      03321       ; call     write_lcd
000F96                03322 wykryto_back_nic_nie_rob
000F96                03323 wykryto_back_exit
000F96 9BA1           03324       bcf   markers3,dzialanie_po_klawiszu
000F98 6B99           03325       clrf  stan_key
000F9A EF70 F00D      03326       goto  LOOP11
                      03327       
                      03328  
                      03329 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; ;                       ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                            ;;;;;;;;                                DOWN
000F9E                03330 wykryto_down
                      03331       
                      03332       ;co sie dzieje jezeli wykryje ze wcisnieto i puszczono klawisz cofnij
                      03333       
000F9E BFE0           03334       btfsc       pozycja_menu,zmiana_opcji
000FA0 EF46 F008      03335       goto        wykryto_down_zmiana_opcji
                      03336       
                      03337       ;jezeli jestem w menu to przeskocz na kolejną opcję gwiazdką
                      03338       
                      03339       
                      03340       ;jezeli w ekranie zegara to pokaż kolejny zestaw czujników
000FA4 51E0           03341       movf        pozycja_menu,w
000FA6 E10A           03342       bnz         wykryto_down_sprawdz_czy_wyswietlam_kolejne_opcje
                      03343 ;jezeli pozycja menu ==0 to po nacisnieciu klawisza zmien wskazania temperatury
                      03344       ;najpierw czyść ekran
000FA8 EC32 F001      03345       call        check_busy
000FAC 0E01           03346       movlw       display_clear
000FAE ECF4 F000      03347       call        send
000FB2 EC32 F001      03348       call        check_busy
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 83


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000FB6 7FA1           03349       btg         markers3,pokazuje_temperatury_47
                      03350       ;dla testow wyswietl na dole ekranu litere b
                      03351       
000FB8 EF2D F009      03352        goto        wykryto_down_exit
                      03353       
Warning[208]: Label truncated at 32 characters. (wykryto_down_sprawdz_czy_wyswietlam_kolejne_opcje)
000FBC                03354 wykryto_down_sprawdz_czy_wyswietlam_kolejne_opcje
                      03355       
                      03356       ; polozenie gwiazdki przechowuje liczbe wskazującą aktualny adres polozenia
                      03357       ;gwiazdki w 
                      03358       ;tablicy_gwiazdki
                      03359       ;
                      03360       
000FBC 0E1A           03361       movlw       HIGH tablica_gwiazdki
000FBE 6EF7           03362       movwf       TBLPTRH
                      03363       
000FC0 0EA4           03364       movlw       LOW tablica_gwiazdki
000FC2 6EF6           03365       movwf       TBLPTRL
                      03366       
                      03367       ;poniewaz najpierw zmniejszam polozenie
000FC4 2BE2           03368       incf        polozenie_gwiazdki,f
000FC6 51E2           03369       movf       polozenie_gwiazdki,w
                      03370       
000FC8 26F6           03371       addwf       TBLPTRL,f
                      03372       
                      03373        ;a nastepnie czytam z adresu tablica_gwiazdki + polozenie_gwiazdki to uzywam polecenia
000FCA 0008           03374       TBLRD *
                      03375       
000FCC 0E01           03376       movlw       1
000FCE 62F5           03377       cpfseq      TABLAT
                      03378 ;jezeli odczytano 1 tzn ze gwiazdka jest polozona na 
                      03379 ; dole ekranu
                      03380 ; i nalezy zmienic pozycje_menu oraz wyswietlic opcje menu z kolejnego ekranu
                      03381 
000FD0 EF2C F008      03382       goto         wykryto_down_zmiana_polozenia_gwiazdki
                      03383       ;polozenie_gwiazdki == 1
                      03384       ;tzn opcje kolejnego ekranu sa wyswietlane
000FD4 0E01           03385       movlw       1
000FD6 6FE2           03386       movwf       polozenie_gwiazdki;znow na pierwszej linii
                      03387       
                      03388       ;numer opcji ulega zmianie na kolejny
000FD8 2BE1           03389       incf        numer_opcji,f
                      03390       ;czyszczenie ekranu
000FDA EC32 F001      03391       call        check_busy
000FDE 0E01           03392       movlw       display_clear
000FE0 ECF4 F000      03393       call        send
000FE4 EC32 F001      03394       call        check_busy
                      03395       
                      03396       ;zaznaczam ze wyświetlam kolejny ekran opcji
                      03397       
                      03398       
                      03399       ;clrf        numer_opcji
                      03400       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 84


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03401       
                      03402       ;call        check_busy
000FE8 0E80           03403       movlw       linia_gorna
                      03404       
000FEA ECF4 F000      03405       call        send
000FEE EC32 F001      03406       call        check_busy
                      03407       
000FF2 0E2A           03408       movlw       _star
000FF4 EC05 F001      03409       call        write_lcd
000FF8 EC32 F001      03410       call        check_busy      
                      03411       
000FFC 90D8           03412       bcf         STATUS,C
000FFE 37E0           03413       rlcf       pozycja_menu,f
                      03414       
                      03415       ;btfsc       pozycja_menu,menu_opcje1
                      03416       ;goto        wykryto_down_wyswietl_opcje_tablicy_jeden
                      03417       
001000 B3E0           03418       btfsc       pozycja_menu,menu_opcje2
001002 EF14 F008      03419       goto        wykryto_down_wyswietl_opcje_tablicy_druga
                      03420       
001006 B5E0           03421       btfsc       pozycja_menu,menu_opcje3
001008 EF14 F008      03422       goto        wykryto_down_wyswietl_opcje_tablicy_trzy
                      03423       
00100C B7E0           03424       btfsc       pozycja_menu,menu_opcje4
00100E EF14 F008      03425       goto        wykryto_down_wyswietl_opcje_tablicy_cztery
                      03426       
                      03427       ;btfsc       pozycja_menu,menu_opcje_end ;(tj zaznaczono bit ekranu którego nie ma w tym wypadku 
                            są   ekrany bit 0 i 1,  2  a bit 3 oznacza ekran którego nie ma     )
                      03428       ;goto        wykryto_down_wyswietl_opcje_tablicy_end
                      03429       ;pisanie 
                      03430       
                      03431       
                      03432       ;gdy wyświetlam opcje ekranu 1 - tzn gwiazdka byla na koncu opcji linii czwartej ekranu 2
001012 0E01           03433       movlw       1
001014 6FE1           03434       movwf       numer_opcji
001016 6FE0           03435       movwf       pozycja_menu
                      03436       
001018 0E1A           03437       movlw       HIGH tablica_pierwsza
00101A 6EF7           03438       movwf       TBLPTRH
                      03439       
00101C 0E00           03440       movlw       LOW tablica_pierwsza
00101E 6EF6           03441       movwf       TBLPTRL
                      03442       
001020 ECC0 F00A      03443       call        wyswietl_opcje_menu
                      03444       
001024 EF2D F009      03445       goto        wykryto_down_exit
                      03446       
                      03447       
                      03448       
Warning[208]: Label truncated at 32 characters. (wykryto_down_wyswietl_opcje_tablicy_druga)
001028                03449 wykryto_down_wyswietl_opcje_tablicy_druga
                      03450       ;gdy wyświetlam opcje ekranu 2
001028 0E1A           03451       movlw       HIGH tablica_druga
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 85


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00102A 6EF7           03452       movwf       TBLPTRH
                      03453       
00102C 0E22           03454       movlw       LOW tablica_druga
00102E 6EF6           03455       movwf       TBLPTRL
                      03456       
                      03457       
001030 ECC0 F00A      03458       call        wyswietl_opcje_menu
                      03459       
001034 EF2D F009      03460       goto        wykryto_down_exit
                      03461       
                      03462 
                      03463 
Warning[208]: Label truncated at 32 characters. (wykryto_down_wyswietl_opcje_tablicy_trzy)
Error[116]  : Address label duplicated or different in second pass (wykryto_down_wyswietl_opcje_tabl)
001038                03464 wykryto_down_wyswietl_opcje_tablicy_trzy
                      03465       ;gdy wyświetlam opcje ekranu 3
001038 0E1A           03466       movlw       HIGH tablica_trzecia
00103A 6EF7           03467       movwf       TBLPTRH
                      03468       
00103C 0E42           03469       movlw       LOW tablica_trzecia
00103E 6EF6           03470       movwf       TBLPTRL
                      03471       
                      03472       
001040 ECC0 F00A      03473       call        wyswietl_opcje_menu
                      03474       
001044 EF2D F009      03475       goto        wykryto_down_exit
                      03476       
                      03477       
                      03478 ;wykryto_down_wyswietl_opcje_tablicy_end      
Warning[208]: Label truncated at 32 characters. (wykryto_down_wyswietl_opcje_tablicy_cztery)
Error[116]  : Address label duplicated or different in second pass (wykryto_down_wyswietl_opcje_tabl)
001048                03479 wykryto_down_wyswietl_opcje_tablicy_cztery      
001048 0E1A           03480       movlw       HIGH tablica_czwarta
00104A 6EF7           03481       movwf       TBLPTRH
                      03482       
00104C 0E6C           03483       movlw       LOW tablica_czwarta
00104E 6EF6           03484       movwf       TBLPTRL
                      03485       
001050 ECC0 F00A      03486       call        wyswietl_opcje_menu
                      03487       
001054 EF2D F009      03488       goto        wykryto_down_exit
                      03489       
Warning[208]: Label truncated at 32 characters. (wykryto_down_zmiana_polozenia_gwiazdki)
001058                03490 wykryto_down_zmiana_polozenia_gwiazdki
                      03491       ;opcje zmnieniaja się o tą położoną wyżej
001058 2BE1           03492       incf        numer_opcji,f
                      03493       
                      03494       ;nowa gwiazdka jest rysowana w miejscu odczytanym z tablicy
00105A EC32 F001      03495       call     check_busy
00105E 50F5           03496       movf        TABLAT,w
001060 ECF4 F000      03497       call        send
                      03498       
001064 EC32 F001      03499       call     check_busy
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 86


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03500       
001068 0E2A           03501       movlw       _star
00106A EC05 F001      03502       call        write_lcd
00106E EC32 F001      03503       call     check_busy
                      03504       ;gwiazdka poprzednia jest kasowana - tzn znow czytam z tablicy ale tym razem polozenie poprzednie
                      03505       
                      03506       
001072 06F6           03507       decf        TBLPTRL,f
001074 0008           03508       TBLRD *
001076 50F5           03509       movf        TABLAT,w
001078 ECF4 F000      03510       call        send
00107C EC32 F001      03511       call     check_busy
001080 0E20           03512       movlw       _puste
001082 EC05 F001      03513       call        write_lcd
                      03514       
001086 2AF6           03515       incf        TBLPTRL,f
                      03516       
001088 EF2D F009      03517       goto        wykryto_down_exit
                      03518 
                      03519       
00108C                03520 wykryto_down_zmiana_opcji
00108C 0E01           03521       movlw       opcja_czujniki
00108E 63E1           03522       cpfseq      numer_opcji
001090 EF5F F008      03523       goto          wykryto_down_sprawdz_2
                      03524       
                      03525       ;jeżeli zmieniam ilość obsługiwanych czujników temp
                      03526       ;to tu powinno być zmiana o 1 ilości kanałów 
                      03527       ;i sprawdzenie czy nie przekroczyłem dopuszczalnych 8
                      03528       
001094 07A5           03529       decf        ile_kanalow,f
                      03530       
001096 0EFF           03531       movlw      0xff
                      03532       
001098 63A5           03533       cpfseq      ile_kanalow
00109A EF51 F008      03534       goto         wykryto_down_zmiana_opcji_wyswietl_kanaly
                      03535       
00109E 0E08           03536       movlw       8
0010A0 6FA5           03537       movwf       ile_kanalow
                      03538       
Warning[208]: Label truncated at 32 characters. (wykryto_down_zmiana_opcji_wyswietl_kanaly)
0010A2                03539 wykryto_down_zmiana_opcji_wyswietl_kanaly
0010A2 EC32 F001      03540       call     check_busy
0010A6 0E80           03541       movlw    linia_gorna
0010A8 0F0C           03542       addlw       0xc
0010AA ECF4 F000      03543       call      send
                      03544       ;
0010AE EC32 F001      03545       call     check_busy
0010B2 51A5           03546       movf        ile_kanalow,w
0010B4 0F30           03547       addlw       0x30
0010B6 EC05 F001      03548       call        write_lcd
                      03549       
0010BA EF2D F009      03550       goto        wykryto_down_exit
                      03551       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 87


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0010BE                03552 wykryto_down_sprawdz_2
0010BE 0E02           03553       movlw       opcja_odstep
0010C0 63E1           03554       cpfseq      numer_opcji
0010C2 EF6F F008      03555       goto        wykryto_down_sprawdz_3
                      03556 
0010C6 07A7           03557       decf        odstep_pomiarowy,f
0010C8 51A7           03558       movf        odstep_pomiarowy,w
0010CA 6F92           03559       movwf       tmp_hex
0010CC 6B93           03560       clrf        tmp_hex_H
0010CE 6B98           03561       clrf        dec1
0010D0 6B97           03562       clrf        dec10
0010D2 ECEC F001      03563       call        hex2dec18
                      03564 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      03565       ;wyświetlam obok nazwy opcji czyli 
0010D6 EC40 F00C      03566       call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      03567   
0010DA EF2D F009      03568       goto        wykryto_down_exit
                      03569       
0010DE                03570 wykryto_down_sprawdz_3  
0010DE 0E03           03571       movlw       opcja_srednia
0010E0 63E1           03572       cpfseq      numer_opcji
0010E2 EF90 F008      03573       goto        wykryto_down_sprawdz_4
                      03574       
                      03575       ;bsf      markers,czy_usrednianie
                      03576       
                      03577       ;sprawdz czy liczba próbek == 1
0010E6 0E01           03578       movlw       0x1
0010E8 63AF           03579       cpfseq      jak_duzo_probek
0010EA EF7B F008      03580       goto        wykryto_down_sprawdz_3_zmniejsz_probki
                      03581       ;zmieniam liczbe próbek na 0x80
0010EE 0E80           03582       movlw       0x80
0010F0 6FAF           03583       movwf       jak_duzo_probek
0010F2 EF81 F008      03584       goto        wykryto_down_3_wyswietl
                      03585       
Warning[208]: Label truncated at 32 characters. (wykryto_down_sprawdz_3_zmniejsz_probki)
0010F6                03586 wykryto_down_sprawdz_3_zmniejsz_probki
                      03587 ;dziele przez 2
0010F6 0E80           03588       movlw       0x80 
0010F8 03AF           03589       mulwf       jak_duzo_probek
0010FA 50F4           03590       movf        PRODH,w
0010FC 6FAF           03591       movwf       jak_duzo_probek
                      03592       
0010FE EC8E F003      03593       call     ustaw_wartosc_dzielenia_usredniania
                      03594       
001102                03595 wykryto_down_3_wyswietl
                      03596 ;sprawdz czy liczba próbek ==1
001102 919F           03597       bcf      markers,czy_usrednianie
                      03598       
001104 0E01           03599       movlw       1
001106 63AF           03600       cpfseq      jak_duzo_probek
001108 819F           03601       bsf      markers,czy_usrednianie      
                      03602       
00110A 51AF           03603       movf        jak_duzo_probek,w
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 88


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00110C 6F92           03604       movwf       tmp_hex
00110E 6B93           03605       clrf        tmp_hex_H
001110 6B98           03606       clrf        dec1
001112 6B97           03607       clrf        dec10
001114 ECEC F001      03608       call        hex2dec18
                      03609 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      03610       ;wyświetlam obok nazwy opcji czyli 
001118 EC40 F00C      03611       call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      03612 
00111C EF2D F009      03613       goto        wykryto_down_exit
                      03614 
                      03615 
001120                03616 wykryto_down_sprawdz_4
                      03617       
                      03618       
001120                03619 wykryto_down_sprawdz_5
001120 0E05           03620       movlw       opcja_ustaw_temp
001122 63E1           03621       cpfseq      numer_opcji
001124 EFA4 F008      03622       goto        wykryto_down_sprawdz_6
                      03623       
                      03624       ;wlacz pomiar pradu
                      03625       ;jako test wlacz podswietlenie lub je wylacz
                      03626       
                      03627       ;btg   portlampka2,lampka2
                      03628       
001128 07AE           03629       decf        jaka_wartosc_regulujeL,f
                      03630       
00112A B0D8           03631       btfsc       STATUS,C
00112C EFA0 F008      03632       goto        wykryto_down_sprawdz_5_zero
                      03633       ;jeżeli w H jest 0 to  umieść tam 1
001130 51AD           03634       movf       jaka_wartosc_regulujeH,w
001132 E004           03635       bz          wykryto_down_sprawdz_5_zawracanie
                      03636       
001134 07AD           03637       decf        jaka_wartosc_regulujeH,f
                      03638       
001136 A4D8           03639       btfss       STATUS,Z
001138 EFA0 F008      03640       goto        wykryto_down_sprawdz_5_zero
Warning[208]: Label truncated at 32 characters. (wykryto_down_sprawdz_5_zawracanie)
00113C                03641 wykryto_down_sprawdz_5_zawracanie
00113C 0E01           03642       movlw       1
00113E 6FAD           03643       movwf       jaka_wartosc_regulujeH
                      03644       
001140                03645 wykryto_down_sprawdz_5_zero      
                      03646                                                 ; movf        jaka_wartosc_regulujeL,w
                      03647                                                 ; movwf       tmp_hex
                      03648                                                 ; movf        jaka_wartosc_regulujeH,w
                      03649                                                 ; movwf        tmp_hex_H
                      03650                                                 ; clrf        dec1
                      03651                                                 ; clrf        dec10
                      03652                                                 ; call        hex2dec18
                      03653 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      03654       ;wyświetlam obok nazwy opcji czyli 
                      03655                                                 ;call        wykryto_enter_gdzie_wyswietlam_liczbe_bajto
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 89


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            wa
                      03656       
                      03657       
001140 EC68 F00B      03658       call  wyswietl_temp_w_opcjach
                      03659       
001144 EF2D F009      03660       goto        wykryto_down_exit
                      03661       
001148                03662 wykryto_down_sprawdz_6
                      03663       
001148                03664 wykryto_down_sprawdz_9
                      03665 
001148 0E09           03666       movlw       opcja_histereza
00114A 63E1           03667       cpfseq      numer_opcji
00114C EFB4 F008      03668       goto        wykryto_down_sprawdz_10
                      03669       
                      03670       ;wlacz pomiar pradu
                      03671       ;jako test wlacz podswietlenie lub je wylacz
                      03672       
                      03673       ;btg   portlampka2,lampka2
001150 07E6           03674       decf        histereza,f
                      03675       
001152 51E6           03676       movf        histereza,w
001154 6F92           03677       movwf       tmp_hex
                      03678       
001156 6B93           03679       clrf        tmp_hex_H
001158 6B98           03680       clrf        dec1
00115A 6B97           03681       clrf        dec10
00115C ECEC F001      03682       call        hex2dec18
                      03683 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      03684       ;wyświetlam obok nazwy opcji czyli 
001160 EC40 F00C      03685       call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      03686       
001164 EF2D F009      03687       goto        wykryto_down_exit     
                      03688 
001168                03689 wykryto_down_sprawdz_10
                      03690       
                      03691       
001168                03692 wykryto_down_sprawdz_11
001168 0E0B           03693       movlw       opcja_ustaw_zegar
00116A 63E1           03694       cpfseq      numer_opcji
00116C EF1D F009      03695       goto        wykryto_down_sprawdz12
                      03696       
                      03697 ;sprawdzenie która wielkość zegara podlega zmianie
                      03698 ;jeżeli dzien_10 to zmniejszam o jeden dzien_1
                      03699 ;problem polega na tym, że nie mogę skorzystać z FSR2 bo  każda z wielkości
                      03700 ;czasu musi być indywidualnie rozpatrywana
001170 0ED7           03701       movlw       dzien_10
001172 63E7           03702       cpfseq      ustawianie_czasu_co_wyswietlam
001174 EFD1 F008      03703       goto        wykryto_down_sprawdz_11_1
                      03704 
                      03705 ;jeżeli dzień_1 jest 0 (0x30) to jeżeli dzien_10 <> 0x30 zmniejsz dzien_10
                      03706 
001178 0E30           03707       movlw       0x30
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 90


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00117A 63D8           03708       cpfseq      dzien_1
00117C EFCE F008      03709       goto        zmniejsz_dzien_1
                      03710       
                      03711       ;sprawdz czy dzien_10 == 0x30
001180 0E30           03712       movlw       0x30
001182 63D7           03713       cpfseq      dzien_10
001184 EFC9 F008      03714       goto        zapisz_do_dzien_1_99
                      03715       
001188 0E39           03716       movlw       0x39
00118A 6FD7           03717       movwf       dzien_10
00118C 6FD8           03718       movwf       dzien_1
                      03719       
00118E EF19 F009      03720       goto        wykryto_down_sprawdz_11_4
                      03721       
001192                03722 zapisz_do_dzien_1_99
001192 0E39           03723       movlw       0x39
001194 6FD8           03724       movwf       dzien_1
001196 07D7           03725       decf        dzien_10,f
001198 EF19 F009      03726       goto        wykryto_down_sprawdz_11_4
                      03727       
                      03728       
00119C                03729 zmniejsz_dzien_1      
00119C 07D8           03730       decf        dzien_1,f
                      03731       
                      03732       
00119E EF19 F009      03733       goto        wykryto_down_sprawdz_11_4
                      03734       
0011A2                03735 wykryto_down_sprawdz_11_1
0011A2 0ED9           03736       movlw       godziny_10
0011A4 63E7           03737       cpfseq      ustawianie_czasu_co_wyswietlam
0011A6 EFEB F008      03738       goto        wykryto_down_sprawdz_11_2
                      03739       
0011AA 0E30           03740       movlw       0x30
0011AC 63DA           03741       cpfseq      godziny_1
0011AE EFE8 F008      03742       goto        zmniejsz_godziny_1
                      03743       
                      03744       ;sprawdz czy dzien_10 == 0x30
0011B2 0E30           03745       movlw       0x30
0011B4 63D9           03746       cpfseq      godziny_10
0011B6 EFE3 F008      03747       goto        zapisz_do_godziny_1_9
                      03748       
0011BA 0E32           03749       movlw       0x32
0011BC 6FD9           03750       movwf       godziny_10
0011BE 0E33           03751       movlw       0x33
0011C0 6FDA           03752       movwf       godziny_1
                      03753       
0011C2 EF19 F009      03754       goto        wykryto_down_sprawdz_11_4
                      03755       
0011C6                03756 zapisz_do_godziny_1_9
0011C6 0E39           03757       movlw       0x39
0011C8 6FDA           03758       movwf       godziny_1
0011CA 07D9           03759       decf        godziny_10,f
0011CC EF19 F009      03760       goto        wykryto_down_sprawdz_11_4
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 91


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03761       
                      03762       
0011D0                03763 zmniejsz_godziny_1      
0011D0 07DA           03764       decf        godziny_1,f
                      03765       
                      03766       
0011D2 EF19 F009      03767       goto        wykryto_down_sprawdz_11_4
                      03768       
                      03769       
0011D6                03770 wykryto_down_sprawdz_11_2
0011D6 0EDB           03771       movlw       minuty_10
0011D8 63E7           03772       cpfseq      ustawianie_czasu_co_wyswietlam
0011DA EF05 F009      03773       goto        wykryto_down_sprawdz_11_3
                      03774       
0011DE 0E30           03775       movlw       0x30
0011E0 63DC           03776       cpfseq      minuty_1
0011E2 EF02 F009      03777       goto        zmniejsz_minuty_1
                      03778       
                      03779       ;sprawdz czy dzien_10 == 0x30
0011E6 0E30           03780       movlw       0x30
0011E8 63DB           03781       cpfseq      minuty_10
0011EA EFFD F008      03782       goto        zapisz_do_minuty_1_9
                      03783       
0011EE 0E35           03784       movlw       0x35
0011F0 6FDB           03785       movwf       minuty_10
0011F2 0E39           03786       movlw       0x39
0011F4 6FDC           03787       movwf       minuty_1
                      03788       
0011F6 EF19 F009      03789       goto        wykryto_down_sprawdz_11_4
                      03790       
0011FA                03791 zapisz_do_minuty_1_9
0011FA 0E39           03792       movlw       0x39
0011FC 6FDC           03793       movwf       minuty_1
0011FE 07DB           03794       decf        minuty_10,f
001200 EF19 F009      03795       goto        wykryto_down_sprawdz_11_4
                      03796       
                      03797       
001204                03798 zmniejsz_minuty_1      
001204 07DC           03799       decf        minuty_1,f
                      03800       
001206 EF19 F009      03801       goto        wykryto_down_sprawdz_11_4
                      03802       
00120A                03803 wykryto_down_sprawdz_11_3     
00120A 0E30           03804       movlw       0x30
00120C 63DE           03805       cpfseq      sekundy_1
00120E EF18 F009      03806       goto        zmniejsz_sekundy_1
                      03807       
                      03808       ;sprawdz czy dzien_10 == 0x30
001212 0E30           03809       movlw       0x30
001214 63DD           03810       cpfseq      sekundy_10
001216 EF13 F009      03811       goto        zapisz_do_sekundy_1_9
                      03812       
00121A 0E35           03813       movlw       0x35
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 92


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00121C 6FDD           03814       movwf       sekundy_10
00121E 0E39           03815       movlw       0x39
001220 6FDE           03816       movwf       sekundy_1
                      03817       
001222 EF19 F009      03818       goto        wykryto_down_sprawdz_11_4
                      03819       
001226                03820 zapisz_do_sekundy_1_9
001226 0E39           03821       movlw       0x39
001228 6FDE           03822       movwf       sekundy_1
00122A 07DD           03823       decf        sekundy_10,f
00122C EF19 F009      03824       goto        wykryto_down_sprawdz_11_4
                      03825       
                      03826       
001230                03827 zmniejsz_sekundy_1      
001230 07DE           03828       decf        sekundy_1,f
                      03829       
001232                03830 wykryto_down_sprawdz_11_4            
                      03831 
001232 EC6D F00C      03832       call        procedura_wyswietlania_kolejnych_liczb_zegara
                      03833       
001236 EF2D F009      03834       goto        wykryto_down_exit           
                      03835 ;       call     check_busy
                      03836 ;       movlw    linia_czwarta
                      03837 ;       call      send
                      03838 ;         
                      03839 ;       call     check_busy
                      03840 ; ;czy gasze czy wyswietlam      
                      03841 ;       btfsc       markers,test
                      03842 ;       goto        zamaz_D
                      03843 ; napisz_D
                      03844 ;       bsf   markers,test
                      03845 ;       movlw       _d
                      03846 ;       goto  wykryto_down_pisz
                      03847 ; zamaz_D      
                      03848 ;       bcf   markers,test
                      03849 ;       movlw       _puste
                      03850 ;       
                      03851 ; wykryto_down_pisz
                      03852 ;       call     write_lcd
00123A                03853 wykryto_down_sprawdz12
                      03854       
00123A                03855 wykryto_down_sprawdz16      
00123A 0E10           03856       movlw       opcja_czujnik_regulacji
00123C 63E1           03857       cpfseq      numer_opcji
00123E EF2D F009      03858       goto        wykryto_down_sprawdz17
                      03859       
                      03860       ;wlacz pomiar pradu
                      03861       ;jako test wlacz podswietlenie lub je wylacz
                      03862       
                      03863       ;btg   portlampka2,lampka2
001242 07E8           03864       decf        ktory_czujnik_reguluje,f
                      03865       
001244 51E8           03866       movf        ktory_czujnik_reguluje,w
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 93


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001246 6F92           03867       movwf       tmp_hex
                      03868       
001248 6B93           03869       clrf        tmp_hex_H
00124A 6B98           03870       clrf        dec1
00124C 6B97           03871       clrf        dec10
00124E ECEC F001      03872       call        hex2dec18
                      03873 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      03874       ;wyświetlam obok nazwy opcji czyli 
001252 EC40 F00C      03875       call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      03876       
001256 EF2D F009      03877       goto        wykryto_down_exit
                      03878 
00125A                03879 wykryto_down_sprawdz17      
00125A                03880 wykryto_down_exit
                      03881 ;jeżeli jest opuszczenie procedury w trakcie przyciskania kończ w inny sposób
                      03882 
00125A B59E           03883       btfsc   znaczniki,czy_moge_juz_zmieniac
00125C EF34 F009      03884       goto    wykryto_down_exit_trzymanie
                      03885       
001260 9BA1           03886       bcf   markers3,dzialanie_po_klawiszu
001262 6B99           03887       clrf  stan_key
001264 EF70 F00D      03888       goto  LOOP11
                      03889  
001268                03890 wykryto_down_exit_trzymanie
001268 959E           03891       bcf     znaczniki,czy_moge_juz_zmieniac
00126A 0012           03892       return
                      03893  
                      03894                         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; ;                       ;;;;;;;;;;;;;;
                            ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;                                UP
00126C                03895 wykryto_up
                      03896       ;co sie dzieje jezeli wykryje ze wcisnieto i puszczono klawisz up
                      03897       
00126C BFE0           03898       btfsc       pozycja_menu,zmiana_opcji
00126E EFD5 F009      03899       goto        wykryto_up_zmiana_opcji
                      03900       
001272 51E0           03901       movf        pozycja_menu,w
001274 E10A           03902       bnz         wykryto_up_sprawdz_czy_wyswietlam_kolejne_opcje
                      03903 ;jezeli pozycja menu ==0 to po nacisnieciu klawisza zmien wskazania temperatury
                      03904 
001276 EC32 F001      03905       call        check_busy
00127A 0E01           03906       movlw       display_clear
00127C ECF4 F000      03907       call        send
001280 EC32 F001      03908       call        check_busy
001284 7FA1           03909       btg         markers3,pokazuje_temperatury_47
                      03910       ;tzn pozwala obejrzec temperatury 0-3 lub 4-7 (zawsze 4)
001286 EFB7 F00A      03911       goto        wykryto_up_exit
                      03912       
                      03913 
                      03914       
Warning[208]: Label truncated at 32 characters. (wykryto_up_sprawdz_czy_wyswietlam_kolejne_opcje)
00128A                03915 wykryto_up_sprawdz_czy_wyswietlam_kolejne_opcje
                      03916       ;movlw       1
                      03917       ;cpfseq      pozycja_menu
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 94


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03918       ;goto        sprawdz_czy_wyswietlam_zmiane_opcji
                      03919       
                      03920       ; polozenie gwiazdki przechowuje liczbe wskazującą aktualny adres polozenia
                      03921       ;gwiazdki w 
                      03922       ;tablicy_gwiazdki
                      03923       ;
                      03924       
00128A 0E1A           03925       movlw       HIGH tablica_gwiazdki
00128C 6EF7           03926       movwf       TBLPTRH
                      03927       
00128E 0EA4           03928       movlw       LOW tablica_gwiazdki
001290 6EF6           03929       movwf       TBLPTRL
                      03930       
                      03931       ;poniewaz najpierw zmniejszam polozenie
001292 07E2           03932       decf        polozenie_gwiazdki,f
001294 51E2           03933       movf       polozenie_gwiazdki,w
                      03934       
001296 26F6           03935       addwf       TBLPTRL,f
                      03936       
                      03937        ;a nastepnie czytam to uzywam polecenia
001298 0008           03938       TBLRD *
00129A 50F5           03939       movf        TABLAT,w
                      03940 ;jezeli odczytano 0 tzn ze bylem na gorze ekranu (pierwsze polecenie)
                      03941 ; i następuje przeskok do ekranu menu 0 lub 1 
00129C E16C           03942       bnz         wykryto_up_zmiana_polozenia_gwiazdki
                      03943       ;polozenie_gwiazdki == 4 bo gwiazdka jest na dole opcji ekranu poprzedniego
00129E 0E04           03944       movlw       4
0012A0 6FE2           03945       movwf       polozenie_gwiazdki
                      03946       
                      03947       
0012A2 07E1           03948       decf        numer_opcji,f
                      03949       ;czyszczenie ekranu
0012A4 EC32 F001      03950       call        check_busy
0012A8 0E01           03951       movlw       display_clear
0012AA ECF4 F000      03952       call        send
0012AE EC32 F001      03953       call        check_busy
                      03954       
                      03955            
                      03956       
                      03957       ;zaznaczam ze wyświetlam kolejny ekran opcji
                      03958       
                      03959       
0012B2 B1E0           03960       btfsc       pozycja_menu,menu_opcje1 ;(tj zaznaczony jet bit wskazujący na pokazywanie opcji ekra
                            nu 1, czyli przeskok do ekranu koncowego)
0012B4 EF67 F009      03961       goto        wykryto_up_wyswietl_opcje_tablicy_end
                      03962       
                      03963       
                      03964       
                      03965       
                      03966       
0012B8 90D8           03967       bcf         STATUS,C
0012BA 33E0           03968       rrcf       pozycja_menu,f
                      03969       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 95


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      03970 ;########################################## WAZNE
                      03971 ;jeżeli będzie więcej ekrnów opcji menu, to tu należy dodać procedurę wykrywania adres której ta
                            blicy jest używany do wyświetlania opcji
                      03972        
                      03973       ;gdy wyświetlam opcje ekranu 2 - tzn gwiazdka byla na górze opcji linii pierwszej ekranu 2
                      03974       
                      03975       ;jeżeli po przesunięciu zaznaczony jest bit menu_opcje1 to wyswietl menu_opcje1
0012BC B1E0           03976       btfsc       pozycja_menu,menu_opcje1 ;(tj zaznaczony jet bit wskazujący na pokazywanie opcji ekra
                            nu 1, czyli przeskok do ekranu 0)
0012BE EF67 F009      03977       goto        wykryto_up_wyswietl_opcje_tablicy_pierwsza
                      03978       
                      03979       
0012C2 B3E0           03980       btfsc       pozycja_menu,menu_opcje2 ;(tj zaznaczony jet bit wskazujący na pokazywanie opcji ekra
                            nu 1, czyli przeskok do ekranu 0)
0012C4 EF67 F009      03981       goto        wykryto_up_wyswietl_opcje_tablicy_dwa
                      03982 
0012C8 B5E0           03983       btfsc       pozycja_menu,menu_opcje3 ;(tj zaznaczony jet bit wskazujący na pokazywanie opcji ekra
                            nu 1, czyli przeskok do ekranu 0)
0012CA EF67 F009      03984       goto        wykryto_up_wyswietl_opcje_tablicy_trzy
                      03985       
                      03986       
Warning[208]: Label truncated at 32 characters. (wykryto_up_wyswietl_opcje_tablicy_pierwsza)
0012CE                03987 wykryto_up_wyswietl_opcje_tablicy_pierwsza
0012CE 0E1A           03988       movlw       HIGH tablica_pierwsza
0012D0 6EF7           03989       movwf       TBLPTRH
                      03990       
0012D2 0E00           03991       movlw       LOW tablica_pierwsza
0012D4 6EF6           03992       movwf       TBLPTRL
                      03993       
0012D6 ECC0 F00A      03994       call        wyswietl_opcje_menu
                      03995       
                      03996       ;wyswietlam gwiazdke na linii ostatniej poprzedniego ekranu
0012DA EC32 F001      03997       call        check_busy
0012DE 0ED0           03998       movlw       linia_czwarta
                      03999       
0012E0 ECF4 F000      04000       call        send
0012E4 EC32 F001      04001       call        check_busy
0012E8 0E2A           04002       movlw       _star
0012EA EC05 F001      04003       call        write_lcd
0012EE EC32 F001      04004       call        check_busy
                      04005       
0012F2 EFB7 F00A      04006       goto        wykryto_up_exit
                      04007       
                      04008            
Warning[208]: Label truncated at 32 characters. (wykryto_up_wyswietl_opcje_tablicy_dwa)
Error[116]  : Address label duplicated or different in second pass (wykryto_up_wyswietl_opcje_tablic)
0012F6                04009 wykryto_up_wyswietl_opcje_tablicy_dwa
                      04010       ;tu jest przeskok z numeru opcji 1 do ostatniej możliwej czyli 8
                      04011       
                      04012       ;wyświetlam opcje ekranu 2
                      04013       
                      04014       
0012F6 0E1A           04015       movlw       HIGH tablica_druga
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 96


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0012F8 6EF7           04016       movwf       TBLPTRH
                      04017       
0012FA 0E22           04018       movlw       LOW tablica_druga
0012FC 6EF6           04019       movwf       TBLPTRL
                      04020       
0012FE ECC0 F00A      04021       call        wyswietl_opcje_menu
                      04022       
                      04023       ;wyswietlam gwiazdke na linii ostatniej poprzedniego ekranu
001302 EC32 F001      04024       call        check_busy
001306 0ED0           04025       movlw       linia_czwarta
001308 ECF4 F000      04026       call        send
                      04027       
00130C EC32 F001      04028       call        check_busy
001310 0E2A           04029       movlw       _star
001312 EC05 F001      04030       call        write_lcd
001316 EC32 F001      04031       call        check_busy
                      04032       
00131A EFB7 F00A      04033       goto        wykryto_up_exit
                      04034 
                      04035 
Warning[208]: Label truncated at 32 characters. (wykryto_up_wyswietl_opcje_tablicy_trzy)
Error[116]  : Address label duplicated or different in second pass (wykryto_up_wyswietl_opcje_tablic)
00131E                04036 wykryto_up_wyswietl_opcje_tablicy_trzy
                      04037       
00131E 0E1A           04038       movlw       HIGH tablica_trzecia
001320 6EF7           04039       movwf       TBLPTRH
                      04040       
001322 0E42           04041       movlw       LOW tablica_trzecia
001324 6EF6           04042       movwf       TBLPTRL
                      04043             
001326 ECC0 F00A      04044       call        wyswietl_opcje_menu
                      04045       
00132A EC32 F001      04046       call        check_busy
00132E 0ED0           04047       movlw       linia_czwarta      
001330 ECF4 F000      04048       call        send
                      04049       
001334 EC32 F001      04050       call        check_busy
001338 0E2A           04051       movlw       _star
00133A EC05 F001      04052       call        write_lcd
00133E EC32 F001      04053       call        check_busy
                      04054       
001342 EF2D F009      04055       goto        wykryto_down_exit
                      04056       
Warning[208]: Label truncated at 32 characters. (wykryto_up_wyswietl_opcje_tablicy_end)
Error[116]  : Address label duplicated or different in second pass (wykryto_up_wyswietl_opcje_tablic)
001346                04057 wykryto_up_wyswietl_opcje_tablicy_end
001346 0E10           04058       movlw       numer_opcji_koncowej    
001348 6FE1           04059       movwf       numer_opcji
00134A 6BE0           04060       clrf            pozycja_menu
00134C 87E0           04061       bsf            pozycja_menu,(menu_opcje_end-1)
                      04062 
00134E 0E1A           04063       movlw       HIGH tablica_czwarta
001350 6EF7           04064       movwf       TBLPTRH
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 97


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04065       
001352 0E6C           04066       movlw       LOW tablica_czwarta
001354 6EF6           04067       movwf       TBLPTRL
                      04068       
                      04069       
001356 ECC0 F00A      04070       call        wyswietl_opcje_menu
                      04071       
00135A EC32 F001      04072       call        check_busy
00135E 0ED0           04073       movlw       linia_czwarta      
001360 ECF4 F000      04074       call        send
                      04075       
001364 EC32 F001      04076       call        check_busy
001368 0E2A           04077       movlw       _star
00136A EC05 F001      04078       call        write_lcd
00136E EC32 F001      04079       call        check_busy
                      04080       
001372 EF2D F009      04081       goto        wykryto_down_exit
                      04082       
                      04083       
Warning[208]: Label truncated at 32 characters. (wykryto_up_zmiana_polozenia_gwiazdki)
001376                04084 wykryto_up_zmiana_polozenia_gwiazdki
                      04085       ;opcje zmnieniaja się o tą położoną wyżej
001376 07E1           04086       decf        numer_opcji,f
                      04087       
                      04088       ;nowa gwiazdka jest rysowana w miejscu odczytanym z tablicy
                      04089       
001378 EC32 F001      04090       call     check_busy
00137C 50F5           04091       movf        TABLAT,w
00137E ECF4 F000      04092       call        send
                      04093       
001382 EC32 F001      04094       call     check_busy
001386 0E2A           04095       movlw       _star
001388 EC05 F001      04096       call        write_lcd
00138C EC32 F001      04097       call     check_busy
                      04098       ;gwiazdka poprzednia jest kasowana - tzn znow czytam z tablicy ale tym razem polozenie poprzednie
                      04099       
                      04100       
001390 2AF6           04101       incf        TBLPTRL,f
001392 0008           04102       TBLRD *
001394 50F5           04103       movf        TABLAT,w
001396 ECF4 F000      04104       call        send
00139A EC32 F001      04105       call     check_busy
00139E 0E20           04106       movlw       _puste
0013A0 EC05 F001      04107       call        write_lcd
                      04108       
0013A4 06F6           04109       decf        TBLPTRL,f
                      04110       
0013A6 EFB7 F00A      04111       goto        wykryto_up_exit
                      04112 
                      04113 
                      04114       
                      04115 ;#########################################KLAWISZ UP
                      04116 ;ZMIANA Opcji
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 98


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0013AA                04117 wykryto_up_zmiana_opcji
                      04118 ;sprawdz którą opcję zmieniam
0013AA 0E01           04119       movlw       opcja_czujniki
0013AC 63E1           04120       cpfseq      numer_opcji
0013AE EFED F009      04121       goto          wykryto_up_sprawdz_2
                      04122       
                      04123       ;jeżeli zmieniam ilość obsługiwanych czujników temp
                      04124       ;to tu powinno być zmiana o 1 ilości kanałów 
                      04125       ;i sprawdzenie czy nie przekroczyłem dopuszczalnych 8
0013B2 2BA5           04126       incf        ile_kanalow,f
0013B4 0E09           04127       movlw      9
                      04128       
0013B6 63A5           04129       cpfseq      ile_kanalow
0013B8 EFDF F009      04130       goto         wykryto_up_zmiana_opcji_wyswietl_kanaly
                      04131       
0013BC 6BA5           04132       clrf              ile_kanalow
                      04133       
Warning[208]: Label truncated at 32 characters. (wykryto_up_zmiana_opcji_wyswietl_kanaly)
0013BE                04134 wykryto_up_zmiana_opcji_wyswietl_kanaly
0013BE EC32 F001      04135       call     check_busy
0013C2 0E80           04136       movlw    linia_gorna
0013C4 0F0C           04137       addlw       0xc
0013C6 ECF4 F000      04138       call      send
                      04139       ;
0013CA EC32 F001      04140       call     check_busy
0013CE 51A5           04141       movf        ile_kanalow,w
0013D0 0F30           04142       addlw       0x30
0013D2 EC05 F001      04143       call        write_lcd
                      04144       
0013D6 EFB7 F00A      04145       goto        wykryto_up_exit
                      04146       
0013DA                04147 wykryto_up_sprawdz_2
0013DA 0E02           04148       movlw       opcja_odstep
0013DC 63E1           04149       cpfseq      numer_opcji
0013DE EFFD F009      04150       goto        wykryto_up_sprawdz_3
                      04151 
0013E2 2BA7           04152       incf        odstep_pomiarowy,f
0013E4 51A7           04153       movf        odstep_pomiarowy,w
                      04154       
0013E6 6F92           04155       movwf       tmp_hex
0013E8 6B93           04156       clrf        tmp_hex_H
0013EA 6B98           04157       clrf        dec1
0013EC 6B97           04158       clrf        dec10
0013EE ECEC F001      04159       call        hex2dec18
                      04160 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04161       ;wyświetlam obok nazwy opcji czyli 
0013F2 EC40 F00C      04162       call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      04163       
                      04164       
0013F6 EFB7 F00A      04165       goto        wykryto_up_exit
                      04166       
0013FA                04167 wykryto_up_sprawdz_3
0013FA 0E03           04168       movlw       opcja_srednia
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 99


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0013FC 63E1           04169       cpfseq      numer_opcji
0013FE EF1C F00A      04170       goto        wykryto_up_sprawdz_4
                      04171       
                      04172       ;sprawdz czy liczba próbek == 128 (0x80)
001402 0E80           04173       movlw       0x80
001404 63AF           04174       cpfseq      jak_duzo_probek
001406 EF0A F00A      04175       goto        wykryto_up_sprawdz_3_zwieksz_probki
                      04176       ;zmieniam liczbe próbek na 1
00140A 0E01           04177       movlw       1
00140C 6FAF           04178       movwf       jak_duzo_probek
00140E 919F           04179       bcf      markers,czy_usrednianie
                      04180       
001410 EF11 F00A      04181       goto        wykryto_up_3_wyswietl
                      04182       
Warning[208]: Label truncated at 32 characters. (wykryto_up_sprawdz_3_zwieksz_probki)
001414                04183 wykryto_up_sprawdz_3_zwieksz_probki
001414 819F           04184       bsf      markers,czy_usrednianie
001416 0E02           04185       movlw       0x02
001418 03AF           04186       mulwf       jak_duzo_probek
00141A 50F3           04187       movf        PRODL,w
00141C 6FAF           04188       movwf       jak_duzo_probek
                      04189       
00141E EC8E F003      04190       call     ustaw_wartosc_dzielenia_usredniania      
                      04191       
001422                04192 wykryto_up_3_wyswietl
001422 51AF           04193       movf        jak_duzo_probek,w
001424 6F92           04194       movwf       tmp_hex
001426 6B93           04195       clrf        tmp_hex_H
001428 6B98           04196       clrf        dec1
00142A 6B97           04197       clrf        dec10
00142C ECEC F001      04198       call        hex2dec18
                      04199 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04200       ;wyświetlam obok nazwy opcji czyli 
001430 EC40 F00C      04201       call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      04202       
001434 EFB7 F00A      04203       goto        wykryto_up_exit
                      04204             
                      04205 
001438                04206 wykryto_up_sprawdz_4
001438                04207 wykryto_up_sprawdz_5
001438 0E05           04208       movlw       opcja_ustaw_temp
00143A 63E1           04209       cpfseq      numer_opcji
00143C EF2C F00A      04210       goto        wykryto_up_sprawdz_6
                      04211       
                      04212             
001440 2BAE           04213       incf        jaka_wartosc_regulujeL,f
                      04214       
001442 E306           04215       bnc         wykryto_up_sprawdz_5_dalej
                      04216       ;czy  przekroczono 0x200
                      04217             
001444 2BAD           04218       incf        jaka_wartosc_regulujeH,f
                      04219       
001446 0E02           04220       movlw       0x02
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 100


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001448 63AD           04221       cpfseq      jaka_wartosc_regulujeH
00144A EF28 F00A      04222       goto        wykryto_up_sprawdz_5_dalej
                      04223       
                      04224       
                      04225       ;jeżeli w H jest 3 to wyzeruj 
00144E 6BAD           04226       clrf       jaka_wartosc_regulujeH
                      04227       
                      04228       
001450                04229 wykryto_up_sprawdz_5_dalej
                      04230                                                 ; movf        jaka_wartosc_regulujeL,w
                      04231                                                 ; movwf       tmp_hex
                      04232                                                 ; movf        jaka_wartosc_regulujeH,w
                      04233                                                 ; movwf        tmp_hex_H
                      04234                                                 ; clrf        dec1
                      04235                                                 ; clrf        dec10
                      04236                                                 ; call        hex2dec18
                      04237                                           ;czyli zawartość rejestru jest zamieniana na postać dziesi
                            tną i przenoszonona do dec100 dec10 dec1
                      04238                                            ;     wyświetlam obok nazwy opcji czyli 
                      04239                                                 ; call        wykryto_enter_gdzie_wyswietlam_liczbe_bajt
                            owa
                      04240       
001450 EC68 F00B      04241       call  wyswietl_temp_w_opcjach
                      04242       
                      04243       
001454 EF2D F009      04244       goto        wykryto_down_exit
001458                04245 wykryto_up_sprawdz_6
                      04246 
                      04247 
001458                04248 wykryto_up_sprawdz_9
                      04249 
001458 0E09           04250       movlw       opcja_histereza
00145A 63E1           04251       cpfseq      numer_opcji
00145C EF3C F00A      04252       goto        wykryto_up_sprawdz_10
                      04253       
                      04254       ;wlacz pomiar pradu
                      04255       ;jako test wlacz podswietlenie lub je wylacz
                      04256       
                      04257       ;btg   portlampka2,lampka2
001460 2BE6           04258       incf        histereza,f
                      04259       
001462 51E6           04260       movf        histereza,w
001464 6F92           04261       movwf       tmp_hex
                      04262       
001466 6B93           04263       clrf        tmp_hex_H
001468 6B98           04264       clrf        dec1
00146A 6B97           04265       clrf        dec10
00146C ECEC F001      04266       call        hex2dec18
                      04267 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04268       ;wyświetlam obok nazwy opcji czyli 
001470 EC40 F00C      04269       call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      04270       
001474 EFB7 F00A      04271       goto        wykryto_up_exit     
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 101


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04272       
001478                04273 wykryto_up_sprawdz_10
                      04274 
001478                04275 wykryto_up_sprawdz_11
001478 0E0B           04276       movlw       opcja_ustaw_zegar
00147A 63E1           04277       cpfseq      numer_opcji
00147C EFA7 F00A      04278       goto        wykryto_up_sprawdz12
                      04279       
                      04280 ;sprawdzenie która wielkość zegara podlega zmianie
                      04281 ;jeżeli dzien_10 to zmniejszam o jeden dzien_1
                      04282 ;problem polega na tym, że nie mogę skorzystać z FSR2 bo  każda z wielkości
                      04283 ;czasu musi być indywidualnie rozpatrywana
001480 0ED7           04284       movlw       dzien_10
001482 63E7           04285       cpfseq      ustawianie_czasu_co_wyswietlam
001484 EF59 F00A      04286       goto        wykryto_up_sprawdz_11_1
                      04287 
                      04288 ;jeżeli dzień_1 jest 9 (0x39) to jeżeli dzien_10 <> 0x39 zwieksz dzien_10
                      04289 
001488 0E39           04290       movlw       0x39
00148A 63D8           04291       cpfseq      dzien_1
00148C EF56 F00A      04292       goto        zwieksz_dzien_1
                      04293       
                      04294       ;sprawdz czy dzien_10 == 0x39
001490 0E39           04295       movlw       0x39
001492 63D7           04296       cpfseq      dzien_10
001494 EF51 F00A      04297       goto        zapisz_do_dzien_1_0
                      04298       
001498 0E30           04299       movlw       0x30 
00149A 6FD8           04300       movwf       dzien_1            
00149C 6FD7           04301       movwf       dzien_10
                      04302       
00149E EFA3 F00A      04303       goto        wykryto_up_sprawdz_11_4
                      04304       
0014A2                04305 zapisz_do_dzien_1_0
0014A2 0E30           04306       movlw       0x30
0014A4 6FD8           04307       movwf       dzien_1
0014A6 2BD7           04308       incf        dzien_10,f
0014A8 EFA3 F00A      04309       goto        wykryto_up_sprawdz_11_4
                      04310       
                      04311       
0014AC                04312 zwieksz_dzien_1      
0014AC 2BD8           04313       incf        dzien_1,f
                      04314       
                      04315       
0014AE EFA3 F00A      04316       goto        wykryto_up_sprawdz_11_4
                      04317       
0014B2                04318 wykryto_up_sprawdz_11_1
0014B2 0ED9           04319       movlw       godziny_10
0014B4 63E7           04320       cpfseq      ustawianie_czasu_co_wyswietlam
0014B6 EF76 F00A      04321       goto        wykryto_up_sprawdz_11_2
                      04322       
                      04323       ;najpierw sprawdze czy godziny_1 i godziny_10 == 23 godzina bo wtedy wpisuje 00
0014BA 0E33           04324       movlw       0x33
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 102


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0014BC 63DA           04325       cpfseq      godziny_1
0014BE EF6A F00A      04326       goto        sprawdz_zwiekszanie_godzin_normalnie
0014C2 0E32           04327       movlw       0x32
0014C4 63D9           04328       cpfseq      godziny_10
0014C6 EF6A F00A      04329       goto        sprawdz_zwiekszanie_godzin_normalnie
                      04330       
                      04331 ;jest godzina 23 => zapisz do godzin 00      
0014CA 0E30           04332       movlw       0x30
0014CC 6FD9           04333       movwf       godziny_10      
0014CE 6FDA           04334       movwf       godziny_1
0014D0 EFA3 F00A      04335       goto        wykryto_up_sprawdz_11_4
                      04336       
Warning[208]: Label truncated at 32 characters. (sprawdz_zwiekszanie_godzin_normalnie)
0014D4                04337 sprawdz_zwiekszanie_godzin_normalnie      
0014D4 0E39           04338       movlw       0x39
0014D6 63DA           04339       cpfseq      godziny_1
0014D8 EF73 F00A      04340       goto        zwieksz_godziny_1      
                      04341 
0014DC 0E30           04342       movlw       0x30
0014DE 6FDA           04343       movwf       godziny_1
0014E0 2BD9           04344       incf        godziny_10,f
0014E2 EFA3 F00A      04345       goto        wykryto_up_sprawdz_11_4
                      04346             
0014E6                04347 zwieksz_godziny_1      
0014E6 2BDA           04348       incf        godziny_1,f
                      04349       
                      04350       
0014E8 EFA3 F00A      04351       goto        wykryto_up_sprawdz_11_4
                      04352       
                      04353       
0014EC                04354 wykryto_up_sprawdz_11_2
0014EC 0EDB           04355       movlw       minuty_10
0014EE 63E7           04356       cpfseq      ustawianie_czasu_co_wyswietlam
0014F0 EF8F F00A      04357       goto        wykryto_up_sprawdz_11_3
                      04358       
                      04359       
0014F4 0E39           04360       movlw       0x39
0014F6 63DC           04361       cpfseq      minuty_1
0014F8 EF8C F00A      04362       goto        zwieksz_minuty_1
                      04363      
0014FC 0E35           04364       movlw       0x35
0014FE 63DB           04365       cpfseq      minuty_10
001500 EF87 F00A      04366       goto        zapisz_do_minuty_1_0
                      04367       
001504 0E30           04368       movlw       0x30
001506 6FDB           04369       movwf       minuty_10
001508 6FDC           04370       movwf       minuty_1
                      04371       
00150A EFA3 F00A      04372       goto        wykryto_up_sprawdz_11_4
                      04373       
00150E                04374 zapisz_do_minuty_1_0
00150E 0E30           04375       movlw       0x30
001510 6FDC           04376       movwf       minuty_1
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 103


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001512 2BDB           04377       incf        minuty_10,f
001514 EFA3 F00A      04378       goto        wykryto_up_sprawdz_11_4
                      04379       
                      04380       
001518                04381 zwieksz_minuty_1      
001518 2BDC           04382       incf        minuty_1,f
                      04383       
00151A EFA3 F00A      04384       goto        wykryto_up_sprawdz_11_4
                      04385       
00151E                04386 wykryto_up_sprawdz_11_3     
00151E 0E30           04387       movlw       0x30
001520 63DE           04388       cpfseq      sekundy_1
001522 EFA2 F00A      04389       goto        zwieksz_sekundy_1
                      04390       
                      04391       ;sprawdz czy dzien_10 == 0x30
001526 0E30           04392       movlw       0x30
001528 63DD           04393       cpfseq      sekundy_10
00152A EF9D F00A      04394       goto        zapisz_do_sekundy_1_0
                      04395       
00152E 0E35           04396       movlw       0x35
001530 6FDD           04397       movwf       sekundy_10
001532 0E39           04398       movlw       0x39
001534 6FDE           04399       movwf       sekundy_1
                      04400       
001536 EFA3 F00A      04401       goto        wykryto_up_sprawdz_11_4
                      04402       
00153A                04403 zapisz_do_sekundy_1_0
00153A 0E30           04404       movlw       0x30
00153C 6FDE           04405       movwf       sekundy_1
00153E 2BDD           04406       incf        sekundy_10,f
001540 EFA3 F00A      04407       goto        wykryto_up_sprawdz_11_4
                      04408       
                      04409       
001544                04410 zwieksz_sekundy_1      
001544 2BDE           04411       incf        sekundy_1,f
                      04412       
001546                04413 wykryto_up_sprawdz_11_4            
                      04414 
001546 EC6D F00C      04415       call        procedura_wyswietlania_kolejnych_liczb_zegara
00154A EFB7 F00A      04416       goto        wykryto_up_exit
                      04417       
00154E                04418 wykryto_up_sprawdz12
                      04419      
00154E                04420 wykryto_up_sprawdz16
00154E 0E10           04421       movlw      opcja_czujnik_regulacji 
001550 63E1           04422       cpfseq      numer_opcji
001552 EF3C F00A      04423       goto        wykryto_up_sprawdz_10
                      04424       
                      04425       ;wlacz pomiar pradu
                      04426       ;jako test wlacz podswietlenie lub je wylacz
                      04427       
                      04428       ;btg   portlampka2,lampka2
001556 2BE8           04429       incf        ktory_czujnik_reguluje,f
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 104


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04430       
001558 51E8           04431       movf        ktory_czujnik_reguluje,w
00155A 6F92           04432       movwf       tmp_hex
                      04433       
00155C 6B93           04434       clrf        tmp_hex_H
00155E 6B98           04435       clrf        dec1
001560 6B97           04436       clrf        dec10
001562 ECEC F001      04437       call        hex2dec18
                      04438 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04439       ;wyświetlam obok nazwy opcji czyli 
001566 EC40 F00C      04440       call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      04441       
00156A EFB7 F00A      04442       goto        wykryto_up_exit          
                      04443       
                      04444       
00156E                04445 wykryto_up_exit
00156E B59E           04446       btfsc   znaczniki,czy_moge_juz_zmieniac
001570 EFBE F00A      04447       goto    wykryto_up_exit_trzymanie
001574 9BA1           04448       bcf   markers3,dzialanie_po_klawiszu
001576 6B99           04449       clrf  stan_key
001578 EF70 F00D      04450       goto  LOOP11
                      04451  
00157C                04452 wykryto_up_exit_trzymanie
00157C 959E           04453       bcf     znaczniki,czy_moge_juz_zmieniac
00157E 0012           04454       return      
                      04455  
                      04456 
                      04457 
                      04458 
                      04459 
                      04460 ;############################################
                      04461 ;#####
                      04462 ;######PISZ na ekranie słowa z tablicy opcji menu
                      04463 
                      04464 
001580                04465 wyswietl_opcje_menu
001580 EC32 F001      04466       call        check_busy
001584 0E80           04467       movlw       linia_gorna
001586 0F01           04468       addlw       1        
001588 ECF4 F000      04469       call        send
00158C EC32 F001      04470       call        check_busy
001590                04471 czytam_pierwsza_linie
                      04472       
                      04473       ;czytam aktualny adres i zwiekszam
001590 0009           04474       TBLRD       *+
                      04475       
001592 50F5           04476       movf        TABLAT,w
                      04477       ;jezeli 0 to skocz do wyswietlania slowa z linii 2
001594 E006           04478       bz          czytam_druga_linie
001596 EC05 F001      04479       call        write_lcd
00159A EC32 F001      04480       call        check_busy
00159E EFC8 F00A      04481       goto        czytam_pierwsza_linie
                      04482       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 105


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0015A2                04483 czytam_druga_linie
                      04484       
0015A2 0EC0           04485       movlw       linia_dolna
0015A4 0F01           04486       addlw       1        
0015A6 ECF4 F000      04487       call        send
0015AA EC32 F001      04488       call        check_busy
                      04489       
0015AE                04490 czytam_druga_linie2
                      04491       ;czytam aktualny adres i zwiekszam
0015AE 0009           04492       TBLRD       *+
                      04493       
0015B0 50F5           04494       movf        TABLAT,w
                      04495       ;jezeli 0 to skocz do wyswietlania slowa z linii 2
0015B2 E006           04496       bz          czytam_trzecia_linie
0015B4 EC05 F001      04497       call        write_lcd
0015B8 EC32 F001      04498       call        check_busy
                      04499       
0015BC EFD7 F00A      04500       goto        czytam_druga_linie2
                      04501       
0015C0                04502 czytam_trzecia_linie
0015C0 0E90           04503       movlw       linia_trzecia
0015C2 0F01           04504       addlw       1        
0015C4 ECF4 F000      04505       call        send
0015C8 EC32 F001      04506       call        check_busy
0015CC                04507 czytam_trzecia_linie2      
0015CC 0009           04508       TBLRD       *+
                      04509       
0015CE 50F5           04510       movf        TABLAT,w
                      04511       ;jezeli 0 to skocz do wyswietlania slowa z linii 2
0015D0 E006           04512       bz          czytam_4_linie
0015D2 EC05 F001      04513       call        write_lcd
0015D6 EC32 F001      04514       call        check_busy
                      04515       
0015DA EFE6 F00A      04516       goto        czytam_trzecia_linie2
                      04517       
0015DE                04518 czytam_4_linie
0015DE 0ED0           04519       movlw       linia_czwarta
0015E0 0F01           04520       addlw       1        
0015E2 ECF4 F000      04521       call        send
0015E6 EC32 F001      04522       call        check_busy
                      04523       
0015EA                04524 czytam_4_linie2
0015EA 0009           04525       TBLRD       *+
                      04526       
0015EC 50F5           04527       movf        TABLAT,w
                      04528       ;jezeli 0 to skocz do wyswietlania slowa z linii 2
0015EE E006           04529       bz          czytam_4_linie3
0015F0 EC05 F001      04530       call        write_lcd
0015F4 EC32 F001      04531       call        check_busy
                      04532       
0015F8 EFF5 F00A      04533       goto        czytam_4_linie2
                      04534       
0015FC                04535 czytam_4_linie3
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 106


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0015FC 0012           04536       return 
                      04537  
                      04538  
                      04539  
                      04540 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;; ;                       ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                            ;;;;;;;;                                ENTER
0015FE                04541 wykryto_enter
                      04542       ;co sie dzieje jezeli wykryje ze wcisnieto i puszczono klawisz enter
                      04543       
0015FE BFE0           04544       btfsc       pozycja_menu,zmiana_opcji
001600 EFE3 F00B      04545       goto        wykryto_enter_zmiana_opcji
                      04546       
001604 51E0           04547       movf        pozycja_menu,w
001606 E121           04548       bnz         sprawdz_czy_wchodze_do_zmiany_opcji
                      04549 ;jezeli pozycja menu ==0 to po nacisnieciu klawisza enter wyswietlane sa napisy ekranu menu 0 i gwiazdka
                             w linii pierwszej przy pierwszej opcji
                      04550       
                      04551       ;wylaczam wskazywanie temperatur i czasu
001608 9B9F           04552       bcf         markers,czy_wyswietlam_temp
00160A 95A1           04553       bcf         markers3,czy_zegar_wyswietlac
                      04554       
                      04555       
                      04556       
00160C EC32 F001      04557       call        check_busy
001610 0E01           04558       movlw       display_clear
001612 ECF4 F000      04559       call        send
001616 EC32 F001      04560       call        check_busy
                      04561       
00161A 0E01           04562       movlw       1
00161C 6FE0           04563       movwf       pozycja_menu
00161E 6FE2           04564       movwf       polozenie_gwiazdki
                      04565       
001620 6FE1           04566       movwf        numer_opcji
                      04567             
001622 EC32 F001      04568       call        check_busy
001626 0E80           04569       movlw       linia_gorna
                      04570       
001628 ECF4 F000      04571       call        send
00162C EC32 F001      04572       call        check_busy
001630 0E2A           04573       movlw       _star
001632 EC05 F001      04574       call        write_lcd
001636 EC32 F001      04575       call        check_busy
                      04576       
                      04577       
00163A 0E1A           04578       movlw       HIGH tablica_pierwsza
00163C 6EF7           04579       movwf       TBLPTRH
                      04580       
00163E 0E00           04581       movlw       LOW tablica_pierwsza
001640 6EF6           04582       movwf       TBLPTRL
                      04583       
001642 ECC0 F00A      04584       call  wyswietl_opcje_menu
                      04585       
001646 EF31 F00C      04586       goto        wykryto_enter_exit     
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 107


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      04587       
Warning[208]: Label truncated at 32 characters. (sprawdz_czy_wchodze_do_zmiany_opcji)
00164A                04588 sprawdz_czy_wchodze_do_zmiany_opcji
00164A 0E01           04589       movlw       opcja_czujniki
00164C 63E1           04590       cpfseq      numer_opcji
00164E EF38 F00B      04591       goto        wykryto_enter_sprawdz_opcje2
                      04592       ;obok nazwy opcji wypisuje aktualna ilosc mierzonych temperatur
                      04593       ;naciskanie klawiszy gora/ dół to zmiana ilości kanałów mierzonych
                      04594       ;klawisz enter lub back powoduje zatwierdzenie pomiarów 
                      04595       
                      04596       ;opcja wyboru jest umieszczona na pierwszej linii ekranu
                      04597       ;
                      04598       ;*pomiar t   2
                      04599       ;na 12 znaku linii pierwszej piszemy aktualną cyfrę kanałów
001652 EC32 F001      04600       call     check_busy
001656 0E80           04601       movlw    linia_gorna
001658 0F0C           04602       addlw       0xc
00165A ECF4 F000      04603       call      send
                      04604       ;
00165E EC32 F001      04605       call     check_busy
001662 51A5           04606       movf        ile_kanalow,w
001664 0F30           04607       addlw       0x30
001666 EC05 F001      04608       call        write_lcd
                      04609             
                      04610       ;zaznaczam ze jest zmiana opcji
00166A 8FE0           04611       bsf         pozycja_menu,zmiana_opcji
                      04612       
00166C EF31 F00C      04613       goto        wykryto_enter_exit
                      04614       
001670                04615 wykryto_enter_sprawdz_opcje2
                      04616 
001670 0E02           04617       movlw       opcja_odstep
001672 63E1           04618       cpfseq      numer_opcji
001674 EF48 F00B      04619       goto        wykryto_enter_sprawdz_opcje3
                      04620 
                      04621       ;pokaz na ekranie ustawienie aktualne odstępu w s.
001678 51A7           04622       movf        odstep_pomiarowy,w
00167A 6F92           04623       movwf       tmp_hex
00167C 6B93           04624       clrf        tmp_hex_H
00167E 6B98           04625       clrf        dec1
001680 6B97           04626       clrf        dec10
001682 ECEC F001      04627       call        hex2dec18
                      04628 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04629       ;wyświetlam obok nazwy opcji czyli 
001686 EC40 F00C      04630       call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      04631       
                      04632       ;zaznaczam ze jest zmiana opcji
00168A 8FE0           04633       bsf         pozycja_menu,zmiana_opcji
                      04634       
00168C EF31 F00C      04635       goto        wykryto_enter_exit
                      04636       
                      04637       
001690                04638 wykryto_enter_sprawdz_opcje3
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 108


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001690 0E03           04639       movlw       opcja_srednia
001692 63E1           04640       cpfseq      numer_opcji
001694 EF58 F00B      04641       goto        wykryto_enter_sprawdz_opcje4
                      04642 
                      04643       ;pokaz na ekranie ustawienie aktualne odstępu w s.
001698 51AF           04644       movf        jak_duzo_probek,w
00169A 6F92           04645       movwf       tmp_hex
00169C 6B93           04646       clrf        tmp_hex_H
00169E 6B98           04647       clrf        dec1
0016A0 6B97           04648       clrf        dec10
0016A2 ECEC F001      04649       call        hex2dec18
                      04650 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04651       ;wyświetlam obok nazwy opcji czyli 
0016A6 EC40 F00C      04652       call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      04653       
0016AA 8FE0           04654       bsf         pozycja_menu,zmiana_opcji
                      04655       
0016AC EF31 F00C      04656       goto        wykryto_enter_exit
                      04657       
0016B0                04658 wykryto_enter_sprawdz_opcje4
0016B0 0E04           04659       movlw       opcja_regulacja
0016B2 63E1           04660       cpfseq      numer_opcji
0016B4 EF5F F00B      04661       goto        wykryto_enter_sprawdz_opcje5
                      04662       
0016B8 7DA0           04663       btg         markers2,reguluj
                      04664       
0016BA EF31 F00C      04665       goto        wykryto_enter_exit
                      04666       
0016BE                04667 wykryto_enter_sprawdz_opcje5
0016BE 0E05           04668       movlw       opcja_ustaw_temp
0016C0 63E1           04669       cpfseq      numer_opcji
0016C2 EF82 F00B      04670       goto        wykryto_enter_sprawdz_opcje6
                      04671       
                      04672       
                      04673       
                      04674                                           ;movf        jaka_wartosc_regulujeL,w      
                      04675                                           ;movwf       tmp_hex
                      04676                                           ;movf        jaka_wartosc_regulujeH,w
                      04677                                           ;movwf        tmp_hex_H
                      04678                                           ;clrf        dec1
                      04679                                           ;clrf        dec10
                      04680                                           ;call        hex2dec18
                      04681                                           ;call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      04682                                           
0016C6 EC68 F00B      04683       call  wyswietl_temp_w_opcjach
                      04684       
0016CA 8FE0           04685       bsf         pozycja_menu,zmiana_opcji
                      04686       
0016CC EF31 F00C      04687       goto        wykryto_enter_exit
                      04688       
0016D0                04689 wyswietl_temp_w_opcjach      
0016D0 51AE           04690       movf        jaka_wartosc_regulujeL,w
                      04691            ;dziele przez 4
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 109


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0016D2 0D40           04692       mullw       0x40
                      04693       
0016D4 50F3           04694       movf        PRODL,w
0016D6 6F9D           04695       movwf       wynik01
                      04696       
                      04697       ;temperatura jest w bajcie starszym
0016D8 50F4           04698       movf        PRODH,w
0016DA 6F92           04699       movwf       tmp_hex
                      04700       
0016DC 51AD           04701       movf        jaka_wartosc_regulujeH,w
0016DE 6F93           04702       movwf        tmp_hex_H
                      04703       
0016E0 ECEC F001      04704          call     hex2dec18
                      04705          
0016E4 0E1A           04706          movlw       HIGH tablica_gwiazdki
0016E6 6EF7           04707       movwf       TBLPTRH
                      04708       
0016E8 0EA4           04709       movlw       LOW tablica_gwiazdki
0016EA 6EF6           04710       movwf       TBLPTRL
                      04711       
                      04712       ;poniewaz najpierw zmniejszam polozenie
                      04713       
0016EC 51E2           04714       movf       polozenie_gwiazdki,w
                      04715       
0016EE 26F6           04716       addwf       TBLPTRL,f
                      04717       
                      04718       
                      04719       
0016F0 EC32 F001      04720       call        check_busy
                      04721        ;a nastepnie czytam to uzywam polecenia
0016F4 0008           04722       TBLRD *
0016F6 50F5           04723       movf        TABLAT,w
                      04724   ;teraz należy do adresu lini dodać miejsce położenia cyfry 100
                      04725   
                      04726 
0016F8 0F09           04727       addlw       0x09
0016FA ECF4 F000      04728       call        send
                      04729          
0016FE EC59 F005      04730        call     wyswietl_cyfry_temperatury
                      04731       
001702 0012           04732       return
                      04733 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04734       ;wyświetlam obok nazwy opcji czyli 
                      04735       
                      04736       
                      04737       
001704                04738 wykryto_enter_sprawdz_opcje6 
001704 0E06           04739       movlw       opcja_pomiar_i
001706 63E1           04740       cpfseq      numer_opcji
001708 EF8C F00B      04741       goto        wykryto_enter_sprawdz_opcje7
                      04742       
00170C 0E02           04743       movlw       2
00170E 6FD5           04744       movwf       jak_duzo_kanalow_pradu
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 110


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001710 6BD6           04745       clrf        ktory_aktualnie_kanal_pradu
                      04746       
001712 71A1           04747       btg   markers3,pomiary_pradu
                      04748       
                      04749       
001714 EF31 F00C      04750       goto        wykryto_enter_exit
                      04751      
001718                04752 wykryto_enter_sprawdz_opcje7
                      04753 
001718 0E07           04754       movlw       opcja_wlacz_1
00171A 63E1           04755       cpfseq      numer_opcji
00171C EF93 F00B      04756       goto        wykryto_enter_sprawdz_opcje8
                      04757       
001720 7081           04758       btg   port_triak,triak1
                      04759       
                      04760       
                      04761       
001722 EF31 F00C      04762       goto        wykryto_enter_exit
                      04763       
001726                04764 wykryto_enter_sprawdz_opcje8
001726 0E08           04765       movlw       opcja_wlacz_2
001728 63E1           04766       cpfseq      numer_opcji
00172A EF9A F00B      04767       goto        wykryto_enter_sprawdz_opcje9
                      04768       
00172E 7281           04769       btg   port_triak,triak2
                      04770       
                      04771       
                      04772       
001730 EF31 F00C      04773       goto        wykryto_enter_exit
                      04774       
                      04775       
001734                04776 wykryto_enter_sprawdz_opcje9
001734 0E09           04777       movlw       opcja_histereza
001736 63E1           04778       cpfseq      numer_opcji
001738 EFAA F00B      04779       goto        wykryto_enter_sprawdz_opcje10
                      04780       
                      04781       ;wlacz pomiar pradu
                      04782       ;jako test wlacz podswietlenie lub je wylacz
                      04783       
                      04784       ;btg   portlampka2,lampka2
00173C 51E6           04785       movf        histereza,w
00173E 6F92           04786       movwf       tmp_hex
                      04787       
001740 6B93           04788       clrf        tmp_hex_H
001742 6B98           04789       clrf        dec1
001744 6B97           04790       clrf        dec10
001746 ECEC F001      04791       call        hex2dec18
                      04792 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04793       ;wyświetlam obok nazwy opcji czyli 
00174A EC40 F00C      04794       call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      04795       
00174E 8FE0           04796       bsf         pozycja_menu,zmiana_opcji
                      04797       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 111


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001750 EF31 F00C      04798       goto        wykryto_enter_exit
                      04799 
001754                04800 wykryto_enter_sprawdz_opcje10
                      04801 
001754                04802 wykryto_enter_sprawdz_opcje11
001754 0E0B           04803       movlw       opcja_ustaw_zegar
001756 63E1           04804       cpfseq      numer_opcji
001758 EFB5 F00B      04805       goto        wykryto_enter_sprawdz_opcje12
                      04806       ;czyszcze rejestr przechowujący wyświetlaną liczbę
00175C 0ED7           04807       movlw       dzien_10
00175E 6FE7           04808       movwf        ustawianie_czasu_co_wyswietlam
001760 8FE0           04809       bsf         pozycja_menu,zmiana_opcji
                      04810       
001762 EC6D F00C      04811       call        procedura_wyswietlania_kolejnych_liczb_zegara
                      04812       
                      04813       
001766 EF31 F00C      04814       goto        wykryto_enter_exit
                      04815       
00176A                04816 wykryto_enter_sprawdz_opcje12
00176A 0E0C           04817       movlw       opcja_ustaw_serial
00176C 63E1           04818       cpfseq      numer_opcji
00176E EFBC F00B      04819       goto        wykryto_enter_sprawdz_opcje13
                      04820       
001772 799F           04821       btg         markers,czy_wysylac_pomiary_serial      
                      04822       
                      04823            
001774 EF31 F00C      04824       goto        wykryto_enter_exit
                      04825 
                      04826       
001778                04827 wykryto_enter_sprawdz_opcje13      
                      04828 
001778 0E0D           04829       movlw       opcja_wyswietl_zegar
00177A 63E1           04830       cpfseq      numer_opcji
00177C EFC3 F00B      04831       goto        wykryto_enter_sprawdz_opcje14
                      04832       
001780 739E           04833       btg   znaczniki,czy_ponownie_wlaczyc_zegar
                      04834       
001782 EF31 F00C      04835       goto        wykryto_enter_exit
                      04836       
001786                04837 wykryto_enter_sprawdz_opcje14
                      04838 
001786 0E0E           04839       movlw       opcja_wyswietl_temp
001788 63E1           04840       cpfseq      numer_opcji
00178A EFCA F00B      04841       goto        wykryto_enter_sprawdz_opcje15
                      04842       
00178E 719E           04843       btg   znaczniki,czy_ponownie_wlaczyc_temp
                      04844       
001790 EF31 F00C      04845       goto        wykryto_enter_exit
                      04846 
001794                04847 wykryto_enter_sprawdz_opcje15
                      04848 
001794 0E0F           04849       movlw       opcja_podswietlenie
001796 63E1           04850       cpfseq      numer_opcji
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 112


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001798 EFD1 F00B      04851       goto        wykryto_enter_sprawdz_opcje16
                      04852       
00179C 7881           04853       btg   portlampka2,lampka2
                      04854       
00179E EF31 F00C      04855       goto        wykryto_enter_exit
                      04856 
                      04857       
0017A2                04858 wykryto_enter_sprawdz_opcje16  
0017A2 0E10           04859       movlw       opcja_czujnik_regulacji
0017A4 63E1           04860       cpfseq      numer_opcji
0017A6 EFE1 F00B      04861       goto        wykryto_enter_sprawdz_opcje17
                      04862       
                      04863       ;wlacz pomiar pradu
                      04864       ;jako test wlacz podswietlenie lub je wylacz
                      04865       
                      04866       ;btg   portlampka2,lampka2
0017AA 5010           04867       movf        opcja_czujnik_regulacji ,w
0017AC 6F92           04868       movwf       tmp_hex
                      04869       
0017AE 6B93           04870       clrf        tmp_hex_H
0017B0 6B98           04871       clrf        dec1
0017B2 6B97           04872       clrf        dec10
0017B4 ECEC F001      04873       call        hex2dec18
                      04874 ;czyli zawartość rejestru jest zamieniana na postać dziesiętną i przenoszonona do dec100 dec10 dec1
                      04875       ;wyświetlam obok nazwy opcji czyli 
0017B8 EC40 F00C      04876       call        wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      04877       
0017BC 8FE0           04878       bsf         pozycja_menu,zmiana_opcji
                      04879       
0017BE EF31 F00C      04880       goto        wykryto_enter_exit
                      04881       
0017C2                04882 wykryto_enter_sprawdz_opcje17      
0017C2 EF31 F00C      04883       goto        wykryto_enter_exit
                      04884       
0017C6                04885 wykryto_enter_zmiana_opcji
0017C6 0E01           04886       movlw       opcja_czujniki
0017C8 63E1           04887       cpfseq      numer_opcji
0017CA EFF5 F00B      04888       goto          wykryto_enter_wyjscie_opcje2
                      04889       
                      04890       
0017CE EC60 F00C      04891       call     enter_back_wyjsc_z_opcji_czujniki
                      04892       
                      04893       ;jeżeli zmieniam ilość obsługiwanych czujników temp
                      04894       ;to tu powinno być wyjście z opcji włączania czujników
                      04895       ;czyli jeżeli ile_kanalow > 0 to włącz pomiary
                      04896       
0017D2 51A5           04897       movf         ile_kanalow,w
0017D4 E046           04898       bz          wykryto_enter_exit
                      04899       
                      04900       
0017D6 6FA6           04901       movwf    ktory_kanal_mierze
                      04902       
                      04903       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 113


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0017D8 51A7           04904       movf    odstep_pomiarowy,w
                      04905       
0017DA 6FA8           04906       movwf    aktualny_odstep
                      04907       
                      04908       
0017DC 85A0           04909       bsf      markers2,pomiary
0017DE 859F           04910       bsf      markers,pomiary_zrobione
0017E0 819F           04911       bsf       markers,czy_usrednianie
                      04912       ;włączyć trzeba moduł A/D
0017E2 0E01           04913       movlw    b'00000001'
0017E4 6EC2           04914       movwf    ADCON0
                      04915       ;bsf      markers,czy_wyswietlam_temp
0017E6 EF31 F00C      04916       goto        wykryto_enter_exit
                      04917             
                      04918       
0017EA                04919 wykryto_enter_wyjscie_opcje2
                      04920 ;opcja z liczbą      
0017EA 0E02           04921       movlw       opcja_odstep
0017EC 63E1           04922       cpfseq      numer_opcji
0017EE EFFD F00B      04923       goto          wykryto_enter_wyjscie_opcje3
0017F2 EC9C F00C      04924       call  enter_back_wyjsc_z_opcji_wyswietlanie_liczby
                      04925       
                      04926       ;call  wykryto_enter_back_wyjsc_z_opcji_skasuj_liczbe
                      04927       
                      04928       
                      04929       
0017F6 EF31 F00C      04930       goto        wykryto_enter_exit
                      04931       
0017FA                04932 wykryto_enter_wyjscie_opcje3
                      04933       
0017FA 0E03           04934       movlw       opcja_srednia
0017FC 63E1           04935       cpfseq      numer_opcji
0017FE EF05 F00C      04936       goto          wykryto_enter_wyjscie_opcje4
001802 EC9C F00C      04937       call  enter_back_wyjsc_z_opcji_wyswietlanie_liczby
                      04938       
                      04939      ; bcf        pozycja_menu,zmiana_opcji
                      04940       
001806 EF31 F00C      04941       goto        wykryto_enter_exit
                      04942       
                      04943 
00180A                04944 wykryto_enter_wyjscie_opcje4
                      04945 
00180A                04946 wykryto_enter_wyjscie_opcje5
                      04947 
00180A 0E05           04948       movlw       opcja_ustaw_temp
00180C 63E1           04949       cpfseq      numer_opcji
00180E EF0D F00C      04950       goto          wykryto_enter_wyjscie_opcje6
001812 EC9C F00C      04951       call  enter_back_wyjsc_z_opcji_wyswietlanie_liczby
                      04952       
                      04953       ;bcf        pozycja_menu,zmiana_opcji
                      04954       
001816 EF31 F00C      04955       goto        wykryto_enter_exit
                      04956       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 114


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00181A                04957 wykryto_enter_wyjscie_opcje6
                      04958 
00181A                04959 wykryto_enter_wyjscie_opcje9
                      04960 
00181A 0E09           04961       movlw       opcja_histereza
00181C 63E1           04962       cpfseq      numer_opcji
00181E EF15 F00C      04963       goto          wykryto_enter_wyjscie_opcje10
001822 EC9C F00C      04964       call  enter_back_wyjsc_z_opcji_wyswietlanie_liczby
                      04965       
                      04966       ;bcf        pozycja_menu,zmiana_opcji
                      04967       
001826 EF31 F00C      04968       goto        wykryto_enter_exit
                      04969 
                      04970 
00182A                04971 wykryto_enter_wyjscie_opcje10
                      04972 
00182A                04973 wykryto_enter_wyjscie_opcje11
00182A 0E0B           04974       movlw       opcja_ustaw_zegar
00182C 63E1           04975       cpfseq      numer_opcji
00182E EF29 F00C      04976       goto        wykryto_enter_wyjscie_opcje12
                      04977 
001832 0EDD           04978       movlw       sekundy_10
001834 63E7           04979       cpfseq      ustawianie_czasu_co_wyswietlam
001836 EF21 F00C      04980       goto        wykryto_enter_wyjscie_opcje11_2
                      04981       ;jezeli jest w tej chwili sekundy_10 tzn ze wychodze z wyswietlania ustawien zegara
                      04982             
00183A EC9C F00C      04983       call  enter_back_wyjsc_z_opcji_wyswietlanie_liczby
                      04984       
                      04985       ;bcf        pozycja_menu,zmiana_opcji
                      04986       
00183E EF31 F00C      04987       goto        wykryto_enter_exit
                      04988       
                      04989       
001842                04990 wykryto_enter_wyjscie_opcje11_2
001842 0E02           04991       movlw       2
001844 27E7           04992       addwf       ustawianie_czasu_co_wyswietlam,f
001846 EC6D F00C      04993       call        procedura_wyswietlania_kolejnych_liczb_zegara
00184A EF31 F00C      04994       goto        wykryto_enter_exit
                      04995       
                      04996 
00184E EF31 F00C      04997       goto        wykryto_enter_exit
                      04998       
001852                04999 wykryto_enter_wyjscie_opcje12      
                      05000 
001852                05001 wykryto_enter_wyjscie_opcje16
001852 0E10           05002       movlw       opcja_czujnik_regulacji
001854 63E1           05003       cpfseq      numer_opcji
001856 EF31 F00C      05004       goto          wykryto_enter_wyjscie_opcje17
00185A EC9C F00C      05005       call  enter_back_wyjsc_z_opcji_wyswietlanie_liczby
                      05006       
                      05007       ;bcf        pozycja_menu,zmiana_opcji
                      05008       
00185E EF31 F00C      05009       goto        wykryto_enter_exit
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 115


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001862                05010 wykryto_enter_wyjscie_opcje17
                      05011 
                      05012 ;             
                      05013 ;       call     check_busy
                      05014 ;       movlw    linia_czwarta
                      05015 ;       call      send
                      05016 ;         
                      05017 ;       call     check_busy
                      05018 ; ;czy gasze czy wyswietlam      
                      05019 ;       btfsc       markers,test
                      05020 ;       goto        zamaz_E
                      05021 ; napisz_E
                      05022 ;       bsf   markers,test
                      05023 ;       movlw       _E
                      05024 ;       goto  wykryto_back_pisz
                      05025 ; zamaz_E
                      05026 ;       bcf   markers,test
                      05027 ;       movlw       _puste
                      05028 ;       
                      05029 ; wykryto_enter_pisz
                      05030 ;       call     write_lcd
                      05031       
                      05032       
                      05033       
001862                05034 wykryto_enter_exit 
001862 9BA1           05035       bcf   markers3,dzialanie_po_klawiszu
001864 6B99           05036       clrf  stan_key
001866 EF70 F00D      05037       goto  LOOP11
                      05038  
                      05039 ;wykryto_enter_back_wyjsc_z_opcji_skasuj_liczbe
                      05040 ;odczytaj_polozenie_gwiazdki_wybierz_linie
                      05041  
Warning[208]: Label truncated at 32 characters. (odczytaj_adres_polozenia_gwiazdki)
00186A                05042 odczytaj_adres_polozenia_gwiazdki
00186A 0E1A           05043       movlw       HIGH tablica_gwiazdki
00186C 6EF7           05044       movwf       TBLPTRH
                      05045       
00186E 0EA4           05046       movlw       LOW tablica_gwiazdki
001870 6EF6           05047       movwf       TBLPTRL
                      05048       
                      05049       ;poniewaz najpierw zmniejszam polozenie
                      05050       
001872 51E2           05051       movf       polozenie_gwiazdki,w
                      05052       
001874 26F6           05053       addwf       TBLPTRL,f
                      05054       
                      05055       
                      05056       
001876 EC32 F001      05057       call        check_busy
                      05058        ;a nastepnie czytam to uzywam polecenia
00187A 0008           05059       TBLRD *
00187C 50F5           05060       movf        TABLAT,w
                      05061 ;na zakończenie procedury adres linii z gwiazdką jest umieszczany w rejestrze W
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 116


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00187E 0012           05062       return
                      05063       
                      05064       
Warning[208]: Label truncated at 32 characters. (wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa)
001880                05065 wykryto_enter_gdzie_wyswietlam_liczbe_bajtowa
                      05066 ;aby liczba wyświetlana znalazła się obok swojej opcji w menu, należy wcześniej odczytać aktualne 
                            położenie gwiazdki
                      05067 ;z tablicy
                      05068 ;dzięki temu uniknięte zostanie wielokrotne powtarzanie procedur wyświetlania liczb w zależności od
                             opcji przy której umieszczona ma być wartośc liczby
                      05069 ;poza tym w wypadku zmiany położenia opcji w tablicy opcji menu ( z linii 2 na 3) to zmiana nastąpi a
                            utomatycznie
                      05070 ;gdyż to położenie gwiazdki decyduje o położeniu cyfr
001880 0E1A           05071       movlw       HIGH tablica_gwiazdki
001882 6EF7           05072       movwf       TBLPTRH
                      05073       
001884 0EA4           05074       movlw       LOW tablica_gwiazdki
001886 6EF6           05075       movwf       TBLPTRL
                      05076       
                      05077       ;poniewaz najpierw zmniejszam polozenie
                      05078       
001888 51E2           05079       movf       polozenie_gwiazdki,w
                      05080       
00188A 26F6           05081       addwf       TBLPTRL,f
                      05082       
                      05083       
                      05084       
00188C EC32 F001      05085       call        check_busy
                      05086        ;a nastepnie czytam to uzywam polecenia
001890 0008           05087       TBLRD *
001892 50F5           05088       movf        TABLAT,w
                      05089   ;teraz należy do adresu lini dodać miejsce położenia cyfry 100
                      05090   
                      05091 
001894 0F0D           05092       addlw       0x0d       
001896 ECF4 F000      05093       call        send
00189A EC32 F001      05094       call        check_busy
                      05095  
                      05096  ;i wyswietlic wszystkie cyfry
00189E 5196           05097       movf        dec100,w
0018A0 0F30           05098       addlw       0x30
0018A2 EC05 F001      05099       call        write_lcd      
0018A6 EC32 F001      05100       call        check_busy
                      05101       
0018AA 5197           05102       movf        dec10,w      
0018AC 0F30           05103       addlw       0x30
0018AE EC05 F001      05104       call        write_lcd      
                      05105       
0018B2 EC32 F001      05106       call        check_busy
0018B6 5198           05107       movf        dec1,w
0018B8 0F30           05108       addlw       0x30
0018BA EC05 F001      05109       call        write_lcd      
                      05110       
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 117


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0018BE 0012           05111       return
                      05112       
                      05113  
Warning[208]: Label truncated at 32 characters. (enter_back_wyjsc_z_opcji_czujniki)
0018C0                05114 enter_back_wyjsc_z_opcji_czujniki
                      05115       ;czysc ustawienia opcji i zgas bit zmiana_opcji
                      05116        
0018C0 9FE0           05117        bcf        pozycja_menu,zmiana_opcji
0018C2 EC32 F001      05118        call     check_busy
0018C6 0E80           05119       movlw    linia_gorna
0018C8 0F0C           05120       addlw       0xc
0018CA ECF4 F000      05121       call      send
                      05122       ;
                      05123       
0018CE EC32 F001      05124       call     check_busy
0018D2 0E20           05125       movlw       _puste
0018D4 EC05 F001      05126       call        write_lcd
                      05127       
0018D8 0012           05128       return
                      05129        
Warning[208]: Label truncated at 32 characters. (procedura_wyswietlania_kolejnych_liczb_zegara)
0018DA                05130 procedura_wyswietlania_kolejnych_liczb_zegara
0018DA EC35 F00C      05131       call  odczytaj_adres_polozenia_gwiazdki
0018DE 0F0C           05132       addlw       0x0c
0018E0 ECF4 F000      05133       call        send
                      05134       
0018E4 EC32 F001      05135       call        check_busy
                      05136       
                      05137 ;która litera jest wyświetlana obok cyfr = D - day, H - hours, M - minute, S- seconds      
0018E8 0ED7           05138       movlw       dzien_10
0018EA 63E7           05139       cpfseq      ustawianie_czasu_co_wyswietlam
0018EC EF6D F00C      05140       goto        procedura_wyswietlania_kolejnych_liczb_zegara_1
0018F0 0E44           05141       movlw       _D
0018F2 EF6D F00C      05142       goto        procedura_wyswietlania_kolejnych_liczb_zegara_4
                      05143       
Warning[208]: Label truncated at 32 characters. (procedura_wyswietlania_kolejnych_liczb_zegara_1)
Error[116]  : Address label duplicated or different in second pass (procedura_wyswietlania_kolejnych)
0018F6                05144 procedura_wyswietlania_kolejnych_liczb_zegara_1
0018F6 0ED9           05145       movlw       godziny_10
0018F8 63E7           05146       cpfseq      ustawianie_czasu_co_wyswietlam
0018FA EF6D F00C      05147       goto        procedura_wyswietlania_kolejnych_liczb_zegara_2
0018FE 0E48           05148       movlw       _H
                      05149       
Warning[208]: Label truncated at 32 characters. (procedura_wyswietlania_kolejnych_liczb_zegara_2)
Error[116]  : Address label duplicated or different in second pass (procedura_wyswietlania_kolejnych)
001900                05150 procedura_wyswietlania_kolejnych_liczb_zegara_2
001900 0EDB           05151       movlw       minuty_10
001902 63E7           05152       cpfseq      ustawianie_czasu_co_wyswietlam
001904 EF6D F00C      05153       goto        procedura_wyswietlania_kolejnych_liczb_zegara_3
001908 0E4D           05154       movlw       _M
00190A EF6D F00C      05155       goto        procedura_wyswietlania_kolejnych_liczb_zegara_4
                      05156       
Warning[208]: Label truncated at 32 characters. (procedura_wyswietlania_kolejnych_liczb_zegara_3)
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 118


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Error[116]  : Address label duplicated or different in second pass (procedura_wyswietlania_kolejnych)
00190E                05157 procedura_wyswietlania_kolejnych_liczb_zegara_3     
                      05158       ; movlw       sekundy_10
                      05159       ; cpfseq      ustawianie_czasu_co_wyswietlam
                      05160       ; goto        procedura_wyswietlania_kolejnych_liczb_zegara_1
00190E 0E53           05161       movlw       _S
                      05162       
Warning[208]: Label truncated at 32 characters. (procedura_wyswietlania_kolejnych_liczb_zegara_4)
Error[116]  : Address label duplicated or different in second pass (procedura_wyswietlania_kolejnych)
001910                05163 procedura_wyswietlania_kolejnych_liczb_zegara_4            
                      05164       
001910 EC05 F001      05165       call        write_lcd
                      05166       
001914 6ADA           05167       clrf        FSR2H
001916 51E7           05168       movf        ustawianie_czasu_co_wyswietlam,w
001918 6ED9           05169       movwf      FSR2L      
                      05170       
00191A EC32 F001      05171       call        check_busy
00191E 50DF           05172       movf        INDF2,w      
001920 EC05 F001      05173       call        write_lcd
                      05174       
001924 EC32 F001      05175       call        check_busy
                      05176       
001928 2AD9           05177       incf        FSR2L,f
00192A 50DF           05178       movf        INDF2,w      
00192C EC05 F001      05179       call        write_lcd
                      05180       
001930 EC32 F001      05181       call        check_busy
                      05182       
001934 2AD9           05183       incf        FSR2L,f       
                      05184        
001936 0012           05185       return
                      05186 
                      05187       
Warning[208]: Label truncated at 32 characters. (enter_back_wyjsc_z_opcji_wyswietlanie_liczby)
001938                05188 enter_back_wyjsc_z_opcji_wyswietlanie_liczby
                      05189 ;procedrura analogiczna to tej związanej z obsługą wyświetlania rejestru
001938 0E1A           05190       movlw       HIGH tablica_gwiazdki
00193A 6EF7           05191       movwf       TBLPTRH
                      05192       
00193C 0EA4           05193       movlw       LOW tablica_gwiazdki
00193E 6EF6           05194       movwf       TBLPTRL
                      05195       
                      05196       ;poniewaz najpierw zmniejszam polozenie
                      05197       
001940 51E2           05198       movf       polozenie_gwiazdki,w
                      05199       
001942 26F6           05200       addwf       TBLPTRL,f
                      05201       
                      05202        ;a nastepnie czytam to uzywam polecenia
001944 0008           05203       TBLRD *
                      05204       
001946 EC32 F001      05205       call        check_busy
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 119


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05206       
00194A 50F5           05207       movf        TABLAT,w
                      05208 ;teraz należy do adresu lini dodać miejsce położenia cyfry 100
00194C 0F0B           05209       addlw       0x0b 
00194E ECF4 F000      05210       call        send
                      05211       
001952 EC32 F001      05212       call        check_busy       
001956 0E20           05213       movlw       _puste
001958 EC05 F001      05214       call        write_lcd      
00195C EC32 F001      05215       call        check_busy
001960 0E20           05216       movlw       _puste
001962 EC05 F001      05217       call        write_lcd      
001966 EC32 F001      05218       call        check_busy
00196A 0E20           05219       movlw       _puste
00196C EC05 F001      05220       call        write_lcd      
001970 EC32 F001      05221       call        check_busy       
001974 0E20           05222       movlw       _puste
001976 EC05 F001      05223       call        write_lcd      
00197A EC32 F001      05224       call        check_busy
00197E 0E20           05225       movlw       _puste
001980 EC05 F001      05226       call        write_lcd 
001984 9FE0           05227       bcf        pozycja_menu,zmiana_opcji
                      05228       
001986 0012           05229       return
                      05230 ;menu wyswietlane w ten sposob, ze na jednym ekranie umieszczone sa cztery opcje
                      05231 ;a do kazdej linii odnosi sie zwiazana z nia tablica nazw opcji
                      05232 ;przy przejsciu do kolejnego ekranu opcji nastepuje zmiana tych opcji na kolejne
001A00                05233       org         1a00h
001A00                05234 tablica_pierwsza
001A00 6F70 696D 7261 05235       db   "pomiar t",0,"odstep",0,"srednia",0,"regulacja",0
       7420 6F00 7364 
       6574 0070 7273 
       6465 696E 0061 
       6572 7567 616C 
       6A63 0061 
                      05236       
001A22                05237 tablica_druga
001A22 7375 6174 2077 05238       db    "ustaw t",0,"pomiar i" ,0, "wlacz1" ,0, "wlacz2" ,0
       0074 6F70 696D 
       7261 6920 7700 
       616C 7A63 0031 
       6C77 6361 327A 
       0000 
001A42                05239 tablica_trzecia
001A42 6968 7473 7265 05240       db     "histereza",0,"ustaw moc",0,"zegar",0,"przesyl serial",0
       7A65 0061 7375 
       6174 2077 6F6D 
       0063 657A 6167 
       0072 7270 657A 
       7973 206C 6573 
       6972 6C61 0000 
                      05241 
001A6C                05242 tablica_czwarta
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 120


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001A6C 7977 7773 6569 05243       db     "wyswietl. zegar",0,"wyswietl. temp",0,"podswietlenie",0,"czuj. reg",0      
       6C74 202E 657A 
       6167 0072 7977 
       7773 6569 6C74 
       202E 6574 706D 
       7000 646F 7773 
       6569 6C74 6E65 
       6569 6300 757A 
       2E6A 7220 6765 
       0000 
                      05244 ;####################  TABLICA POLOZEN gwiazdki
                      05245 
001AA4                05246 tablica_gwiazdki        
001AA4 8000 90C0 01D0 05247       db    0,linia_gorna,linia_dolna,linia_trzecia,linia_czwarta,1
                      05248       
                      05249       
                      05250  
                      05251     
001AAA                05252 LOOP
                      05253 
001AAA ABA1           05254       btfss       markers3,dzialanie_po_klawiszu
001AAC EF64 F00D      05255       goto        LOOP_sprawdz_keys        
                      05256 
                      05257 
                      05258       
001AB0 B199           05259       btfsc   stan_key,latch_back
001AB2 EFBC F007      05260       goto    wykryto_back
                      05261                   
001AB6 B399           05262       btfsc    stan_key,latch_down
001AB8 EFCF F007      05263       goto     wykryto_down
                      05264                            
001ABC B599           05265       btfsc    stan_key,latch_up
001ABE EF36 F009      05266       goto     wykryto_up
                      05267          
001AC2 B799           05268       btfsc    stan_key,latch_enter
001AC4 EFFF F00A      05269       goto     wykryto_enter 
                      05270       
                      05271 ;jeżeli zaznaczono że należy zmieniać już wartości to sprawdź które klawisze i które procedury 
                            wywołuję      
                      05272 ;      btfss       znaczniki,czy_moge_juz_zmieniac
                      05273  ;     goto        
                      05274       
                      05275       
                      05276       
001AC8                05277 LOOP_sprawdz_keys
001AC8 A083           05278       btfss   latch_keys,latch_back
001ACA EC83 F007      05279       call    wcisnieto_back
                      05280                   
001ACE A283           05281       btfss    latch_keys,latch_down
001AD0 EC8A F007      05282       call     wcisnieto_down
                      05283                            
001AD4 A483           05284       btfss    latch_keys,latch_up
001AD6 EC96 F007      05285       call     wcisnieto_up
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 121


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05286          
001ADA A683           05287       btfss    latch_keys,latch_enter
001ADC ECB5 F007      05288       call     wcisnieto_enter
                      05289 
001AE0                05290 LOOP11      
001AE0 B7A1           05291       btfsc markers3,odswiezanie_zegara
001AE2 EF1F F002      05292       goto  napisz_czas
                      05293       
001AE6                05294 LOOP_temperatury      
                      05295 ;jezeli jest ustawiony bit pomiary to sprawdz 
001AE6 A5A0           05296          btfss    markers2,pomiary
001AE8 EF82 F00D      05297          goto     LOOP1
                      05298 
                      05299          
                      05300 ;jezeli ustawiony jest bit czy_wlaczyc_ponownie_temp to nawet nie sprawdzaj
001AEC B7A1           05301             btfsc      markers3,odswiezanie_zegara
001AEE EF82 F00D      05302             goto        LOOP1   
                      05303          
001AF2 B59F           05304          btfsc    markers,pomiary_zrobione
001AF4 EF82 F00D      05305          goto     LOOP1
                      05306          
001AF8 B79F           05307          btfsc    markers,inicjuj_pomiary
001AFA EC65 F002      05308          call     rozpocznij_pomiary
                      05309                   
001AFE B9A0           05310          btfsc    markers2,wyslij_pomiar
001B00 ECF7 F005      05311          call     wysylanie_pomiaru
001B04                05312 LOOP1         
001B04 B3A0           05313          btfsc    markers2,przerwanie_t1
001B06 EC79 F002      05314          call     procedura_obslugi_zegara
                      05315          
001B0A B7A0           05316          btfsc    markers2,sprawdz_odebrane
001B0C ECDC F004      05317          call     sprawdz_czy_polecenie
                      05318 
                      05319 
                      05320 ;          btfsc    markers2,wyswietl
                      05321 ;          call     wyswietl_litere
                      05322                   
                      05323 ;        btfsc    markers2,blad_transmisji
                      05324 ;        call     wyswietl_error
                      05325          
                      05326          
                      05327          
                      05328 ;        btfsc    markers2,poczatkowy_bit
                      05329 ;        call     poczatek_odbioru
                      05330          
001B10                05331 LOOP2    
                      05332          
                      05333 
001B10 EF55 F00D      05334          goto     LOOP
                      05335          
                      05336 
                      05337 
                      05338          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 122


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05339 ; org    800h
                      05340 ;ta funkcja zlicza nacisniecia klawisza rb0ółńżą
                      05341 ;funkcja odczekuj?ca
                      05342 
                      05343 
                      05344 
                      05345          
                      05346 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      05347 
                      05348 ;POCZATEK
                      05349 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;       
                      05350          ;org      0800h    
                      05351 
                      05352 
                      05353                 
001B14                05354 inicjacja
                      05355          ;ulamek 0,25 - tzn 1 
                      05356           ;movlw    0x0
                      05357           ;movlw   numer_opcji_koncowej
                      05358           ;movwf   
                      05359           ;movwf    tmp
                      05360           ;decf    tmp,f
                      05361           ;bsf   tmp,(menu_opcje_end)
                      05362           ;btfss   STATUS,C
                      05363           ;incf    tmp,f
                      05364 ;          
                      05365 ;          addlw    0xc3
                      05366          ;movwf    tmp7
                      05367          ;mnoze 2,5 * 0x30 tzn 
                      05368          ;movlw    0x30
                      05369          ;ulamek
                      05370          ;mulwf    tmp
                      05371          ;movf     PRODH,w
                      05372          ;movwf    dec10
                      05373          ;movf    PRODL,w
                      05374          ;movwf    dec1
                      05375          
                      05376          ;movlw    0x30
                      05377          
                      05378          
                      05379          ;mulwf    tmp7
                      05380          
                      05381          
001B14 6AD8           05382          clrf    STATUS ;czyszcze status
                      05383          ;movlw    
                      05384          ;clrf    czas;
001B16 6A80           05385          clrf     PORTA
001B18 6A81           05386          clrf     PORTB
001B1A 6A82           05387          clrf     PORTC
001B1C 6A83           05388           clrf     PORTD
001B1E 6A84           05389          clrf     PORTE
001B20 6A89           05390          clrf     LATA
001B22 6A8A           05391          clrf     LATB
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 123


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001B24 6A8B           05392          clrf     LATC
001B26 6A8C           05393          clrf     LATD
001B28 6A8D           05394          clrf     LATE
                      05395 ;przerwania kompatybilne z 16fxx
001B2A 8ED0           05396          bsf      RCON,IPEN         
                      05397          
                      05398 ;ustawiam TMR1
                      05399                                     ;Timer 1 ustawiony jako 1/16 sekundy
001B2C 0E01           05400          movlw    b'00000001'
001B2E 6ECD           05401          movwf    T1CON
                      05402 ;pzrerwania
001B30 6AF2           05403          clrf     INTCON
001B32 8EF2           05404          bsf      INTCON,GIE
001B34 8CF2           05405          bsf      INTCON,PEIE
                      05406          
                      05407          
001B36 6AF0           05408          clrf     INTCON3
001B38 0E80           05409          movlw    b'10000000'
001B3A 6EF1           05410          movwf    INTCON2
001B3C 9AF2           05411          bcf     INTCON,TMR0IE
001B3E 9896           05412          bcf      TRISE,PSPMODE
001B40 9AC6           05413          bcf      SSPCON1,SSPEN
001B42 9EAB           05414          BCF      RCSTA,SPEN
                      05415          
                      05416          ;ustawienia comparatora
001B44 0E00           05417          movlw    b'00000000'
001B46 6EB5           05418          movwf    CVRCON
                      05419          ;komparator wylaczony
001B48 0E07           05420          movlw    b'00000111'
001B4A 6EB4           05421          movwf    CMCON
                      05422          ;movlw   b'00000000'       ;wszystkie linie na wysoko
                      05423          ;ovwf    PORTB
                      05424          
001B4C                05425 CCP_init         
001B4C 0E00           05426          movlw    0
001B4E 6EBD           05427          movwf    CCP1CON
001B50 6EBA           05428          movwf    CCP2CON
                      05429          ;BCF     
001B52 6ACC           05430          clrf     TMR2
                      05431          
001B54                05432 Timer3_init                                                 ;ustawienie zegara tmr3
001B54 0E61           05433             movlw       b'01100001'
001B56 6EB1           05434             movwf       T3CON
                      05435          
                      05436          
001B58                05437 BEGIN2lcd_init
                      05438          ;bsf      STATUS,RP0        ;bank 1
001B58 6A9D           05439          clrf     PIE1
001B5A 6AA0           05440          clrf     PIE2
001B5C 809D           05441          bsf      PIE1,TMR1IE
                      05442          
                      05443      ;ustawiam na wyjscia 1 -wejscie
                      05444         ;movlw   b'11111111'
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 124


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05445          
001B5E 0E3F           05446          movlw    b'00111111'
001B60 6E92           05447          movwf    TRISA
                      05448          
Warning[205]: Found directive in column 1. (IF)
                      05449 IF (czy_ekran==1)
001B62 0EE0           05450          movlw   b'11100000'
001B64 6E93           05451          movwf    TRISB
Warning[205]: Found directive in column 1. (ENDIF)
                      05452 ENDIF
                      05453 
Warning[205]: Found directive in column 1. (IF)
                      05454 IF (czy_ekran==0)
                      05455          movlw   b'11111111'
                      05456          movwf    TRISB
                      05457 ENDIF
                      05458 
001B66 0EA0           05459         movlw   b'10100000'
001B68 6E94           05460          movwf    TRISC
                      05461          
                      05462 ;tu sie zminienia dla kabli
                      05463         ;movlw   b'11111111'
Warning[205]: Found directive in column 1. (IF)
                      05464 IF (czy_ekran==1)        
001B6A 0E0F           05465          movlw    normalne_ustawienie_tris_lcd
001B6C 6E95           05466          movwf    TRISD
Warning[205]: Found directive in column 1. (ENDIF)
                      05467 ENDIF
                      05468          
Warning[205]: Found directive in column 1. (IF)
                      05469 IF (czy_ekran==0)
                      05470          movlw    0x0F
                      05471          movwf    TRISD
                      05472 ENDIF
                      05473          
001B6E 0E07           05474          movlw   b'00000111'
001B70 6E96           05475          movwf    TRISE
                      05476          
                      05477          
                      05478 ;ustawienia timera 0
001B72 0EC7           05479          movlw    b'11000111'
001B74 6ED5           05480          movwf    T0CON
                      05481  ;dopiero teraz w??cz zegar
                      05482          
                      05483 
                      05484 
                      05485 ;90  czyli 5a
                      05486 ;50      32
                      05487 ;210(200us) d2
                      05488 ;196(190us) c4    
                      05489 ;        movlw    b'11010010'
001B76 0E80           05490          movlw    0x80
001B78 6ECB           05491          movwf    PR2
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 125


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05492          
                      05493 ;bank 0
                      05494          ;bcf      STATUS,RP0
                      05495 ;        movlw    b'01000000'
                      05496 ;        movwf    ADCON0
                      05497          
                      05498 ;ustawiam TMR2 z licznikiem 1:1
                      05499          
                      05500 ;wyczyscic trzeba pamiec na zmienne
                      05501 ;jezeli tego nie zrobie to
                      05502 ;po wlaczeniu zasilani moga pojawic
                      05503 ; sie problemy bo moga tam byc losowe dane
                      05504 ;od 000 do f7f
001B7A 0E80           05505          movlw    0x80
001B7C 6EE9           05506          movwf    FSR0L
001B7E 6AEA           05507          clrf     FSR0H
001B80                05508 next
                      05509          ;movlw   0
001B80 6AEF           05510          clrf     INDF0
001B82 2AE9           05511          INCF     FSR0L,f
                      05512          ;movlw    0ffh
                      05513          
001B84 A0D8           05514          btfss    STATUS,C
001B86 EFC0 F00D      05515          goto     next
                      05516          
001B8A 2AEA           05517          incf     FSR0H,f
001B8C 0E02           05518          movlw    b'00000010' ;02 banki
001B8E 18EA           05519          xorwf    FSR0H,w
001B90 A4D8           05520          BTFSS    STATUS,Z
                      05521          ;btfss    FSR0H,4
001B92 EFC0 F00D      05522          goto     next
                      05523          
001B96 EF00 F00E      05524          goto     test_koniec
                      05525 ;w przyadku testowania
                      05526 
001B9A 0E00           05527          movlw    dane_odebraneL
001B9C 6EE9           05528          movwf    FSR0L
001B9E 0E01           05529          movlw    dane_odebraneH
001BA0 6EEA           05530          movwf    FSR0H
                      05531          
                      05532         
001BA2 0E1B           05533         movlw      HIGH(tab_test)
001BA4 6EFA           05534         movwf     PCLATH
001BA6                05535 test_petla        
                      05536          
                      05537          
                      05538         
                      05539         ;movf      PCLATH,w,0
001BA6 5191           05540          movf     tmp,w
001BA8 ECE0 F00D      05541          call     tab_test
                      05542          
                      05543          
                      05544          
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 126


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001BAC 6EEF           05545          movwf    INDF0
001BAE 0A00           05546          xorlw    0
001BB0 B4D8           05547          btfsc    STATUS,Z
001BB2 EFE8 F00D      05548          goto     test_regulator
001BB6 2B91           05549          incf     tmp,f
001BB8 2B91           05550          incf     tmp,f
001BBA 2AE9           05551          incf     FSR0L,f
001BBC EFD3 F00D      05552          goto     test_petla
                      05553          
                      05554          
001BC0                05555 tab_test
001BC0 26F9           05556          addwf    PCL,f
                      05557          ;retlw    0x2a
                      05558          
                      05559          ;retlw    0x43
                      05560          ;retlw    0x46
                      05561          ;retlw    0x0d
001BC2 0C2A           05562          retlw    _star
                      05563          ;retlw    _wiekszosci
                      05564          ;retlw    _P     
001BC4 0C70           05565          retlw    _p
                      05566          ;retlw    _1
                      05567          
001BC6 0C30           05568          retlw    0x30
                      05569          ;retlw    _
                      05570          
                      05571          ;retlw    _F
                      05572          ;retlw    _
                      05573          ;retlw    _F
001BC8 0C32           05574          retlw    0x32
                      05575          ;retlw    _kropka
001BCA 0C30           05576          retlw    0x30
001BCC 0C36           05577          retlw    0x36
                      05578          ;retlw    _e
                      05579          ;retlw    0x34
                      05580          ;retlw    0x30
                      05581          ;retlw    _A
                      05582          ;retlw    0x30
                      05583          ;retlw    0x37
001BCE 0C00           05584          retlw    0
                      05585          
                      05586          
001BD0                05587 test_regulator
                      05588       ;bsf      markers2,sprawdz_odebrane
                      05589          ;goto     test_koniec
                      05590          
001BD0 0E01           05591          movlw    1
001BD2 6FA5           05592          movwf    ile_kanalow
                      05593          
001BD4 0E00           05594          movlw    0
001BD6 6FA6           05595          movwf    ktory_kanal_mierze
                      05596          
                      05597          ;movwf     ktore_dzielenie_przez2
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 127


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05598          
001BD8 0E01           05599          movlw    0x01
001BDA 6FAF           05600          movwf    jak_duzo_probek
                      05601          
001BDC 0E04           05602          movlw    0x04
001BDE 6FA7           05603          movwf    odstep_pomiarowy
001BE0 0E04           05604          movlw    0x04
001BE2 6FA8           05605         movwf    aktualny_odstep
                      05606          
                      05607          
001BE4 819F           05608          bsf       markers,czy_usrednianie
001BE6 85A0           05609          bsf      markers2,pomiary
001BE8 859F           05610          bsf      markers,pomiary_zrobione
001BEA 8B9F           05611          bsf      markers,czy_wyswietlam_temp
                      05612          ;
001BEC 0E01           05613          movlw    0x01
001BEE 6EC2           05614          movwf    ADCON0   
                      05615                
001BF0 0E0F           05616          movlw    0xf
001BF2 6F8D           05617          movwf    odebrano_liter
001BF4 0EFF           05618          movlw    0xff
001BF6 6F86           05619          movwf    linia1
001BF8 0EF0           05620          movlw    0xf0
001BFA 6F87           05621          movwf    linia2
001BFC 0E11           05622          movlw    0x11
001BFE 6F9E           05623          movwf    znaczniki
                      05624          
                      05625          
                      05626          
                      05627          
001C00                05628 test_koniec
                      05629          
                      05630          ;bcf      PCLATH,3
                      05631          ;bcf      PCLATH,4
001C00 6AFA           05632          clrf     PCLATH
001C02 EF9C F001      05633          goto    Start
                      05634                   
                      05635 ;test ustawiania probkowania
                      05636 ;0x2a 0x93 probka         
                      05637 
                      05638 
                      05639          end
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 128


SYMBOL TABLE
  LABEL                             VALUE 

A                                 00000000
ACCESS                            00000000
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACQT0                             00000003
ACQT1                             00000004
ACQT2                             00000005
ADCON0                            00000FC2
ADCON1                            00000FC1
ADCON2                            00000FC0
ADCS0                             00000000
ADCS1                             00000001
ADCS2                             00000002
ADDEN                             00000003
ADEN                              00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADIP                              00000006
ADON                              00000000
ADRES                             00000FC3
ADRESH                            00000FC4
ADRESL                            00000FC3
AN0                               00000000
AN1                               00000001
AN10                              00000001
AN11                              00000004
AN12                              00000000
AN2                               00000002
AN3                               00000003
AN4                               00000005
AN5                               00000000
AN6                               00000001
AN7                               00000002
AN8                               00000002
AN9                               00000003
BANKED                            00000001
BCLIE                             00000003
BCLIF                             00000003
BCLIP                             00000003
BEGIN                             00000000
BEGIN2lcd_init                    00001B58
BF                                00000000
BOR                               00000000
BRGH                              00000002
BSR                               00000FE0
C                                 00000000
C1INV                             00000004
C1OUT_CMCON                       00000006
C1OUT_PORTA                       00000004
C2INV                             00000005
C2OUT_CMCON                       00000007
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 129


SYMBOL TABLE
  LABEL                             VALUE 

C2OUT_PORTA                       00000005
CCP1                              00000002
CCP1CON                           00000FBD
CCP1IE                            00000002
CCP1IF                            00000002
CCP1IP                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2A                             00000003
CCP2CON                           00000FBA
CCP2IE                            00000000
CCP2IF                            00000000
CCP2IP                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCP2_PORTB                        00000003
CCP2_PORTC                        00000001
CCPR1                             00000FBE
CCPR1H                            00000FBF
CCPR1L                            00000FBE
CCPR2                             00000FBB
CCPR2H                            00000FBC
CCPR2L                            00000FBB
CCP_init                          00001B4C
CFGS                              00000006
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CIS                               00000003
CK                                00000006
CKE                               00000006
CKP                               00000004
CLKI                              00000007
CLKO                              00000006
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             00000FB4
CMIE                              00000006
CMIF                              00000006
CMIP                              00000006
CREN                              00000004
CS                                00000002
CSRC                              00000007
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 130


SYMBOL TABLE
  LABEL                             VALUE 

CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            00000FB5
CVREF                             00000002
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC2B0                             00000004
DC2B1                             00000005
DDRA                              TRISA
DDRB                              TRISB
DDRC                              TRISC
DDRD                              TRISD
DDRE                              TRISE
DONE                              00000001
D_A                               00000005
D_NOT_A                           00000005
ECCPAS                            00000FB6
ECCPAS0                           00000004
ECCPAS1                           00000005
ECCPAS2                           00000006
ECCPASE                           00000007
EEADR                             00000FA9
EECON1                            00000FA6
EECON2                            00000FA7
EEDATA                            00000FA8
EEIE                              00000004
EEIF                              00000004
EEIP                              00000004
EEPGD                             00000007
FAST                              00000001
FERR                              00000002
FLTS                              00000002
FREE                              00000004
FSR0                              00000000
FSR0H                             00000FEA
FSR0L                             00000FE9
FSR1                              00000001
FSR1H                             00000FE2
FSR1L                             00000FE1
FSR2                              00000002
FSR2H                             00000FDA
FSR2L                             00000FD9
GCEN                              00000007
GIE                               00000007
GIEH                              00000007
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 131


SYMBOL TABLE
  LABEL                             VALUE 

GIEL                              00000006
GIE_GIEH                          00000007
GO                                00000001
GO_DONE                           00000001
GO_NOT_DONE                       00000001
I2C_DAT                           00000005
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
IDLEN                             00000007
INDF0                             00000FEF
INDF1                             00000FE7
INDF2                             00000FDF
INT0                              00000000
INT0E                             00000004
INT0F                             00000001
INT0IE                            00000004
INT0IF                            00000001
INT1                              00000001
INT1E                             00000003
INT1F                             00000000
INT1IE                            00000003
INT1IF                            00000000
INT1IP                            00000006
INT1P                             00000006
INT2                              00000002
INT2E                             00000004
INT2F                             00000001
INT2IE                            00000004
INT2IF                            00000001
INT2IP                            00000007
INT2P                             00000007
INTCON                            00000FF2
INTCON2                           00000FF1
INTCON3                           00000FF0
INTE                              00000004
INTEDG0                           00000006
INTEDG1                           00000005
INTEDG2                           00000004
INTF                              00000001
IOFS                              00000002
IPEN                              00000007
IPR1                              00000F9F
IPR2                              00000FA2
IRCF0                             00000004
IRCF1                             00000005
IRCF2                             00000006
IRVST                             00000005
IVRST                             00000005
KBI0                              00000004
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 132


SYMBOL TABLE
  LABEL                             VALUE 

KBI1                              00000005
KBI2                              00000006
KBI3                              00000007
LATA                              00000F89
LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA3                             00000003
LATA4                             00000004
LATA5                             00000005
LATA6                             00000006
LATA7                             00000007
LATB                              00000F8A
LATB0                             00000000
LATB1                             00000001
LATB2                             00000002
LATB3                             00000003
LATB4                             00000004
LATB5                             00000005
LATB6                             00000006
LATB7                             00000007
LATC                              00000F8B
LATC0                             00000000
LATC1                             00000001
LATC2                             00000002
LATC3                             00000003
LATC4                             00000004
LATC5                             00000005
LATC6                             00000006
LATC7                             00000007
LATD                              00000F8C
LATD0                             00000000
LATD1                             00000001
LATD2                             00000002
LATD3                             00000003
LATD4                             00000004
LATD5                             00000005
LATD6                             00000006
LATD7                             00000007
LATE                              00000F8D
LATE0                             00000000
LATE1                             00000001
LATE2                             00000002
LOOP                              00001AAA
LOOP1                             00001B04
LOOP11                            00001AE0
LOOP2                             00001B10
LOOP_sprawdz_keys                 00001AC8
LOOP_temperatury                  00001AE6
LVDCON                            00000FD2
LVDEN                             00000004
LVDIE                             00000002
LVDIF                             00000002
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 133


SYMBOL TABLE
  LABEL                             VALUE 

LVDIN                             00000005
LVDIP                             00000002
LVDL0                             00000000
LVDL1                             00000001
LVDL2                             00000002
LVDL3                             00000003
MCLR                              00000003
N                                 00000004
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BOR                           00000000
NOT_CS                            00000002
NOT_DONE                          00000001
NOT_PD                            00000002
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RD                            00000000
NOT_RI                            00000004
NOT_SS                            00000005
NOT_T1SYNC                        00000002
NOT_T3SYNC                        00000002
NOT_TO                            00000003
NOT_W                             00000002
NOT_WR                            00000001
NOT_WRITE                         00000002
OBF                               00000006
OERR                              00000001
OSC1                              00000007
OSC2                              00000006
OSCCON                            00000FD3
OSCFIE                            00000007
OSCFIF                            00000007
OSCFIP                            00000007
OSCTUN2                           00000F9A
OSCTUNE                           00000F9B
OSTS                              00000003
OV                                00000003
P                                 00000004
P1A                               00000002
P1B                               00000005
P1C                               00000006
P1D                               00000007
P1M0                              00000006
P1M1                              00000007
PC                                00000FF9
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000FF9
PCLATH                            00000FFA
PCLATU                            00000FFB
PD                                00000002
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 134


SYMBOL TABLE
  LABEL                             VALUE 

PDC0                              00000000
PDC1                              00000001
PDC2                              00000002
PDC3                              00000003
PDC4                              00000004
PDC5                              00000005
PDC6                              00000006
PEIE                              00000006
PEIE_GIEL                         00000006
PEN                               00000002
PGC                               00000006
PGD                               00000007
PGM                               00000005
PIE1                              00000F9D
PIE2                              00000FA0
PIN_HI                            0000077A
PIN_LO                            0000077E
PIR1                              00000F9E
PIR2                              00000FA1
PLUSW0                            00000FEB
PLUSW1                            00000FE3
PLUSW2                            00000FDB
POR                               00000001
PORTA                             00000F80
PORTB                             00000F81
PORTC                             00000F82
PORTD                             00000F83
PORTE                             00000F84
POSTDEC0                          00000FED
POSTDEC1                          00000FE5
POSTDEC2                          00000FDD
POSTINC0                          00000FEE
POSTINC1                          00000FE6
POSTINC2                          00000FDE
PR2                               00000FCB
PREINC0                           00000FEC
PREINC1                           00000FE4
PREINC2                           00000FDC
PROD                              00000FF3
PRODH                             00000FF4
PRODL                             00000FF3
PRSEN                             00000007
PSA                               00000003
PSP0                              00000000
PSP1                              00000001
PSP2                              00000002
PSP3                              00000003
PSP4                              00000004
PSP5                              00000005
PSP6                              00000006
PSP7                              00000007
PSPIE                             00000007
PSPIF                             00000007
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 135


SYMBOL TABLE
  LABEL                             VALUE 

PSPIP                             00000007
PSPMODE                           00000004
PSSAC0                            00000002
PSSAC1                            00000003
PSSBD0                            00000000
PSSBD1                            00000001
PWM1CON                           00000FB7
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RA6                               00000006
RA7                               00000007
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RBIP                              00000000
RBPU                              00000007
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCIP                              00000005
RCON                              00000FD0
RCREG                             00000FAE
RCSTA                             00000FAB
RD                                00000000
RD0                               00000000
RD1                               00000001
RD16                              00000007
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 136


SYMBOL TABLE
  LABEL                             VALUE 

RE0                               00000000
RE1                               00000001
RE2                               00000002
RE3                               00000003
READ_WRITE                        00000002
RI                                00000004
RSEN                              00000001
RX                                00000007
RX9                               00000006
RX9D                              00000000
RXD                               00000007
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SCK                               00000003
SCL                               00000003
SCS                               00000000
SCS0                              00000000
SCS1                              00000001
SDA                               00000004
SDI                               00000004
SDO                               00000005
SEN                               00000000
SMP                               00000007
SP0                               00000000
SP1                               00000001
SP2                               00000002
SP3                               00000003
SP4                               00000004
SPBRG                             00000FAF
SPEN                              00000007
SREN                              00000005
SS                                00000005
SSPADD                            00000FC8
SSPBUF                            00000FC9
SSPCON1                           00000FC6
SSPCON2                           00000FC5
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPIP                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000FC7
STATUS                            00000FD8
STKFUL                            00000007
STKOVF                            00000007
STKPTR                            00000FFC
STKPTR0                           00000000
STKPTR1                           00000001
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 137


SYMBOL TABLE
  LABEL                             VALUE 

STKPTR2                           00000002
STKPTR3                           00000003
STKPTR4                           00000004
STKUNF                            00000006
SWDTE                             00000000
SWDTEN                            00000000
SYNC                              00000004
Start                             00000338
T016BIT                           00000006
T08BIT                            00000006
T0CKI                             00000004
T0CON                             00000FD5
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0IP                              00000002
T0PS0                             00000000
T0PS1                             00000001
T0PS2                             00000002
T0PS3                             00000003
T0SE                              00000004
T13CKI                            00000000
T1CKI                             00000000
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000FCD
T1OSCEN                           00000003
T1OSI                             00000001
T1OSO                             00000000
T1RUN                             00000006
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000FCA
T3CCP1                            00000003
T3CCP2                            00000006
T3CKPS0                           00000004
T3CKPS1                           00000005
T3CON                             00000FB1
T3SYNC                            00000002
TABLAT                            00000FF5
TBLPTR                            00000FF6
TBLPTRH                           00000FF7
TBLPTRL                           00000FF6
TBLPTRU                           00000FF8
TMR0H                             00000FD7
TMR0IE                            00000005
TMR0IF                            00000002
TMR0IP                            00000002
TMR0L                             00000FD6
TMR0ON                            00000007
TMR1CS                            00000001
TMR1H                             00000FCF
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 138


SYMBOL TABLE
  LABEL                             VALUE 

TMR1IE                            00000000
TMR1IF                            00000000
TMR1IP                            00000000
TMR1L                             00000FCE
TMR1ON                            00000000
TMR2                              00000FCC
TMR2IE                            00000001
TMR2IF                            00000001
TMR2IP                            00000001
TMR2ON                            00000002
TMR3CS                            00000001
TMR3H                             00000FB3
TMR3IE                            00000001
TMR3IF                            00000001
TMR3IP                            00000001
TMR3L                             00000FB2
TMR3ON                            00000000
TMR_nie_pusty                     00000552
TO                                00000003
TOS                               00000FFD
TOSH                              00000FFE
TOSL                              00000FFD
TOSU                              00000FFF
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000F92
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISA6                            00000006
TRISA7                            00000007
TRISB                             00000F93
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000F94
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 139


SYMBOL TABLE
  LABEL                             VALUE 

TRISC7                            00000007
TRISD                             00000F95
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000F96
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TUN5                              00000005
TUNSEL                            00000007
TX                                00000006
TX9                               00000006
TX9D                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXIP                              00000004
TXREG                             00000FAD
TXREG_nie_pusty                   00000558
TXSTA                             00000FAC
Tab_zle_polecenie                 00000672
Timer3_init                       00001B54
UA                                00000001
VCFG0                             00000004
VCFG1                             00000005
VREFM                             00000002
VREFP                             00000003
W                                 00000000
WCOL                              00000007
WDTCON                            00000FD1
WR                                00000001
WREG                              00000FE8
WREN                              00000002
WRERR                             00000003
Z                                 00000002
_1                                00000031
_16K                              000000FD
_1K                               000000F5
_2                                00000032
_2K                               000000F7
_3                                00000033
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 140


SYMBOL TABLE
  LABEL                             VALUE 

_32K                              000000FF
_4                                00000034
_4K                               000000F9
_5                                00000035
_6                                00000036
_7                                00000037
_8                                00000038
_8K                               000000FB
_9                                00000039
_A                                00000041
_B                                00000042
_BORV_20_2L                       000000FF
_BORV_27_2L                       000000FB
_BORV_42_2L                       000000F7
_BORV_45_2L                       000000F3
_BOR_OFF_2L                       000000FD
_BOR_ON_2L                        000000FF
_C                                00000043
_CCP2MX_B3                        000000FE
_CCP2MX_B3_3H                     000000FE
_CCP2MX_C1                        000000FF
_CCP2MX_C1_3H                     000000FF
_CCP2MX_OFF                       000000FE
_CCP2MX_OFF_3H                    000000FE
_CCP2MX_ON                        000000FF
_CCP2MX_ON_3H                     000000FF
_CONFIG1H                         00300001
_CONFIG2H                         00300003
_CONFIG2L                         00300002
_CONFIG3H                         00300005
_CONFIG4L                         00300006
_CONFIG5H                         00300009
_CONFIG5L                         00300008
_CONFIG6H                         0030000B
_CONFIG6L                         0030000A
_CONFIG7H                         0030000D
_CONFIG7L                         0030000C
_CP0_OFF_5L                       000000FF
_CP0_ON_5L                        000000FE
_CP1_OFF_5L                       000000FF
_CP1_ON_5L                        000000FD
_CP2_OFF_5L                       000000FF
_CP2_ON_5L                        000000FB
_CP3_OFF_5L                       000000FF
_CP3_ON_5L                        000000F7
_CPB_OFF_5H                       000000FF
_CPB_ON_5H                        000000BF
_CPD_OFF_5H                       000000FF
_CPD_ON_5H                        0000007F
_D                                00000044
_DEBUG_OFF_4L                     000000FF
_DEBUG_ON_4L                      0000007F
_DEVID1                           003FFFFE
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 141


SYMBOL TABLE
  LABEL                             VALUE 

_DEVID2                           003FFFFF
_E                                00000045
_EBTR0_OFF_7L                     000000FF
_EBTR0_ON_7L                      000000FE
_EBTR1_OFF_7L                     000000FF
_EBTR1_ON_7L                      000000FD
_EBTR2_OFF_7L                     000000FF
_EBTR2_ON_7L                      000000FB
_EBTR3_OFF_7L                     000000FF
_EBTR3_ON_7L                      000000F7
_EBTRB_OFF_7H                     000000FF
_EBTRB_ON_7H                      000000BF
_ECIOP_OSC                        000000F5
_ECIOP_OSC_1H                     000000F5
_ECIO_OSC_1H                      000000F5
_EC_OSC                           000000F4
_EC_OSC_1H                        000000F4
_F                                00000046
_FSCM_OFF_1H                      000000BF
_FSCM_ON_1H                       000000FF
_G                                00000047
_H                                00000048
_HSPLL_OSC                        000000F6
_HSPLL_OSC_1H                     000000F6
_HS_OSC                           000000F2
_HS_OSC_1H                        000000F2
_I                                00000049
_IDLOC0                           00200000
_IDLOC1                           00200001
_IDLOC2                           00200002
_IDLOC3                           00200003
_IDLOC4                           00200004
_IDLOC5                           00200005
_IDLOC6                           00200006
_IDLOC7                           00200007
_IESO_OFF_1H                      0000007F
_IESO_ON_1H                       000000FF
_INTIO1_OSC                       000000F9
_INTIO1_OSC_1H                    000000F9
_INTIO2_OSC                       000000F8
_INTIO2_OSC_1H                    000000F8
_J                                0000004A
_K                                0000004B
_L                                0000004C
_LP_OSC                           000000F0
_LP_OSC_1H                        000000F0
_LVP_OFF_4L                       000000FB
_LVP_ON_4L                        000000FF
_M                                0000004D
_MCLRE_OFF_3H                     0000007F
_MCLRE_ON_3H                      000000FF
_N                                0000004E
_O                                0000004F
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 142


SYMBOL TABLE
  LABEL                             VALUE 

_P                                00000050
_PBAD_ANA_3H                      000000FF
_PBAD_DIG_3H                      000000FD
_PWRT_OFF_2L                      000000FF
_PWRT_ON_2L                       000000FE
_Q                                00000051
_R                                00000052
_RCIO_OSC                         000000F7
_RCIO_OSC_1H                      000000F7
_RC_OSC                           000000FC
_RC_OSC_1H                        000000FC
_S                                00000053
_STVR_OFF_4L                      000000FE
_STVR_ON_4L                       000000FF
_T                                00000054
_U                                00000055
_V                                00000056
_W                                00000057
_WDTPS_128_2H                     000000EF
_WDTPS_16K_2H                     000000FD
_WDTPS_16_2H                      000000E9
_WDTPS_1K_2H                      000000F5
_WDTPS_1_2H                       000000E1
_WDTPS_256_2H                     000000F1
_WDTPS_2K_2H                      000000F7
_WDTPS_2_2H                       000000E3
_WDTPS_32K_2H                     000000FF
_WDTPS_32_2H                      000000EB
_WDTPS_4K_2H                      000000F9
_WDTPS_4_2H                       000000E5
_WDTPS_512_2H                     000000F3
_WDTPS_64_2H                      000000ED
_WDTPS_8K_2H                      000000FB
_WDTPS_8_2H                       000000E7
_WDT_OFF_2H                       000000FE
_WDT_ON_2H                        000000FF
_WRT0_OFF_6L                      000000FF
_WRT0_ON_6L                       000000FE
_WRT1_OFF_6L                      000000FF
_WRT1_ON_6L                       000000FD
_WRT2_OFF_6L                      000000FF
_WRT2_ON_6L                       000000FB
_WRT3_OFF_6L                      000000FF
_WRT3_ON_6L                       000000F7
_WRTB_OFF_6H                      000000FF
_WRTB_ON_6H                       000000BF
_WRTC_OFF_6H                      000000FF
_WRTC_ON_6H                       000000DF
_WRTD_OFF_6H                      000000FF
_WRTD_ON_6H                       0000007F
_X                                00000058
_XT_OSC                           000000F1
_XT_OSC_1H                        000000F1
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 143


SYMBOL TABLE
  LABEL                             VALUE 

_Y                                00000059
_Z                                0000005A
__18F4320                         00000001
_a                                00000061
_b                                00000062
_c                                00000063
_d                                00000064
_dwukropek                        0000003A
_e                                00000065
_f                                00000066
_g                                00000067
_h                                00000068
_i                                00000069
_j                                0000006A
_k                                0000006B
_kropka                           0000002E
_l                                0000006C
_linia_pionowa                    0000007C
_m                                0000006D
_minus                            0000002D
_mniejszosci                      0000003C
_n                                0000006E
_o                                0000006F
_p                                00000070
_plus                             0000002B
_przecinek                        0000002C
_puste                            00000020
_q                                00000071
_r                                00000072
_s                                00000073
_star                             0000002A
_stopni                           000000DF
_t                                00000074
_u                                00000075
_up                               0000005E
_v                                00000076
_w                                00000077
_wiekszosci                       0000003E
_x                                00000078
_y                                00000079
_z                                0000007A
aktualny_odstep                   000000A8
bajt_ds                           000000CA
bez_wlaczania_pomiarow            000004F2
bez_wyswietlania_pradu            00000CFE
bez_wyswietlania_pradu2           00000D3A
bez_wyswietlania_temp1            00000C30
bez_wyswietlania_temp2            00000CBA
bit                               0000008C
blad_inicjacji_ds                 000007E0
bsr_temp                          00000083
check                             00000272
check_busy                        00000264
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 144


SYMBOL TABLE
  LABEL                             VALUE 

check_if_write                    00000316
clear_line                        00000246
clear_line_old                    00000218
clear_line_old2                   0000022C
clear_line_petla                  0000024C
cmd_off                           00000214
cyfry_0_9                         00000606
czekam_na_kolejny_bit             000008B8
czujnik_ds1820                    00000005
czy_ekran                         00000001
czy_moge_juz_zmieniac             00000002
czy_pomiary_na_ekran              00000001
czy_ponownie_wlaczyc_temp         00000000
czy_ponownie_wlaczyc_zegar        00000001
czy_usrednianie                   00000000
czy_wlaczyc_ponownie_temp         00000006
czy_wyswietlam_temp               00000005
czy_wysylac_pomiary_serial        00000004
czy_wysylanie                     00000001
czy_zegar_wyswietlac              00000002
czytaj_eeprom                     0000030C
czytam_4_linie                    000015DE
czytam_4_linie2                   000015EA
czytam_4_linie3                   000015FC
czytam_druga_linie                000015A2
czytam_druga_linie2               000015AE
czytam_pierwsza_linie             00001590
czytam_trzecia_linie              000015C0
czytam_trzecia_linie2             000015CC
dana                              00000003
dane_lcd                          000000A2
dane_odebraneH                    00000001
dane_odebraneL                    00000000
dd_addres_set                     00000080
dec1                              00000098
dec10                             00000097
dec100                            00000096
disp_home                         00000002
display1_4b                       00000000
display2_4b                       0000000F
display_2                         0000000F
display_clear                     00000001
display_clear1_4b                 00000000
display_clear2_4b                 00000001
display_off                       00000008
display_on                        0000000C
dlugosc_oczekiwania_na_zmiane     00000004
do_sekundy                        000000DF
dzialanie_po_klawiszu             00000005
dzien_1                           000000D8
dzien_10                          000000D7
enable                            00000003
enter_back_wyjsc_z_opcji_czujnik  000018C0
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 145


SYMBOL TABLE
  LABEL                             VALUE 

enter_back_wyjsc_z_opcji_wyswiet  00001938
entry                             00000006
entry1_4b                         00000000
entry2_4b                         0000000C
fsrh1_temp                        000000E5
fsrh_temp                         00000085
fsrl1_temp                        000000E4
fsrl_temp                         00000084
function_set1_4b                  00000003
function_set2                     00000008
function_set2_4b                  00000008
godziny_1                         000000DA
godziny_10                        000000D9
hex2_dec_koniec                   0000043C
hex2dec18                         000003D8
hex2dec18_brak_setek              0000040E
hex2dec18_nie_przekroczono_1      000003FC
hex2dec_temperatur_popraw_o_128   0000042C
hex2dec_temperatur_popraw_o_64    00000420
histereza                         000000E6
ile_kanalow                       000000A5
ile_znakow                        00000010
inicjacja                         00001B14
inicjacja_ds1820                  000007B2
inicjacja_ok                      00000808
inicjuj_pomiar                    00000692
inicjuj_pomiary                   00000003
init_4bit                         00000022
init_8bit                         00000030
jak_duzo_bajtow_odbieram_z_ds     000000B5
jak_duzo_kanalow_pradu            000000D5
jak_duzo_probek                   000000AF
jak_duzo_zliczen_tmr1_na_sekunde  00000010
jaka_wartosc_regulujeH            000000AD
jaka_wartosc_regulujeL            000000AE
jezeli_nie_wysylam_pomiarow       00000EAA
juz_wysylac                       00000DD2
juz_wysylac_znak_LF               00000E9A
kalibracja                        00000000
kb_change                         00000004
kb_cofnij                         00000005
kb_enter                          00000006
kb_minus                          00000007
koncz_z_moca                      00000DCE
koniec_wyswietlania               00000AAC
kopiuj_liczbe_przeslana           000005DE
ktora_probka                      000000B0
ktore_bity_lcd_tris               000000F0
ktore_bity_uzywane_na_lcd         0000000F
ktory_aktualnie_kanal_pradu       000000D6
ktory_czujnik_reguluje            000000E8
ktory_kanal                       000000B1
ktory_kanal_mierze                000000A6
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 146


SYMBOL TABLE
  LABEL                             VALUE 

ktory_rejestr_zapisuje            000000A9
lampka                            00000004
lampka2                           00000004
latch_back                        00000000
latch_down                        00000001
latch_enter                       00000003
latch_keys                        00000F83
latch_lcd                         00000F8C
latch_lcd_e                       00000F8B
latch_lcd_rs                      00000F8A
latch_lcd_rw                      00000F8A
latch_moc                         00000F8A
latch_multiplekser                00000F8B
latch_up                          00000002
lcd_init                          00000298
letter                            0000008A
liczba1                           0000008E
liczba2                           0000008F
liczba3                           00000090
linia1                            00000086
linia2                            00000087
linia3                            00000088
linia4                            00000089
linia_czwarta                     000000D0
linia_dolna                       000000C0
linia_druga                       000000C0
linia_gorna                       00000080
linia_pierwsza                    00000080
linia_trzecia                     00000090
ma                                00000002
mamy_back                         00000000
mamy_down                         00000001
mamy_enter                        00000003
mamy_up                           00000002
markers                           0000009F
markers2                          000000A0
markers3                          000000A1
mb                                00000001
mc                                00000000
menu_opcje1                       00000000
menu_opcje2                       00000001
menu_opcje3                       00000002
menu_opcje4                       00000003
menu_opcje_end                    00000004
minuty_1                          000000DC
minuty_10                         000000DB
n                                 0000008B
napisz_czas                       0000043E
napisz_minus                      00000006
napisz_wartosc_temperatury        00000C8E
next                              00001B80
nie                               00000001
nie_czysc_rejestru_polozenia      00000C42
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 147


SYMBOL TABLE
  LABEL                             VALUE 

nie_przekroczono_bajtu_ulamka     00000BDA
normalne_ustawienie_tris_lcd      0000000F
numer_opcji                       000000E1
numer_opcji_koncowej              00000010
odczytaj_adres_polozenia_gwiazdk  0000186A
odebrano_liter                    0000008D
odejmij_512_od_wyniku_sredniej    00000B8E
odstep_pomiarowy                  000000A7
odswiezanie_zegara                00000003
odznacz_by_znow_mierzyc           000004B8
opcja_czujnik_regulacji           00000010
opcja_czujniki                    00000001
opcja_histereza                   00000009
opcja_odstep                      00000002
opcja_podswietlenie               0000000F
opcja_pomiar_i                    00000006
opcja_regulacja                   00000004
opcja_srednia                     00000003
opcja_ustaw_moc                   0000000A
opcja_ustaw_serial                0000000C
opcja_ustaw_temp                  00000005
opcja_ustaw_zegar                 0000000B
opcja_wlacz_1                     00000007
opcja_wlacz_2                     00000008
opcja_wyswietl_temp               0000000E
opcja_wyswietl_zegar              0000000D
pclath_temp                       00000082
petla_czy_jest_0                  00000892
petla_dzielenia                   00000BA8
petla_inicjacji1                  000007C8
petla_inicjacji2                  000007D4
petla_inicjacji3                  000007FC
petla_napisz_czas                 0000047E
petla_napisz_czas_dwukropek       00000474
petla_odbioru_ds1820              00000888
petla_odczytu_poprawek_z_eeprom   00000344
petla_send0                       000007A6
petla_send1                       00000792
petla_sending                     00000856
petla_wysylania_odebranych_bajto  000008D6
pin_A                             00000000
pin_B                             00000001
pin_C                             00000002
pin_e_4724                        00000001
pisz_cyfre_1                      00000B10
pisz_cyfre_10                     00000B04
pisz_cyfre_100                    00000AF8
pisz_ulamek_00                    00000B36
pisz_ulamek_25                    00000B4C
pisz_ulamek_50                    00000B62
pisz_ulamek_75                    00000B78
pokaz_rejestr                     00000618
pokazuje_temperatury_47           00000007
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 148


SYMBOL TABLE
  LABEL                             VALUE 

polecenie_wysylane                000000B4
polozenie_danych_lcd              00000001
polozenie_gwiazdki                000000E2
polozenie_liczby_menu             0000000C
pomiar0H                          000000B6
pomiar0L                          000000B7
pomiar1H                          000000B8
pomiar1L                          000000B9
pomiar2H                          000000BA
pomiar2L                          000000BB
pomiar3H                          000000BC
pomiar3L                          000000BD
pomiar4H                          000000BE
pomiar4L                          000000BF
pomiar5H                          000000C0
pomiar5L                          000000C1
pomiar6H                          000000C2
pomiar6L                          000000C3
pomiar7H                          000000C4
pomiar7L                          000000C5
pomiarH                           000000AA
pomiarL                           000000AB
pomiar_prad1                      00000002
pomiar_prad1H                     000000C6
pomiar_prad1L                     000000C7
pomiar_prad2                      00000004
pomiar_prad2H                     000000C8
pomiar_prad2L                     000000C9
pomiar_ulamek                     000000AC
pomiary                           00000002
pomiary_pradu                     00000000
pomiary_zrobione                  00000002
poprawka0                         000000CB
poprawka0_ee                      00000000
poprawka1                         000000CC
poprawka1_ee                      00000001
poprawka2                         000000CD
poprawka2_ee                      00000002
poprawka3                         000000CE
poprawka3_ee                      00000003
poprawka4                         000000CF
poprawka4_ee                      00000004
poprawka5                         000000D0
poprawka5_ee                      00000005
poprawka6                         000000D1
poprawka6_ee                      00000006
poprawka7                         000000D2
poprawka7_ee                      00000007
poprawka_prad1                    000000D3
poprawka_prad1_ee                 00000008
poprawka_prad2                    000000D4
poprawka_prad2_ee                 00000009
port_CTS                          00000F82
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 149


SYMBOL TABLE
  LABEL                             VALUE 

port_RTS                          00000F82
port_ds1820                       00000F82
port_keys                         00000F83
port_lcd                          00000F83
port_lcd_e                        00000F82
port_lcd_rs                       00000F81
port_lcd_rw                       00000F81
port_multiplekser                 00000F82
port_serial                       00000F81
port_triak                        00000F81
portlampka2                       00000F81
powrot_z_polecen                  00000A4E
pozycja_menu                      000000E0
procedura_obslugi_zegara          000004F2
procedura_regulacji_dwustawnej    00000D3E
procedura_sumowania_wyniku        00000BC8
procedura_wyswietlania_kolejnych  000018DA
procek                            018F4320
przerwanie                        00000008
przerwanie_1                      0000002E
przerwanie_2                      0000003A
przerwanie_3                      00000046
przerwanie_4                      00000052
przerwanie_5                      0000005E
przerwanie_6                      00000064
przerwanie_7                      00000070
przerwanie_pomiaru                0000018A
przerwanie_t0                     00000000
przerwanie_t1                     00000001
przerwanie_wysylania              00000176
rcsta_temp                        000000A4
reguluj                           00000006
rozkaz_rejestracji_poprawki_pomi  0000096C
rozkaz_wysylania_znaku_na_lcd     00000762
rozkazy_ds1820                    00000926
rozpocznij_pomiary                000004CA
rs                                00000003
rw                                00000002
sa_rowne_nic_nie_rob              00000D84
sa_rowne_sprawdz_Lbajt            00000D6A
sekundy_1                         000000DE
sekundy_10                        000000DD
send                              000001E8
send4bit_petla                    000001EE
send_0                            0000079A
send_1                            00000784
set_4bit                          00000028
set_8bit                          0000003C
sprawdz_10                        00000ABC
sprawdz_RTS                       00000DEE
sprawdz_RTS_prad                  00000E2A
sprawdz_czy_ds1820_wysyla         00000880
sprawdz_czy_mam_dalej_mierzyc     00000D8C
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 150


SYMBOL TABLE
  LABEL                             VALUE 

sprawdz_czy_mam_dalej_mierzyc_pr  00000D9E
sprawdz_czy_mam_wyswietlac_47     00000C5C
sprawdz_czy_mozna_wysylac         00000552
sprawdz_czy_odebrano_litere       000005A6
sprawdz_czy_odebrano_mala_litere  000005C6
sprawdz_czy_polecenie             000009B8
sprawdz_czy_wchodze_do_zmiany_op  0000164A
sprawdz_czy_wlaczyc_szybka_zmian  00000F44
sprawdz_dzien                     000000E2
sprawdz_godziny                   000000FC
sprawdz_ktore_polecenie           000009CA
sprawdz_odebrane                  00000003
sprawdz_zwiekszanie_godzin_norma  000014D4
stan2_key                         0000009A
stan_key                          00000099
status_temp                       00000081
sumuj_liczby                      00000502
sumuj_liczby_do_kropki            00000506
szybka_zmiana_wartosci            000000E3
tab_test                          00001BC0
tablica_czwarta                   00001A6C
tablica_druga                     00001A22
tablica_gwiazdki                  00001AA4
tablica_pierwsza                  00001A00
tablica_trzecia                   00001A42
test_koniec                       00001C00
test_petla                        00001BA6
test_regulator                    00001BD0
tmp                               00000091
tmp6                              00000094
tmp7                              00000095
tmp_hex                           00000092
tmp_hex_H                         00000093
tmp_lcd                           000000A3
triak1                            00000000
triak2                            00000001
tris_lcd                          00000F95
trzymanie_klawisza                00000007
usrednianie_przez_co_mnoze        000000B2
usrednianie_wartosci              00000BA4
ustaw_linie_druga                 00000C7E
ustaw_linie_trzecia               00000C6E
ustaw_probki                      0000073C
ustaw_regulator                   000006FE
ustaw_spbrg                       0000060C
ustaw_sprawdzanie_szybkiej_zmian  00000F60
ustaw_wartosc_dzielenia_usrednia  0000071C
ustaw_wyswietlanie_czasu_na_lcd   00000108
ustawianie_czasu_co_wyswietlam    000000E7
ustawienie_liczby_odbieranych_ba  00000906
w_temp                            00000080
wait                              000001DA
wait_petla                        000001DC
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 151


SYMBOL TABLE
  LABEL                             VALUE 

wcisnieto_back                    00000F06
wcisnieto_down                    00000F14
wcisnieto_enter                   00000F6A
wcisnieto_klawisz                 00000004
wcisnieto_up                      00000F2C
wlacz_przerwanie_tmr3             00000EFA
wlaczenie_rejestracji_pradu       0000094A
write                             00000040
write_4bit                        00000010
write_lcd                         0000020A
wybor_czujnika_regulatora         0000099C
wybrano_czujnik_regulatora_wieks  000009B0
wyjscie_przerwanie                00000070
wykonano_pomiary_wszystkich_kana  00000DB2
wykryto_back                      00000F78
wykryto_back_exit                 00000F96
wykryto_back_nic_nie_rob          00000F96
wykryto_blad                      00000184
wykryto_down                      00000F9E
wykryto_down_3_wyswietl           00001102
wykryto_down_exit                 0000125A
wykryto_down_exit_trzymanie       00001268
wykryto_down_sprawdz12            0000123A
wykryto_down_sprawdz16            0000123A
wykryto_down_sprawdz17            0000125A
wykryto_down_sprawdz_10           00001168
wykryto_down_sprawdz_11           00001168
wykryto_down_sprawdz_11_1         000011A2
wykryto_down_sprawdz_11_2         000011D6
wykryto_down_sprawdz_11_3         0000120A
wykryto_down_sprawdz_11_4         00001232
wykryto_down_sprawdz_2            000010BE
wykryto_down_sprawdz_3            000010DE
wykryto_down_sprawdz_3_zmniejsz_  000010F6
wykryto_down_sprawdz_4            00001120
wykryto_down_sprawdz_5            00001120
wykryto_down_sprawdz_5_zawracani  0000113C
wykryto_down_sprawdz_5_zero       00001140
wykryto_down_sprawdz_6            00001148
wykryto_down_sprawdz_9            00001148
wykryto_down_sprawdz_czy_wyswiet  00000FBC
wykryto_down_wyswietl_opcje_tabl  00001028
wykryto_down_zmiana_opcji         0000108C
wykryto_down_zmiana_opcji_wyswie  000010A2
wykryto_down_zmiana_polozenia_gw  00001058
wykryto_enter                     000015FE
wykryto_enter_exit                00001862
wykryto_enter_gdzie_wyswietlam_l  00001880
wykryto_enter_sprawdz_opcje10     00001754
wykryto_enter_sprawdz_opcje11     00001754
wykryto_enter_sprawdz_opcje12     0000176A
wykryto_enter_sprawdz_opcje13     00001778
wykryto_enter_sprawdz_opcje14     00001786
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 152


SYMBOL TABLE
  LABEL                             VALUE 

wykryto_enter_sprawdz_opcje15     00001794
wykryto_enter_sprawdz_opcje16     000017A2
wykryto_enter_sprawdz_opcje17     000017C2
wykryto_enter_sprawdz_opcje2      00001670
wykryto_enter_sprawdz_opcje3      00001690
wykryto_enter_sprawdz_opcje4      000016B0
wykryto_enter_sprawdz_opcje5      000016BE
wykryto_enter_sprawdz_opcje6      00001704
wykryto_enter_sprawdz_opcje7      00001718
wykryto_enter_sprawdz_opcje8      00001726
wykryto_enter_sprawdz_opcje9      00001734
wykryto_enter_wyjscie_opcje10     0000182A
wykryto_enter_wyjscie_opcje11     0000182A
wykryto_enter_wyjscie_opcje11_2   00001842
wykryto_enter_wyjscie_opcje12     00001852
wykryto_enter_wyjscie_opcje16     00001852
wykryto_enter_wyjscie_opcje17     00001862
wykryto_enter_wyjscie_opcje2      000017EA
wykryto_enter_wyjscie_opcje3      000017FA
wykryto_enter_wyjscie_opcje4      0000180A
wykryto_enter_wyjscie_opcje5      0000180A
wykryto_enter_wyjscie_opcje6      0000181A
wykryto_enter_wyjscie_opcje9      0000181A
wykryto_enter_zmiana_opcji        000017C6
wykryto_odbior                    00000132
wykryto_odbior_CR                 00000162
wykryto_odbior_odczyt             00000132
wykryto_oerr                      0000017A
wykryto_rb                        00000116
wykryto_t0                        00000122
wykryto_t1                        0000008C
wykryto_t1_wyjscie                00000110
wykryto_t2                        0000012C
wykryto_t3                        000001A6
wykryto_t3_nie_puszczono          000001BE
wykryto_up                        0000126C
wykryto_up_3_wyswietl             00001422
wykryto_up_exit                   0000156E
wykryto_up_exit_trzymanie         0000157C
wykryto_up_sprawdz12              0000154E
wykryto_up_sprawdz16              0000154E
wykryto_up_sprawdz_10             00001478
wykryto_up_sprawdz_11             00001478
wykryto_up_sprawdz_11_1           000014B2
wykryto_up_sprawdz_11_2           000014EC
wykryto_up_sprawdz_11_3           0000151E
wykryto_up_sprawdz_11_4           00001546
wykryto_up_sprawdz_2              000013DA
wykryto_up_sprawdz_3              000013FA
wykryto_up_sprawdz_3_zwieksz_pro  00001414
wykryto_up_sprawdz_4              00001438
wykryto_up_sprawdz_5              00001438
wykryto_up_sprawdz_5_dalej        00001450
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 153


SYMBOL TABLE
  LABEL                             VALUE 

wykryto_up_sprawdz_6              00001458
wykryto_up_sprawdz_9              00001458
wykryto_up_sprawdz_czy_wyswietla  0000128A
wykryto_up_wyswietl_opcje_tablic  000012CE
wykryto_up_zmiana_opcji           000013AA
wykryto_up_zmiana_opcji_wyswietl  000013BE
wykryto_up_zmiana_polozenia_gwia  00001376
wylacz_moc                        00000007
wylacz_pomiary                    000006E2
wylacz_regulator                  000006F6
wylaczam_moc                      00000DCC
wylaczenie_rejestarcji_pradu      00000966
wynik                             0000009C
wynik01                           0000009D
wynik_to_po_prostu_L              00000BA2
wynikh                            0000009B
wyslij_na_ekran_to_co_odebralem   00000A58
wyslij_pomiar                     00000004
wyslij_starszy                    00000DEE
wyslij_znak                       00000560
wyslij_znak_koniec                00000580
wyslij_znak_petla                 00000568
wyswietl_1                        00000490
wyswietl_cyfry_temperatury        00000AB2
wyswietl_cyfry_temperatury2       00000AC6
wyswietl_litere_petla             00000A6E
wyswietl_litere_petla2            00000A88
wyswietl_litere_petla3            00000AA6
wyswietl_opcje_menu               00001580
wyswietl_puste                    0000048E
wyswietl_temp_w_opcjach           000016D0
wysylanie_bajtu_rozkazu           00000848
wysylanie_danych                  00000836
wysylanie_danych_rozkaz           0000083C
wysylanie_pomiaru                 00000BEE
zalacz_grzanie                    00000D62
zalacz_moc                        00000005
zamien_na_hex                     000005F4
zapal_lampke                      000004FC
zapis_do_pamieci_prad             00000CBE
zapis_do_pamieci_temperatury      00000C06
zapis_eeprom                      00000316
zapisz_do_dzien_1_0               000014A2
zapisz_do_dzien_1_99              00001192
zapisz_do_godziny_1_9             000011C6
zapisz_do_minuty_1_0              0000150E
zapisz_do_minuty_1_9              000011FA
zapisz_do_pamieci                 00000C00
zapisz_do_pamieci_nie_sprawdzaj_  00000C1E
zapisz_do_sekundy_1_0             0000153A
zapisz_do_sekundy_1_9             00001226
zla_dana_wez_0                    000005DA
zle_polecenie                     00000650
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 154


SYMBOL TABLE
  LABEL                             VALUE 

zle_polecenie_petla               00000652
zmiana_opcji                      00000007
zmierz_nastepny_czujnik_temperat  00000EC4
zmierz_nastepny_kanal             00000ED0
zmierz_nastepny_nie_3             00000EE8
zmierz_prad                       00000EBA
zmniejsz_dzien_1                  0000119C
zmniejsz_godziny_1                000011D0
zmniejsz_minuty_1                 00001204
zmniejsz_sekundy_1                00001230
znacznik_CTS                      00000004
znacznik_RTS                      00000005
znacznik_pomiaru_pradu            00000001
znaczniki                         0000009E
znaczniki_ds                      000000B3
znak_I                            000000CC
znak_cr                           0000000D
znak_lf                           0000000A
znow_kaz_mierzyc                  00000BE8
zwieksz_dzien_1                   000014AC
zwieksz_godziny_1                 000014E6
zwieksz_minuty_1                  00001518
zwieksz_przy_wysylaniu_FSR        00000DEC
zwieksz_sekundy_1                 00001544
﻿                               00000000


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XXXX----XXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
02C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
03C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 155


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


0440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
04C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0580 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
05C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0600 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0640 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0680 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
06C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0700 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0740 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0780 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
07C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0800 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0840 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0880 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
08C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0900 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0940 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0980 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
09C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0AC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0BC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0CC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0DC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0EC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 156


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


0FC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
10C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
11C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
12C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
13C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
14C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1580 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
15C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1600 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1640 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1680 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
16C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1700 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1740 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1780 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
17C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1800 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1840 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1880 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
18C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1900 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1940 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1980 : XXXXXXXX-------- ---------------- ---------------- ----------------
1A00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1A40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1A80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1AC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1B00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1B40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM  5.39                  SERIAL_MPLAB.ASM   5-9-2011  14:54:09         PAGE 157


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


1B80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1BC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1C00 : XXXXXX---------- ---------------- ---------------- ----------------
0000 : XXXXXXXX-------- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Bytes Used:  7058
Program Memory Bytes Free:  1134


Errors   :    12
Warnings :   110 reported,     0 suppressed
Messages :     0 reported,     0 suppressed

